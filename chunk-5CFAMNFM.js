import{a as dt,b as ft}from"./chunk-OC5M4CSB.js";import{eb as ut,na as rt,oa as at,qa as lt,ta as ht,va as ct}from"./chunk-TXLPFZIX.js";import{Cb as D,Ea as Y,Fa as $,Ga as j,Ib as Z,Ma as G,Mc as nt,Pa as X,Pb as L,Qc as ot,Rc as S,Ua as K,Ub as N,Vb as I,Wb as F,_b as q,bc as J,dc as P,ea as U,ic as Q,jc as tt,kc as et,la as _,lb as M,mb as B,mc as v,n as x,nc as b,pd as st,qa as k,ua as V,uc as it,va as H,zb as W}from"./chunk-7MXG77XU.js";var Ct=["canvas"];function Et(r,m){r&1&&F(0,"nz-spin")}function wt(r,m){if(r&1){let l=q();N(0,"div")(1,"p",2),v(2),I(),N(3,"button",3),J("click",function(){$(l);let u=P(2);return j(u.reloadQRCode())}),F(4,"span",4),N(5,"span"),v(6),I()()()}if(r&2){let l=P(2);M(2),b(l.locale.expired),M(4),b(l.locale.refresh)}}function pt(r,m){if(r&1&&(N(0,"div")(1,"p",2),v(2),I()()),r&2){let l=P(2);M(2),b(l.locale.scanned)}}function zt(r,m){if(r&1&&(N(0,"div",1),D(1,Et,1,0,"nz-spin")(2,wt,7,2,"div")(3,pt,3,1,"div"),I()),r&2){let l,a=P();M(),L((l=a.nzStatus)==="loading"?1:l==="expired"?2:l==="scanned"?3:-1)}}function gt(r,m){r&1&&F(0,"canvas",null,0)}var g;(function(r){let m=(()=>{class o{static encodeText(t,e){let i=r.QrSegment.makeSegments(t);return o.encodeSegments(i,e)}static encodeBinary(t,e){let i=r.QrSegment.makeBytes(t);return o.encodeSegments([i],e)}static encodeSegments(t,e,i=1,n=40,s=-1,c=!0){if(!(o.MIN_VERSION<=i&&i<=n&&n<=o.MAX_VERSION)||s<-1||s>7)throw new RangeError("Invalid value");let h,f;for(h=i;;h++){let C=o.getNumDataCodewords(h,e)*8,p=w.getTotalBits(t,h);if(p<=C){f=p;break}if(h>=n)throw new RangeError("Data too long")}for(let C of[o.Ecc.MEDIUM,o.Ecc.QUARTILE,o.Ecc.HIGH])c&&f<=o.getNumDataCodewords(h,C)*8&&(e=C);let d=[];for(let C of t){l(C.mode.modeBits,4,d),l(C.numChars,C.mode.numCharCountBits(h),d);for(let p of C.getData())d.push(p)}u(d.length==f);let A=o.getNumDataCodewords(h,e)*8;u(d.length<=A),l(0,Math.min(4,A-d.length),d),l(0,(8-d.length%8)%8,d),u(d.length%8==0);for(let C=236;d.length<A;C^=253)l(C,8,d);let z=[];for(;z.length*8<d.length;)z.push(0);return d.forEach((C,p)=>z[p>>>3]|=C<<7-(p&7)),new o(h,e,z,s)}constructor(t,e,i,n){if(this.version=t,this.errorCorrectionLevel=e,this.modules=[],this.isFunction=[],t<o.MIN_VERSION||t>o.MAX_VERSION)throw new RangeError("Version value out of range");if(n<-1||n>7)throw new RangeError("Mask value out of range");this.size=t*4+17;let s=[];for(let h=0;h<this.size;h++)s.push(!1);for(let h=0;h<this.size;h++)this.modules.push(s.slice()),this.isFunction.push(s.slice());this.drawFunctionPatterns();let c=this.addEccAndInterleave(i);if(this.drawCodewords(c),n==-1){let h=1e9;for(let f=0;f<8;f++){this.applyMask(f),this.drawFormatBits(f);let d=this.getPenaltyScore();d<h&&(n=f,h=d),this.applyMask(f)}}u(n>=0&&n<=7),this.mask=n,this.applyMask(n),this.drawFormatBits(n),this.isFunction=[]}getModule(t,e){return t>=0&&t<this.size&&e>=0&&e<this.size&&this.modules[e][t]}getModules(){return this.modules}drawFunctionPatterns(){for(let i=0;i<this.size;i++)this.setFunctionModule(6,i,i%2==0),this.setFunctionModule(i,6,i%2==0);this.drawFinderPattern(3,3),this.drawFinderPattern(this.size-4,3),this.drawFinderPattern(3,this.size-4);let t=this.getAlignmentPatternPositions(),e=t.length;for(let i=0;i<e;i++)for(let n=0;n<e;n++)i==0&&n==0||i==0&&n==e-1||i==e-1&&n==0||this.drawAlignmentPattern(t[i],t[n]);this.drawFormatBits(0),this.drawVersion()}drawFormatBits(t){let e=this.errorCorrectionLevel.formatBits<<3|t,i=e;for(let s=0;s<10;s++)i=i<<1^(i>>>9)*1335;let n=(e<<10|i)^21522;u(n>>>15==0);for(let s=0;s<=5;s++)this.setFunctionModule(8,s,a(n,s));this.setFunctionModule(8,7,a(n,6)),this.setFunctionModule(8,8,a(n,7)),this.setFunctionModule(7,8,a(n,8));for(let s=9;s<15;s++)this.setFunctionModule(14-s,8,a(n,s));for(let s=0;s<8;s++)this.setFunctionModule(this.size-1-s,8,a(n,s));for(let s=8;s<15;s++)this.setFunctionModule(8,this.size-15+s,a(n,s));this.setFunctionModule(8,this.size-8,!0)}drawVersion(){if(this.version<7)return;let t=this.version;for(let i=0;i<12;i++)t=t<<1^(t>>>11)*7973;let e=this.version<<12|t;u(e>>>18==0);for(let i=0;i<18;i++){let n=a(e,i),s=this.size-11+i%3,c=Math.floor(i/3);this.setFunctionModule(s,c,n),this.setFunctionModule(c,s,n)}}drawFinderPattern(t,e){for(let i=-4;i<=4;i++)for(let n=-4;n<=4;n++){let s=Math.max(Math.abs(n),Math.abs(i)),c=t+n,h=e+i;c>=0&&c<this.size&&h>=0&&h<this.size&&this.setFunctionModule(c,h,s!=2&&s!=4)}}drawAlignmentPattern(t,e){for(let i=-2;i<=2;i++)for(let n=-2;n<=2;n++)this.setFunctionModule(t+n,e+i,Math.max(Math.abs(n),Math.abs(i))!=1)}setFunctionModule(t,e,i){this.modules[e][t]=i,this.isFunction[e][t]=!0}addEccAndInterleave(t){let e=this.version,i=this.errorCorrectionLevel;if(t.length!=o.getNumDataCodewords(e,i))throw new RangeError("Invalid argument");let n=o.NUM_ERROR_CORRECTION_BLOCKS[i.ordinal][e],s=o.ECC_CODEWORDS_PER_BLOCK[i.ordinal][e],c=Math.floor(o.getNumRawDataModules(e)/8),h=n-c%n,f=Math.floor(c/n),d=[],A=o.reedSolomonComputeDivisor(s);for(let C=0,p=0;C<n;C++){let R=t.slice(p,p+f-s+(C<h?0:1));p+=R.length;let mt=o.reedSolomonComputeRemainder(R,A);C<h&&R.push(0),d.push(R.concat(mt))}let z=[];for(let C=0;C<d[0].length;C++)d.forEach((p,R)=>{(C!=f-s||R>=h)&&z.push(p[C])});return u(z.length==c),z}drawCodewords(t){if(t.length!=Math.floor(o.getNumRawDataModules(this.version)/8))throw new RangeError("Invalid argument");let e=0;for(let i=this.size-1;i>=1;i-=2){i==6&&(i=5);for(let n=0;n<this.size;n++)for(let s=0;s<2;s++){let c=i-s,f=(i+1&2)==0?this.size-1-n:n;!this.isFunction[f][c]&&e<t.length*8&&(this.modules[f][c]=a(t[e>>>3],7-(e&7)),e++)}}u(e==t.length*8)}applyMask(t){if(t<0||t>7)throw new RangeError("Mask value out of range");for(let e=0;e<this.size;e++)for(let i=0;i<this.size;i++){let n;switch(t){case 0:n=(i+e)%2==0;break;case 1:n=e%2==0;break;case 2:n=i%3==0;break;case 3:n=(i+e)%3==0;break;case 4:n=(Math.floor(i/3)+Math.floor(e/2))%2==0;break;case 5:n=i*e%2+i*e%3==0;break;case 6:n=(i*e%2+i*e%3)%2==0;break;case 7:n=((i+e)%2+i*e%3)%2==0;break;default:throw new Error("Unreachable")}!this.isFunction[e][i]&&n&&(this.modules[e][i]=!this.modules[e][i])}}getPenaltyScore(){let t=0;for(let s=0;s<this.size;s++){let c=!1,h=0,f=[0,0,0,0,0,0,0];for(let d=0;d<this.size;d++)this.modules[s][d]==c?(h++,h==5?t+=o.PENALTY_N1:h>5&&t++):(this.finderPenaltyAddHistory(h,f),c||(t+=this.finderPenaltyCountPatterns(f)*o.PENALTY_N3),c=this.modules[s][d],h=1);t+=this.finderPenaltyTerminateAndCount(c,h,f)*o.PENALTY_N3}for(let s=0;s<this.size;s++){let c=!1,h=0,f=[0,0,0,0,0,0,0];for(let d=0;d<this.size;d++)this.modules[d][s]==c?(h++,h==5?t+=o.PENALTY_N1:h>5&&t++):(this.finderPenaltyAddHistory(h,f),c||(t+=this.finderPenaltyCountPatterns(f)*o.PENALTY_N3),c=this.modules[d][s],h=1);t+=this.finderPenaltyTerminateAndCount(c,h,f)*o.PENALTY_N3}for(let s=0;s<this.size-1;s++)for(let c=0;c<this.size-1;c++){let h=this.modules[s][c];h==this.modules[s][c+1]&&h==this.modules[s+1][c]&&h==this.modules[s+1][c+1]&&(t+=o.PENALTY_N2)}let e=0;for(let s of this.modules)e=s.reduce((c,h)=>c+(h?1:0),e);let i=this.size*this.size,n=Math.ceil(Math.abs(e*20-i*10)/i)-1;return u(n>=0&&n<=9),t+=n*o.PENALTY_N4,u(t>=0&&t<=2568888),t}getAlignmentPatternPositions(){if(this.version==1)return[];{let t=Math.floor(this.version/7)+2,e=this.version==32?26:Math.ceil((this.version*4+4)/(t*2-2))*2,i=[6];for(let n=this.size-7;i.length<t;n-=e)i.splice(1,0,n);return i}}static getNumRawDataModules(t){if(t<o.MIN_VERSION||t>o.MAX_VERSION)throw new RangeError("Version number out of range");let e=(16*t+128)*t+64;if(t>=2){let i=Math.floor(t/7)+2;e-=(25*i-10)*i-55,t>=7&&(e-=36)}return u(e>=208&&e<=29648),e}static getNumDataCodewords(t,e){return Math.floor(o.getNumRawDataModules(t)/8)-o.ECC_CODEWORDS_PER_BLOCK[e.ordinal][t]*o.NUM_ERROR_CORRECTION_BLOCKS[e.ordinal][t]}static reedSolomonComputeDivisor(t){if(t<1||t>255)throw new RangeError("Degree out of range");let e=[];for(let n=0;n<t-1;n++)e.push(0);e.push(1);let i=1;for(let n=0;n<t;n++){for(let s=0;s<e.length;s++)e[s]=o.reedSolomonMultiply(e[s],i),s+1<e.length&&(e[s]^=e[s+1]);i=o.reedSolomonMultiply(i,2)}return e}static reedSolomonComputeRemainder(t,e){let i=e.map(n=>0);for(let n of t){let s=n^i.shift();i.push(0),e.forEach((c,h)=>i[h]^=o.reedSolomonMultiply(c,s))}return i}static reedSolomonMultiply(t,e){if(t>>>8||e>>>8)throw new RangeError("Byte out of range");let i=0;for(let n=7;n>=0;n--)i=i<<1^(i>>>7)*285,i^=(e>>>n&1)*t;return u(i>>>8==0),i}finderPenaltyCountPatterns(t){let e=t[1];u(e<=this.size*3);let i=e>0&&t[2]==e&&t[3]==e*3&&t[4]==e&&t[5]==e;return(i&&t[0]>=e*4&&t[6]>=e?1:0)+(i&&t[6]>=e*4&&t[0]>=e?1:0)}finderPenaltyTerminateAndCount(t,e,i){return t&&(this.finderPenaltyAddHistory(e,i),e=0),e+=this.size,this.finderPenaltyAddHistory(e,i),this.finderPenaltyCountPatterns(i)}finderPenaltyAddHistory(t,e){e[0]==0&&(t+=this.size),e.pop(),e.unshift(t)}static{this.MIN_VERSION=1}static{this.MAX_VERSION=40}static{this.PENALTY_N1=3}static{this.PENALTY_N2=3}static{this.PENALTY_N3=40}static{this.PENALTY_N4=10}static{this.ECC_CODEWORDS_PER_BLOCK=[[-1,7,10,15,20,26,18,20,24,30,18,20,24,26,30,22,24,28,30,28,28,28,28,30,30,26,28,30,30,30,30,30,30,30,30,30,30,30,30,30,30],[-1,10,16,26,18,24,16,18,22,22,26,30,22,22,24,24,28,28,26,26,26,26,28,28,28,28,28,28,28,28,28,28,28,28,28,28,28,28,28,28,28],[-1,13,22,18,26,18,24,18,22,20,24,28,26,24,20,30,24,28,28,26,30,28,30,30,30,30,28,30,30,30,30,30,30,30,30,30,30,30,30,30,30],[-1,17,28,22,16,22,28,26,26,24,28,24,28,22,24,24,30,28,28,26,28,30,24,30,30,30,30,30,30,30,30,30,30,30,30,30,30,30,30,30,30]]}static{this.NUM_ERROR_CORRECTION_BLOCKS=[[-1,1,1,1,1,1,2,2,2,2,4,4,4,4,4,6,6,6,6,7,8,8,9,9,10,12,12,12,13,14,15,16,17,18,19,19,20,21,22,24,25],[-1,1,1,1,2,2,4,4,4,5,5,5,8,9,9,10,10,11,13,14,16,17,17,18,20,21,23,25,26,28,29,31,33,35,37,38,40,43,45,47,49],[-1,1,1,2,2,4,4,6,6,8,8,8,10,12,16,12,17,16,18,21,20,23,23,25,27,29,34,34,35,38,40,43,45,48,51,53,56,59,62,65,68],[-1,1,1,2,4,4,4,5,6,8,8,11,11,16,16,18,16,19,21,25,25,25,34,30,32,35,37,40,42,45,48,51,54,57,60,63,66,70,74,77,81]]}}return o})();r.QrCode=m;function l(o,E,t){if(E<0||E>31||o>>>E)throw new RangeError("Value out of range");for(let e=E-1;e>=0;e--)t.push(o>>>e&1)}function a(o,E){return(o>>>E&1)!=0}function u(o){if(!o)throw new Error("Assertion error")}let w=(()=>{class o{static makeBytes(t){let e=[];for(let i of t)l(i,8,e);return new o(o.Mode.BYTE,t.length,e)}static makeNumeric(t){if(!o.isNumeric(t))throw new RangeError("String contains non-numeric characters");let e=[];for(let i=0;i<t.length;){let n=Math.min(t.length-i,3);l(parseInt(t.substring(i,i+n),10),n*3+1,e),i+=n}return new o(o.Mode.NUMERIC,t.length,e)}static makeAlphanumeric(t){if(!o.isAlphanumeric(t))throw new RangeError("String contains unencodable characters in alphanumeric mode");let e=[],i;for(i=0;i+2<=t.length;i+=2){let n=o.ALPHANUMERIC_CHARSET.indexOf(t.charAt(i))*45;n+=o.ALPHANUMERIC_CHARSET.indexOf(t.charAt(i+1)),l(n,11,e)}return i<t.length&&l(o.ALPHANUMERIC_CHARSET.indexOf(t.charAt(i)),6,e),new o(o.Mode.ALPHANUMERIC,t.length,e)}static makeSegments(t){return t==""?[]:o.isNumeric(t)?[o.makeNumeric(t)]:o.isAlphanumeric(t)?[o.makeAlphanumeric(t)]:[o.makeBytes(o.toUtf8ByteArray(t))]}static makeEci(t){let e=[];if(t<0)throw new RangeError("ECI assignment value out of range");if(t<128)l(t,8,e);else if(t<16384)l(2,2,e),l(t,14,e);else if(t<1e6)l(6,3,e),l(t,21,e);else throw new RangeError("ECI assignment value out of range");return new o(o.Mode.ECI,0,e)}static isNumeric(t){return o.NUMERIC_REGEX.test(t)}static isAlphanumeric(t){return o.ALPHANUMERIC_REGEX.test(t)}constructor(t,e,i){if(this.mode=t,this.numChars=e,this.bitData=i,e<0)throw new RangeError("Invalid argument");this.bitData=i.slice()}getData(){return this.bitData.slice()}static getTotalBits(t,e){let i=0;for(let n of t){let s=n.mode.numCharCountBits(e);if(n.numChars>=1<<s)return 1/0;i+=4+s+n.bitData.length}return i}static toUtf8ByteArray(t){t=encodeURI(t);let e=[];for(let i=0;i<t.length;i++)t.charAt(i)!="%"?e.push(t.charCodeAt(i)):(e.push(parseInt(t.substring(i+1,i+3),16)),i+=2);return e}static{this.NUMERIC_REGEX=/^[0-9]*$/}static{this.ALPHANUMERIC_REGEX=/^[A-Z0-9 $%*+.\/:-]*$/}static{this.ALPHANUMERIC_CHARSET="0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ $%*+-./:"}}return o})();r.QrSegment=w})(g||(g={}));(function(r){var m;(function(l){class a{static{this.LOW=new a(0,1)}static{this.MEDIUM=new a(1,0)}static{this.QUARTILE=new a(2,3)}static{this.HIGH=new a(3,2)}constructor(w,o){this.ordinal=w,this.formatBits=o}}l.Ecc=a})(m=r.QrCode||(r.QrCode={}))})(g||(g={}));(function(r){var m;(function(l){class a{static{this.NUMERIC=new a(1,[10,12,14])}static{this.ALPHANUMERIC=new a(2,[9,11,13])}static{this.BYTE=new a(4,[8,16,16])}static{this.KANJI=new a(8,[8,10,12])}static{this.ECI=new a(7,[0,0,0])}constructor(w,o){this.modeBits=w,this.numBitsCharCount=o}numCharCountBits(w){return this.numBitsCharCount[Math.floor((w+7)/17)]}}l.Mode=a})(m=r.QrSegment||(r.QrSegment={}))})(g||(g={}));var y=g,Rt={L:y.QrCode.Ecc.LOW,M:y.QrCode.Ecc.MEDIUM,Q:y.QrCode.Ecc.QUARTILE,H:y.QrCode.Ecc.HIGH},Mt=160,Nt=10,At=10,It="#000000",Pt="#FFFFFF",yt=40,Bt="M",Lt=(r,m=Bt)=>r?y.QrCode.encodeText(r,Rt[m]):null;function Ft(r,m,l=Mt,a=Nt,u=At,w=It,o=Pt,E=yt,t){let e=r.getContext("2d"),i=vt(u);if(r.style.width=`${l}px`,r.style.height=`${l}px`,!m){e.fillStyle="rgba(0, 0, 0, 0)",e.fillRect(0,0,r.width,r.height);return}if(r.width=m.size*a+i[1]+i[3],r.height=m.size*a+i[0]+i[2],!t)O(e,r.width,r.height,a,o),T(e,m,a,i,o,w);else{let n=new Image;n.src=t,n.crossOrigin="anonymous",n.width=E*(r.width/l),n.height=E*(r.width/l);let s=()=>{h(),O(e,r.width,r.height,a,o),T(e,m,a,i,o,w);let f=r.width/2-E*(r.width/l)/2;e.fillRect(f,f,E*(r.width/l),E*(r.width/l)),e.drawImage(n,f,f,E*(r.width/l),E*(r.width/l))},c=()=>{h(),O(e,r.width,r.height,a,o),T(e,m,a,i,o,w)},h=()=>{n.removeEventListener("load",s),n.removeEventListener("error",c)};n.addEventListener("load",s),n.addEventListener("error",c)}}function T(r,m,l,a,u,w){for(let o=0;o<m.size;o++)for(let E=0;E<m.size;E++)r.fillStyle=m.getModule(E,o)?w:u,r.fillRect(a[3]+E*l,a[0]+o*l,l,l)}function O(r,m,l,a,u){r.fillStyle=u,r.fillRect(0,0,m*a,l*a)}function vt(r){return Array.isArray(r)?Array(4).fill(0).map((m,l)=>r[l%r.length]):[r,r,r,r]}var bt=(()=>{class r{constructor(l,a,u){this.i18n=l,this.el=a,this.cdr=u,this.nzValue="",this.nzPadding=0,this.nzColor="#000000",this.nzBgColor="#FFFFFF",this.nzSize=160,this.nzIcon="",this.nzIconSize=40,this.nzBordered=!0,this.nzStatus="active",this.nzLevel="M",this.nzRefresh=new G,this.isBrowser=!0,this.destroy$=new x,this.platformId=k(K),this.isBrowser=st(this.platformId),this.cdr.markForCheck()}ngOnInit(){this.el.nativeElement.style.backgroundColor=this.nzBgColor,this.i18n.localeChange.pipe(U(this.destroy$)).subscribe(()=>{this.locale=this.i18n.getLocaleData("QRCode"),this.cdr.markForCheck()})}ngOnChanges(l){let{nzValue:a,nzIcon:u,nzLevel:w,nzSize:o,nzIconSize:E,nzColor:t,nzPadding:e,nzBgColor:i}=l;(a||u||w||o||E||t||e||i)&&this.canvas&&this.drawCanvasQRCode(),i&&(this.el.nativeElement.style.backgroundColor=this.nzBgColor)}ngAfterViewInit(){this.drawCanvasQRCode()}reloadQRCode(){this.drawCanvasQRCode(),this.nzRefresh.emit("refresh")}drawCanvasQRCode(){this.canvas&&Ft(this.canvas.nativeElement,Lt(this.nzValue,this.nzLevel),this.nzSize,10,this.nzPadding,this.nzColor,this.nzBgColor,this.nzIconSize,this.nzIcon)}ngOnDestroy(){this.destroy$.next(),this.destroy$.complete()}static{this.\u0275fac=function(a){return new(a||r)(B(ut),B(X),B(nt))}}static{this.\u0275cmp=V({type:r,selectors:[["nz-qrcode"]],viewQuery:function(a,u){if(a&1&&Q(Ct,5),a&2){let w;tt(w=et())&&(u.canvas=w.first)}},hostAttrs:[1,"ant-qrcode"],hostVars:2,hostBindings:function(a,u){a&2&&Z("ant-qrcode-border",u.nzBordered)},inputs:{nzValue:"nzValue",nzPadding:"nzPadding",nzColor:"nzColor",nzBgColor:"nzBgColor",nzSize:[2,"nzSize","nzSize",S],nzIcon:"nzIcon",nzIconSize:[2,"nzIconSize","nzIconSize",S],nzBordered:[2,"nzBordered","nzBordered",ot],nzStatus:"nzStatus",nzLevel:"nzLevel"},outputs:{nzRefresh:"nzRefresh"},exportAs:["nzQRCode"],standalone:!0,features:[W,Y,it],decls:2,vars:2,consts:[["canvas",""],[1,"ant-qrcode-mask"],[1,"ant-qrcode-expired"],["nz-button","","nzType","link",3,"click"],["nz-icon","","nzType","reload","nzTheme","outline"]],template:function(a,u){a&1&&D(0,zt,4,1,"div",1)(1,gt,2,0,"canvas"),a&2&&(L(u.nzStatus!=="active"?0:-1),M(),L(u.isBrowser?1:-1))},dependencies:[ft,dt,ct,ht,lt,at,rt],encapsulation:2,changeDetection:0})}}return r})(),Jt=(()=>{class r{static{this.\u0275fac=function(a){return new(a||r)}}static{this.\u0275mod=H({type:r})}static{this.\u0275inj=_({imports:[bt]})}}return r})();export{bt as a,Jt as b};
