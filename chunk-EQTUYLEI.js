import{b as ee}from"./chunk-KSRDVEKR.js";import{a as Z,b as $}from"./chunk-5CUVPQL2.js";import"./chunk-D5MXNW3W.js";import{b as L}from"./chunk-PE6PQG5P.js";import"./chunk-WU3VUF36.js";import{c as X,d as Y}from"./chunk-G4MBMDPR.js";import{i as U}from"./chunk-C6KGLNM7.js";import"./chunk-RXULLGBC.js";import"./chunk-5MKA6IQ4.js";import{a as k,b as P,e as q,f as j,g as R,h as Q}from"./chunk-GXHJ6PF2.js";import"./chunk-OC5M4CSB.js";import{C as v,D as N,F as A,G as D,H as B,Hb as H,N as F,cc as G,fc as J,hc as K,o as T,ta as O,z as V}from"./chunk-TXLPFZIX.js";import{Cb as w,Dc as C,Fa as p,Ga as s,Gb as r,Ub as m,Vb as a,Wb as x,_b as z,bc as f,dc as l,ic as S,jc as I,kc as b,lb as o,lc as E,mb as h,mc as u,qc as d,rc as c,sc as g,ua as y,uc as W,xb as M}from"./chunk-7MXG77XU.js";var ie=["menu"];function oe(_,te){if(_&1){let t=z();m(0,"form",3)(1,"nz-form-item")(2,"nz-form-label",4),u(3,"\u83DC\u5355\u7F16\u53F7"),a(),m(4,"nz-form-control",4)(5,"input",5),g("ngModelChange",function(e){p(t);let n=l();return c(n.menuItem.id,e)||(n.menuItem.id=e),s(e)}),a()()(),m(6,"nz-form-item")(7,"nz-form-label",4),u(8,"\u83DC\u5355\u540D\u79F0"),a(),m(9,"nz-form-control",4)(10,"input",6),g("ngModelChange",function(e){p(t);let n=l();return c(n.menuItem.name,e)||(n.menuItem.name=e),s(e)}),a()()(),m(11,"nz-form-item")(12,"nz-form-label",4),u(13,"\u83DC\u5355\u7C7B\u578B"),a(),m(14,"nz-form-control",4)(15,"nz-select",7),g("ngModelChange",function(e){p(t);let n=l();return c(n.menuItem.type,e)||(n.menuItem.type=e),s(e)}),f("ngModelChange",function(){p(t);let e=l();return s(e.getMenuTree())}),a()()(),m(16,"nz-form-item")(17,"nz-form-label",4),u(18,"\u83DC\u5355\u7236\u7EA7"),a(),m(19,"nz-form-control",4)(20,"nz-tree-select",8),g("ngModelChange",function(e){p(t);let n=l();return c(n.menuItem.parentId,e)||(n.menuItem.parentId=e),s(e)}),a()()(),m(21,"nz-form-item")(22,"nz-form-label",4),u(23,"\u83DC\u5355\u56FE\u6807"),a(),m(24,"nz-form-control",4)(25,"input",9),g("ngModelChange",function(e){p(t);let n=l();return c(n.menuItem.ico,e)||(n.menuItem.ico=e),s(e)}),a()()(),m(26,"nz-form-item")(27,"nz-form-label",4),u(28,"\u83DC\u5355\u8DEF\u7531"),a(),m(29,"nz-form-control",4)(30,"input",10),g("ngModelChange",function(e){p(t);let n=l();return c(n.menuItem.path,e)||(n.menuItem.path=e),s(e)}),a()()(),m(31,"nz-form-item")(32,"nz-form-label",4),u(33,"\u83DC\u5355\u8DEF\u5F84"),a(),m(34,"nz-form-control",4)(35,"input",11),g("ngModelChange",function(e){p(t);let n=l();return c(n.menuItem.posi,e)||(n.menuItem.posi=e),s(e)}),a()()(),m(36,"nz-form-item")(37,"nz-form-label",4),u(38,"\u83DC\u5355\u987A\u5E8F"),a(),m(39,"nz-form-control",4)(40,"input",12),g("ngModelChange",function(e){p(t);let n=l();return c(n.menuItem.seq,e)||(n.menuItem.seq=e),s(e)}),a()()(),m(41,"nz-form-item")(42,"nz-form-label",4),u(43,"\u662F\u5426\u9875\u9762"),a(),m(44,"nz-form-control",4)(45,"nz-select",13),g("ngModelChange",function(e){p(t);let n=l();return c(n.menuItem.isLeaf,e)||(n.menuItem.isLeaf=e),s(e)}),a()()(),m(46,"nz-form-item")(47,"nz-form-label",4),u(48,"\u6309\u94AE\u7BA1\u7406"),a(),m(49,"button",14),f("click",function(){p(t);let e=l(),n=E(4);return s(e.editBtn(n))}),u(50,"\u70B9\u51FB"),a()()()}if(_&2){let t=l();o(2),r("nzSpan",5),o(2),r("nzSpan",12),o(),d("ngModel",t.menuItem.id),o(2),r("nzSpan",5),o(2),r("nzSpan",12),o(),d("ngModel",t.menuItem.name),o(2),r("nzSpan",5),o(2),r("nzSpan",12),o(),d("ngModel",t.menuItem.type),r("nzOptions",t.typeOptions),o(2),r("nzSpan",5),o(2),r("nzSpan",12),o(),r("nzNodes",t.menuTrees),d("ngModel",t.menuItem.parentId),o(2),r("nzSpan",5),o(2),r("nzSpan",12),o(),d("ngModel",t.menuItem.ico),o(2),r("nzSpan",5),o(2),r("nzSpan",12),o(),d("ngModel",t.menuItem.path),o(2),r("nzSpan",5),o(2),r("nzSpan",12),o(),d("ngModel",t.menuItem.posi),o(2),r("nzSpan",5),o(2),r("nzSpan",12),o(),d("ngModel",t.menuItem.seq),o(2),r("nzSpan",5),o(2),r("nzSpan",12),o(),d("ngModel",t.menuItem.isLeaf),r("nzOptions",t.boolOptions),o(2),r("nzSpan",5)}}function re(_,te){if(_&1){let t=z();m(0,"nz-checkbox-group",15),g("ngModelChange",function(e){p(t);let n=l();return c(n.btnsModel,e)||(n.btnsModel=e),s(e)}),a()}if(_&2){let t=l();d("ngModel",t.btnsModel)}}var Se=(()=>{class _ extends Z{constructor(t,i,e){super(t,i),this.myApi=t,this.route=i,this.modal=e,this.menuItem={id:null,name:"",parentId:"",ico:"",path:"",posi:"",type:0,seq:0,isLeaf:1},this.typeOptions=[],this.boolOptions=[],this.menuTrees=[],this.btnsModel=[]}afterInitialization(){this.myApi.getDict("menuType").subscribe(t=>{this.typeOptions=t}),this.myApi.getDict("boolean").subscribe(t=>{this.boolOptions=t}),this.myApi.get("btn/btns",{pageNum:1,pageSize:500}).then(t=>{t.code===200&&(this.btnsModel=t.data.records.map(i=>({label:i.name,value:i.id})))})}btnClick(t){if(t==="add"){this.add();return}else if(t==="delete"){this.delete();return}super.btnClick(t)}add(){this.menuItem={id:null,name:"",parentId:"",ico:"",path:"",posi:"",type:0,seq:0,isLeaf:1},this.getMenuTree(),this.modal.create({nzWidth:"640px",nzTitle:"\u65B0\u589E\u83DC\u5355",nzContent:this.menuModel,nzClosable:!0,nzOnOk:()=>{this.myApi.post("menu/menu",this.menuItem).then(t=>{t.code===200&&this.myApi.success("\u4FDD\u5B58\u6210\u529F")})},nzCancelText:null})}gotoSetForm(t){this.menuItem=t.row,this.getMenuTree(),this.modal.create({nzWidth:"640px",nzTitle:"\u7F16\u8F91\u83DC\u5355",nzContent:this.menuModel,nzClosable:!0,nzOnOk:()=>{this.myApi.put("menu/menu",this.menuItem).then(i=>{i.code===200&&this.myApi.success("\u4FDD\u5B58\u6210\u529F")})},nzCancelText:null})}delete(){if(this.selectData.length===0){this.myApi.warning("\u8BF7\u52FE\u9009\u6570\u636E");return}this.myApi.confirm("\u60A8\u662F\u5426\u786E\u8BA4\u5220\u9664\uFF1F",()=>{this.myApi.delete("menu/menu",this.selectData).then(t=>{t.code===200&&(this.myApi.success("\u5220\u9664\u6210\u529F"),this.refresh())})})}getMenuTree(){this.myApi.get("menu/tree",{type:this.menuItem.type}).then(t=>{t.code===200&&(this.menuTrees=t.data)})}editBtn(t){this.btnsModel.forEach(i=>i.checked=!1),this.myApi.get("form/btns",{formId:this.menuItem.id}).then(i=>{i.code===200&&i.data.forEach(e=>{let n=this.btnsModel.find(ne=>ne.value===e.id);n&&(n.checked=!0)})}),this.modal.create({nzWidth:"640px",nzTitle:"\u9009\u62E9\u6309\u94AE",nzContent:t,nzClosable:!0,nzOnOk:()=>{let i=this.btnsModel.filter(e=>e.checked).map(e=>({btnId:e.value,formId:this.menuItem.id}));this.myApi.post(`form/btns?formId=${this.menuItem.id}`,i).then(e=>{e.code===200&&this.myApi.success("\u4FDD\u5B58\u6210\u529F")})},nzCancelText:null})}static{this.\u0275fac=function(i){return new(i||_)(h(K),h(T),h(G))}}static{this.\u0275cmp=y({type:_,selectors:[["app-menu"]],viewQuery:function(i,e){if(i&1&&S(ie,5),i&2){let n;I(n=b())&&(e.menuModel=n.first)}},standalone:!0,features:[M,W],decls:5,vars:1,consts:[["menu",""],["btns1",""],[2,"height","100%",3,"commonObjs"],["nz-form",""],[3,"nzSpan"],["nz-input","","name","id","disabled","",3,"ngModelChange","ngModel"],["nz-input","","name","name",3,"ngModelChange","ngModel"],["name","type","nzAllowClear","","nzShowSearch","","nzPlaceHolder","\u9009\u62E9\u7C7B\u578B",3,"ngModelChange","ngModel","nzOptions"],["nzShowSearch","","nzPlaceHolder","Please select","name","parentId",3,"ngModelChange","nzNodes","ngModel"],["nz-input","","name","ico",3,"ngModelChange","ngModel"],["nz-input","","name","path",3,"ngModelChange","ngModel"],["nz-input","","name","posi",3,"ngModelChange","ngModel"],["nz-input","","name","seq",3,"ngModelChange","ngModel"],["name","isLeaf","nzAllowClear","","nzShowSearch","","nzPlaceHolder","\u9009\u62E9\u7C7B\u578B",3,"ngModelChange","ngModel","nzOptions"],["nz-button","","nzType","link",3,"click"],[3,"ngModelChange","ngModel"]],template:function(i,e){i&1&&(x(0,"app-form-report",2),w(1,oe,51,31,"ng-template",null,0,C)(3,re,1,1,"ng-template",null,1,C)),i&2&&r("commonObjs",e.commonObjs)},dependencies:[J,$,F,B,V,v,N,D,A,P,R,j,q,Q,H,k,U,Y,X,ee,L,O]})}}return _})();export{Se as MenuComponent};
