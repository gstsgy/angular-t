import{a as hm}from"./chunk-KSRDVEKR.js";import{a as om,b as am}from"./chunk-O5DKJRVM.js";import{d as sm}from"./chunk-RXULLGBC.js";import"./chunk-5MKA6IQ4.js";import{C as X0,G as G0,Hb as nm,Jb as im,N as K0,Oa as bs,Pa as J0,Wa as Q0,Xa as tm,hc as rm,ia as id,ja as Do,na as Vh,oa as q0,pa as j0,ta as Z0,ua as $0,yb as em,z as V0}from"./chunk-TXLPFZIX.js";import{Cb as $i,Fa as Ih,Fb as U0,G as z0,Ga as zh,Gb as Bi,Ib as Wh,K as W0,Ma as F0,Mc as nd,Na as N0,Pb as ko,Qc as Rr,Ub as re,Vb as jt,Wb as Ne,Xb as Fh,Yb as Nh,_b as Y0,a as li,b as Bo,bc as qu,dc as xs,e as Gt,ea as Oo,ec as ju,fc as Zu,g as UP,h as I0,ic as Hh,jb as H0,jc as Uh,kc as Yh,lb as Fe,mb as qn,mc as Pe,nc as $u,qa as Gu,qc as Ju,rc as Qu,sc as td,t as Ro,tc as ed,ua as Ao,uc as Mo,zb as Ku}from"./chunk-7MXG77XU.js";var tw=Gt((wz,Q1)=>{"use strict";Q1.exports=function(){return typeof Promise=="function"&&Promise.prototype&&Promise.prototype.then}});var mr=Gt(es=>{"use strict";var Dp,NM=[0,26,44,70,100,134,172,196,242,292,346,404,466,532,581,655,733,815,901,991,1085,1156,1258,1364,1474,1588,1706,1828,1921,2051,2185,2323,2465,2611,2761,2876,3034,3196,3362,3532,3706];es.getSymbolSize=function(t){if(!t)throw new Error('"version" cannot be null or undefined');if(t<1||t>40)throw new Error('"version" should be in range from 1 to 40');return t*4+17};es.getSymbolTotalCodewords=function(t){return NM[t]};es.getBCHDigit=function(e){let t=0;for(;e!==0;)t++,e>>>=1;return t};es.setToSJISFunction=function(t){if(typeof t!="function")throw new Error('"toSJISFunc" is not a valid function.');Dp=t};es.isKanjiModeEnabled=function(){return typeof Dp<"u"};es.toSJIS=function(t){return Dp(t)}});var dc=Gt(Hn=>{"use strict";Hn.L={bit:1};Hn.M={bit:0};Hn.Q={bit:3};Hn.H={bit:2};function HM(e){if(typeof e!="string")throw new Error("Param is not a string");switch(e.toLowerCase()){case"l":case"low":return Hn.L;case"m":case"medium":return Hn.M;case"q":case"quartile":return Hn.Q;case"h":case"high":return Hn.H;default:throw new Error("Unknown EC Level: "+e)}}Hn.isValid=function(t){return t&&typeof t.bit<"u"&&t.bit>=0&&t.bit<4};Hn.from=function(t,n){if(Hn.isValid(t))return t;try{return HM(t)}catch{return n}}});var iw=Gt((Ez,nw)=>{"use strict";function ew(){this.buffer=[],this.length=0}ew.prototype={get:function(e){let t=Math.floor(e/8);return(this.buffer[t]>>>7-e%8&1)===1},put:function(e,t){for(let n=0;n<t;n++)this.putBit((e>>>t-n-1&1)===1)},getLengthInBits:function(){return this.length},putBit:function(e){let t=Math.floor(this.length/8);this.buffer.length<=t&&this.buffer.push(0),e&&(this.buffer[t]|=128>>>this.length%8),this.length++}};nw.exports=ew});var sw=Gt((Sz,rw)=>{"use strict";function Ia(e){if(!e||e<1)throw new Error("BitMatrix size must be defined and greater than 0");this.size=e,this.data=new Uint8Array(e*e),this.reservedBit=new Uint8Array(e*e)}Ia.prototype.set=function(e,t,n,i){let s=e*this.size+t;this.data[s]=n,i&&(this.reservedBit[s]=!0)};Ia.prototype.get=function(e,t){return this.data[e*this.size+t]};Ia.prototype.xor=function(e,t,n){this.data[e*this.size+t]^=n};Ia.prototype.isReserved=function(e,t){return this.reservedBit[e*this.size+t]};rw.exports=Ia});var ow=Gt(fc=>{"use strict";var UM=mr().getSymbolSize;fc.getRowColCoords=function(t){if(t===1)return[];let n=Math.floor(t/7)+2,i=UM(t),s=i===145?26:Math.ceil((i-13)/(2*n-2))*2,a=[i-7];for(let h=1;h<n-1;h++)a[h]=a[h-1]-s;return a.push(6),a.reverse()};fc.getPositions=function(t){let n=[],i=fc.getRowColCoords(t),s=i.length;for(let a=0;a<s;a++)for(let h=0;h<s;h++)a===0&&h===0||a===0&&h===s-1||a===s-1&&h===0||n.push([i[a],i[h]]);return n}});var lw=Gt(hw=>{"use strict";var YM=mr().getSymbolSize,aw=7;hw.getPositions=function(t){let n=YM(t);return[[0,0],[n-aw,0],[0,n-aw]]}});var cw=Gt(ne=>{"use strict";ne.Patterns={PATTERN000:0,PATTERN001:1,PATTERN010:2,PATTERN011:3,PATTERN100:4,PATTERN101:5,PATTERN110:6,PATTERN111:7};var ns={N1:3,N2:3,N3:40,N4:10};ne.isValid=function(t){return t!=null&&t!==""&&!isNaN(t)&&t>=0&&t<=7};ne.from=function(t){return ne.isValid(t)?parseInt(t,10):void 0};ne.getPenaltyN1=function(t){let n=t.size,i=0,s=0,a=0,h=null,l=null;for(let u=0;u<n;u++){s=a=0,h=l=null;for(let f=0;f<n;f++){let g=t.get(u,f);g===h?s++:(s>=5&&(i+=ns.N1+(s-5)),h=g,s=1),g=t.get(f,u),g===l?a++:(a>=5&&(i+=ns.N1+(a-5)),l=g,a=1)}s>=5&&(i+=ns.N1+(s-5)),a>=5&&(i+=ns.N1+(a-5))}return i};ne.getPenaltyN2=function(t){let n=t.size,i=0;for(let s=0;s<n-1;s++)for(let a=0;a<n-1;a++){let h=t.get(s,a)+t.get(s,a+1)+t.get(s+1,a)+t.get(s+1,a+1);(h===4||h===0)&&i++}return i*ns.N2};ne.getPenaltyN3=function(t){let n=t.size,i=0,s=0,a=0;for(let h=0;h<n;h++){s=a=0;for(let l=0;l<n;l++)s=s<<1&2047|t.get(h,l),l>=10&&(s===1488||s===93)&&i++,a=a<<1&2047|t.get(l,h),l>=10&&(a===1488||a===93)&&i++}return i*ns.N3};ne.getPenaltyN4=function(t){let n=0,i=t.data.length;for(let a=0;a<i;a++)n+=t.data[a];return Math.abs(Math.ceil(n*100/i/5)-10)*ns.N4};function VM(e,t,n){switch(e){case ne.Patterns.PATTERN000:return(t+n)%2===0;case ne.Patterns.PATTERN001:return t%2===0;case ne.Patterns.PATTERN010:return n%3===0;case ne.Patterns.PATTERN011:return(t+n)%3===0;case ne.Patterns.PATTERN100:return(Math.floor(t/2)+Math.floor(n/3))%2===0;case ne.Patterns.PATTERN101:return t*n%2+t*n%3===0;case ne.Patterns.PATTERN110:return(t*n%2+t*n%3)%2===0;case ne.Patterns.PATTERN111:return(t*n%3+(t+n)%2)%2===0;default:throw new Error("bad maskPattern:"+e)}}ne.applyMask=function(t,n){let i=n.size;for(let s=0;s<i;s++)for(let a=0;a<i;a++)n.isReserved(a,s)||n.xor(a,s,VM(t,a,s))};ne.getBestMask=function(t,n){let i=Object.keys(ne.Patterns).length,s=0,a=1/0;for(let h=0;h<i;h++){n(h),ne.applyMask(h,t);let l=ne.getPenaltyN1(t)+ne.getPenaltyN2(t)+ne.getPenaltyN3(t)+ne.getPenaltyN4(t);ne.applyMask(h,t),l<a&&(a=l,s=h)}return s}});var zp=Gt(Ip=>{"use strict";var yr=dc(),pc=[1,1,1,1,1,1,1,1,1,1,2,2,1,2,2,4,1,2,4,4,2,4,4,4,2,4,6,5,2,4,6,6,2,5,8,8,4,5,8,8,4,5,8,11,4,8,10,11,4,9,12,16,4,9,16,16,6,10,12,18,6,10,17,16,6,11,16,19,6,13,18,21,7,14,21,25,8,16,20,25,8,17,23,25,9,17,23,34,9,18,25,30,10,20,27,32,12,21,29,35,12,23,34,37,12,25,34,40,13,26,35,42,14,28,38,45,15,29,40,48,16,31,43,51,17,33,45,54,18,35,48,57,19,37,51,60,19,38,53,63,20,40,56,66,21,43,59,70,22,45,62,74,24,47,65,77,25,49,68,81],gc=[7,10,13,17,10,16,22,28,15,26,36,44,20,36,52,64,26,48,72,88,36,64,96,112,40,72,108,130,48,88,132,156,60,110,160,192,72,130,192,224,80,150,224,264,96,176,260,308,104,198,288,352,120,216,320,384,132,240,360,432,144,280,408,480,168,308,448,532,180,338,504,588,196,364,546,650,224,416,600,700,224,442,644,750,252,476,690,816,270,504,750,900,300,560,810,960,312,588,870,1050,336,644,952,1110,360,700,1020,1200,390,728,1050,1260,420,784,1140,1350,450,812,1200,1440,480,868,1290,1530,510,924,1350,1620,540,980,1440,1710,570,1036,1530,1800,570,1064,1590,1890,600,1120,1680,1980,630,1204,1770,2100,660,1260,1860,2220,720,1316,1950,2310,750,1372,2040,2430];Ip.getBlocksCount=function(t,n){switch(n){case yr.L:return pc[(t-1)*4+0];case yr.M:return pc[(t-1)*4+1];case yr.Q:return pc[(t-1)*4+2];case yr.H:return pc[(t-1)*4+3];default:return}};Ip.getTotalCodewordsCount=function(t,n){switch(n){case yr.L:return gc[(t-1)*4+0];case yr.M:return gc[(t-1)*4+1];case yr.Q:return gc[(t-1)*4+2];case yr.H:return gc[(t-1)*4+3];default:return}}});var uw=Gt(mc=>{"use strict";var za=new Uint8Array(512),_c=new Uint8Array(256);(function(){let t=1;for(let n=0;n<255;n++)za[n]=t,_c[t]=n,t<<=1,t&256&&(t^=285);for(let n=255;n<512;n++)za[n]=za[n-255]})();mc.log=function(t){if(t<1)throw new Error("log("+t+")");return _c[t]};mc.exp=function(t){return za[t]};mc.mul=function(t,n){return t===0||n===0?0:za[_c[t]+_c[n]]}});var dw=Gt(Wa=>{"use strict";var Wp=uw();Wa.mul=function(t,n){let i=new Uint8Array(t.length+n.length-1);for(let s=0;s<t.length;s++)for(let a=0;a<n.length;a++)i[s+a]^=Wp.mul(t[s],n[a]);return i};Wa.mod=function(t,n){let i=new Uint8Array(t);for(;i.length-n.length>=0;){let s=i[0];for(let h=0;h<n.length;h++)i[h]^=Wp.mul(n[h],s);let a=0;for(;a<i.length&&i[a]===0;)a++;i=i.slice(a)}return i};Wa.generateECPolynomial=function(t){let n=new Uint8Array([1]);for(let i=0;i<t;i++)n=Wa.mul(n,new Uint8Array([1,Wp.exp(i)]));return n}});var gw=Gt((Oz,pw)=>{"use strict";var fw=dw();function Fp(e){this.genPoly=void 0,this.degree=e,this.degree&&this.initialize(this.degree)}Fp.prototype.initialize=function(t){this.degree=t,this.genPoly=fw.generateECPolynomial(this.degree)};Fp.prototype.encode=function(t){if(!this.genPoly)throw new Error("Encoder not initialized");let n=new Uint8Array(t.length+this.degree);n.set(t);let i=fw.mod(n,this.genPoly),s=this.degree-i.length;if(s>0){let a=new Uint8Array(this.degree);return a.set(i,s),a}return i};pw.exports=Fp});var Np=Gt(_w=>{"use strict";_w.isValid=function(t){return!isNaN(t)&&t>=1&&t<=40}});var Hp=Gt(Ni=>{"use strict";var mw="[0-9]+",XM="[A-Z $%*+\\-./:]+",Fa="(?:[u3000-u303F]|[u3040-u309F]|[u30A0-u30FF]|[uFF00-uFFEF]|[u4E00-u9FAF]|[u2605-u2606]|[u2190-u2195]|u203B|[u2010u2015u2018u2019u2025u2026u201Cu201Du2225u2260]|[u0391-u0451]|[u00A7u00A8u00B1u00B4u00D7u00F7])+";Fa=Fa.replace(/u/g,"\\u");var GM="(?:(?![A-Z0-9 $%*+\\-./:]|"+Fa+`)(?:.|[\r
]))+`;Ni.KANJI=new RegExp(Fa,"g");Ni.BYTE_KANJI=new RegExp("[^A-Z0-9 $%*+\\-./:]+","g");Ni.BYTE=new RegExp(GM,"g");Ni.NUMERIC=new RegExp(mw,"g");Ni.ALPHANUMERIC=new RegExp(XM,"g");var KM=new RegExp("^"+Fa+"$"),qM=new RegExp("^"+mw+"$"),jM=new RegExp("^[A-Z0-9 $%*+\\-./:]+$");Ni.testKanji=function(t){return KM.test(t)};Ni.testNumeric=function(t){return qM.test(t)};Ni.testAlphanumeric=function(t){return jM.test(t)}});var vr=Gt(be=>{"use strict";var ZM=Np(),Up=Hp();be.NUMERIC={id:"Numeric",bit:1,ccBits:[10,12,14]};be.ALPHANUMERIC={id:"Alphanumeric",bit:2,ccBits:[9,11,13]};be.BYTE={id:"Byte",bit:4,ccBits:[8,16,16]};be.KANJI={id:"Kanji",bit:8,ccBits:[8,10,12]};be.MIXED={bit:-1};be.getCharCountIndicator=function(t,n){if(!t.ccBits)throw new Error("Invalid mode: "+t);if(!ZM.isValid(n))throw new Error("Invalid version: "+n);return n>=1&&n<10?t.ccBits[0]:n<27?t.ccBits[1]:t.ccBits[2]};be.getBestModeForData=function(t){return Up.testNumeric(t)?be.NUMERIC:Up.testAlphanumeric(t)?be.ALPHANUMERIC:Up.testKanji(t)?be.KANJI:be.BYTE};be.toString=function(t){if(t&&t.id)return t.id;throw new Error("Invalid mode")};be.isValid=function(t){return t&&t.bit&&t.ccBits};function $M(e){if(typeof e!="string")throw new Error("Param is not a string");switch(e.toLowerCase()){case"numeric":return be.NUMERIC;case"alphanumeric":return be.ALPHANUMERIC;case"kanji":return be.KANJI;case"byte":return be.BYTE;default:throw new Error("Unknown mode: "+e)}}be.from=function(t,n){if(be.isValid(t))return t;try{return $M(t)}catch{return n}}});var bw=Gt(is=>{"use strict";var yc=mr(),JM=zp(),yw=dc(),wr=vr(),Yp=Np(),ww=7973,vw=yc.getBCHDigit(ww);function QM(e,t,n){for(let i=1;i<=40;i++)if(t<=is.getCapacity(i,n,e))return i}function xw(e,t){return wr.getCharCountIndicator(e,t)+4}function tD(e,t){let n=0;return e.forEach(function(i){let s=xw(i.mode,t);n+=s+i.getBitsLength()}),n}function eD(e,t){for(let n=1;n<=40;n++)if(tD(e,n)<=is.getCapacity(n,t,wr.MIXED))return n}is.from=function(t,n){return Yp.isValid(t)?parseInt(t,10):n};is.getCapacity=function(t,n,i){if(!Yp.isValid(t))throw new Error("Invalid QR Code version");typeof i>"u"&&(i=wr.BYTE);let s=yc.getSymbolTotalCodewords(t),a=JM.getTotalCodewordsCount(t,n),h=(s-a)*8;if(i===wr.MIXED)return h;let l=h-xw(i,t);switch(i){case wr.NUMERIC:return Math.floor(l/10*3);case wr.ALPHANUMERIC:return Math.floor(l/11*2);case wr.KANJI:return Math.floor(l/13);case wr.BYTE:default:return Math.floor(l/8)}};is.getBestVersionForData=function(t,n){let i,s=yw.from(n,yw.M);if(Array.isArray(t)){if(t.length>1)return eD(t,s);if(t.length===0)return 1;i=t[0]}else i=t;return QM(i.mode,i.getLength(),s)};is.getEncodedBits=function(t){if(!Yp.isValid(t)||t<7)throw new Error("Invalid QR Code version");let n=t<<12;for(;yc.getBCHDigit(n)-vw>=0;)n^=ww<<yc.getBCHDigit(n)-vw;return t<<12|n}});var Tw=Gt(Cw=>{"use strict";var Vp=mr(),Sw=1335,nD=21522,Ew=Vp.getBCHDigit(Sw);Cw.getEncodedBits=function(t,n){let i=t.bit<<3|n,s=i<<10;for(;Vp.getBCHDigit(s)-Ew>=0;)s^=Sw<<Vp.getBCHDigit(s)-Ew;return(i<<10|s)^nD}});var Pw=Gt((zz,Lw)=>{"use strict";var iD=vr();function eo(e){this.mode=iD.NUMERIC,this.data=e.toString()}eo.getBitsLength=function(t){return 10*Math.floor(t/3)+(t%3?t%3*3+1:0)};eo.prototype.getLength=function(){return this.data.length};eo.prototype.getBitsLength=function(){return eo.getBitsLength(this.data.length)};eo.prototype.write=function(t){let n,i,s;for(n=0;n+3<=this.data.length;n+=3)i=this.data.substr(n,3),s=parseInt(i,10),t.put(s,10);let a=this.data.length-n;a>0&&(i=this.data.substr(n),s=parseInt(i,10),t.put(s,a*3+1))};Lw.exports=eo});var Rw=Gt((Wz,Bw)=>{"use strict";var rD=vr(),Xp=["0","1","2","3","4","5","6","7","8","9","A","B","C","D","E","F","G","H","I","J","K","L","M","N","O","P","Q","R","S","T","U","V","W","X","Y","Z"," ","$","%","*","+","-",".","/",":"];function no(e){this.mode=rD.ALPHANUMERIC,this.data=e}no.getBitsLength=function(t){return 11*Math.floor(t/2)+6*(t%2)};no.prototype.getLength=function(){return this.data.length};no.prototype.getBitsLength=function(){return no.getBitsLength(this.data.length)};no.prototype.write=function(t){let n;for(n=0;n+2<=this.data.length;n+=2){let i=Xp.indexOf(this.data[n])*45;i+=Xp.indexOf(this.data[n+1]),t.put(i,11)}this.data.length%2&&t.put(Xp.indexOf(this.data[n]),6)};Bw.exports=no});var Aw=Gt((Fz,Ow)=>{"use strict";var sD=vr();function io(e){this.mode=sD.BYTE,typeof e=="string"?this.data=new TextEncoder().encode(e):this.data=new Uint8Array(e)}io.getBitsLength=function(t){return t*8};io.prototype.getLength=function(){return this.data.length};io.prototype.getBitsLength=function(){return io.getBitsLength(this.data.length)};io.prototype.write=function(e){for(let t=0,n=this.data.length;t<n;t++)e.put(this.data[t],8)};Ow.exports=io});var Mw=Gt((Nz,kw)=>{"use strict";var oD=vr(),aD=mr();function ro(e){this.mode=oD.KANJI,this.data=e}ro.getBitsLength=function(t){return t*13};ro.prototype.getLength=function(){return this.data.length};ro.prototype.getBitsLength=function(){return ro.getBitsLength(this.data.length)};ro.prototype.write=function(e){let t;for(t=0;t<this.data.length;t++){let n=aD.toSJIS(this.data[t]);if(n>=33088&&n<=40956)n-=33088;else if(n>=57408&&n<=60351)n-=49472;else throw new Error("Invalid SJIS character: "+this.data[t]+`
Make sure your charset is UTF-8`);n=(n>>>8&255)*192+(n&255),e.put(n,13)}};kw.exports=ro});var Dw=Gt((Hz,Gp)=>{"use strict";var Na={single_source_shortest_paths:function(e,t,n){var i={},s={};s[t]=0;var a=Na.PriorityQueue.make();a.push(t,0);for(var h,l,u,f,g,p,v,w,E;!a.empty();){h=a.pop(),l=h.value,f=h.cost,g=e[l]||{};for(u in g)g.hasOwnProperty(u)&&(p=g[u],v=f+p,w=s[u],E=typeof s[u]>"u",(E||w>v)&&(s[u]=v,a.push(u,v),i[u]=l))}if(typeof n<"u"&&typeof s[n]>"u"){var P=["Could not find a path from ",t," to ",n,"."].join("");throw new Error(P)}return i},extract_shortest_path_from_predecessor_list:function(e,t){for(var n=[],i=t,s;i;)n.push(i),s=e[i],i=e[i];return n.reverse(),n},find_path:function(e,t,n){var i=Na.single_source_shortest_paths(e,t,n);return Na.extract_shortest_path_from_predecessor_list(i,n)},PriorityQueue:{make:function(e){var t=Na.PriorityQueue,n={},i;e=e||{};for(i in t)t.hasOwnProperty(i)&&(n[i]=t[i]);return n.queue=[],n.sorter=e.sorter||t.default_sorter,n},default_sorter:function(e,t){return e.cost-t.cost},push:function(e,t){var n={value:e,cost:t};this.queue.push(n),this.queue.sort(this.sorter)},pop:function(){return this.queue.shift()},empty:function(){return this.queue.length===0}}};typeof Gp<"u"&&(Gp.exports=Na)});var Yw=Gt(so=>{"use strict";var Ht=vr(),Ww=Pw(),Fw=Rw(),Nw=Aw(),Hw=Mw(),Ha=Hp(),vc=mr(),hD=Dw();function Iw(e){return unescape(encodeURIComponent(e)).length}function Ua(e,t,n){let i=[],s;for(;(s=e.exec(n))!==null;)i.push({data:s[0],index:s.index,mode:t,length:s[0].length});return i}function Uw(e){let t=Ua(Ha.NUMERIC,Ht.NUMERIC,e),n=Ua(Ha.ALPHANUMERIC,Ht.ALPHANUMERIC,e),i,s;return vc.isKanjiModeEnabled()?(i=Ua(Ha.BYTE,Ht.BYTE,e),s=Ua(Ha.KANJI,Ht.KANJI,e)):(i=Ua(Ha.BYTE_KANJI,Ht.BYTE,e),s=[]),t.concat(n,i,s).sort(function(h,l){return h.index-l.index}).map(function(h){return{data:h.data,mode:h.mode,length:h.length}})}function Kp(e,t){switch(t){case Ht.NUMERIC:return Ww.getBitsLength(e);case Ht.ALPHANUMERIC:return Fw.getBitsLength(e);case Ht.KANJI:return Hw.getBitsLength(e);case Ht.BYTE:return Nw.getBitsLength(e)}}function lD(e){return e.reduce(function(t,n){let i=t.length-1>=0?t[t.length-1]:null;return i&&i.mode===n.mode?(t[t.length-1].data+=n.data,t):(t.push(n),t)},[])}function cD(e){let t=[];for(let n=0;n<e.length;n++){let i=e[n];switch(i.mode){case Ht.NUMERIC:t.push([i,{data:i.data,mode:Ht.ALPHANUMERIC,length:i.length},{data:i.data,mode:Ht.BYTE,length:i.length}]);break;case Ht.ALPHANUMERIC:t.push([i,{data:i.data,mode:Ht.BYTE,length:i.length}]);break;case Ht.KANJI:t.push([i,{data:i.data,mode:Ht.BYTE,length:Iw(i.data)}]);break;case Ht.BYTE:t.push([{data:i.data,mode:Ht.BYTE,length:Iw(i.data)}])}}return t}function uD(e,t){let n={},i={start:{}},s=["start"];for(let a=0;a<e.length;a++){let h=e[a],l=[];for(let u=0;u<h.length;u++){let f=h[u],g=""+a+u;l.push(g),n[g]={node:f,lastCount:0},i[g]={};for(let p=0;p<s.length;p++){let v=s[p];n[v]&&n[v].node.mode===f.mode?(i[v][g]=Kp(n[v].lastCount+f.length,f.mode)-Kp(n[v].lastCount,f.mode),n[v].lastCount+=f.length):(n[v]&&(n[v].lastCount=f.length),i[v][g]=Kp(f.length,f.mode)+4+Ht.getCharCountIndicator(f.mode,t))}}s=l}for(let a=0;a<s.length;a++)i[s[a]].end=0;return{map:i,table:n}}function zw(e,t){let n,i=Ht.getBestModeForData(e);if(n=Ht.from(t,i),n!==Ht.BYTE&&n.bit<i.bit)throw new Error('"'+e+'" cannot be encoded with mode '+Ht.toString(n)+`.
 Suggested mode is: `+Ht.toString(i));switch(n===Ht.KANJI&&!vc.isKanjiModeEnabled()&&(n=Ht.BYTE),n){case Ht.NUMERIC:return new Ww(e);case Ht.ALPHANUMERIC:return new Fw(e);case Ht.KANJI:return new Hw(e);case Ht.BYTE:return new Nw(e)}}so.fromArray=function(t){return t.reduce(function(n,i){return typeof i=="string"?n.push(zw(i,null)):i.data&&n.push(zw(i.data,i.mode)),n},[])};so.fromString=function(t,n){let i=Uw(t,vc.isKanjiModeEnabled()),s=cD(i),a=uD(s,n),h=hD.find_path(a.map,"start","end"),l=[];for(let u=1;u<h.length-1;u++)l.push(a.table[h[u]].node);return so.fromArray(lD(l))};so.rawSplit=function(t){return so.fromArray(Uw(t,vc.isKanjiModeEnabled()))}});var Xw=Gt(Vw=>{"use strict";var xc=mr(),qp=dc(),dD=iw(),fD=sw(),pD=ow(),gD=lw(),$p=cw(),Jp=zp(),_D=gw(),wc=bw(),mD=Tw(),yD=vr(),jp=Yw();function vD(e,t){let n=e.size,i=gD.getPositions(t);for(let s=0;s<i.length;s++){let a=i[s][0],h=i[s][1];for(let l=-1;l<=7;l++)if(!(a+l<=-1||n<=a+l))for(let u=-1;u<=7;u++)h+u<=-1||n<=h+u||(l>=0&&l<=6&&(u===0||u===6)||u>=0&&u<=6&&(l===0||l===6)||l>=2&&l<=4&&u>=2&&u<=4?e.set(a+l,h+u,!0,!0):e.set(a+l,h+u,!1,!0))}}function wD(e){let t=e.size;for(let n=8;n<t-8;n++){let i=n%2===0;e.set(n,6,i,!0),e.set(6,n,i,!0)}}function xD(e,t){let n=pD.getPositions(t);for(let i=0;i<n.length;i++){let s=n[i][0],a=n[i][1];for(let h=-2;h<=2;h++)for(let l=-2;l<=2;l++)h===-2||h===2||l===-2||l===2||h===0&&l===0?e.set(s+h,a+l,!0,!0):e.set(s+h,a+l,!1,!0)}}function bD(e,t){let n=e.size,i=wc.getEncodedBits(t),s,a,h;for(let l=0;l<18;l++)s=Math.floor(l/3),a=l%3+n-8-3,h=(i>>l&1)===1,e.set(s,a,h,!0),e.set(a,s,h,!0)}function Zp(e,t,n){let i=e.size,s=mD.getEncodedBits(t,n),a,h;for(a=0;a<15;a++)h=(s>>a&1)===1,a<6?e.set(a,8,h,!0):a<8?e.set(a+1,8,h,!0):e.set(i-15+a,8,h,!0),a<8?e.set(8,i-a-1,h,!0):a<9?e.set(8,15-a-1+1,h,!0):e.set(8,15-a-1,h,!0);e.set(i-8,8,1,!0)}function ED(e,t){let n=e.size,i=-1,s=n-1,a=7,h=0;for(let l=n-1;l>0;l-=2)for(l===6&&l--;;){for(let u=0;u<2;u++)if(!e.isReserved(s,l-u)){let f=!1;h<t.length&&(f=(t[h]>>>a&1)===1),e.set(s,l-u,f),a--,a===-1&&(h++,a=7)}if(s+=i,s<0||n<=s){s-=i,i=-i;break}}}function SD(e,t,n){let i=new dD;n.forEach(function(u){i.put(u.mode.bit,4),i.put(u.getLength(),yD.getCharCountIndicator(u.mode,e)),u.write(i)});let s=xc.getSymbolTotalCodewords(e),a=Jp.getTotalCodewordsCount(e,t),h=(s-a)*8;for(i.getLengthInBits()+4<=h&&i.put(0,4);i.getLengthInBits()%8!==0;)i.putBit(0);let l=(h-i.getLengthInBits())/8;for(let u=0;u<l;u++)i.put(u%2?17:236,8);return CD(i,e,t)}function CD(e,t,n){let i=xc.getSymbolTotalCodewords(t),s=Jp.getTotalCodewordsCount(t,n),a=i-s,h=Jp.getBlocksCount(t,n),l=i%h,u=h-l,f=Math.floor(i/h),g=Math.floor(a/h),p=g+1,v=f-g,w=new _D(v),E=0,P=new Array(h),S=new Array(h),R=0,A=new Uint8Array(e.buffer);for(let V=0;V<h;V++){let K=V<u?g:p;P[V]=A.slice(E,E+K),S[V]=w.encode(P[V]),E+=K,R=Math.max(R,K)}let I=new Uint8Array(i),W=0,F,H;for(F=0;F<R;F++)for(H=0;H<h;H++)F<P[H].length&&(I[W++]=P[H][F]);for(F=0;F<v;F++)for(H=0;H<h;H++)I[W++]=S[H][F];return I}function TD(e,t,n,i){let s;if(Array.isArray(e))s=jp.fromArray(e);else if(typeof e=="string"){let f=t;if(!f){let g=jp.rawSplit(e);f=wc.getBestVersionForData(g,n)}s=jp.fromString(e,f||40)}else throw new Error("Invalid data");let a=wc.getBestVersionForData(s,n);if(!a)throw new Error("The amount of data is too big to be stored in a QR Code");if(!t)t=a;else if(t<a)throw new Error(`
The chosen QR Code version cannot contain this amount of data.
Minimum version required to store current data is: `+a+`.
`);let h=SD(t,n,s),l=xc.getSymbolSize(t),u=new fD(l);return vD(u,t),wD(u),xD(u,t),Zp(u,n,0),t>=7&&bD(u,t),ED(u,h),isNaN(i)&&(i=$p.getBestMask(u,Zp.bind(null,u,n))),$p.applyMask(i,u),Zp(u,n,i),{modules:u,version:t,errorCorrectionLevel:n,maskPattern:i,segments:s}}Vw.create=function(t,n){if(typeof t>"u"||t==="")throw new Error("No input text");let i=qp.M,s,a;return typeof n<"u"&&(i=qp.from(n.errorCorrectionLevel,qp.M),s=wc.from(n.version),a=$p.from(n.maskPattern),n.toSJISFunc&&xc.setToSJISFunction(n.toSJISFunc)),TD(t,s,i,a)}});var Qp=Gt(rs=>{"use strict";function Gw(e){if(typeof e=="number"&&(e=e.toString()),typeof e!="string")throw new Error("Color should be defined as hex string");let t=e.slice().replace("#","").split("");if(t.length<3||t.length===5||t.length>8)throw new Error("Invalid hex color: "+e);(t.length===3||t.length===4)&&(t=Array.prototype.concat.apply([],t.map(function(i){return[i,i]}))),t.length===6&&t.push("F","F");let n=parseInt(t.join(""),16);return{r:n>>24&255,g:n>>16&255,b:n>>8&255,a:n&255,hex:"#"+t.slice(0,6).join("")}}rs.getOptions=function(t){t||(t={}),t.color||(t.color={});let n=typeof t.margin>"u"||t.margin===null||t.margin<0?4:t.margin,i=t.width&&t.width>=21?t.width:void 0,s=t.scale||4;return{width:i,scale:i?4:s,margin:n,color:{dark:Gw(t.color.dark||"#000000ff"),light:Gw(t.color.light||"#ffffffff")},type:t.type,rendererOpts:t.rendererOpts||{}}};rs.getScale=function(t,n){return n.width&&n.width>=t+n.margin*2?n.width/(t+n.margin*2):n.scale};rs.getImageWidth=function(t,n){let i=rs.getScale(t,n);return Math.floor((t+n.margin*2)*i)};rs.qrToImageData=function(t,n,i){let s=n.modules.size,a=n.modules.data,h=rs.getScale(s,i),l=Math.floor((s+i.margin*2)*h),u=i.margin*h,f=[i.color.light,i.color.dark];for(let g=0;g<l;g++)for(let p=0;p<l;p++){let v=(g*l+p)*4,w=i.color.light;if(g>=u&&p>=u&&g<l-u&&p<l-u){let E=Math.floor((g-u)/h),P=Math.floor((p-u)/h);w=f[a[E*s+P]?1:0]}t[v++]=w.r,t[v++]=w.g,t[v++]=w.b,t[v]=w.a}}});var Kw=Gt(bc=>{"use strict";var tg=Qp();function LD(e,t,n){e.clearRect(0,0,t.width,t.height),t.style||(t.style={}),t.height=n,t.width=n,t.style.height=n+"px",t.style.width=n+"px"}function PD(){try{return document.createElement("canvas")}catch{throw new Error("You need to specify a canvas element")}}bc.render=function(t,n,i){let s=i,a=n;typeof s>"u"&&(!n||!n.getContext)&&(s=n,n=void 0),n||(a=PD()),s=tg.getOptions(s);let h=tg.getImageWidth(t.modules.size,s),l=a.getContext("2d"),u=l.createImageData(h,h);return tg.qrToImageData(u.data,t,s),LD(l,a,h),l.putImageData(u,0,0),a};bc.renderToDataURL=function(t,n,i){let s=i;typeof s>"u"&&(!n||!n.getContext)&&(s=n,n=void 0),s||(s={});let a=bc.render(t,n,s),h=s.type||"image/png",l=s.rendererOpts||{};return a.toDataURL(h,l.quality)}});var Zw=Gt(jw=>{"use strict";var BD=Qp();function qw(e,t){let n=e.a/255,i=t+'="'+e.hex+'"';return n<1?i+" "+t+'-opacity="'+n.toFixed(2).slice(1)+'"':i}function eg(e,t,n){let i=e+t;return typeof n<"u"&&(i+=" "+n),i}function RD(e,t,n){let i="",s=0,a=!1,h=0;for(let l=0;l<e.length;l++){let u=Math.floor(l%t),f=Math.floor(l/t);!u&&!a&&(a=!0),e[l]?(h++,l>0&&u>0&&e[l-1]||(i+=a?eg("M",u+n,.5+f+n):eg("m",s,0),s=0,a=!1),u+1<t&&e[l+1]||(i+=eg("h",h),h=0)):s++}return i}jw.render=function(t,n,i){let s=BD.getOptions(n),a=t.modules.size,h=t.modules.data,l=a+s.margin*2,u=s.color.light.a?"<path "+qw(s.color.light,"fill")+' d="M0 0h'+l+"v"+l+'H0z"/>':"",f="<path "+qw(s.color.dark,"stroke")+' d="'+RD(h,a,s.margin)+'"/>',g='viewBox="0 0 '+l+" "+l+'"',v='<svg xmlns="http://www.w3.org/2000/svg" '+(s.width?'width="'+s.width+'" height="'+s.width+'" ':"")+g+' shape-rendering="crispEdges">'+u+f+`</svg>
`;return typeof i=="function"&&i(null,v),v}});var Jw=Gt(Ya=>{"use strict";var OD=tw(),ng=Xw(),$w=Kw(),AD=Zw();function ig(e,t,n,i,s){let a=[].slice.call(arguments,1),h=a.length,l=typeof a[h-1]=="function";if(!l&&!OD())throw new Error("Callback required as last argument");if(l){if(h<2)throw new Error("Too few arguments provided");h===2?(s=n,n=t,t=i=void 0):h===3&&(t.getContext&&typeof s>"u"?(s=i,i=void 0):(s=i,i=n,n=t,t=void 0))}else{if(h<1)throw new Error("Too few arguments provided");return h===1?(n=t,t=i=void 0):h===2&&!t.getContext&&(i=n,n=t,t=void 0),new Promise(function(u,f){try{let g=ng.create(n,i);u(e(g,t,i))}catch(g){f(g)}})}try{let u=ng.create(n,i);s(null,e(u,t,i))}catch(u){s(u)}}Ya.create=ng.create;Ya.toCanvas=ig.bind(null,$w.render);Ya.toDataURL=ig.bind(null,$w.renderToDataURL);Ya.toString=ig.bind(null,function(e,t,n){return AD.render(e,n)})});var lm;(function(e){e[e.No=0]="No",e[e.Yes=1]="Yes",e[e.NoAndSkip=2]="NoAndSkip",e[e.YesAndSkip=3]="YesAndSkip"})(lm||(lm={}));var Cy={};function J(e){return e===void 0}function Be(e){return e==null}function gt(e){return typeof e=="string"}var{isFinite:wl}=Number;function Dt(e){return typeof e=="number"}var{isArray:Ct}=Array;function ht(e){return e&&typeof e=="object"}function YP(e){return JSON.stringify(e)==="{}"}var vt={default:(e,t)=>(Xh(t,e),Xh(e,t),e),assign(e,t,n){let i;Object.keys(t).forEach(s=>{var a,h;if(i=t[s],i?.constructor===Object&&((a=e[s])===null||a===void 0?void 0:a.constructor)===Object)return Xh(e[s],t[s],n&&n[s]);n&&s in n?((h=n[s])===null||h===void 0?void 0:h.constructor)===Object&&Xh(e[s]={},t[s],n[s]):e[s]=t[s]})},copyAttrs:(e,t,n)=>(n.forEach(i=>{J(t[i])||(e[i]=t[i])}),e),clone:e=>JSON.parse(JSON.stringify(e)),toMap(e){let t={};for(let n=0,i=e.length;n<i;n++)t[e[n]]=!0;return t},stintSet(e,t,n){n||(n=void 0),e[t]!==n&&(e[t]=n)}},{assign:Xh}=vt,Vo=class{get __useNaturalRatio(){return!0}get __isLinePath(){let{path:t}=this;return t&&t.length===6&&t[0]===1}get __usePathBox(){return this.__pathInputed}get __blendMode(){if(this.eraser&&this.eraser!=="path")return"destination-out";let{blendMode:t}=this;return t==="pass-through"?null:t}constructor(t){this.__leaf=t}__get(t){if(this.__input){let n=this.__input[t];if(!J(n))return n}return this[t]}__getData(){let t={tag:this.__leaf.tag},{__input:n}=this,i;for(let s in this)s[0]!=="_"&&(i=n?n[s]:void 0,t[s]=J(i)?this[s]:i);return t}__setInput(t,n){this.__input||(this.__input={}),this.__input[t]=n}__getInput(t){if(this.__input){let n=this.__input[t];if(!J(n))return n}if(t!=="path"||this.__pathInputed)return this["_"+t]}__removeInput(t){this.__input&&!J(this.__input[t])&&(this.__input[t]=void 0)}__getInputData(t,n){let i={};if(t)if(Ct(t))for(let s of t)i[s]=this.__getInput(s);else for(let s in t)i[s]=this.__getInput(s);else{let s,a,{__input:h}=this;i.tag=this.__leaf.tag;for(let l in this)if(l[0]!=="_"&&(s=this["_"+l],!J(s))){if(l==="path"&&!this.__pathInputed)continue;a=h?h[l]:void 0,i[l]=J(a)?s:a}}if(n&&n.matrix){let{a:s,b:a,c:h,d:l,e:u,f}=this.__leaf.__localMatrix;i.matrix={a:s,b:a,c:h,d:l,e:u,f}}return i}__setMiddle(t,n){this.__middle||(this.__middle={}),this.__middle[t]=n}__getMiddle(t){return this.__middle&&this.__middle[t]}__checkSingle(){let t=this;if(t.blendMode==="pass-through"){let n=this.__leaf;t.opacity<1&&(n.isBranch||t.__hasMultiPaint)||n.__hasEraser||t.eraser||t.filter?t.__single=!0:t.__single&&(t.__single=!1)}else t.__single=!0}__removeNaturalSize(){this.__naturalWidth=this.__naturalHeight=void 0}destroy(){this.__input=this.__middle=null}},{floor:cm,max:um}=Math,N={toURL(e,t){let n=encodeURIComponent(e);return t==="text"?n="data:text/plain;charset=utf-8,"+n:t==="svg"&&(n="data:image/svg+xml,"+n),n},image:{hitCanvasSize:100,maxCacheSize:4096e3,maxPatternSize:8847360,crossOrigin:"anonymous",isLarge:(e,t,n,i)=>e.width*e.height*(t?t*n:1)>(i||rd.maxCacheSize),isSuperLarge:(e,t,n)=>rd.isLarge(e,t,n,rd.maxPatternSize),getRealURL(e){let{prefix:t,suffix:n}=N.image;return!n||e.startsWith("data:")||e.startsWith("blob:")||(e+=(e.includes("?")?"&":"?")+n),t&&e[0]==="/"&&(e=t+e),e},resize(e,t,n,i,s,a,h,l,u){let f=N.origin.createCanvas(um(cm(t+(i||0)),1),um(cm(n+(s||0)),1)),g=f.getContext("2d");if(l&&(g.globalAlpha=l),g.imageSmoothingEnabled=h!==!1,e)if(a){let p=t/a.width,v=n/a.height;g.setTransform(p,0,0,v,-a.x*p,-a.y*v),g.drawImage(e,0,0,e.width,e.height)}else g.drawImage(e,0,0,t,n);return f},setPatternTransform(e,t,n){try{t&&e.setTransform&&(e.setTransform(t),t=void 0)}catch{}n&&vt.stintSet(n,"transform",t)}}},{image:rd}=N,ki={RUNTIME:"runtime",LEAF:"leaf",TASK:"task",CNAVAS:"canvas",IMAGE:"image",types:{},create(e){let{types:t}=VP;return t[e]?t[e]++:(t[e]=1,0)}},VP=ki,tn,en,sd,{max:Io}=Math,od=[0,0,0,0],Ds={zero:[...od],tempFour:od,set:(e,t,n,i,s)=>(n===void 0&&(n=i=s=t),e[0]=t,e[1]=n,e[2]=i,e[3]=s,e),setTemp:(e,t,n,i)=>Gh(od,e,t,n,i),toTempAB(e,t,n){sd=n?Dt(e)?t:e:[],Dt(e)?(tn=dm(e),en=t):Dt(t)?(tn=e,en=dm(t)):(tn=e,en=t),tn.length!==4&&(tn=ad(tn)),en.length!==4&&(en=ad(en))},get(e,t){let n;if(!Dt(e))switch(e.length){case 4:n=J(t)?e:[...e];break;case 2:n=[e[0],e[1],e[0],e[1]];break;case 3:n=[e[0],e[1],e[2],e[1]];break;case 1:e=e[0];break;default:e=0}if(n||(n=[e,e,e,e]),!J(t))for(let i=0;i<4;i++)n[i]>t&&(n[i]=t);return n},max:(e,t,n)=>Dt(e)&&Dt(t)?Io(e,t):(fm(e,t,n),Gh(sd,Io(tn[0],en[0]),Io(tn[1],en[1]),Io(tn[2],en[2]),Io(tn[3],en[3]))),add:(e,t,n)=>Dt(e)&&Dt(t)?e+t:(fm(e,t,n),Gh(sd,tn[0]+en[0],tn[1]+en[1],tn[2]+en[2],tn[3]+en[3])),swapAndScale(e,t,n,i){if(Dt(e))return t===n?e*t:[e*n,e*t];let s=i?e:[],[a,h,l,u]=e.length===4?e:ad(e);return Gh(s,l*n,u*t,a*n,h*t)}},{set:Gh,get:ad,setTemp:dm,toTempAB:fm}=Ds,{round:XP,pow:GP,max:KP,floor:qP,PI:Kd}=Math,Kt={within:(e,t,n)=>(ht(t)&&(n=t.max,t=t.min),!J(t)&&e<t&&(e=t),!J(n)&&e>n&&(e=n),e),fourNumber:Ds.get,formatRotation:(e,t)=>(e%=360,t?e<0&&(e+=360):(e>180&&(e-=360),e<-180&&(e+=360)),Kt.float(e)),getGapRotation(e,t,n=0){let i=e+n;if(t>1){let s=Math.abs(i%t);(s<1||s>t-1)&&(i=Math.round(i/t)*t)}return i-n},float(e,t){let n=J(t)?1e12:GP(10,t);return(e=XP(e*n)/n)===-0?0:e},sign:e=>e<0?-1:1,getScaleData(e,t,n,i){if(i||(i={}),t){let s=(Dt(t)?t:t.width||0)/n.width,a=(Dt(t)?t:t.height||0)/n.height;i.scaleX=s||a||1,i.scaleY=a||s||1}else e&&Kt.assignScale(i,e);return i},assignScale(e,t){Dt(t)?e.scaleX=e.scaleY=t:(e.scaleX=t.x,e.scaleY=t.y)},getFloorScale:(e,t=1)=>KP(qP(e),t)/e,randInt:Kh,randColor:e=>`rgba(${Kh(255)},${Kh(255)},${Kh(255)},${e||1})`};function Kh(e){return Math.round(Math.random()*e)}var Yt=Kd/180,jn=2*Kd,Os=Kd/2;function Ko(){return{x:0,y:0}}function qo(){return{x:0,y:0,width:0,height:0}}function jo(){return{a:1,b:0,c:0,d:1,e:0,f:0}}var{sin:hd,cos:ld,acos:qh,sqrt:cd}=Math,{float:Es}=Kt,Ss={};function pm(){return Object.assign(Object.assign(Object.assign({},{a:1,b:0,c:0,d:1,e:0,f:0}),{x:0,y:0,width:0,height:0}),{scaleX:1,scaleY:1,rotation:0,skewX:0,skewY:0})}var rt={defaultMatrix:{a:1,b:0,c:0,d:1,e:0,f:0},defaultWorld:pm(),tempMatrix:{},set(e,t=1,n=0,i=0,s=1,a=0,h=0){e.a=t,e.b=n,e.c=i,e.d=s,e.e=a,e.f=h},get:jo,getWorld:pm,copy(e,t){e.a=t.a,e.b=t.b,e.c=t.c,e.d=t.d,e.e=t.e,e.f=t.f},translate(e,t,n){e.e+=t,e.f+=n},translateInner(e,t,n,i){e.e+=e.a*t+e.c*n,e.f+=e.b*t+e.d*n,i&&(e.e-=t,e.f-=n)},scale(e,t,n=t){e.a*=t,e.b*=t,e.c*=n,e.d*=n},pixelScale(e,t,n){n||(n=e),n.a=e.a*t,n.b=e.b*t,n.c=e.c*t,n.d=e.d*t,n.e=e.e*t,n.f=e.f*t},scaleOfOuter(e,t,n,i){ae.toInnerPoint(e,t,Ss),ae.scaleOfInner(e,Ss,n,i)},scaleOfInner(e,t,n,i=n){ae.translateInner(e,t.x,t.y),ae.scale(e,n,i),ae.translateInner(e,-t.x,-t.y)},rotate(e,t){let{a:n,b:i,c:s,d:a}=e,h=ld(t*=Yt),l=hd(t);e.a=n*h-i*l,e.b=n*l+i*h,e.c=s*h-a*l,e.d=s*l+a*h},rotateOfOuter(e,t,n){ae.toInnerPoint(e,t,Ss),ae.rotateOfInner(e,Ss,n)},rotateOfInner(e,t,n){ae.translateInner(e,t.x,t.y),ae.rotate(e,n),ae.translateInner(e,-t.x,-t.y)},skew(e,t,n){let{a:i,b:s,c:a,d:h}=e;n&&(n*=Yt,e.a=i+a*n,e.b=s+h*n),t&&(t*=Yt,e.c=a+i*t,e.d=h+s*t)},skewOfOuter(e,t,n,i){ae.toInnerPoint(e,t,Ss),ae.skewOfInner(e,Ss,n,i)},skewOfInner(e,t,n,i=0){ae.translateInner(e,t.x,t.y),ae.skew(e,n,i),ae.translateInner(e,-t.x,-t.y)},multiply(e,t){let{a:n,b:i,c:s,d:a,e:h,f:l}=e;e.a=t.a*n+t.b*s,e.b=t.a*i+t.b*a,e.c=t.c*n+t.d*s,e.d=t.c*i+t.d*a,e.e=t.e*n+t.f*s+h,e.f=t.e*i+t.f*a+l},multiplyParent(e,t,n,i,s){let{e:a,f:h}=e;if(n||(n=e),J(i)&&(i=e.a!==1||e.b||e.c||e.d!==1),i){let{a:l,b:u,c:f,d:g}=e;n.a=l*t.a+u*t.c,n.b=l*t.b+u*t.d,n.c=f*t.a+g*t.c,n.d=f*t.b+g*t.d,s&&(n.scaleX=t.scaleX*s.scaleX,n.scaleY=t.scaleY*s.scaleY)}else n.a=t.a,n.b=t.b,n.c=t.c,n.d=t.d,s&&(n.scaleX=t.scaleX,n.scaleY=t.scaleY);n.e=a*t.a+h*t.c+t.e,n.f=a*t.b+h*t.d+t.f},divide(e,t){ae.multiply(e,ae.tempInvert(t))},divideParent(e,t){ae.multiplyParent(e,ae.tempInvert(t))},tempInvert(e){let{tempMatrix:t}=ae;return ae.copy(t,e),ae.invert(t),t},invert(e){let{a:t,b:n,c:i,d:s,e:a,f:h}=e;if(n||i){let l=1/(t*s-n*i);e.a=s*l,e.b=-n*l,e.c=-i*l,e.d=t*l,e.e=-(a*s-h*i)*l,e.f=-(h*t-a*n)*l}else if(t===1&&s===1)e.e=-a,e.f=-h;else{let l=1/(t*s);e.a=s*l,e.d=t*l,e.e=-a*s*l,e.f=-h*t*l}},toOuterPoint(e,t,n,i){let{x:s,y:a}=t;n||(n=t),n.x=s*e.a+a*e.c,n.y=s*e.b+a*e.d,i||(n.x+=e.e,n.y+=e.f)},toInnerPoint(e,t,n,i){let{a:s,b:a,c:h,d:l}=e,u=1/(s*l-a*h),{x:f,y:g}=t;if(n||(n=t),n.x=(f*l-g*h)*u,n.y=(g*s-f*a)*u,!i){let{e:p,f:v}=e;n.x-=(p*l-v*h)*u,n.y-=(v*s-p*a)*u}},setLayout(e,t,n,i,s){let{x:a,y:h,scaleX:l,scaleY:u}=t;if(J(s)&&(s=t.rotation||t.skewX||t.skewY),s){let{rotation:f,skewX:g,skewY:p}=t,v=f*Yt,w=ld(v),E=hd(v);if(g||p){let P=g*Yt,S=p*Yt;e.a=(w+S*-E)*l,e.b=(E+S*w)*l,e.c=(P*w-E)*u,e.d=(w+P*E)*u}else e.a=w*l,e.b=E*l,e.c=-E*u,e.d=w*u}else e.a=l,e.b=0,e.c=0,e.d=u;e.e=a,e.f=h,(n=n||i)&&ae.translateInner(e,-n.x,-n.y,!i)},getLayout(e,t,n,i){let{a:s,b:a,c:h,d:l,e:u,f}=e,g,p,v,w,E,P=u,S=f;if(a||h){let R=s*l-a*h;if(h&&!i){g=cd(s*s+a*a),p=R/g;let W=s/g;v=a>0?qh(W):-qh(W)}else{p=cd(h*h+l*l),g=R/p;let W=h/p;v=Os-(l>0?qh(-W):-qh(W))}let A=Es(ld(v)),I=hd(v);g=Es(g),p=Es(p),w=A?Es((h/p+I)/A/Yt,9):0,E=A?Es((a/g-I)/A/Yt,9):0,v=Es(v/Yt)}else g=s,p=l,v=w=E=0;return(t=n||t)&&(P+=t.x*s+t.y*h,S+=t.x*a+t.y*l,n||(P-=t.x,S-=t.y)),{x:P,y:S,scaleX:g,scaleY:p,rotation:v,skewX:w,skewY:E}},withScale(e,t,n=t){let i=e;if(!t||!n){let{a:s,b:a,c:h,d:l}=e;a||h?n=(s*l-a*h)/(t=cd(s*s+a*a)):(t=s,n=l)}return i.scaleX=t,i.scaleY=n,i},reset(e){ae.set(e)}},ae=rt,{float:jh}=Kt,{toInnerPoint:ud,toOuterPoint:gm}=rt,{sin:_m,cos:mm,abs:ym,sqrt:jP,atan2:ZP,min:$P,round:Zh}=Math,j={defaultPoint:{x:0,y:0},tempPoint:{},tempRadiusPoint:{},set(e,t=0,n=0){e.x=t,e.y=n},setRadius(e,t,n){e.radiusX=t,e.radiusY=J(n)?t:n},copy(e,t){e.x=t.x,e.y=t.y},copyFrom(e,t,n){e.x=t,e.y=n},round(e,t){e.x=t?Zh(e.x-.5)+.5:Zh(e.x),e.y=t?Zh(e.y-.5)+.5:Zh(e.y)},move(e,t,n){ht(t)?(e.x+=t.x,e.y+=t.y):(e.x+=t,e.y+=n)},scale(e,t,n=t){e.x&&(e.x*=t),e.y&&(e.y*=n)},scaleOf(e,t,n,i=n){e.x+=(e.x-t.x)*(n-1),e.y+=(e.y-t.y)*(i-1)},rotate(e,t,n){n||(n=er.defaultPoint);let i=mm(t*=Yt),s=_m(t),a=e.x-n.x,h=e.y-n.y;e.x=n.x+a*i-h*s,e.y=n.y+a*s+h*i},tempToInnerOf(e,t){let{tempPoint:n}=er;return $h(n,e),ud(t,n,n),n},tempToOuterOf(e,t){let{tempPoint:n}=er;return $h(n,e),gm(t,n,n),n},tempToInnerRadiusPointOf(e,t){let{tempRadiusPoint:n}=er;return $h(n,e),er.toInnerRadiusPointOf(e,t,n),n},copyRadiusPoint:(e,t,n,i)=>($h(e,t),JP(e,n,i),e),toInnerRadiusPointOf(e,t,n){n||(n=e),ud(t,e,n),n.radiusX=Math.abs(e.radiusX/t.scaleX),n.radiusY=Math.abs(e.radiusY/t.scaleY)},toInnerOf(e,t,n){ud(t,e,n)},toOuterOf(e,t,n){gm(t,e,n)},getCenter:(e,t)=>({x:e.x+(t.x-e.x)/2,y:e.y+(t.y-e.y)/2}),getCenterX:(e,t)=>e+(t-e)/2,getCenterY:(e,t)=>e+(t-e)/2,getDistance:(e,t)=>dd(e.x,e.y,t.x,t.y),getDistanceFrom(e,t,n,i){let s=ym(n-e),a=ym(i-t);return jP(s*s+a*a)},getMinDistanceFrom:(e,t,n,i,s,a)=>$P(dd(e,t,n,i),dd(n,i,s,a)),getAngle:(e,t)=>vm(e,t)/Yt,getRotation:(e,t,n,i)=>(i||(i=t),er.getRadianFrom(e.x,e.y,t.x,t.y,n.x,n.y,i.x,i.y)/Yt),getRadianFrom(e,t,n,i,s,a,h,l){J(h)&&(h=n,l=i);let u=e-n,f=t-i,g=s-h,p=a-l;return Math.atan2(u*p-f*g,u*g+f*p)},getAtan2:(e,t)=>ZP(t.y-e.y,t.x-e.x),getDistancePoint(e,t,n,i,s){let a=vm(e,t);return s&&(e=t),i||(t={}),t.x=e.x+mm(a)*n,t.y=e.y+_m(a)*n,t},toNumberPoints(e){let t=e;return ht(e[0])&&(t=[],e.forEach(n=>t.push(n.x,n.y))),t},isSame:(e,t)=>jh(e.x)===jh(t.x)&&jh(e.y)===jh(t.y),reset(e){er.reset(e)}},er=j,{getDistanceFrom:dd,copy:$h,setRadius:JP,getAtan2:vm}=er,Xo=class e{constructor(t,n){this.set(t,n)}set(t,n){return ht(t)?j.copy(this,t):j.set(this,t,n),this}get(){let{x:t,y:n}=this;return{x:t,y:n}}clone(){return new e(this)}move(t,n){return j.move(this,t,n),this}scale(t,n){return j.scale(this,t,n),this}scaleOf(t,n,i){return j.scaleOf(this,t,n,i),this}rotate(t,n){return j.rotate(this,t,n),this}rotateOf(t,n){return j.rotate(this,n,t),this}getRotation(t,n,i){return j.getRotation(this,t,n,i)}toInnerOf(t,n){return j.toInnerOf(this,t,n),this}toOuterOf(t,n){return j.toOuterOf(this,t,n),this}getCenter(t){return new e(j.getCenter(this,t))}getDistance(t){return j.getDistance(this,t)}getDistancePoint(t,n,i,s){return new e(j.getDistancePoint(this,t,n,i,s))}getAngle(t){return j.getAngle(this,t)}getAtan2(t){return j.getAtan2(this,t)}isSame(t){return j.isSame(this,t)}reset(){return j.reset(this),this}},DD=new Xo,ye=class e{constructor(t,n,i,s,a,h){this.set(t,n,i,s,a,h)}set(t,n,i,s,a,h){return ht(t)?rt.copy(this,t):rt.set(this,t,n,i,s,a,h),this}setWith(t){return rt.copy(this,t),this.scaleX=t.scaleX,this.scaleY=t.scaleY,this}get(){let{a:t,b:n,c:i,d:s,e:a,f:h}=this;return{a:t,b:n,c:i,d:s,e:a,f:h}}clone(){return new e(this)}translate(t,n){return rt.translate(this,t,n),this}translateInner(t,n){return rt.translateInner(this,t,n),this}scale(t,n){return rt.scale(this,t,n),this}scaleWith(t,n){return rt.scale(this,t,n),this.scaleX*=t,this.scaleY*=n||t,this}pixelScale(t){return rt.pixelScale(this,t),this}scaleOfOuter(t,n,i){return rt.scaleOfOuter(this,t,n,i),this}scaleOfInner(t,n,i){return rt.scaleOfInner(this,t,n,i),this}rotate(t){return rt.rotate(this,t),this}rotateOfOuter(t,n){return rt.rotateOfOuter(this,t,n),this}rotateOfInner(t,n){return rt.rotateOfInner(this,t,n),this}skew(t,n){return rt.skew(this,t,n),this}skewOfOuter(t,n,i){return rt.skewOfOuter(this,t,n,i),this}skewOfInner(t,n,i){return rt.skewOfInner(this,t,n,i),this}multiply(t){return rt.multiply(this,t),this}multiplyParent(t){return rt.multiplyParent(this,t),this}divide(t){return rt.divide(this,t),this}divideParent(t){return rt.divideParent(this,t),this}invert(){return rt.invert(this),this}invertWith(){return rt.invert(this),this.scaleX=1/this.scaleX,this.scaleY=1/this.scaleY,this}toOuterPoint(t,n,i){rt.toOuterPoint(this,t,n,i)}toInnerPoint(t,n,i){rt.toInnerPoint(this,t,n,i)}setLayout(t,n,i){return rt.setLayout(this,t,n,i),this}getLayout(t,n,i){return rt.getLayout(this,t,n,i)}withScale(t,n){return rt.withScale(this,t,n)}reset(){rt.reset(this)}},ID=new ye,xl={tempPointBounds:{},setPoint(e,t,n){e.minX=e.maxX=t,e.minY=e.maxY=n},addPoint(e,t,n){e.minX=t<e.minX?t:e.minX,e.minY=n<e.minY?n:e.minY,e.maxX=t>e.maxX?t:e.maxX,e.maxY=n>e.maxY?n:e.maxY},addBounds(e,t,n,i,s){wm(e,t,n),wm(e,t+i,n+s)},copy(e,t){e.minX=t.minX,e.minY=t.minY,e.maxX=t.maxX,e.maxY=t.maxY},addPointBounds(e,t){e.minX=t.minX<e.minX?t.minX:e.minX,e.minY=t.minY<e.minY?t.minY:e.minY,e.maxX=t.maxX>e.maxX?t.maxX:e.maxX,e.maxY=t.maxY>e.maxY?t.maxY:e.maxY},toBounds(e,t){t.x=e.minX,t.y=e.minY,t.width=e.maxX-e.minX,t.height=e.maxY-e.minY}},{addPoint:wm}=xl,pl,ir;(function(e){e[e.top=0]="top",e[e.right=1]="right",e[e.bottom=2]="bottom",e[e.left=3]="left"})(pl||(pl={})),function(e){e[e.topLeft=0]="topLeft",e[e.top=1]="top",e[e.topRight=2]="topRight",e[e.right=3]="right",e[e.bottomRight=4]="bottomRight",e[e.bottom=5]="bottom",e[e.bottomLeft=6]="bottomLeft",e[e.left=7]="left",e[e.center=8]="center",e[e["top-left"]=0]="top-left",e[e["top-right"]=2]="top-right",e[e["bottom-right"]=4]="bottom-right",e[e["bottom-left"]=6]="bottom-left"}(ir||(ir={}));var qd=[{x:0,y:0},{x:.5,y:0},{x:1,y:0},{x:1,y:.5},{x:1,y:1},{x:.5,y:1},{x:0,y:1},{x:0,y:.5},{x:.5,y:.5}];qd.forEach(e=>e.type="percent");var xn={directionData:qd,tempPoint:{},get:xm,toPoint(e,t,n,i,s,a){let h=xm(e);n.x=h.x,n.y=h.y,h.type==="percent"&&(n.x*=t.width,n.y*=t.height,s&&(a||(n.x-=s.x,n.y-=s.y),h.x&&(n.x-=h.x===1?s.width:h.x===.5?h.x*s.width:0),h.y&&(n.y-=h.y===1?s.height:h.y===.5?h.y*s.height:0))),i||(n.x+=t.x,n.y+=t.y)},getPoint:(e,t,n)=>(n||(n={}),xn.toPoint(e,t,n,!0),n)};function xm(e){return gt(e)?qd[ir[e]]:e}var{toPoint:QP}=xn,jd={toPoint(e,t,n,i,s,a){QP(e,n,i,s,t,a)}},{tempPointBounds:Ji,setPoint:bm,addPoint:Jh,toBounds:Em}=xl,{toOuterPoint:Qh}=rt,{float:tl,fourNumber:tB}=Kt,{floor:Sm,ceil:el}=Math,ci,ui,Or,Ar,Ri={},Mn={},kr={},X={tempBounds:kr,set(e,t=0,n=0,i=0,s=0){e.x=t,e.y=n,e.width=i,e.height=s},copy(e,t){e.x=t.x,e.y=t.y,e.width=t.width,e.height=t.height},copyAndSpread(e,t,n,i,s){let{x:a,y:h,width:l,height:u}=t;if(Ct(n)){let f=tB(n);i?Nt.set(e,a+f[3],h+f[0],l-f[1]-f[3],u-f[2]-f[0]):Nt.set(e,a-f[3],h-f[0],l+f[1]+f[3],u+f[2]+f[0])}else i&&(n=-n),Nt.set(e,a-n,h-n,l+2*n,u+2*n);s&&(s==="width"?(e.y=h,e.height=u):(e.x=a,e.width=l))},minX:e=>e.width>0?e.x:e.x+e.width,minY:e=>e.height>0?e.y:e.y+e.height,maxX:e=>e.width>0?e.x+e.width:e.x,maxY:e=>e.height>0?e.y+e.height:e.y,move(e,t,n){e.x+=t,e.y+=n},scroll(e,t){e.x+=t.scrollX,e.y+=t.scrollY},getByMove:(e,t,n)=>(e=Object.assign({},e),Nt.move(e,t,n),e),toOffsetOutBounds(e,t,n){t?Tm(t,e):t=e,n||(n=e),t.offsetX=Nt.maxX(n),t.offsetY=Nt.maxY(n),Nt.move(t,-t.offsetX,-t.offsetY)},scale(e,t,n=t,i){i||j.scale(e,t,n),e.width*=t,e.height*=n},scaleOf(e,t,n,i=n){j.scaleOf(e,t,n,i),e.width*=n,e.height*=i},tempToOuterOf:(e,t)=>(Nt.copy(kr,e),Nt.toOuterOf(kr,t),kr),getOuterOf:(e,t)=>(e=Object.assign({},e),Nt.toOuterOf(e,t),e),toOuterOf(e,t,n){if(n||(n=e),t.b===0&&t.c===0){let{a:i,d:s,e:a,f:h}=t;i>0?(n.width=e.width*i,n.x=a+e.x*i):(n.width=e.width*-i,n.x=a+e.x*i-n.width),s>0?(n.height=e.height*s,n.y=h+e.y*s):(n.height=e.height*-s,n.y=h+e.y*s-n.height)}else Ri.x=e.x,Ri.y=e.y,Qh(t,Ri,Mn),bm(Ji,Mn.x,Mn.y),Ri.x=e.x+e.width,Qh(t,Ri,Mn),Jh(Ji,Mn.x,Mn.y),Ri.y=e.y+e.height,Qh(t,Ri,Mn),Jh(Ji,Mn.x,Mn.y),Ri.x=e.x,Qh(t,Ri,Mn),Jh(Ji,Mn.x,Mn.y),Em(Ji,n)},toInnerOf(e,t,n){n||(n=e),Nt.move(n,-t.e,-t.f),Nt.scale(n,1/t.a,1/t.d)},getFitMatrix(e,t,n=1){let i=Math.min(n,Nt.getFitScale(e,t));return new ye(i,0,0,i,-t.x*i,-t.y*i)},getFitScale(e,t,n){let i=e.width/t.width,s=e.height/t.height;return n?Math.max(i,s):Math.min(i,s)},put(e,t,n="center",i=1,s=!0,a){a||(a=t),gt(i)&&(i=Nt.getFitScale(e,t,i==="cover")),kr.width=s?t.width*=i:t.width*i,kr.height=s?t.height*=i:t.height*i,jd.toPoint(n,kr,e,a,!0,!0)},getSpread(e,t,n){let i={};return Nt.copyAndSpread(i,e,t,!1,n),i},spread(e,t,n){Nt.copyAndSpread(e,e,t,!1,n)},shrink(e,t,n){Nt.copyAndSpread(e,e,t,!0,n)},ceil(e){let{x:t,y:n}=e;e.x=Sm(e.x),e.y=Sm(e.y),e.width=t>e.x?el(e.width+t-e.x):el(e.width),e.height=n>e.y?el(e.height+n-e.y):el(e.height)},unsign(e){e.width<0&&(e.x+=e.width,e.width=-e.width),e.height<0&&(e.y+=e.height,e.height=-e.height)},float(e,t){e.x=tl(e.x,t),e.y=tl(e.y,t),e.width=tl(e.width,t),e.height=tl(e.height,t)},add(e,t,n){ci=e.x+e.width,ui=e.y+e.height,Or=t.x,Ar=t.y,n||(Or+=t.width,Ar+=t.height),ci=ci>Or?ci:Or,ui=ui>Ar?ui:Ar,e.x=e.x<t.x?e.x:t.x,e.y=e.y<t.y?e.y:t.y,e.width=ci-e.x,e.height=ui-e.y},addList(e,t){Nt.setListWithFn(e,t,void 0,!0)},setList(e,t,n=!1){Nt.setListWithFn(e,t,void 0,n)},addListWithFn(e,t,n){Nt.setListWithFn(e,t,n,!0)},setListWithFn(e,t,n,i=!1){let s,a=!0;for(let h=0,l=t.length;h<l;h++)s=n?n(t[h],h):t[h],s&&(s.width||s.height)&&(a?(a=!1,i||Tm(e,s)):Cm(e,s));a&&Nt.reset(e)},setPoints(e,t){t.forEach((n,i)=>i===0?bm(Ji,n.x,n.y):Jh(Ji,n.x,n.y)),Em(Ji,e)},setPoint(e,t){Nt.set(e,t.x,t.y)},addPoint(e,t){Cm(e,t,!0)},getPoints(e){let{x:t,y:n,width:i,height:s}=e;return[{x:t,y:n},{x:t+i,y:n},{x:t+i,y:n+s},{x:t,y:n+s}]},hitRadiusPoint:(e,t,n)=>(n&&(t=j.tempToInnerRadiusPointOf(t,n)),t.x>=e.x-t.radiusX&&t.x<=e.x+e.width+t.radiusX&&t.y>=e.y-t.radiusY&&t.y<=e.y+e.height+t.radiusY),hitPoint:(e,t,n)=>(n&&(t=j.tempToInnerOf(t,n)),t.x>=e.x&&t.x<=e.x+e.width&&t.y>=e.y&&t.y<=e.y+e.height),hit:(e,t,n)=>(n&&(t=Nt.tempToOuterOf(t,n)),!(e.y+e.height<t.y||t.y+t.height<e.y||e.x+e.width<t.x||t.x+t.width<e.x)),includes:(e,t,n)=>(n&&(t=Nt.tempToOuterOf(t,n)),e.x<=t.x&&e.y<=t.y&&e.x+e.width>=t.x+t.width&&e.y+e.height>=t.y+t.height),getIntersectData(e,t,n){if(n&&(t=Nt.tempToOuterOf(t,n)),!Nt.hit(e,t))return{x:0,y:0,width:0,height:0};let{x:i,y:s,width:a,height:h}=t;return ci=i+a,ui=s+h,Or=e.x+e.width,Ar=e.y+e.height,i=i>e.x?i:e.x,s=s>e.y?s:e.y,ci=ci<Or?ci:Or,ui=ui<Ar?ui:Ar,a=ci-i,h=ui-s,{x:i,y:s,width:a,height:h}},intersect(e,t,n){Nt.copy(e,Nt.getIntersectData(e,t,n))},isSame:(e,t)=>e.x===t.x&&e.y===t.y&&e.width===t.width&&e.height===t.height,isEmpty:e=>e.x===0&&e.y===0&&e.width===0&&e.height===0,reset(e){Nt.set(e)}},Nt=X,{add:Cm,copy:Tm}=Nt,It=class e{get minX(){return X.minX(this)}get minY(){return X.minY(this)}get maxX(){return X.maxX(this)}get maxY(){return X.maxY(this)}constructor(t,n,i,s){this.set(t,n,i,s)}set(t,n,i,s){return ht(t)?X.copy(this,t):X.set(this,t,n,i,s),this}get(){let{x:t,y:n,width:i,height:s}=this;return{x:t,y:n,width:i,height:s}}clone(){return new e(this)}move(t,n){return X.move(this,t,n),this}scale(t,n,i){return X.scale(this,t,n,i),this}scaleOf(t,n,i){return X.scaleOf(this,t,n,i),this}toOuterOf(t,n){return X.toOuterOf(this,t,n),this}toInnerOf(t,n){return X.toInnerOf(this,t,n),this}getFitMatrix(t,n){return X.getFitMatrix(this,t,n)}put(t,n,i){X.put(this,t,n,i)}spread(t,n){return X.spread(this,t,n),this}shrink(t,n){return X.shrink(this,t,n),this}ceil(){return X.ceil(this),this}unsign(){return X.unsign(this),this}float(t){return X.float(this,t),this}add(t){return X.add(this,t),this}addList(t){return X.setList(this,t,!0),this}setList(t){return X.setList(this,t),this}addListWithFn(t,n){return X.setListWithFn(this,t,n,!0),this}setListWithFn(t,n){return X.setListWithFn(this,t,n),this}setPoint(t){return X.setPoint(this,t),this}setPoints(t){return X.setPoints(this,t),this}addPoint(t){return X.addPoint(this,t),this}getPoints(){return X.getPoints(this)}hitPoint(t,n){return X.hitPoint(this,t,n)}hitRadiusPoint(t,n){return X.hitRadiusPoint(this,t,n)}hit(t,n){return X.hit(this,t,n)}includes(t,n){return X.includes(this,t,n)}intersect(t,n){return X.intersect(this,t,n),this}getIntersect(t,n){return new e(X.getIntersectData(this,t,n))}isSame(t){return X.isSame(this,t)}isEmpty(){return X.isEmpty(this)}reset(){X.reset(this)}},sr=new It,gl=class{constructor(t,n,i,s,a,h){ht(t)?this.copy(t):this.set(t,n,i,s,a,h)}set(t=0,n=0,i=0,s=0,a=0,h=0){this.top=t,this.right=n,this.bottom=i,this.left=s,this.width=a,this.height=h}copy(t){let{top:n,right:i,bottom:s,left:a,width:h,height:l}=t;this.set(n,i,s,a,h,l)}getBoundsFrom(t){let{top:n,right:i,bottom:s,left:a,width:h,height:l}=this;return new It(a,n,h||t.width-a-i,l||t.height-n-s)}},eB={0:1,1:1,2:1,3:1,4:1,5:1,6:1,7:1,8:1,9:1,".":1,e:1,E:1},{randColor:Lm}=Kt,Pt=class e{constructor(t){this.repeatMap={},this.name=t}static get(t){return new e(t)}static set filter(t){this.filterList=Pm(t)}static set exclude(t){this.excludeList=Pm(t)}static drawRepaint(t,n){let i=Lm();t.fillWorld(n,i.replace("1)",".1)")),t.strokeWorld(n,i)}static drawBounds(t,n,i){let s=e.showBounds==="hit",a=t.__nowWorld,h=Lm();s&&(n.setWorld(a),t.__drawHitPath(n),n.fillStyle=h.replace("1)",".2)"),n.fill()),n.resetTransform(),n.setStroke(h,2),s?n.stroke():n.strokeWorld(a,h)}log(...t){if(Mr.enable){if(Mr.filterList.length&&Mr.filterList.every(n=>n!==this.name)||Mr.excludeList.length&&Mr.excludeList.some(n=>n===this.name))return;console.log("%c"+this.name,"color:#21ae62",...t)}}tip(...t){Mr.enable&&this.warn(...t)}warn(...t){Mr.showWarn&&console.warn(this.name,...t)}repeat(t,...n){this.repeatMap[t]||(this.warn("repeat:"+t,...n),this.repeatMap[t]=!0)}error(...t){try{throw new Error}catch(n){console.error(this.name,...t,n)}}};function Pm(e){return e?gt(e)&&(e=[e]):e=[],e}Pt.filterList=[],Pt.excludeList=[],Pt.showWarn=!0;var Mr=Pt,nB=Pt.get("RunTime"),bn={currentId:0,currentName:"",idMap:{},nameMap:{},nameToIdMap:{},start(e,t){let n=ki.create(ki.RUNTIME);return Dn.currentId=Dn.idMap[n]=t?performance.now():Date.now(),Dn.currentName=Dn.nameMap[n]=e,Dn.nameToIdMap[e]=n,n},end(e,t){let n=Dn.idMap[e],i=Dn.nameMap[e],s=t?(performance.now()-n)/1e3:Date.now()-n;Dn.idMap[e]=Dn.nameMap[e]=Dn.nameToIdMap[i]=void 0,nB.log(i,s,"ms")},endOfName(e,t){let n=Dn.nameToIdMap[e];J(n)||Dn.end(n,t)}},Dn=bn,Ty=[],Zt={list:{},add(e,...t){this.list[e]=!0,Ty.push(...t)},has(e,t){let n=this.list[e];return!n&&t&&this.need(e),n},need(e){console.error("please install and import plugin: "+(e.includes("-x")?"":"@leafer-in/")+e)}};setTimeout(()=>Ty.forEach(e=>Zt.has(e,!0)));var $t={editor:e=>Zt.need("editor")},Bm=Pt.get("UICreator"),Is={list:{},register(e){let{__tag:t}=e.prototype;nl[t]&&Bm.repeat(t),nl[t]=e},get(e,t,n,i,s,a){nl[e]||Bm.error("not register "+e);let h=new nl[e](t);return J(n)||(h.x=n,i&&(h.y=i),s&&(h.width=s),a&&(h.height=a)),h}},{list:nl}=Is,iB=Pt.get("EventCreator"),zr={nameList:{},register(e){let t;Object.keys(e).forEach(n=>{t=e[n],gt(t)&&(zo[t]&&iB.repeat(t),zo[t]=e)})},changeName(e,t){let n=zo[e];if(n){let i=Object.keys(n).find(s=>n[s]===e);i&&(n[i]=t,zo[t]=n)}},has(e){return!!this.nameList[e]},get:(e,...t)=>new zo[e](...t)},{nameList:zo}=zr,ks=class{constructor(){this.list=[]}add(t){t.manager=this,this.list.push(t)}get(t){let n,{list:i}=this;for(let a=0,h=i.length;a<h;a++)if(n=i[a],n.recycled&&n.isSameSize(t))return n.recycled=!1,n.manager||(n.manager=this),n;let s=$t.canvas(t);return this.add(s),s}recycle(t){t.recycled=!0}clearRecycled(){let t,n=[];for(let i=0,s=this.list.length;i<s;i++)t=this.list[i],t.recycled?t.destroy():n.push(t);this.list=n}clear(){this.list.forEach(t=>{t.destroy()}),this.list.length=0}destroy(){this.clear()}};function Q(e,t,n,i){var s,a=arguments.length,h=a<3?t:i===null?i=Object.getOwnPropertyDescriptor(t,n):i;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")h=Reflect.decorate(e,t,n,i);else for(var l=e.length-1;l>=0;l--)(s=e[l])&&(h=(a<3?s(h):a>3?s(t,n,h):s(t,n))||h);return a>3&&h&&Object.defineProperty(t,n,h),h}function Ly(e,t,n,i){return new(n||(n=Promise))(function(s,a){function h(f){try{u(i.next(f))}catch(g){a(g)}}function l(f){try{u(i.throw(f))}catch(g){a(g)}}function u(f){var g;f.done?s(f.value):(g=f.value,g instanceof n?g:new n(function(p){p(g)})).then(h,l)}u((i=i.apply(e,t||[])).next())})}function se(e){return(t,n)=>{e||(e=n);let i={get(){return this.context[e]},set(s){this.context[e]=s}};n==="strokeCap"&&(i.set=function(s){this.context[e]=s==="none"?"butt":s}),Object.defineProperty(t,n,i)}}var Py=[];function At(){return(e,t)=>{Py.push(t)}}var rB=[],$=class{set blendMode(t){t==="normal"&&(t="source-over"),this.context.globalCompositeOperation=t}get blendMode(){return this.context.globalCompositeOperation}set dashPattern(t){this.context.setLineDash(t||rB)}get dashPattern(){return this.context.getLineDash()}__bindContext(){let t;Py.forEach(n=>{t=this.context[n],t&&(this[n]=t.bind(this.context))}),this.textBaseline="alphabetic"}setTransform(t,n,i,s,a,h){}resetTransform(){}getTransform(){}save(){}restore(){}transform(t,n,i,s,a,h){ht(t)?this.context.transform(t.a,t.b,t.c,t.d,t.e,t.f):this.context.transform(t,n,i,s,a,h)}translate(t,n){}scale(t,n){}rotate(t){}fill(t,n){}stroke(t){}clip(t,n){}fillRect(t,n,i,s){}strokeRect(t,n,i,s){}clearRect(t,n,i,s){}drawImage(t,n,i,s,a,h,l,u,f){switch(arguments.length){case 9:if(n<0){let g=-n/s*u;s+=n,n=0,h+=g,u-=g}if(i<0){let g=-i/a*f;a+=i,i=0,l+=g,f-=g}this.context.drawImage(t,n,i,s,a,h,l,u,f);break;case 5:this.context.drawImage(t,n,i,s,a);break;case 3:this.context.drawImage(t,n,i)}}beginPath(){}moveTo(t,n){}lineTo(t,n){}bezierCurveTo(t,n,i,s,a,h){}quadraticCurveTo(t,n,i,s){}closePath(){}arc(t,n,i,s,a,h){}arcTo(t,n,i,s,a){}ellipse(t,n,i,s,a,h,l,u){}rect(t,n,i,s){}roundRect(t,n,i,s,a){}createConicGradient(t,n,i){}createLinearGradient(t,n,i,s){}createPattern(t,n){}createRadialGradient(t,n,i,s,a,h){}fillText(t,n,i,s){}measureText(t){}strokeText(t,n,i,s){}destroy(){this.context=null}};Q([se("imageSmoothingEnabled")],$.prototype,"smooth",void 0),Q([se("imageSmoothingQuality")],$.prototype,"smoothLevel",void 0),Q([se("globalAlpha")],$.prototype,"opacity",void 0),Q([se()],$.prototype,"fillStyle",void 0),Q([se()],$.prototype,"strokeStyle",void 0),Q([se("lineWidth")],$.prototype,"strokeWidth",void 0),Q([se("lineCap")],$.prototype,"strokeCap",void 0),Q([se("lineJoin")],$.prototype,"strokeJoin",void 0),Q([se("lineDashOffset")],$.prototype,"dashOffset",void 0),Q([se()],$.prototype,"miterLimit",void 0),Q([se()],$.prototype,"shadowBlur",void 0),Q([se()],$.prototype,"shadowColor",void 0),Q([se()],$.prototype,"shadowOffsetX",void 0),Q([se()],$.prototype,"shadowOffsetY",void 0),Q([se()],$.prototype,"filter",void 0),Q([se()],$.prototype,"font",void 0),Q([se()],$.prototype,"fontKerning",void 0),Q([se()],$.prototype,"fontStretch",void 0),Q([se()],$.prototype,"fontVariantCaps",void 0),Q([se()],$.prototype,"textAlign",void 0),Q([se()],$.prototype,"textBaseline",void 0),Q([se()],$.prototype,"textRendering",void 0),Q([se()],$.prototype,"wordSpacing",void 0),Q([se()],$.prototype,"letterSpacing",void 0),Q([se()],$.prototype,"direction",void 0),Q([At()],$.prototype,"setTransform",null),Q([At()],$.prototype,"resetTransform",null),Q([At()],$.prototype,"getTransform",null),Q([At()],$.prototype,"save",null),Q([At()],$.prototype,"restore",null),Q([At()],$.prototype,"translate",null),Q([At()],$.prototype,"scale",null),Q([At()],$.prototype,"rotate",null),Q([At()],$.prototype,"fill",null),Q([At()],$.prototype,"stroke",null),Q([At()],$.prototype,"clip",null),Q([At()],$.prototype,"fillRect",null),Q([At()],$.prototype,"strokeRect",null),Q([At()],$.prototype,"clearRect",null),Q([At()],$.prototype,"beginPath",null),Q([At()],$.prototype,"moveTo",null),Q([At()],$.prototype,"lineTo",null),Q([At()],$.prototype,"bezierCurveTo",null),Q([At()],$.prototype,"quadraticCurveTo",null),Q([At()],$.prototype,"closePath",null),Q([At()],$.prototype,"arc",null),Q([At()],$.prototype,"arcTo",null),Q([At()],$.prototype,"ellipse",null),Q([At()],$.prototype,"rect",null),Q([At()],$.prototype,"roundRect",null),Q([At()],$.prototype,"createConicGradient",null),Q([At()],$.prototype,"createLinearGradient",null),Q([At()],$.prototype,"createPattern",null),Q([At()],$.prototype,"createRadialGradient",null),Q([At()],$.prototype,"fillText",null),Q([At()],$.prototype,"measureText",null),Q([At()],$.prototype,"strokeText",null);var{copy:sB,multiplyParent:oB,pixelScale:aB}=rt,{round:il}=Math,kt=new It,Rm=new It,hB={width:1,height:1,pixelRatio:1},sn=["width","height","pixelRatio"],Ms=class extends ${get width(){return this.size.width}get height(){return this.size.height}get pixelRatio(){return this.size.pixelRatio}get pixelWidth(){return this.width*this.pixelRatio||0}get pixelHeight(){return this.height*this.pixelRatio||0}get pixelSnap(){return this.config.pixelSnap}set pixelSnap(t){this.config.pixelSnap=t}get allowBackgroundColor(){return this.view&&this.parentView}constructor(t,n){super(),this.size={},this.worldTransform={},t||(t=hB),this.manager=n,this.innerId=ki.create(ki.CNAVAS);let{width:i,height:s,pixelRatio:a}=t;this.autoLayout=!i||!s,this.size.pixelRatio=a||N.devicePixelRatio,this.config=t,this.init()}init(){}__createContext(){let{view:t}=this,{contextSettings:n}=this.config;this.context=n?t.getContext("2d",n):t.getContext("2d"),this.__bindContext()}export(t,n){}toBlob(t,n){}toDataURL(t,n){}saveAs(t,n){}resize(t,n=!0){if(this.isSameSize(t))return;let i;this.context&&!this.unreal&&n&&this.width&&(i=this.getSameCanvas(),i.copyWorld(this));let s=this.size;vt.copyAttrs(s,t,sn),sn.forEach(a=>s[a]||(s[a]=1)),this.bounds=new It(0,0,this.width,this.height),this.updateViewSize(),this.updateClientBounds(),this.context&&(this.smooth=this.config.smooth,!this.unreal&&i&&(this.clearWorld(i.bounds),this.copyWorld(i),i.recycle()))}updateViewSize(){}updateClientBounds(){}getClientBounds(t){return t&&this.updateClientBounds(),this.clientBounds||this.bounds}startAutoLayout(t,n){}stopAutoLayout(){}setCursor(t){}setWorld(t,n){let{pixelRatio:i,pixelSnap:s}=this,a=this.worldTransform;n&&oB(t,n,a),aB(t,i,a),s&&!t.ignorePixelSnap&&(t.half&&t.half*i%2?(a.e=il(a.e-.5)+.5,a.f=il(a.f-.5)+.5):(a.e=il(a.e),a.f=il(a.f))),this.setTransform(a.a,a.b,a.c,a.d,a.e,a.f)}useWorldTransform(t){t&&(this.worldTransform=t);let n=this.worldTransform;n&&this.setTransform(n.a,n.b,n.c,n.d,n.e,n.f)}setStroke(t,n,i,s){n&&(this.strokeWidth=n),t&&(this.strokeStyle=t),i&&this.setStrokeOptions(i,s)}setStrokeOptions(t,n){let{strokeCap:i,strokeJoin:s,dashPattern:a,dashOffset:h,miterLimit:l}=t;n&&(n.strokeCap&&(i=n.strokeCap),n.strokeJoin&&(s=n.strokeJoin),J(n.dashPattern)||(a=n.dashPattern),J(n.dashOffset)||(h=n.dashOffset),n.miterLimit&&(l=n.miterLimit)),this.strokeCap=i,this.strokeJoin=s,this.dashPattern=a,this.dashOffset=h,this.miterLimit=l}saveBlendMode(t){this.savedBlendMode=this.blendMode,this.blendMode=t}restoreBlendMode(){this.blendMode=this.savedBlendMode}hitFill(t,n){return!0}hitStroke(t,n){return!0}hitPixel(t,n,i=1){return!0}setWorldShadow(t,n,i,s){let{pixelRatio:a}=this;this.shadowOffsetX=t*a,this.shadowOffsetY=n*a,this.shadowBlur=i*a,this.shadowColor=s||"black"}setWorldBlur(t){let{pixelRatio:n}=this;this.filter=`blur(${t*n}px)`}copyWorld(t,n,i,s,a){s&&(this.blendMode=s),n?(this.setTempPixelBounds(n,a),i?(this.setTempPixelBounds2(i,a),i=Rm):i=kt,this.drawImage(t.view,kt.x,kt.y,kt.width,kt.height,i.x,i.y,i.width,i.height)):this.drawImage(t.view,0,0),s&&(this.blendMode="source-over")}copyWorldToInner(t,n,i,s,a){n.b||n.c?(this.save(),this.resetTransform(),this.copyWorld(t,n,X.tempToOuterOf(i,n),s,a),this.restore()):(s&&(this.blendMode=s),this.setTempPixelBounds(n,a),this.drawImage(t.view,kt.x,kt.y,kt.width,kt.height,i.x,i.y,i.width,i.height),s&&(this.blendMode="source-over"))}copyWorldByReset(t,n,i,s,a,h){this.resetTransform(),this.copyWorld(t,n,i,s,h),a||this.useWorldTransform()}useGrayscaleAlpha(t){let n,i;this.setTempPixelBounds(t,!0,!0);let{context:s}=this,a=s.getImageData(kt.x,kt.y,kt.width,kt.height),{data:h}=a;for(let l=0,u=h.length;l<u;l+=4)i=.299*h[l]+.587*h[l+1]+.114*h[l+2],(n=h[l+3])&&(h[l+3]=n===255?i:n*(i/255));s.putImageData(a,kt.x,kt.y)}useMask(t,n,i){this.copyWorld(t,n,i,"destination-in")}useEraser(t,n,i){this.copyWorld(t,n,i,"destination-out")}fillWorld(t,n,i,s){i&&(this.blendMode=i),this.fillStyle=n,this.setTempPixelBounds(t,s),this.fillRect(kt.x,kt.y,kt.width,kt.height),i&&(this.blendMode="source-over")}strokeWorld(t,n,i,s){i&&(this.blendMode=i),this.strokeStyle=n,this.setTempPixelBounds(t,s),this.strokeRect(kt.x,kt.y,kt.width,kt.height),i&&(this.blendMode="source-over")}clipWorld(t,n=!0){this.beginPath(),this.setTempPixelBounds(t,n),this.rect(kt.x,kt.y,kt.width,kt.height),this.clip()}clipUI(t){t.windingRule?this.clip(t.windingRule):this.clip()}clearWorld(t,n=!0){this.setTempPixelBounds(t,n),this.clearRect(kt.x,kt.y,kt.width,kt.height)}clear(){let{pixelRatio:t}=this;this.clearRect(0,0,this.width*t+2,this.height*t+2)}setTempPixelBounds(t,n,i){this.copyToPixelBounds(kt,t,n,i)}setTempPixelBounds2(t,n,i){this.copyToPixelBounds(Rm,t,n,i)}copyToPixelBounds(t,n,i,s){t.set(n),s&&t.intersect(this.bounds),t.scale(this.pixelRatio),i&&t.ceil()}isSameSize(t){return this.width===t.width&&this.height===t.height&&(!t.pixelRatio||this.pixelRatio===t.pixelRatio)}getSameCanvas(t,n){let{size:i,pixelSnap:s}=this,a=this.manager?this.manager.get(i):$t.canvas(Object.assign({},i));return a.save(),t&&(sB(a.worldTransform,this.worldTransform),a.useWorldTransform()),n&&(a.smooth=this.smooth),a.pixelSnap!==s&&(a.pixelSnap=s),a}recycle(t){this.recycled||(this.restore(),t?this.clearWorld(t):this.clear(),this.manager?this.manager.recycle(this):this.destroy())}updateRender(t){}unrealCanvas(){}destroy(){this.manager=this.view=this.parentView=null}},di={creator:{},parse(e,t){},convertToCanvasData(e,t){}},By={N:21,D:22,X:23,G:24,F:25,O:26,P:27,U:28},wn=Object.assign({M:1,m:10,L:2,l:20,H:3,h:30,V:4,v:40,C:5,c:50,S:6,s:60,Q:7,q:70,T:8,t:80,A:9,a:90,Z:11,z:11,R:12},By),Ry={M:3,m:3,L:3,l:3,H:2,h:2,V:2,v:2,C:7,c:7,S:5,s:5,Q:5,q:5,T:3,t:3,A:8,a:8,Z:1,z:1,N:5,D:9,X:6,G:9,F:5,O:7,P:4,U:6},Oy={m:10,l:20,H:3,h:30,V:4,v:40,c:50,S:6,s:60,q:70,T:8,t:80,A:9,a:90},lB=Object.assign(Object.assign({},Oy),By),_l=wn,Ay={};for(let e in _l)Ay[_l[e]]=e;var Zd={};for(let e in _l)Zd[_l[e]]=Ry[e];var ky={drawRoundRect(e,t,n,i,s,a){let h=Kt.fourNumber(a,Math.min(i/2,s/2)),l=t+i,u=n+s;h[0]?e.moveTo(t+h[0],n):e.moveTo(t,n),h[1]?e.arcTo(l,n,l,u,h[1]):e.lineTo(l,n),h[2]?e.arcTo(l,u,t,u,h[2]):e.lineTo(l,u),h[3]?e.arcTo(t,u,t,n,h[3]):e.lineTo(t,u),h[0]?e.arcTo(t,n,l,n,h[0]):e.lineTo(t,n)}},{sin:Cs,cos:Wo,hypot:Om,atan2:Am,ceil:cB,abs:km,PI:Mm,sqrt:Dm,pow:rl}=Math,{setPoint:fd,addPoint:sl}=xl,{set:ol,toNumberPoints:uB}=j,{M:Im,L:pd,C:gd,Q:zm,Z:dB}=wn,_d={},Ir={points(e,t,n,i){let s=uB(t);if(e.push(Im,s[0],s[1]),n&&s.length>5){let a,h,l,u,f,g,p,v,w,E,P,S,R,A,I,W=s.length,F=n===!0?.5:n;i&&(s=[s[W-2],s[W-1],...s,s[0],s[1],s[2],s[3]],W=s.length);for(let H=2;H<W-2;H+=2)a=s[H-2],h=s[H-1],l=s[H],u=s[H+1],f=s[H+2],g=s[H+3],P=l-a,S=u-h,R=Dm(rl(P,2)+rl(S,2)),A=Dm(rl(f-l,2)+rl(g-u,2)),(R||A)&&(I=R+A,R=F*R/I,A=F*A/I,f-=a,g-=h,p=l-R*f,v=u-R*g,H===2?i||e.push(zm,p,v,l,u):(P||S)&&e.push(gd,w,E,p,v,l,u),w=l+A*f,E=u+A*g);i||e.push(zm,w,E,s[W-2],s[W-1])}else for(let a=2,h=s.length;a<h;a+=2)e.push(pd,s[a],s[a+1]);i&&e.push(dB)},rect(e,t,n,i,s){di.creator.path=e,di.creator.moveTo(t,n).lineTo(t+i,n).lineTo(t+i,n+s).lineTo(t,n+s).lineTo(t,n)},roundRect(e,t,n,i,s,a){di.creator.path=[],ky.drawRoundRect(di.creator,t,n,i,s,a),e.push(...di.convertToCanvasData(di.creator.path,!0))},arcTo(e,t,n,i,s,a,h,l,u,f,g){let p=i-t,v=s-n,w=a-i,E=h-s,P=Am(v,p),S=Am(E,w),R=Om(p,v),A=Om(w,E),I=S-P;if(I<0&&(I+=jn),R<1e-12||A<1e-12||I<1e-12||km(I-Mm)<1e-12)return e&&e.push(pd,i,s),u&&(fd(u,t,n),sl(u,i,s)),g&&ol(g,t,n),void(f&&ol(f,i,s));let W=p*E-w*v<0,F=W?-1:1,H=l/Wo(I/2),V=i+H*Wo(P+I/2+Os*F),K=s+H*Cs(P+I/2+Os*F);return P-=Os*F,S-=Os*F,Nm(e,V,K,l,l,0,P/Yt,S/Yt,W,u,f,g)},arc:(e,t,n,i,s,a,h,l,u,f)=>Nm(e,t,n,i,i,0,s,a,h,l,u,f),ellipse(e,t,n,i,s,a,h,l,u,f,g,p){let v=a*Yt,w=Cs(v),E=Wo(v),P=h*Yt,S=l*Yt;P>Mm&&(P-=jn),S<0&&(S+=jn);let R=S-P;R<0?R+=jn:R>jn&&(R-=jn),u&&(R-=jn);let A=cB(km(R/Os)),I=R/A,W=Cs(I/4),F=8/3*W*W/Cs(I/2);S=P+I;let H,V,K,ct,ft,it,Y,ot,Wt=Wo(P),xt=Cs(P),Te=K=E*i*Wt-w*s*xt,Ye=ct=w*i*Wt+E*s*xt,ke=t+K,Hi=n+ct;e&&e.push(e.length?pd:Im,ke,Hi),f&&fd(f,ke,Hi),p&&ol(p,ke,Hi);for(let Cn=0;Cn<A;Cn++)H=Wo(S),V=Cs(S),K=E*i*H-w*s*V,ct=w*i*H+E*s*V,ft=t+Te-F*(E*i*xt+w*s*Wt),it=n+Ye-F*(w*i*xt-E*s*Wt),Y=t+K+F*(E*i*V+w*s*H),ot=n+ct+F*(w*i*V-E*s*H),e&&e.push(gd,ft,it,Y,ot,t+K,n+ct),f&&Fm(t+Te,n+Ye,ft,it,Y,ot,t+K,n+ct,f,!0),Te=K,Ye=ct,Wt=H,xt=V,P=S,S+=I;g&&ol(g,t+K,n+ct)},quadraticCurveTo(e,t,n,i,s,a,h){e.push(gd,(t+2*i)/3,(n+2*s)/3,(a+2*i)/3,(h+2*s)/3,a,h)},toTwoPointBoundsByQuadraticCurve(e,t,n,i,s,a,h,l){Fm(e,t,(e+2*n)/3,(t+2*i)/3,(s+2*n)/3,(a+2*i)/3,s,a,h,l)},toTwoPointBounds(e,t,n,i,s,a,h,l,u,f){let g=[],p,v,w,E,P,S,R,A,I=e,W=n,F=s,H=h;for(let V=0;V<2;++V)if(V==1&&(I=t,W=i,F=a,H=l),p=-3*I+9*W-9*F+3*H,v=6*I-12*W+6*F,w=3*W-3*I,Math.abs(p)<1e-12){if(Math.abs(v)<1e-12)continue;E=-w/v,0<E&&E<1&&g.push(E)}else R=v*v-4*w*p,A=Math.sqrt(R),R<0||(P=(-v+A)/(2*p),0<P&&P<1&&g.push(P),S=(-v-A)/(2*p),0<S&&S<1&&g.push(S));f?sl(u,e,t):fd(u,e,t),sl(u,h,l);for(let V=0,K=g.length;V<K;V++)Wm(g[V],e,t,n,i,s,a,h,l,_d),sl(u,_d.x,_d.y)},getPointAndSet(e,t,n,i,s,a,h,l,u,f){let g=1-e,p=g*g*g,v=3*g*g*e,w=3*g*e*e,E=e*e*e;f.x=p*t+v*i+w*a+E*l,f.y=p*n+v*s+w*h+E*u},getPoint(e,t,n,i,s,a,h,l,u){let f={};return Wm(e,t,n,i,s,a,h,l,u,f),f},getDerivative(e,t,n,i,s){let a=1-e;return 3*a*a*(n-t)+6*a*e*(i-n)+3*e*e*(s-i)}},{getPointAndSet:Wm,toTwoPointBounds:Fm,ellipse:Nm}=Ir,{sin:fB,cos:pB,sqrt:Hm,atan2:Um}=Math,{ellipse:gB}=Ir,_B={ellipticalArc(e,t,n,i,s,a,h,l,u,f,g){let p=(u-t)/2,v=(f-n)/2,w=a*Yt,E=fB(w),P=pB(w),S=-P*p-E*v,R=-P*v+E*p,A=i*i,I=s*s,W=R*R,F=S*S,H=A*I-A*W-I*F,V=0;if(H<0){let Te=Hm(1-H/(A*I));i*=Te,s*=Te}else V=(h===l?-1:1)*Hm(H/(A*W+I*F));let K=V*i*R/s,ct=-V*s*S/i,ft=Um((R-ct)/s,(S-K)/i),it=Um((-R-ct)/s,(-S-K)/i),Y=it-ft;l===0&&Y>0?Y-=jn:l===1&&Y<0&&(Y+=jn);let ot=t+p+P*K-E*ct,Wt=n+v+E*K+P*ct,xt=Y<0?1:0;g||N.ellipseToCurve?gB(e,ot,Wt,i,s,a,ft/Yt,it/Yt,xt):i!==s||a?e.push(wn.G,ot,Wt,i,s,a,ft/Yt,it/Yt,xt):e.push(wn.O,ot,Wt,i,ft/Yt,it/Yt,xt)}},mB={toCommand:e=>[],toNode:e=>[]},{M:md,m:yB,L:Fo,l:vB,H:wB,h:xB,V:bB,v:EB,C:Ts,c:SB,S:yd,s:CB,Q:Ls,q:TB,T:vd,t:LB,A:PB,a:BB,Z:wd,z:RB,N:OB,D:AB,X:kB,G:MB,F:DB,O:IB,P:zB,U:WB}=wn,{rect:FB,roundRect:Ym,arcTo:NB,arc:Vm,ellipse:Xm,quadraticCurveTo:Gm}=Ir,{ellipticalArc:HB}=_B,UB=Pt.get("PathConvert"),Oi={},rr={current:{dot:0},stringify(e,t){let n,i,s,a=0,h=e.length,l="";for(;a<h;){i=e[a],n=Zd[i],l+=i===s?" ":Ay[i];for(let u=1;u<n;u++)l+=Kt.float(e[a+u],t),u===n-1||(l+=" ");s=i,a+=n}return l},parse(e,t){let n,i,s,a="",h=[],l=t?lB:Oy;for(let u=0,f=e.length;u<f;u++)i=e[u],eB[i]?(i==="."&&(In.dot&&(Dr(h,a),a=""),In.dot++),a==="0"&&i!=="."&&(Dr(h,a),a=""),a+=i):wn[i]?(a&&(Dr(h,a),a=""),In.name=wn[i],In.length=Ry[i],In.index=0,Dr(h,In.name),!n&&l[i]&&(n=!0)):i==="-"||i==="+"?s==="e"||s==="E"?a+=i:(a&&Dr(h,a),a=i):a&&(Dr(h,a),a=""),s=i;return a&&Dr(h,a),n?rr.toCanvasData(h,t):h},toCanvasData(e,t){let n,i,s,a,h,l=0,u=0,f=0,g=0,p=0,v=e.length,w=[];for(;p<v;){switch(s=e[p],s){case yB:e[p+1]+=l,e[p+2]+=u;case md:l=e[p+1],u=e[p+2],w.push(md,l,u),p+=3;break;case xB:e[p+1]+=l;case wB:l=e[p+1],w.push(Fo,l,u),p+=2;break;case EB:e[p+1]+=u;case bB:u=e[p+1],w.push(Fo,l,u),p+=2;break;case vB:e[p+1]+=l,e[p+2]+=u;case Fo:l=e[p+1],u=e[p+2],w.push(Fo,l,u),p+=3;break;case CB:e[p+1]+=l,e[p+2]+=u,e[p+3]+=l,e[p+4]+=u,s=yd;case yd:h=a===Ts||a===yd,f=h?2*l-n:e[p+1],g=h?2*u-i:e[p+2],n=e[p+1],i=e[p+2],l=e[p+3],u=e[p+4],w.push(Ts,f,g,n,i,l,u),p+=5;break;case SB:e[p+1]+=l,e[p+2]+=u,e[p+3]+=l,e[p+4]+=u,e[p+5]+=l,e[p+6]+=u,s=Ts;case Ts:n=e[p+3],i=e[p+4],l=e[p+5],u=e[p+6],w.push(Ts,e[p+1],e[p+2],n,i,l,u),p+=7;break;case LB:e[p+1]+=l,e[p+2]+=u,s=vd;case vd:h=a===Ls||a===vd,n=h?2*l-n:e[p+1],i=h?2*u-i:e[p+2],t?Gm(w,l,u,n,i,e[p+1],e[p+2]):w.push(Ls,n,i,e[p+1],e[p+2]),l=e[p+1],u=e[p+2],p+=3;break;case TB:e[p+1]+=l,e[p+2]+=u,e[p+3]+=l,e[p+4]+=u,s=Ls;case Ls:n=e[p+1],i=e[p+2],t?Gm(w,l,u,n,i,e[p+3],e[p+4]):w.push(Ls,n,i,e[p+3],e[p+4]),l=e[p+3],u=e[p+4],p+=5;break;case BB:e[p+6]+=l,e[p+7]+=u;case PB:HB(w,l,u,e[p+1],e[p+2],e[p+3],e[p+4],e[p+5],e[p+6],e[p+7],t),l=e[p+6],u=e[p+7],p+=8;break;case RB:case wd:w.push(wd),p++;break;case OB:l=e[p+1],u=e[p+2],t?FB(w,l,u,e[p+3],e[p+4]):Qi(w,e,p,5),p+=5;break;case AB:l=e[p+1],u=e[p+2],t?Ym(w,l,u,e[p+3],e[p+4],[e[p+5],e[p+6],e[p+7],e[p+8]]):Qi(w,e,p,9),p+=9;break;case kB:l=e[p+1],u=e[p+2],t?Ym(w,l,u,e[p+3],e[p+4],e[p+5]):Qi(w,e,p,6),p+=6;break;case MB:Xm(t?w:Qi(w,e,p,9),e[p+1],e[p+2],e[p+3],e[p+4],e[p+5],e[p+6],e[p+7],e[p+8],null,Oi),l=Oi.x,u=Oi.y,p+=9;break;case DB:t?Xm(w,e[p+1],e[p+2],e[p+3],e[p+4],0,0,360,!1):Qi(w,e,p,5),l=e[p+1]+e[p+3],u=e[p+2],p+=5;break;case IB:Vm(t?w:Qi(w,e,p,7),e[p+1],e[p+2],e[p+3],e[p+4],e[p+5],e[p+6],null,Oi),l=Oi.x,u=Oi.y,p+=7;break;case zB:t?Vm(w,e[p+1],e[p+2],e[p+3],0,360,!1):Qi(w,e,p,4),l=e[p+1]+e[p+3],u=e[p+2],p+=4;break;case WB:NB(t?w:Qi(w,e,p,6),l,u,e[p+1],e[p+2],e[p+3],e[p+4],e[p+5],null,Oi),l=Oi.x,u=Oi.y,p+=6;break;default:return UB.error(`command: ${s} [index:${p}]`,e),w}a=s}return w},objectToCanvasData(e){if(e[0].name.length>1)return mB.toCommand(e);{let t=[];return e.forEach(n=>{switch(n.name){case"M":t.push(md,n.x,n.y);break;case"L":t.push(Fo,n.x,n.y);break;case"C":t.push(Ts,n.x1,n.y1,n.x2,n.y2,n.x,n.y);break;case"Q":t.push(Ls,n.x1,n.y1,n.x,n.y);break;case"Z":t.push(wd)}}),t}},copyData(e,t,n,i){for(let s=n,a=n+i;s<a;s++)e.push(t[s])},pushData(e,t){In.index===In.length&&(In.index=1,e.push(In.name)),e.push(Number(t)),In.index++,In.dot=0}},{current:In,pushData:Dr,copyData:Qi}=rr,{M:xd,L:YB,C:VB,Q:XB,Z:GB,N:Km,D:KB,X:qB,G:jB,F:ZB,O:$B,P:JB,U:QB}=wn,{getMinDistanceFrom:tR,getRadianFrom:eR}=j,{tan:nR,min:qm,abs:iR}=Math,Ps={},or={beginPath(e){e.length=0},moveTo(e,t,n){e.push(xd,t,n)},lineTo(e,t,n){e.push(YB,t,n)},bezierCurveTo(e,t,n,i,s,a,h){e.push(VB,t,n,i,s,a,h)},quadraticCurveTo(e,t,n,i,s){e.push(XB,t,n,i,s)},closePath(e){e.push(GB)},rect(e,t,n,i,s){e.push(Km,t,n,i,s)},roundRect(e,t,n,i,s,a){if(Dt(a))e.push(qB,t,n,i,s,a);else{let h=Kt.fourNumber(a);h?e.push(KB,t,n,i,s,...h):e.push(Km,t,n,i,s)}},ellipse(e,t,n,i,s,a,h,l,u){if(i===s)return jm(e,t,n,i,h,l,u);Be(a)?e.push(ZB,t,n,i,s):(Be(h)&&(h=0),Be(l)&&(l=360),e.push(jB,t,n,i,s,a,h,l,u?1:0))},arc(e,t,n,i,s,a,h){Be(s)?e.push(JB,t,n,i):(Be(s)&&(s=0),Be(a)&&(a=360),e.push($B,t,n,i,s,a,h?1:0))},arcTo(e,t,n,i,s,a,h,l){if(!J(h)){let u=tR(h,l,t,n,i,s);a=qm(a,qm(u/2,u/2*iR(nR(eR(h,l,t,n,i,s)/2))))}e.push(QB,t,n,i,s,a)},drawEllipse(e,t,n,i,s,a,h,l,u){Ir.ellipse(null,t,n,i,s,Be(a)?0:a,Be(h)?0:h,Be(l)?360:l,u,null,null,Ps),e.push(xd,Ps.x,Ps.y),rR(e,t,n,i,s,a,h,l,u)},drawArc(e,t,n,i,s,a,h){Ir.arc(null,t,n,i,Be(s)?0:s,Be(a)?360:a,h,null,null,Ps),e.push(xd,Ps.x,Ps.y),jm(e,t,n,i,s,a,h)},drawPoints(e,t,n,i){Ir.points(e,t,n,i)}},{ellipse:rR,arc:jm}=or,{moveTo:sR,lineTo:oR,quadraticCurveTo:aR,bezierCurveTo:hR,closePath:lR,beginPath:cR,rect:uR,roundRect:dR,ellipse:fR,arc:pR,arcTo:gR,drawEllipse:_R,drawArc:mR,drawPoints:yR}=or,Go=class{set path(t){this.__path=t}get path(){return this.__path}constructor(t){this.set(t)}set(t){return this.__path=t?gt(t)?di.parse(t):t:[],this}beginPath(){return cR(this.__path),this.paint(),this}moveTo(t,n){return sR(this.__path,t,n),this.paint(),this}lineTo(t,n){return oR(this.__path,t,n),this.paint(),this}bezierCurveTo(t,n,i,s,a,h){return hR(this.__path,t,n,i,s,a,h),this.paint(),this}quadraticCurveTo(t,n,i,s){return aR(this.__path,t,n,i,s),this.paint(),this}closePath(){return lR(this.__path),this.paint(),this}rect(t,n,i,s){return uR(this.__path,t,n,i,s),this.paint(),this}roundRect(t,n,i,s,a){return dR(this.__path,t,n,i,s,a),this.paint(),this}ellipse(t,n,i,s,a,h,l,u){return fR(this.__path,t,n,i,s,a,h,l,u),this.paint(),this}arc(t,n,i,s,a,h){return pR(this.__path,t,n,i,s,a,h),this.paint(),this}arcTo(t,n,i,s,a){return gR(this.__path,t,n,i,s,a),this.paint(),this}drawEllipse(t,n,i,s,a,h,l,u){return _R(this.__path,t,n,i,s,a,h,l,u),this.paint(),this}drawArc(t,n,i,s,a,h){return mR(this.__path,t,n,i,s,a,h),this.paint(),this}drawPoints(t,n,i){return yR(this.__path,t,n,i),this.paint(),this}clearPath(){return this.beginPath()}paint(){}},{M:vR,L:wR,C:xR,Q:bR,Z:ER,N:SR,D:CR,X:TR,G:LR,F:PR,O:BR,P:RR,U:OR}=wn,AR=Pt.get("PathDrawer"),My={drawPathByData(e,t){if(!t)return;let n,i=0,s=t.length;for(;i<s;)switch(n=t[i],n){case vR:e.moveTo(t[i+1],t[i+2]),i+=3;break;case wR:e.lineTo(t[i+1],t[i+2]),i+=3;break;case xR:e.bezierCurveTo(t[i+1],t[i+2],t[i+3],t[i+4],t[i+5],t[i+6]),i+=7;break;case bR:e.quadraticCurveTo(t[i+1],t[i+2],t[i+3],t[i+4]),i+=5;break;case ER:e.closePath(),i+=1;break;case SR:e.rect(t[i+1],t[i+2],t[i+3],t[i+4]),i+=5;break;case CR:e.roundRect(t[i+1],t[i+2],t[i+3],t[i+4],[t[i+5],t[i+6],t[i+7],t[i+8]]),i+=9;break;case TR:e.roundRect(t[i+1],t[i+2],t[i+3],t[i+4],t[i+5]),i+=6;break;case LR:e.ellipse(t[i+1],t[i+2],t[i+3],t[i+4],t[i+5]*Yt,t[i+6]*Yt,t[i+7]*Yt,t[i+8]),i+=9;break;case PR:e.ellipse(t[i+1],t[i+2],t[i+3],t[i+4],0,0,jn,!1),i+=5;break;case BR:e.arc(t[i+1],t[i+2],t[i+3],t[i+4]*Yt,t[i+5]*Yt,t[i+6]),i+=7;break;case RR:e.arc(t[i+1],t[i+2],t[i+3],0,jn,!1),i+=4;break;case OR:e.arcTo(t[i+1],t[i+2],t[i+3],t[i+4],t[i+5]),i+=6;break;default:return void AR.error(`command: ${n} [index:${i}]`,t)}}},{M:kR,L:MR,C:Zm,Q:$m,Z:Jm,N:DR,D:Qm,X:IR,G:zR,F:WR,O:FR,P:NR,U:HR}=wn,{toTwoPointBounds:UR,toTwoPointBoundsByQuadraticCurve:YR,arcTo:VR,arc:XR,ellipse:GR}=Ir,{addPointBounds:No,copy:bd,addPoint:KR,setPoint:Ed,addBounds:al,toBounds:qR}=xl,jR=Pt.get("PathBounds"),Bs,hl,Sd,yn={},ty={},Ai={},Dy={toBounds(e,t){Dy.toTwoPointBounds(e,ty),qR(ty,t)},toTwoPointBounds(e,t){if(!e||!e.length)return Ed(t,0,0);let n,i,s,a,h,l=0,u=0,f=0,g=e.length;for(;l<g;)switch(h=e[l],l===0&&(h===Jm||h===Zm||h===$m?Ed(t,u,f):Ed(t,e[l+1],e[l+2])),h){case kR:case MR:u=e[l+1],f=e[l+2],KR(t,u,f),l+=3;break;case Zm:s=e[l+5],a=e[l+6],UR(u,f,e[l+1],e[l+2],e[l+3],e[l+4],s,a,yn),No(t,yn),u=s,f=a,l+=7;break;case $m:n=e[l+1],i=e[l+2],s=e[l+3],a=e[l+4],YR(u,f,n,i,s,a,yn),No(t,yn),u=s,f=a,l+=5;break;case Jm:l+=1;break;case DR:u=e[l+1],f=e[l+2],al(t,u,f,e[l+3],e[l+4]),l+=5;break;case Qm:case IR:u=e[l+1],f=e[l+2],al(t,u,f,e[l+3],e[l+4]),l+=h===Qm?9:6;break;case zR:GR(null,e[l+1],e[l+2],e[l+3],e[l+4],e[l+5],e[l+6],e[l+7],e[l+8],yn,Ai),l===0?bd(t,yn):No(t,yn),u=Ai.x,f=Ai.y,l+=9;break;case WR:u=e[l+1],f=e[l+2],hl=e[l+3],Sd=e[l+4],al(t,u-hl,f-Sd,2*hl,2*Sd),u+=hl,l+=5;break;case FR:XR(null,e[l+1],e[l+2],e[l+3],e[l+4],e[l+5],e[l+6],yn,Ai),l===0?bd(t,yn):No(t,yn),u=Ai.x,f=Ai.y,l+=7;break;case NR:u=e[l+1],f=e[l+2],Bs=e[l+3],al(t,u-Bs,f-Bs,2*Bs,2*Bs),u+=Bs,l+=4;break;case HR:VR(null,u,f,e[l+1],e[l+2],e[l+3],e[l+4],e[l+5],yn,Ai),l===0?bd(t,yn):No(t,yn),u=Ai.x,f=Ai.y,l+=6;break;default:return void jR.error(`command: ${h} [index:${l}]`,e)}}},{M:Cd,L:ll,Z:Ho}=wn,{getCenterX:ZR,getCenterY:$R}=j,{arcTo:Td}=or,Iy={smooth(e,t,n){let i,s,a,h=0,l=0,u=0,f=0,g=0,p=0,v=0,w=0,E=0;Ct(t)&&(t=t[0]||0);let P=e.length,S=[];for(;h<P;){switch(i=e[h],i){case Cd:f=w=e[h+1],g=E=e[h+2],h+=3,e[h]===ll?(p=e[h+1],v=e[h+2],S.push(Cd,ZR(f,p),$R(g,v))):S.push(Cd,f,g);break;case ll:switch(l=e[h+1],u=e[h+2],h+=3,e[h]){case ll:Td(S,l,u,e[h+1],e[h+2],t,w,E);break;case Ho:Td(S,l,u,f,g,t,w,E);break;default:S.push(ll,l,u)}w=l,E=u;break;case Ho:s!==Ho&&(Td(S,f,g,p,v,t,w,E),S.push(Ho)),h+=1;break;default:a=Zd[i];for(let R=0;R<a;R++)S.push(e[h+R]);h+=a}s=i}return i!==Ho&&(S[1]=f,S[2]=g),S}};function zy(e){return new Go(e)}var zs=zy();di.creator=zy(),di.parse=rr.parse,di.convertToCanvasData=rr.toCanvasData;var{drawRoundRect:JR}=ky;function $d(e){(function(t){t&&!t.roundRect&&(t.roundRect=function(n,i,s,a,h){JR(this,n,i,s,a,h)})})(e)}var As={alphaPixelTypes:["png","webp","svg"],upperCaseTypeMap:{},mineType:e=>!e||e.startsWith("image")?e:(e==="jpg"&&(e="jpeg"),"image/"+e),fileType(e){let t=e.split(".");return t[t.length-1]},isOpaqueImage(e){let t=Wd.fileType(e);return["jpg","jpeg"].some(n=>n===t)},getExportOptions(e){switch(typeof e){case"object":return e;case"number":return{quality:e};case"boolean":return{blob:e};default:return{}}}},Wd=As;Wd.alphaPixelTypes.forEach(e=>Wd.upperCaseTypeMap[e]=e.toUpperCase());var QR=Pt.get("TaskProcessor"),Fd=class{constructor(t){this.parallel=!0,this.time=1,this.id=ki.create(ki.TASK),this.task=t}run(){return Ly(this,void 0,void 0,function*(){try{if(this.isComplete)return;if(this.canUse&&!this.canUse())return this.cancel();this.task&&this.parent.running&&(yield this.task())}catch(t){QR.error(t)}})}complete(){this.isComplete=!0,this.parent=this.task=this.canUse=null}cancel(){this.isCancel=!0,this.complete()}},ml=class{get total(){return this.list.length+this.delayNumber}get finishedIndex(){return this.isComplete?0:this.index+this.parallelSuccessNumber}get remain(){return this.isComplete?this.total:this.total-this.finishedIndex}get percent(){let{total:t}=this,n=0,i=0;for(let s=0;s<t;s++)s<=this.finishedIndex?(i+=this.list[s].time,s===this.finishedIndex&&(n=i)):n+=this.list[s].time;return this.isComplete?1:i/n}constructor(t){this.config={parallel:6},this.list=[],this.running=!1,this.isComplete=!0,this.index=0,this.delayNumber=0,t&&vt.assign(this.config,t),this.empty()}add(t,n,i){let s,a,h,l,u=new Fd(t);return u.parent=this,Dt(n)?l=n:n&&(a=n.parallel,s=n.start,h=n.time,l=n.delay,i||(i=n.canUse)),h&&(u.time=h),a===!1&&(u.parallel=!1),i&&(u.canUse=i),J(l)?this.push(u,s):(this.delayNumber++,setTimeout(()=>{this.delayNumber&&(this.delayNumber--,this.push(u,s))},l)),this.isComplete=!1,u}push(t,n){this.list.push(t),n===!1||this.timer||(this.timer=setTimeout(()=>this.start()))}empty(){this.index=0,this.parallelSuccessNumber=0,this.list=[],this.parallelList=[],this.delayNumber=0}start(){this.running||(this.running=!0,this.isComplete=!1,this.run())}pause(){clearTimeout(this.timer),this.timer=null,this.running=!1}resume(){this.start()}skip(){this.index++,this.resume()}stop(){this.isComplete=!0,this.list.forEach(t=>{t.isComplete||t.cancel()}),this.pause(),this.empty()}run(){this.running&&(this.setParallelList(),this.parallelList.length>1?this.runParallelTasks():this.remain?this.runTask():this.onComplete())}runTask(){let t=this.list[this.index];t?t.run().then(()=>{this.onTask(t),this.index++,t.isCancel?this.runTask():this.nextTask()}).catch(n=>{this.onError(n)}):this.timer=setTimeout(()=>this.nextTask())}runParallelTasks(){this.parallelList.forEach(t=>this.runParallelTask(t))}runParallelTask(t){t.run().then(()=>{this.onTask(t),this.fillParallelTask()}).catch(n=>{this.onParallelError(n)})}nextTask(){this.total===this.finishedIndex?this.onComplete():this.timer=setTimeout(()=>this.run())}setParallelList(){let t,{config:n,list:i,index:s}=this;this.parallelList=[],this.parallelSuccessNumber=0;let a=s+n.parallel;if(a>i.length&&(a=i.length),n.parallel>1)for(let h=s;h<a&&(t=i[h],t.parallel);h++)this.parallelList.push(t)}fillParallelTask(){let t,n=this.parallelList;this.parallelSuccessNumber++,n.pop();let i=n.length,s=this.finishedIndex+i;if(n.length){if(!this.running)return;s<this.total&&(t=this.list[s],t&&t.parallel&&(n.push(t),this.runParallelTask(t)))}else this.index+=this.parallelSuccessNumber,this.parallelSuccessNumber=0,this.nextTask()}onComplete(){this.stop(),this.config.onComplete&&this.config.onComplete()}onTask(t){t.complete(),this.config.onTask&&this.config.onTask()}onParallelError(t){this.parallelList.forEach(n=>{n.parallel=!1}),this.parallelList.length=0,this.parallelSuccessNumber=0,this.onError(t)}onError(t){this.pause(),this.config.onError&&this.config.onError(t)}destroy(){this.stop()}},tO=Pt.get("Resource"),nr={tasker:new ml,map:{},get isComplete(){return tr.tasker.isComplete},set(e,t){tr.map[e]&&tO.repeat(e),tr.map[e]=t},get:e=>tr.map[e],remove(e){let t=tr.map[e];t&&(t.destroy&&t.destroy(),delete tr.map[e])},loadImage(e,t){return new Promise((n,i)=>{let s=this.setImage(e,e,t);s.load(()=>n(s),a=>i(a))})},setImage(e,t,n){let i;return gt(t)?i={url:t}:t.url||(i={url:e,view:t}),i&&(n&&(i.format=n),t=$t.image(i)),tr.set(e,t),t},destroy(){tr.map={}}},tr=nr,on={maxRecycled:10,recycledList:[],patternTasker:new ml({parallel:1}),get(e){let t=nr.get(e.url);return t||nr.set(e.url,t=$t.image(e)),t.use++,t},recycle(e){e.use--,setTimeout(()=>{e.use||(N.image.isLarge(e)?e.url&&nr.remove(e.url):(e.clearLevels(),Uo.recycledList.push(e)))})},recyclePaint(e){Uo.recycle(e.image)},clearRecycled(e){let t=Uo.recycledList;(t.length>Uo.maxRecycled||e)&&(t.forEach(n=>(!n.use||e)&&n.url&&nr.remove(n.url)),t.length=0)},clearLevels(){},hasAlphaPixel:e=>As.alphaPixelTypes.some(t=>Uo.isFormat(t,e)),isFormat(e,t){if(t.format)return t.format===e;let{url:n}=t;if(n.startsWith("data:")){if(n.startsWith("data:"+As.mineType(e)))return!0}else if(n.includes("."+e)||n.includes("."+As.upperCaseTypeMap[e])||e==="png"&&!n.includes("."))return!0;return!1},destroy(){this.clearRecycled(!0)}},Uo=on,{IMAGE:eO,create:nO}=ki,Wr=class{get url(){return this.config.url}get crossOrigin(){let{crossOrigin:t}=this.config;return J(t)?N.image.crossOrigin:t}get completed(){return this.ready||!!this.error}constructor(t){if(this.use=0,this.waitComplete=[],this.innerId=nO(eO),this.config=t||(t={url:""}),t.view){let{view:n}=t;this.setView(n.config?n.view:n)}on.isFormat("svg",t)&&(this.isSVG=!0),on.hasAlphaPixel(t)&&(this.hasAlphaPixel=!0)}load(t,n,i){return this.loading||(this.loading=!0,nr.tasker.add(()=>Ly(this,void 0,void 0,function*(){return yield N.origin.loadImage(this.getLoadUrl(i),this.crossOrigin,this).then(s=>{i&&this.setThumbView(s),this.setView(s)}).catch(s=>{this.error=s,this.onComplete(!1)})}))),this.waitComplete.push(t,n),this.waitComplete.length-2}unload(t,n){let i=this.waitComplete;if(n){let s=i[t+1];s&&s({type:"stop"})}i[t]=i[t+1]=void 0}setView(t){this.ready=!0,this.width||(this.width=t.width,this.height=t.height,this.view=t),this.onComplete(!0)}onComplete(t){let n;this.waitComplete.forEach((i,s)=>{n=s%2,i&&(t?n||i(this):n&&i(this.error))}),this.waitComplete.length=0,this.loading=!1}getFull(t){return this.view}getCanvas(t,n,i,s,a,h,l){if(t||(t=this.width),n||(n=this.height),this.cache){let{params:f,data:g}=this.cache;for(let p in f)if(f[p]!==arguments[p]){g=null;break}if(g)return g}let u=N.image.resize(this.view,t,n,a,h,void 0,l,i,s);return this.cache=this.use>1?{data:u,params:arguments}:null,u}getPattern(t,n,i,s){let a=N.canvas.createPattern(t,n);return N.image.setPatternTransform(a,i,s),a}getLoadUrl(t){return this.url}setThumbView(t){}getThumbSize(t){}getMinLevel(){}getLevelData(t,n,i){}clearLevels(t){}destroy(){this.clearLevels();let{view:t}=this;t&&t.close&&t.close(),this.config={url:""},this.cache=this.view=null,this.waitComplete.length=0}};function En(e,t,n,i){i||(n.configurable=n.enumerable=!0),Object.defineProperty(e,t,n)}function bl(e,t){return Object.getOwnPropertyDescriptor(e,t)}function Wy(e,t){let n="_"+e;return{get(){let i=this[n];return i??t},set(i){this[n]=i}}}function te(e,t){return(n,i)=>iO(n,i,e,t&&t(i))}function iO(e,t,n,i){En(e,t,Object.assign({get(){return this.__getAttr(t)},set(a){this.__setAttr(t,a)}},i||{})),qy(e,t,n)}function Jt(e){return te(e)}function Zo(e,t){return te(e,n=>({set(i){this.__setAttr(n,i,t)&&(this.__layout.matrixChanged||this.__layout.matrixChange())}}))}function Jd(e,t){return te(e,n=>({set(i){this.__setAttr(n,i,t)&&(this.__layout.matrixChanged||this.__layout.matrixChange(),this.__scrollWorld||(this.__scrollWorld={}))}}))}function Qd(e){return te(e,t=>({set(n){this.__setAttr(t,n)&&(this.__hasAutoLayout=!!(this.origin||this.around||this.flow),this.__local||this.__layout.createLocal(),ar(this))}}))}function tf(e,t){return te(e,n=>({set(i){this.__setAttr(n,i,t)&&(this.__layout.scaleChanged||this.__layout.scaleChange())}}))}function El(e,t){return te(e,n=>({set(i){this.__setAttr(n,i,t)&&(this.__layout.rotationChanged||this.__layout.rotationChange())}}))}function Tt(e,t){return te(e,n=>({set(i){this.__setAttr(n,i,t)&&ar(this)}}))}function Fy(e){return te(e,t=>({set(n){this.__setAttr(t,n)&&(ar(this),this.__.__removeNaturalSize())}}))}function ar(e){e.__layout.boxChanged||e.__layout.boxChange(),e.__hasAutoLayout&&(e.__layout.matrixChanged||e.__layout.matrixChange())}function Ny(e){return te(e,t=>({set(n){let i=this.__;i.__pathInputed!==2&&(i.__pathInputed=n?1:0),n||(i.__pathForRender=void 0),this.__setAttr(t,n),ar(this)}}))}var He=Tt;function $o(e,t){return te(e,n=>({set(i){this.__setAttr(n,i)&&(rO(this),t&&(this.__.__useStroke=!0))}}))}function rO(e){e.__layout.strokeChanged||e.__layout.strokeChange(),e.__.__useArrow&&ar(e)}var $n=$o;function Sl(e){return te(e,t=>({set(n){this.__setAttr(t,n),this.__layout.renderChanged||this.__layout.renderChange()}}))}function Jn(e){return te(e,t=>({set(n){this.__setAttr(t,n)&&(this.__layout.surfaceChanged||this.__layout.surfaceChange())}}))}function ef(e){return te(e,t=>({set(n){if(this.__setAttr(t,n)){let i=this.__;vt.stintSet(i,"__useDim",i.dim||i.bright||i.dimskip),this.__layout.surfaceChange()}}}))}function Hy(e){return te(e,t=>({set(n){this.__setAttr(t,n)&&(this.__layout.opacityChanged||this.__layout.opacityChange()),this.mask&&Yy(this)}}))}function Uy(e){return te(e,t=>({set(n){let i=this.visible;if(i===!0&&n===0){if(this.animationOut)return this.__runAnimation("out",()=>ey(this,t,n,i))}else i===0&&n===!0&&this.animation&&this.__runAnimation("in");ey(this,t,n,i),this.mask&&Yy(this)}}))}function Yy(e){let{parent:t}=e;if(t){let{__hasMask:n}=t;t.__updateMask(),n!==t.__hasMask&&t.forceUpdate()}}function ey(e,t,n,i){e.__setAttr(t,n)&&(e.__layout.opacityChanged||e.__layout.opacityChange(),i!==0&&n!==0||ar(e))}function Vy(e){return te(e,t=>({set(n){this.__setAttr(t,n)&&(this.__layout.surfaceChange(),this.waitParent(()=>{this.parent.__layout.childrenSortChange()}))}}))}function Xy(e){return te(e,t=>({set(n){this.__setAttr(t,n)&&(this.__layout.boxChanged||this.__layout.boxChange(),this.waitParent(()=>{this.parent.__updateMask(n)}))}}))}function Gy(e){return te(e,t=>({set(n){this.__setAttr(t,n)&&this.waitParent(()=>{this.parent.__updateEraser(n)})}}))}function hr(e){return te(e,t=>({set(n){this.__setAttr(t,n)&&(this.__layout.hitCanvasChanged=!0,Pt.showBounds==="hit"&&this.__layout.surfaceChange(),this.leafer&&this.leafer.updateCursor())}}))}function Ky(e){return te(e,t=>({set(n){this.__setAttr(t,n),this.leafer&&this.leafer.updateCursor()}}))}function Ie(e){return(t,n)=>{En(t,"__DataProcessor",{get:()=>e})}}function qy(e,t,n){let i=e.__DataProcessor.prototype,s="_"+t,a=function(g){return"set"+g.charAt(0).toUpperCase()+g.slice(1)}(t),h=Wy(t,n);if(J(n))h.get=function(){return this[s]};else if(typeof n=="function")h.get=function(){let g=this[s];return g??n(this.__leaf)};else if(ht(n)){let g=YP(n);h.get=function(){let p=this[s];return p??(this[s]=g?{}:vt.clone(n))}}let l=e.isBranchLeaf;t==="width"?h.get=function(){let g=this[s];if(g==null){let p=this,v=p.__naturalWidth,w=p.__leaf;return!n||w.pathInputed?w.boxBounds.width:v?p._height&&p.__useNaturalRatio?p._height*v/p.__naturalHeight:v:l&&w.children.length?w.boxBounds.width:n}return g}:t==="height"&&(h.get=function(){let g=this[s];if(g==null){let p=this,v=p.__naturalHeight,w=p.__leaf;return!n||w.pathInputed?w.boxBounds.height:v?p._width&&p.__useNaturalRatio?p._width*v/p.__naturalWidth:v:l&&w.children.length?w.boxBounds.height:n}return g});let u,f=i;for(;!u&&f;)u=bl(f,t),f=f.__proto__;u&&u.set&&(h.set=u.set),i[a]&&(h.set=i[a],delete i[a]),En(i,t,h)}var sO=new Pt("rewrite"),dl=[],oO=["destroy","constructor"];function pi(e){return(t,n)=>{dl.push({name:t.constructor.name+"."+n,run:()=>{t[n]=e}})}}function Jo(){return e=>{jy()}}function jy(e){dl.length&&(dl.forEach(t=>{e&&sO.error(t.name,"\u9700\u5728Class\u4E0A\u88C5\u9970@rewriteAble()"),t.run()}),dl.length=0)}function nn(e,t){return n=>{var i;(e.prototype?(i=e.prototype,Object.getOwnPropertyNames(i)):Object.keys(e)).forEach(s=>{oO.includes(s)||t&&t.includes(s)||(e.prototype?bl(e.prototype,s).writable&&(n.prototype[s]=e.prototype[s]):n.prototype[s]=e[s])})}}function Re(){return e=>{Is.register(e)}}function gi(){return e=>{zr.register(e)}}setTimeout(()=>jy(!0));var{copy:Rs,toInnerPoint:aO,toOuterPoint:hO,scaleOfOuter:ny,rotateOfOuter:lO,skewOfOuter:cO,multiplyParent:iy,divideParent:ry,getLayout:uO}=rt,he={},{round:sy}=Math,Vt={updateAllMatrix(e,t,n){if(t&&e.__hasAutoLayout&&e.__layout.matrixChanged&&(n=!0),fO(e,t,n),e.isBranch){let{children:i}=e;for(let s=0,a=i.length;s<a;s++)dO(i[s],t,n)}},updateMatrix(e,t,n){let i=e.__layout;t?n&&(i.waitAutoLayout=!0,e.__hasAutoLayout&&(i.matrixChanged=!1)):i.waitAutoLayout&&(i.waitAutoLayout=!1),i.matrixChanged&&e.__updateLocalMatrix(),i.waitAutoLayout||e.__updateWorldMatrix()},updateBounds(e){let t=e.__layout;t.boundsChanged&&e.__updateLocalBounds(),t.waitAutoLayout||e.__updateWorldBounds()},updateAllWorldOpacity(e){if(e.__updateWorldOpacity(),e.isBranch){let{children:t}=e;for(let n=0,i=t.length;n<i;n++)oy(t[n])}},updateChange(e){let t=e.__layout;t.stateStyleChanged&&e.updateState(),t.opacityChanged&&oy(e),e.__updateChange()},updateAllChange(e){if(gO(e),e.isBranch){let{children:t}=e;for(let n=0,i=t.length;n<i;n++)pO(t[n])}},worldHittable(e){for(;e;){if(!e.__.hittable)return!1;e=e.parent}return!0},draggable:e=>(e.draggable||e.editable)&&e.hitSelf&&!e.locked,copyCanvasByWorld(e,t,n,i,s,a){i||(i=e.__nowWorld),e.__worldFlipped||N.fullImageShadow?t.copyWorldByReset(n,i,e.__nowWorld,s,a):t.copyWorldToInner(n,i,e.__layout.renderBounds,s)},moveWorld(e,t,n=0,i,s){let a=ht(t)?Object.assign({},t):{x:t,y:n};i?hO(e.localTransform,a,a,!0):e.parent&&aO(e.parent.scrollWorldTransform,a,a,!0),me.moveLocal(e,a.x,a.y,s)},moveLocal(e,t,n=0,i){ht(t)&&(n=t.y,t=t.x),t+=e.x,n+=e.y,e.leafer&&e.leafer.config.pointSnap&&(t=sy(t),n=sy(n)),i?e.animate({x:t,y:n},i):(e.x=t,e.y=n)},zoomOfWorld(e,t,n,i,s,a){me.zoomOfLocal(e,Ld(e,t),n,i,s,a)},zoomOfLocal(e,t,n,i=n,s,a){let h=e.__localMatrix;if(Dt(i)||(i&&(a=i),i=n),Rs(he,h),ny(he,t,n,i),me.hasHighPosition(e))me.setTransform(e,he,s,a);else{let l=e.x+he.e-h.e,u=e.y+he.f-h.f;a&&!s?e.animate({x:l,y:u,scaleX:e.scaleX*n,scaleY:e.scaleY*i},a):(e.x=l,e.y=u,e.scaleResize(n,i,s!==!0))}},rotateOfWorld(e,t,n,i){me.rotateOfLocal(e,Ld(e,t),n,i)},rotateOfLocal(e,t,n,i){let s=e.__localMatrix;Rs(he,s),lO(he,t,n),me.hasHighPosition(e)?me.setTransform(e,he,!1,i):e.set({x:e.x+he.e-s.e,y:e.y+he.f-s.f,rotation:Kt.formatRotation(e.rotation+n)},i)},skewOfWorld(e,t,n,i,s,a){me.skewOfLocal(e,Ld(e,t),n,i,s,a)},skewOfLocal(e,t,n,i=0,s,a){Rs(he,e.__localMatrix),cO(he,t,n,i),me.setTransform(e,he,s,a)},transformWorld(e,t,n,i){Rs(he,e.worldTransform),iy(he,t),e.parent&&ry(he,e.parent.scrollWorldTransform),me.setTransform(e,he,n,i)},transform(e,t,n,i){Rs(he,e.localTransform),iy(he,t),me.setTransform(e,he,n,i)},setTransform(e,t,n,i){let s=e.__,a=s.origin&&me.getInnerOrigin(e,s.origin),h=uO(t,a,s.around&&me.getInnerOrigin(e,s.around));if(me.hasOffset(e)&&(h.x-=s.offsetX,h.y-=s.offsetY),n){let l=h.scaleX/e.scaleX,u=h.scaleY/e.scaleY;if(delete h.scaleX,delete h.scaleY,a){X.scale(e.boxBounds,Math.abs(l),Math.abs(u));let f=me.getInnerOrigin(e,s.origin);j.move(h,a.x-f.x,a.y-f.y)}e.set(h),e.scaleResize(l,u,!1)}else e.set(h,i)},getFlipTransform(e,t){let n={a:1,b:0,c:0,d:1,e:0,f:0},i=t==="x"?1:-1;return ny(n,me.getLocalOrigin(e,"center"),-1*i,1*i),n},getLocalOrigin:(e,t)=>j.tempToOuterOf(me.getInnerOrigin(e,t),e.localTransform),getInnerOrigin(e,t){let n={};return xn.toPoint(t,e.boxBounds,n),n},getRelativeWorld:(e,t,n)=>(Rs(he,e.worldTransform),ry(he,t.scrollWorldTransform),n?he:Object.assign({},he)),drop(e,t,n,i){e.setTransform(me.getRelativeWorld(e,t,!0),i),t.add(e,n)},hasHighPosition:e=>e.origin||e.around||me.hasOffset(e),hasOffset:e=>e.offsetX||e.offsetY,hasParent(e,t){if(!t)return!1;for(;e;){if(t===e)return!0;e=e.parent}},animateMove(e,t,n=.3){if(t.x||t.y)if(Math.abs(t.x)<1&&Math.abs(t.y)<1)e.move(t);else{let i=t.x*n,s=t.y*n;t.x-=i,t.y-=s,e.move(i,s),N.requestRender(()=>me.animateMove(e,t,n))}}},me=Vt,{updateAllMatrix:dO,updateMatrix:fO,updateAllWorldOpacity:oy,updateAllChange:pO,updateChange:gO}=me;function Ld(e,t){return e.updateLayout(),e.parent?j.tempToInnerOf(t,e.parent.scrollWorldTransform):t}var Fr={worldBounds:e=>e.__world,localBoxBounds:e=>e.__.eraser||e.__.visible===0?null:e.__local||e.__layout,localStrokeBounds:e=>e.__.eraser||e.__.visible===0?null:e.__layout.localStrokeBounds,localRenderBounds:e=>e.__.eraser||e.__.visible===0?null:e.__layout.localRenderBounds,maskLocalBoxBounds:(e,t)=>Pd(e,t)&&e.__localBoxBounds,maskLocalStrokeBounds:(e,t)=>Pd(e,t)&&e.__layout.localStrokeBounds,maskLocalRenderBounds:(e,t)=>Pd(e,t)&&e.__layout.localRenderBounds,excludeRenderBounds:(e,t)=>!(!t.bounds||t.bounds.hit(e.__world,t.matrix))||!(!t.hideBounds||!t.hideBounds.includes(e.__world,t.matrix))},Yo;function Pd(e,t){return t||(Yo=0),e.__.mask&&(Yo=1),Yo<0?null:(Yo&&(Yo=-1),!0)}var{updateBounds:ay}=Vt,Ws={sort:(e,t)=>e.__.zIndex===t.__.zIndex?e.__tempNumber-t.__tempNumber:e.__.zIndex-t.__.zIndex,pushAllChildBranch(e,t){if(e.__tempNumber=1,e.__.__childBranchNumber){let{children:n}=e;for(let i=0,s=n.length;i<s;i++)(e=n[i]).isBranch&&(e.__tempNumber=1,t.add(e),_O(e,t))}},pushAllParent(e,t){let{keys:n}=t;if(n)for(;e.parent&&J(n[e.parent.innerId]);)t.add(e.parent),e=e.parent;else for(;e.parent;)t.add(e.parent),e=e.parent},pushAllBranchStack(e,t){let n=t.length,{children:i}=e;for(let s=0,a=i.length;s<a;s++)i[s].isBranch&&t.push(i[s]);for(let s=n,a=t.length;s<a;s++)hy(t[s],t)},updateBounds(e,t){let n=[e];hy(e,n),mO(n,t)},updateBoundsByBranchStack(e,t){let n,i;for(let s=e.length-1;s>-1;s--){n=e[s],i=n.children;for(let a=0,h=i.length;a<h;a++)ay(i[a]);t&&t===n||ay(n)}},move(e,t,n){let i,{children:s}=e;for(let a=0,h=s.length;a<h;a++)i=(e=s[a]).__world,i.e+=t,i.f+=n,i.x+=t,i.y+=n,e.isBranch&&yO(e,t,n)},scale(e,t,n,i,s,a,h){let l,{children:u}=e,f=i-1,g=s-1;for(let p=0,v=u.length;p<v;p++)l=(e=u[p]).__world,l.a*=i,l.d*=s,(l.b||l.c)&&(l.b*=i,l.c*=s),l.e===l.x&&l.f===l.y?(l.x=l.e+=(l.e-a)*f+t,l.y=l.f+=(l.f-h)*g+n):(l.e+=(l.e-a)*f+t,l.f+=(l.f-h)*g+n,l.x+=(l.x-a)*f+t,l.y+=(l.y-h)*g+n),l.width*=i,l.height*=s,l.scaleX*=i,l.scaleY*=s,e.isBranch&&vO(e,t,n,i,s,a,h)}},{pushAllChildBranch:_O,pushAllBranchStack:hy,updateBoundsByBranchStack:mO,move:yO,scale:vO}=Ws,Fs={run(e){if(e&&e.length){let t=e.length;for(let n=0;n<t;n++)e[n]();e.length===t?e.length=0:e.splice(0,t)}}},{getRelativeWorld:ly,updateBounds:wO}=Vt,{toOuterOf:cl,getPoints:xO,copy:bO}=X,Bd="_localContentBounds",Rd="_worldContentBounds",Od="_worldBoxBounds",Ad="_worldStrokeBounds",Nd=class{get contentBounds(){return this._contentBounds||this.boxBounds}set contentBounds(t){this._contentBounds=t}get strokeBounds(){return this._strokeBounds||this.boxBounds}get renderBounds(){return this._renderBounds||this.boxBounds}set renderBounds(t){this._renderBounds=t}get localContentBounds(){return cl(this.contentBounds,this.leaf.__localMatrix,this[Bd]||(this[Bd]={})),this[Bd]}get localStrokeBounds(){return this._localStrokeBounds||this}get localRenderBounds(){return this._localRenderBounds||this}get worldContentBounds(){return cl(this.contentBounds,this.leaf.__world,this[Rd]||(this[Rd]={})),this[Rd]}get worldBoxBounds(){return cl(this.boxBounds,this.leaf.__world,this[Od]||(this[Od]={})),this[Od]}get worldStrokeBounds(){return cl(this.strokeBounds,this.leaf.__world,this[Ad]||(this[Ad]={})),this[Ad]}get a(){return 1}get b(){return 0}get c(){return 0}get d(){return 1}get e(){return this.leaf.__.x}get f(){return this.leaf.__.y}get x(){return this.e+this.boxBounds.x}get y(){return this.f+this.boxBounds.y}get width(){return this.boxBounds.width}get height(){return this.boxBounds.height}constructor(t){this.leaf=t,this.leaf.__local&&(this._localRenderBounds=this._localStrokeBounds=this.leaf.__local),t.__world&&(this.boxBounds={x:0,y:0,width:0,height:0},this.boxChange(),this.matrixChange())}createLocal(){let t=this.leaf.__local={a:1,b:0,c:0,d:1,e:0,f:0,x:0,y:0,width:0,height:0};this._localStrokeBounds||(this._localStrokeBounds=t),this._localRenderBounds||(this._localRenderBounds=t)}update(){let{leaf:t}=this,{leafer:n}=t;if(t.isApp)return wO(t);if(n)n.ready?n.watcher.changed&&n.layouter.layout():n.start();else{let i=t;for(;i.parent&&!i.parent.leafer;)i=i.parent;let s=i;if(s.__fullLayouting)return;s.__fullLayouting=!0,N.layout(s),delete s.__fullLayouting}}getTransform(t="world"){this.update();let{leaf:n}=this;switch(t){case"world":return n.__world;case"local":return n.__localMatrix;case"inner":return rt.defaultMatrix;case"page":t=n.zoomLayer;default:return ly(n,t)}}getBounds(t,n="world"){switch(this.update(),n){case"world":return this.getWorldBounds(t);case"local":return this.getLocalBounds(t);case"inner":return this.getInnerBounds(t);case"page":n=this.leaf.zoomLayer;default:return new It(this.getInnerBounds(t)).toOuterOf(this.getTransform(n))}}getInnerBounds(t="box"){switch(t){case"render":return this.renderBounds;case"content":if(this.contentBounds)return this.contentBounds;case"box":return this.boxBounds;case"stroke":return this.strokeBounds}}getLocalBounds(t="box"){switch(t){case"render":return this.localRenderBounds;case"stroke":return this.localStrokeBounds;case"content":if(this.contentBounds)return this.localContentBounds;case"box":return this.leaf.__localBoxBounds}}getWorldBounds(t="box"){switch(t){case"render":return this.leaf.__world;case"stroke":return this.worldStrokeBounds;case"content":if(this.contentBounds)return this.worldContentBounds;case"box":return this.worldBoxBounds}}getLayoutBounds(t,n="world",i){let{leaf:s}=this,a,h,l,u=this.getInnerBounds(t);switch(n){case"world":a=s.getWorldPoint(u),h=s.__world;break;case"local":let{scaleX:f,scaleY:g,rotation:p,skewX:v,skewY:w}=s.__;l={scaleX:f,scaleY:g,rotation:p,skewX:v,skewY:w},a=s.getLocalPointByInner(u);break;case"inner":a=u,h=rt.defaultMatrix;break;case"page":n=s.zoomLayer;default:a=s.getWorldPoint(u,n),h=ly(s,n,!0)}if(l||(l=rt.getLayout(h)),bO(l,u),j.copy(l,a),i){let{scaleX:f,scaleY:g}=l,p=Math.abs(f),v=Math.abs(g);p===1&&v===1||(l.scaleX/=p,l.scaleY/=v,l.width*=p,l.height*=v)}return l}getLayoutPoints(t,n="world"){let{leaf:i}=this,s=xO(this.getInnerBounds(t)),a;switch(n){case"world":a=null;break;case"local":a=i.parent;break;case"inner":break;case"page":n=i.zoomLayer;default:a=n}return J(a)||s.forEach(h=>i.innerToWorld(h,null,!1,a)),s}shrinkContent(){let{x:t,y:n,width:i,height:s}=this.boxBounds;this._contentBounds={x:t,y:n,width:i,height:s}}spreadStroke(){let{x:t,y:n,width:i,height:s}=this.strokeBounds;this._strokeBounds={x:t,y:n,width:i,height:s},this._localStrokeBounds={x:t,y:n,width:i,height:s},this.renderSpread||this.spreadRenderCancel()}spreadRender(){let{x:t,y:n,width:i,height:s}=this.renderBounds;this._renderBounds={x:t,y:n,width:i,height:s},this._localRenderBounds={x:t,y:n,width:i,height:s}}shrinkContentCancel(){this._contentBounds=void 0}spreadStrokeCancel(){let t=this.renderBounds===this.strokeBounds;this._strokeBounds=this.boxBounds,this._localStrokeBounds=this.leaf.__localBoxBounds,t&&this.spreadRenderCancel()}spreadRenderCancel(){this._renderBounds=this._strokeBounds,this._localRenderBounds=this._localStrokeBounds}boxChange(){this.boxChanged=!0,this.localBoxChanged?this.boundsChanged||(this.boundsChanged=!0):this.localBoxChange(),this.hitCanvasChanged=!0}localBoxChange(){this.localBoxChanged=!0,this.boundsChanged=!0}strokeChange(){this.strokeChanged=!0,this.strokeSpread||(this.strokeSpread=1),this.boundsChanged=!0,this.hitCanvasChanged=!0}renderChange(){this.renderChanged=!0,this.renderSpread||(this.renderSpread=1),this.boundsChanged=!0}scaleChange(){this.scaleChanged=!0,this._scaleOrRotationChange()}rotationChange(){this.rotationChanged=!0,this.affectRotation=!0,this._scaleOrRotationChange()}_scaleOrRotationChange(){this.affectScaleOrRotation=!0,this.matrixChange(),this.leaf.__local||this.createLocal()}matrixChange(){this.matrixChanged=!0,this.localBoxChanged?this.boundsChanged||(this.boundsChanged=!0):this.localBoxChange()}surfaceChange(){this.surfaceChanged=!0}opacityChange(){this.opacityChanged=!0,this.surfaceChanged||this.surfaceChange()}childrenSortChange(){this.childrenSortChanged||(this.childrenSortChanged=this.affectChildrenSort=!0,this.leaf.forceUpdate("surface"))}destroy(){}},Ke=class{constructor(t,n){this.bubbles=!1,this.type=t,n&&(this.target=n)}stopDefault(){this.isStopDefault=!0,this.origin&&N.event.stopDefault(this.origin)}stopNow(){this.isStopNow=!0,this.isStop=!0,this.origin&&N.event.stopNow(this.origin)}stop(){this.isStop=!0,this.origin&&N.event.stop(this.origin)}},le=class extends Ke{constructor(t,n,i){super(t,n),this.parent=i,this.child=n}};le.ADD="child.add",le.REMOVE="child.remove",le.CREATED="created",le.MOUNTED="mounted",le.UNMOUNTED="unmounted",le.DESTROY="destroy";var Hd="property.scroll",rn=class extends Ke{constructor(t,n,i,s,a){super(t,n),this.attrName=i,this.oldValue=s,this.newValue=a}};rn.CHANGE="property.change",rn.LEAFER_CHANGE="property.leafer_change",rn.SCROLL=Hd;var EO={scrollX:Hd,scrollY:Hd},vn=class extends Ke{constructor(t,n){super(t),Object.assign(this,n)}};vn.LOAD="image.load",vn.LOADED="image.loaded",vn.ERROR="image.error";var Zn=class extends Ke{static checkHas(t,n,i){i==="on"?n===fl?t.__hasWorldEvent=!0:t.__hasLocalEvent=!0:(t.__hasLocalEvent=t.hasEvent(Ud)||t.hasEvent(Yd)||t.hasEvent(Vd),t.__hasWorldEvent=t.hasEvent(fl))}static emitLocal(t){if(t.leaferIsReady){let{resized:n}=t.__layout;n!=="local"&&(t.emit(Ud,t),n==="inner"&&t.emit(Yd,t)),t.emit(Vd,t)}}static emitWorld(t){t.leaferIsReady&&t.emit(fl,this)}};Zn.RESIZE="bounds.resize",Zn.INNER="bounds.inner",Zn.LOCAL="bounds.local",Zn.WORLD="bounds.world";var{RESIZE:Ud,INNER:Yd,LOCAL:Vd,WORLD:fl}=Zn,Xd={};[Ud,Yd,Vd,fl].forEach(e=>Xd[e]=1);var an=(()=>{class e extends Ke{get bigger(){if(!this.old)return!0;let{width:n,height:i}=this.old;return this.width>=n&&this.height>=i}get smaller(){return!this.bigger}get samePixelRatio(){return!this.old||this.pixelRatio===this.old.pixelRatio}constructor(n,i){ht(n)?(super(e.RESIZE),Object.assign(this,n)):super(n),this.old=i}static isResizing(n){return this.resizingKeys&&!J(this.resizingKeys[n.innerId])}}return e.RESIZE="resize",e})(),zn=class extends Ke{constructor(t,n){super(t),this.data=n}};zn.REQUEST="watch.request",zn.DATA="watch.data";var St=class extends Ke{constructor(t,n,i){super(t),n&&(this.data=n,this.times=i)}};St.REQUEST="layout.request",St.START="layout.start",St.BEFORE="layout.before",St.LAYOUT="layout",St.AFTER="layout.after",St.AGAIN="layout.again",St.END="layout.end";var yt=class extends Ke{constructor(t,n,i,s){super(t),n&&(this.times=n),i&&(this.renderBounds=i,this.renderOptions=s)}};yt.REQUEST="render.request",yt.CHILD_START="render.child_start",yt.CHILD_END="render.child_end",yt.START="render.start",yt.BEFORE="render.before",yt.RENDER="render",yt.AFTER="render.after",yt.AGAIN="render.again",yt.END="render.end",yt.NEXT="render.next";var wt=class extends Ke{};wt.START="leafer.start",wt.BEFORE_READY="leafer.before_ready",wt.READY="leafer.ready",wt.AFTER_READY="leafer.after_ready",wt.VIEW_READY="leafer.view_ready",wt.VIEW_COMPLETED="leafer.view_completed",wt.STOP="leafer.stop",wt.RESTART="leafer.restart",wt.END="leafer.end",wt.UPDATE_MODE="leafer.update_mode",wt.TRANSFORM="leafer.transform",wt.MOVE="leafer.move",wt.SCALE="leafer.scale",wt.ROTATE="leafer.rotate",wt.SKEW="leafer.skew";var{MOVE:cy,SCALE:uy,ROTATE:SO,SKEW:dy}=wt,CO={x:cy,y:cy,scaleX:uy,scaleY:uy,rotation:SO,skewX:dy,skewY:dy},fy={},Gd=class{set event(t){this.on(t)}on(t,n,i){if(!n){let g;if(Ct(t))t.forEach(p=>this.on(p[0],p[1],p[2]));else for(let p in t)Ct(g=t[p])?this.on(p,g[0],g[1]):this.on(p,g);return}let s,a,h;i&&(i==="once"?a=!0:typeof i=="boolean"?s=i:(s=i.capture,a=i.once));let l=kd(this,s,!0),u=gt(t)?t.split(" "):t,f=a?{listener:n,once:a}:{listener:n};u.forEach(g=>{g&&(h=l[g],h?h.findIndex(p=>p.listener===n)===-1&&h.push(f):l[g]=[f],Xd[g]&&Zn.checkHas(this,g,"on"))})}off(t,n,i){if(t){let s=gt(t)?t.split(" "):t;if(n){let a,h,l;i&&(a=typeof i=="boolean"?i:i!=="once"&&i.capture);let u=kd(this,a);s.forEach(f=>{f&&(h=u[f],h&&(l=h.findIndex(g=>g.listener===n),l>-1&&h.splice(l,1),h.length||delete u[f],Xd[f]&&Zn.checkHas(this,f,"off")))})}else{let{__bubbleMap:a,__captureMap:h}=this;s.forEach(l=>{a&&delete a[l],h&&delete h[l]})}}else this.__bubbleMap=this.__captureMap=void 0}on_(t,n,i,s){return n?this.on(t,i?n=n.bind(i):n,s):Ct(t)&&t.forEach(a=>this.on(a[0],a[2]?a[1]=a[1].bind(a[2]):a[1],a[3])),{type:t,current:this,listener:n,options:s}}off_(t){if(!t)return;let n=Ct(t)?t:[t];n.forEach(i=>{i&&(i.listener?i.current.off(i.type,i.listener,i.options):Ct(i.type)&&i.type.forEach(s=>i.current.off(s[0],s[1],s[3])))}),n.length=0}once(t,n,i,s){if(!n)return Ct(t)&&t.forEach(a=>this.once(a[0],a[1],a[2],a[3]));ht(i)?n=n.bind(i):s=i,this.on(t,n,{once:!0,capture:s})}emit(t,n,i){!n&&zr.has(t)&&(n=zr.get(t,{type:t,target:this,current:this}));let s=kd(this,i)[t];if(s){let a;for(let h=0,l=s.length;h<l&&!((a=s[h])&&(a.listener(n),a.once&&(this.off(t,a.listener,i),h--,l--),n&&n.isStopNow));h++);}this.syncEventer&&this.syncEventer.emitEvent(n,i)}emitEvent(t,n){t.current=this,this.emit(t.type,t,n)}hasEvent(t,n){if(this.syncEventer&&this.syncEventer.hasEvent(t,n))return!0;let{__bubbleMap:i,__captureMap:s}=this,a=i&&i[t],h=s&&s[t];return!!(J(n)?a||h:n?h:a)}destroy(){this.__captureMap=this.__bubbleMap=this.syncEventer=null}};function kd(e,t,n){if(t){let{__captureMap:i}=e;return i||(n?e.__captureMap={}:fy)}{let{__bubbleMap:i}=e;return i||(n?e.__bubbleMap={}:fy)}}var{on:TO,on_:LO,off:PO,off_:BO,once:RO,emit:OO,emitEvent:AO,hasEvent:kO,destroy:MO}=Gd.prototype,DO={on:TO,on_:LO,off:PO,off_:BO,once:RO,emit:OO,emitEvent:AO,hasEvent:kO,destroyEventer:MO},IO=Pt.get("setAttr"),zO={__setAttr(e,t,n){if(this.leaferIsCreated){let i=this.__.__getInput(e);if(!n||wl(t)||J(t)||(IO.warn(this.innerName,e,t),t=void 0),ht(t)||i!==t){if(this.__realSetAttr(e,t),this.isLeafer){this.emitEvent(new rn(rn.LEAFER_CHANGE,this,e,i,t));let a=CO[e];a&&(this.emitEvent(new wt(a,this)),this.emitEvent(new wt(wt.TRANSFORM,this)))}this.emitPropertyEvent(rn.CHANGE,e,i,t);let s=EO[e];return s&&this.emitPropertyEvent(s,e,i,t),!0}return!1}return this.__realSetAttr(e,t),!0},emitPropertyEvent(e,t,n,i){let s=new rn(e,this,t,n,i);this.isLeafer||this.hasEvent(e)&&this.emitEvent(s),this.leafer.emitEvent(s)},__realSetAttr(e,t){let n=this.__;n[e]=t,this.__proxyData&&this.setProxyAttr(e,t),n.normalStyle&&(this.lockNormalStyle||J(n.normalStyle[e])||(n.normalStyle[e]=t))},__getAttr(e){return this.__proxyData?this.getProxyAttr(e):this.__.__get(e)}},{setLayout:WO,multiplyParent:FO,translateInner:py,defaultWorld:NO}=rt,{toPoint:HO,tempPoint:Md}=xn,UO={__updateWorldMatrix(){let{parent:e,__layout:t,__world:n,__scrollWorld:i,__:s}=this;FO(this.__local||t,e?e.__scrollWorld||e.__world:NO,n,!!t.affectScaleOrRotation,s),i&&py(Object.assign(i,n),s.scrollX,s.scrollY)},__updateLocalMatrix(){if(this.__local){let e=this.__layout,t=this.__local,n=this.__;e.affectScaleOrRotation&&(e.scaleChanged&&(e.resized||(e.resized="scale"))||e.rotationChanged)&&(WO(t,n,null,null,e.affectRotation),e.scaleChanged=e.rotationChanged=void 0),t.e=n.x+n.offsetX,t.f=n.y+n.offsetY,(n.around||n.origin)&&(HO(n.around||n.origin,e.boxBounds,Md),py(t,-Md.x,-Md.y,!n.around))}this.__layout.matrixChanged=void 0}},{updateMatrix:YO,updateAllMatrix:gy}=Vt,{updateBounds:_y}=Ws,{toOuterOf:ul,copyAndSpread:my,copy:VO}=X,{toBounds:XO}=Dy,GO={__updateWorldBounds(){let{__layout:e,__world:t}=this;ul(e.renderBounds,t,t),e.resized&&(e.resized==="inner"&&this.__onUpdateSize(),this.__hasLocalEvent&&Zn.emitLocal(this),e.resized=void 0),this.__hasWorldEvent&&Zn.emitWorld(this)},__updateLocalBounds(){let e=this.__layout;e.boxChanged&&(this.__.__pathInputed||this.__updatePath(),this.__updateRenderPath(),this.__updateBoxBounds(),e.resized="inner"),e.localBoxChanged&&(this.__local&&this.__updateLocalBoxBounds(),e.localBoxChanged=void 0,e.strokeSpread&&(e.strokeChanged=!0),e.renderSpread&&(e.renderChanged=!0),this.parent&&this.parent.__layout.boxChange()),e.boxChanged=void 0,e.strokeChanged&&(e.strokeSpread=this.__updateStrokeSpread(),e.strokeSpread?(e.strokeBounds===e.boxBounds&&e.spreadStroke(),this.__updateStrokeBounds(),this.__updateLocalStrokeBounds()):e.spreadStrokeCancel(),e.strokeChanged=void 0,(e.renderSpread||e.strokeSpread!==e.strokeBoxSpread)&&(e.renderChanged=!0),this.parent&&this.parent.__layout.strokeChange(),e.resized="inner"),e.renderChanged&&(e.renderSpread=this.__updateRenderSpread(),e.renderSpread?(e.renderBounds!==e.boxBounds&&e.renderBounds!==e.strokeBounds||e.spreadRender(),this.__updateRenderBounds(),this.__updateLocalRenderBounds()):e.spreadRenderCancel(),e.renderChanged=void 0,this.parent&&this.parent.__layout.renderChange()),e.resized||(e.resized="local"),e.boundsChanged=void 0},__updateLocalBoxBounds(){this.__hasMotionPath&&this.__updateMotionPath(),this.__hasAutoLayout&&this.__updateAutoLayout(),ul(this.__layout.boxBounds,this.__local,this.__local)},__updateLocalStrokeBounds(){ul(this.__layout.strokeBounds,this.__localMatrix,this.__layout.localStrokeBounds)},__updateLocalRenderBounds(){ul(this.__layout.renderBounds,this.__localMatrix,this.__layout.localRenderBounds)},__updateBoxBounds(e,t){let n=this.__layout.boxBounds,i=this.__;i.__usePathBox?XO(i.path,n):(n.x=0,n.y=0,n.width=i.width,n.height=i.height)},__updateAutoLayout(){this.__layout.matrixChanged=!0,this.isBranch?(this.__extraUpdate(),this.__.flow?(this.__layout.boxChanged&&this.__updateFlowLayout(),gy(this),_y(this,this),this.__.__autoSide&&this.__updateBoxBounds(!0)):(gy(this),_y(this,this))):YO(this)},__updateNaturalSize(){let{__:e,__layout:t}=this;e.__naturalWidth=t.boxBounds.width,e.__naturalHeight=t.boxBounds.height},__updateStrokeBounds(e){let t=this.__layout;my(t.strokeBounds,t.boxBounds,t.strokeBoxSpread)},__updateRenderBounds(e){let t=this.__layout,{renderSpread:n}=t;Dt(n)&&n<=0?VO(t.renderBounds,t.strokeBounds):my(t.renderBounds,t.boxBounds,n)}},KO={__render(e,t){if(t.shape)return this.__renderShape(e,t);if((!t.cellList||t.cellList.has(this))&&this.__worldOpacity){let n=this.__;if(n.bright&&!t.topRendering)return t.topList.add(this);if(e.setWorld(this.__nowWorld=this.__getNowWorld(t)),e.opacity=t.dimOpacity&&!n.dimskip?n.opacity*t.dimOpacity:n.opacity,this.__.__single){if(n.eraser==="path")return this.__renderEraser(e,t);let i=e.getSameCanvas(!0,!0);this.__draw(i,t,e),Vt.copyCanvasByWorld(this,e,i,this.__nowWorld,n.__blendMode,!0),i.recycle(this.__nowWorld)}else this.__draw(e,t);Pt.showBounds&&Pt.drawBounds(this,e,t)}},__renderShape(e,t){this.__worldOpacity&&(e.setWorld(this.__nowWorld=this.__getNowWorld(t)),this.__drawShape(e,t))},__clip(e,t){this.__worldOpacity&&(e.setWorld(this.__nowWorld=this.__getNowWorld(t)),this.__drawRenderPath(e),e.clipUI(this))},__updateWorldOpacity(){this.__worldOpacity=this.__.visible?this.parent?this.parent.__worldOpacity*this.__.opacity:this.__.opacity:0,this.__layout.opacityChanged&&(this.__layout.opacityChanged=!1)}},{excludeRenderBounds:yy}=Fr,qO={__updateChange(){let{__layout:e}=this;e.childrenSortChanged&&(this.__updateSortChildren(),e.childrenSortChanged=!1),this.__.__checkSingle()},__render(e,t){if(this.__nowWorld=this.__getNowWorld(t),this.__worldOpacity){let n=this.__;if(n.__useDim)if(n.dim)t.dimOpacity=n.dim===!0?.2:n.dim;else{if(n.bright&&!t.topRendering)return t.topList.add(this);n.dimskip&&t.dimOpacity&&(t.dimOpacity=0)}if(n.__single&&!this.isBranchLeaf){if(n.eraser==="path")return this.__renderEraser(e,t);let i=e.getSameCanvas(!1,!0);this.__renderBranch(i,t);let s=this.__nowWorld;e.opacity=t.dimOpacity?n.opacity*t.dimOpacity:n.opacity,e.copyWorldByReset(i,s,s,n.__blendMode,!0),i.recycle(s)}else this.__renderBranch(e,t)}},__renderBranch(e,t){if(this.__hasMask)this.__renderMask(e,t);else{let{children:n}=this;for(let i=0,s=n.length;i<s;i++)yy(n[i],t)||n[i].__render(e,t)}},__clip(e,t){if(this.__worldOpacity){let{children:n}=this;for(let i=0,s=n.length;i<s;i++)yy(n[i],t)||n[i].__clip(e,t)}}},Dd={},{LEAF:jO,create:ZO}=ki,{stintSet:vy}=vt,{toInnerPoint:$O,toOuterPoint:JO,multiplyParent:QO}=rt,{toOuterOf:wy}=X,{copy:xy,move:by}=j,{moveLocal:tA,zoomOfLocal:eA,rotateOfLocal:nA,skewOfLocal:iA,moveWorld:Ey,zoomOfWorld:rA,rotateOfWorld:sA,skewOfWorld:oA,transform:Sy,transformWorld:aA,setTransform:hA,getFlipTransform:lA,getLocalOrigin:Id,getRelativeWorld:cA,drop:uA}=Vt,fi=class{get tag(){return this.__tag}set tag(e){}get __tag(){return"Leaf"}get innerName(){return this.__.name||this.tag+this.innerId}get __DataProcessor(){return Vo}get __LayoutProcessor(){return Nd}get leaferIsCreated(){return this.leafer&&this.leafer.created}get leaferIsReady(){return this.leafer&&this.leafer.ready}get isLeafer(){return!1}get isBranch(){return!1}get isBranchLeaf(){return!1}get __localMatrix(){return this.__local||this.__layout}get __localBoxBounds(){return this.__local||this.__layout}get worldTransform(){return this.__layout.getTransform("world")}get localTransform(){return this.__layout.getTransform("local")}get scrollWorldTransform(){return this.updateLayout(),this.__scrollWorld||this.__world}get boxBounds(){return this.getBounds("box","inner")}get renderBounds(){return this.getBounds("render","inner")}get worldBoxBounds(){return this.getBounds("box")}get worldStrokeBounds(){return this.getBounds("stroke")}get worldRenderBounds(){return this.getBounds("render")}get worldOpacity(){return this.updateLayout(),this.__worldOpacity}get __worldFlipped(){return this.__world.scaleX<0||this.__world.scaleY<0}get __onlyHitMask(){return this.__hasMask&&!this.__.hitChildren}get __ignoreHitWorld(){return(this.__hasMask||this.__hasEraser)&&this.__.hitChildren}get __inLazyBounds(){return this.leaferIsCreated&&this.leafer.lazyBounds.hit(this.__world)}get pathInputed(){return this.__.__pathInputed}set event(e){this.on(e)}constructor(e){this.innerId=ZO(jO),this.reset(e),this.__bubbleMap&&this.__emitLifeEvent(le.CREATED)}reset(e){this.leafer&&this.leafer.forceRender(this.__world),e!==0&&(this.__world={a:1,b:0,c:0,d:1,e:0,f:0,x:0,y:0,width:0,height:0,scaleX:1,scaleY:1},e!==null&&(this.__local={a:1,b:0,c:0,d:1,e:0,f:0,x:0,y:0,width:0,height:0})),this.__worldOpacity=1,this.__=new this.__DataProcessor(this),this.__layout=new this.__LayoutProcessor(this),this.__level&&this.resetCustom(),e&&(e.__&&(e=e.toJSON()),e.children?this.set(e):Object.assign(this,e))}resetCustom(){this.__hasMask=this.__hasEraser=null,this.forceUpdate()}waitParent(e,t){t&&(e=e.bind(t)),this.parent?e():this.on(le.ADD,e,"once")}waitLeafer(e,t){t&&(e=e.bind(t)),this.leafer?e():this.on(le.MOUNTED,e,"once")}nextRender(e,t,n){this.leafer?this.leafer.nextRender(e,t,n):this.waitLeafer(()=>this.leafer.nextRender(e,t,n))}removeNextRender(e){this.nextRender(e,null,"off")}__bindLeafer(e){if(this.isLeafer&&e!==null&&(e=this),this.leafer&&!e&&this.leafer.leafs--,this.leafer=e,e?(e.leafs++,this.__level=this.parent?this.parent.__level+1:1,this.animation&&this.__runAnimation("in"),this.__bubbleMap&&this.__emitLifeEvent(le.MOUNTED)):this.__emitLifeEvent(le.UNMOUNTED),this.isBranch){let{children:t}=this;for(let n=0,i=t.length;n<i;n++)t[n].__bindLeafer(e)}}set(e,t){}get(e){}setAttr(e,t){this[e]=t}getAttr(e){return this[e]}getComputedAttr(e){return this.__[e]}toJSON(e){return e&&this.__layout.update(),this.__.__getInputData(null,e)}toString(e){return JSON.stringify(this.toJSON(e))}toSVG(){}__SVG(e){}toHTML(){}__setAttr(e,t){return!0}__getAttr(e){}setProxyAttr(e,t){}getProxyAttr(e){}find(e,t){}findTag(e){}findOne(e,t){}findId(e){}focus(e){}updateState(){}updateLayout(){this.__layout.update()}forceUpdate(e){J(e)?e="width":e==="surface"&&(e="blendMode");let t=this.__.__getInput(e);this.__[e]=J(t)?null:void 0,this[e]=t}forceRender(e,t){this.forceUpdate("surface")}__extraUpdate(){this.leaferIsReady&&this.leafer.layouter.addExtra(this)}__updateWorldMatrix(){}__updateLocalMatrix(){}__updateWorldBounds(){}__updateLocalBounds(){}__updateLocalBoxBounds(){}__updateLocalStrokeBounds(){}__updateLocalRenderBounds(){}__updateBoxBounds(e,t){}__updateContentBounds(){}__updateStrokeBounds(e){}__updateRenderBounds(e){}__updateAutoLayout(){}__updateFlowLayout(){}__updateNaturalSize(){}__updateStrokeSpread(){return 0}__updateRenderSpread(){return 0}__onUpdateSize(){}__updateEraser(e){this.__hasEraser=!!e||this.children.some(t=>t.__.eraser)}__renderEraser(e,t){e.save(),this.__clip(e,t);let{renderBounds:n}=this.__layout;e.clearRect(n.x,n.y,n.width,n.height),e.restore()}__updateMask(e){this.__hasMask=this.children.some(t=>t.__.mask&&t.__.visible&&t.__.opacity)}__renderMask(e,t){}__getNowWorld(e){if(e.matrix){this.__cameraWorld||(this.__cameraWorld={});let t=this.__cameraWorld,n=this.__world;return QO(n,e.matrix,t,void 0,n),wy(this.__layout.renderBounds,t,t),vy(t,"half",n.half),vy(t,"ignorePixelSnap",n.ignorePixelSnap),t}return this.__world}getClampRenderScale(){let{scaleX:e}=this.__nowWorld||this.__world;return e<0&&(e=-e),e>1?e:1}getRenderScaleData(e,t){let{scaleX:n,scaleY:i}=on.patternLocked?this.__world:this.__nowWorld;return e&&(n<0&&(n=-n),i<0&&(i=-i)),(t===!0||t==="zoom-in"&&n>1&&i>1)&&(n=i=1),Dd.scaleX=n,Dd.scaleY=i,Dd}getTransform(e){return this.__layout.getTransform(e||"local")}getBounds(e,t){return this.__layout.getBounds(e,t)}getLayoutBounds(e,t,n){return this.__layout.getLayoutBounds(e,t,n)}getLayoutPoints(e,t){return this.__layout.getLayoutPoints(e,t)}getWorldBounds(e,t,n){let i=t?cA(this,t):this.worldTransform,s=n?e:{};return wy(e,i,s),s}worldToLocal(e,t,n,i){this.parent?this.parent.worldToInner(e,t,n,i):t&&xy(t,e)}localToWorld(e,t,n,i){this.parent?this.parent.innerToWorld(e,t,n,i):t&&xy(t,e)}worldToInner(e,t,n,i){i&&(i.innerToWorld(e,t,n),e=t||e),$O(this.scrollWorldTransform,e,t,n)}innerToWorld(e,t,n,i){JO(this.scrollWorldTransform,e,t,n),i&&i.worldToInner(t||e,null,n)}getBoxPoint(e,t,n,i){return this.getBoxPointByInner(this.getInnerPoint(e,t,n,i),null,null,!0)}getBoxPointByInner(e,t,n,i){let s=i?e:Object.assign({},e),{x:a,y:h}=this.boxBounds;return by(s,-a,-h),s}getInnerPoint(e,t,n,i){let s=i?e:{};return this.worldToInner(e,s,n,t),s}getInnerPointByBox(e,t,n,i){let s=i?e:Object.assign({},e),{x:a,y:h}=this.boxBounds;return by(s,a,h),s}getInnerPointByLocal(e,t,n,i){return this.getInnerPoint(e,this.parent,n,i)}getLocalPoint(e,t,n,i){let s=i?e:{};return this.worldToLocal(e,s,n,t),s}getLocalPointByInner(e,t,n,i){return this.getWorldPoint(e,this.parent,n,i)}getPagePoint(e,t,n,i){return(this.leafer?this.leafer.zoomLayer:this).getInnerPoint(e,t,n,i)}getWorldPoint(e,t,n,i){let s=i?e:{};return this.innerToWorld(e,s,n,t),s}getWorldPointByBox(e,t,n,i){return this.getWorldPoint(this.getInnerPointByBox(e,null,null,i),t,n,!0)}getWorldPointByLocal(e,t,n,i){let s=i?e:{};return this.localToWorld(e,s,n,t),s}getWorldPointByPage(e,t,n,i){return(this.leafer?this.leafer.zoomLayer:this).getWorldPoint(e,t,n,i)}setTransform(e,t,n){hA(this,e,t,n)}transform(e,t,n){Sy(this,e,t,n)}move(e,t,n){tA(this,e,t,n)}moveInner(e,t,n){Ey(this,e,t,!0,n)}scaleOf(e,t,n,i,s){eA(this,Id(this,e),t,n,i,s)}rotateOf(e,t,n){nA(this,Id(this,e),t,n)}skewOf(e,t,n,i,s){iA(this,Id(this,e),t,n,i,s)}transformWorld(e,t,n){aA(this,e,t,n)}moveWorld(e,t,n){Ey(this,e,t,!1,n)}scaleOfWorld(e,t,n,i,s){rA(this,e,t,n,i,s)}rotateOfWorld(e,t){sA(this,e,t)}skewOfWorld(e,t,n,i,s){oA(this,e,t,n,i,s)}flip(e,t){Sy(this,lA(this,e),!1,t)}scaleResize(e,t=e,n){this.scaleX*=e,this.scaleY*=t}__scaleResize(e,t){}resizeWidth(e){}resizeHeight(e){}hit(e,t){return!0}__hitWorld(e,t){return!0}__hit(e,t){return!0}__hitFill(e){return!0}__hitStroke(e,t){return!0}__hitPixel(e){return!0}__drawHitPath(e){}__updateHitCanvas(){}__render(e,t){}__drawFast(e,t){}__draw(e,t,n){}__clip(e,t){}__renderShape(e,t){}__drawShape(e,t){}__updateWorldOpacity(){}__updateChange(){}__drawPath(e){}__drawRenderPath(e){}__updatePath(){}__updateRenderPath(){}getMotionPathData(){return Zt.need("path")}getMotionPoint(e){return Zt.need("path")}getMotionTotal(){return 0}__updateMotionPath(){}__runAnimation(e,t){}__updateSortChildren(){}add(e,t){}remove(e,t){this.parent&&this.parent.remove(this,t)}dropTo(e,t,n){uA(this,e,t,n)}on(e,t,n){}off(e,t,n){}on_(e,t,n,i){}off_(e){}once(e,t,n,i){}emit(e,t,n){}emitEvent(e,t){}hasEvent(e,t){return!1}static changeAttr(e,t,n){n?this.addAttr(e,t,n):qy(this.prototype,e,t)}static addAttr(e,t,n,i){n||(n=Tt),n(t,i)(this.prototype,e)}__emitLifeEvent(e){this.hasEvent(e)&&this.emitEvent(new le(e,this,this.parent))}destroy(){this.destroyed||(this.parent&&this.remove(),this.children&&this.clear(),this.__emitLifeEvent(le.DESTROY),this.__.destroy(),this.__layout.destroy(),this.destroyEventer(),this.destroyed=!0)}};fi=Q([nn(zO),nn(UO),nn(GO),nn(DO),nn(KO)],fi);var{setListWithFn:zd}=X,{sort:dA}=Ws,{localBoxBounds:fA,localStrokeBounds:pA,localRenderBounds:gA,maskLocalBoxBounds:_A,maskLocalStrokeBounds:mA,maskLocalRenderBounds:yA}=Fr,vA=new Pt("Branch"),yl=class extends fi{__updateStrokeSpread(){let{children:e}=this;for(let t=0,n=e.length;t<n;t++)if(e[t].__layout.strokeSpread)return 1;return 0}__updateRenderSpread(){let{children:e}=this;for(let t=0,n=e.length;t<n;t++)if(e[t].__layout.renderSpread)return 1;return 0}__updateBoxBounds(e,t){zd(t||this.__layout.boxBounds,this.children,this.__hasMask?_A:fA)}__updateStrokeBounds(e){zd(e||this.__layout.strokeBounds,this.children,this.__hasMask?mA:pA)}__updateRenderBounds(e){zd(e||this.__layout.renderBounds,this.children,this.__hasMask?yA:gA)}__updateSortChildren(){let e,{children:t}=this;if(t.length>1){for(let n=0,i=t.length;n<i;n++)t[n].__tempNumber=n,t[n].__.zIndex&&(e=!0);t.sort(dA),this.__layout.affectChildrenSort=e}}add(e,t){if(e===this||e.destroyed)return vA.warn("add self or destroyed");let n=J(t);if(!e.__){if(Ct(e))return e.forEach(s=>{this.add(s,t),n||t++});e=Is.get(e.tag,e)}e.parent&&e.parent.remove(e),e.parent=this,n?this.children.push(e):this.children.splice(t,0,e),e.isBranch&&(this.__.__childBranchNumber=(this.__.__childBranchNumber||0)+1);let i=e.__layout;i.boxChanged||i.boxChange(),i.matrixChanged||i.matrixChange(),e.__bubbleMap&&e.__emitLifeEvent(le.ADD),this.leafer&&(e.__bindLeafer(this.leafer),this.leafer.created&&this.__emitChildEvent(le.ADD,e)),this.__layout.affectChildrenSort&&this.__layout.childrenSortChange()}addMany(...e){this.add(e)}remove(e,t){e?e.__?e.animationOut?e.__runAnimation("out",()=>this.__remove(e,t)):this.__remove(e,t):this.find(e).forEach(n=>this.remove(n,t)):J(e)&&super.remove(null,t)}removeAll(e){let{children:t}=this;t.length&&(this.children=[],this.__preRemove(),this.__.__childBranchNumber=0,t.forEach(n=>{this.__realRemoveChild(n),e&&n.destroy()}))}clear(){this.removeAll(!0)}__remove(e,t){let n=this.children.indexOf(e);n>-1&&(this.children.splice(n,1),e.isBranch&&(this.__.__childBranchNumber=(this.__.__childBranchNumber||1)-1),this.__preRemove(),this.__realRemoveChild(e),t&&e.destroy())}__preRemove(){this.__hasMask&&this.__updateMask(),this.__hasEraser&&this.__updateEraser(),this.__layout.boxChange(),this.__layout.affectChildrenSort&&this.__layout.childrenSortChange()}__realRemoveChild(e){e.__emitLifeEvent(le.REMOVE),e.parent=null,this.leafer&&(e.__bindLeafer(null),this.leafer.created&&(this.__emitChildEvent(le.REMOVE,e),this.leafer.hitCanvasManager&&this.leafer.hitCanvasManager.clear()))}__emitChildEvent(e,t){let n=new le(e,t,this);this.hasEvent(e)&&!this.isLeafer&&this.emitEvent(n),this.leafer.emitEvent(n)}};yl=Q([nn(qO)],yl);var Bt=class e{get length(){return this.list.length}constructor(t){this.reset(),t&&(Ct(t)?this.addList(t):this.add(t))}has(t){return t&&!J(this.keys[t.innerId])}indexAt(t){return this.list[t]}indexOf(t){let n=this.keys[t.innerId];return J(n)?-1:n}add(t){let{list:n,keys:i}=this;J(i[t.innerId])&&(n.push(t),i[t.innerId]=n.length-1)}addAt(t,n=0){let{keys:i}=this;if(J(i[t.innerId])){let{list:s}=this;for(let a=n,h=s.length;a<h;a++)i[s[a].innerId]++;n===0?s.unshift(t):(n>s.length&&(n=s.length),s.splice(n,0,t)),i[t.innerId]=n}}addList(t){for(let n=0;n<t.length;n++)this.add(t[n])}remove(t){let{list:n}=this,i;for(let s=0,a=n.length;s<a;s++)J(i)?n[s].innerId===t.innerId&&(i=s,delete this.keys[t.innerId]):this.keys[n[s].innerId]=s-1;J(i)||n.splice(i,1)}sort(t){let{list:n}=this;t?n.sort((i,s)=>s.__level-i.__level):n.sort((i,s)=>i.__level-s.__level)}forEach(t){this.list.forEach(t)}clone(){let t=new e;return t.list=[...this.list],t.keys=Object.assign({},this.keys),t}update(){this.keys={};let{list:t,keys:n}=this;for(let i=0,s=t.length;i<s;i++)n[t[i].innerId]=i}reset(){this.list=[],this.keys={}}destroy(){this.reset()}},vl=class{get length(){return this._length}constructor(t){this._length=0,this.reset(),t&&(Ct(t)?this.addList(t):this.add(t))}has(t){return!J(this.keys[t.innerId])}without(t){return J(this.keys[t.innerId])}sort(t){let{levels:n}=this;t?n.sort((i,s)=>s-i):n.sort((i,s)=>i-s)}addList(t){t.forEach(n=>{this.add(n)})}add(t){let{keys:n,levelMap:i}=this;n[t.innerId]||(n[t.innerId]=1,i[t.__level]?i[t.__level].push(t):(i[t.__level]=[t],this.levels.push(t.__level)),this._length++)}forEach(t){let n;this.levels.forEach(i=>{n=this.levelMap[i];for(let s=0,a=n.length;s<a;s++)t(n[s])})}reset(){this.levelMap={},this.keys={},this.levels=[],this._length=0}destroy(){this.levelMap=null}};function L(e,t,n,i){var s,a=arguments.length,h=a<3?t:i===null?i=Object.getOwnPropertyDescriptor(t,n):i;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")h=Reflect.decorate(e,t,n,i);else for(var l=e.length-1;l>=0;l--)(s=e[l])&&(h=(a<3?s(h):a>3?s(t,n,h):s(t,n))||h);return a>3&&h&&Object.defineProperty(t,n,h),h}function Ns(e){return te(e,t=>({set(n){this.__setAttr(t,n),n&&(this.__.__useEffect=!0),this.__layout.renderChanged||this.__layout.renderChange()}}))}function Qo(e){return te(e,t=>({set(n){this.__setAttr(t,n),this.__layout.boxChanged||this.__layout.boxChange(),this.__updateSize()}}))}function xA(){return(e,t)=>{let n="_"+t;En(e,t,{set(i){this.isLeafer&&(this[n]=i)},get(){return this.isApp?this.tree.zoomLayer:this.isLeafer?this[n]||this:this.leafer&&this.leafer.zoomLayer}})}}var mf={},we={hasTransparent:function(e){if(!e||e.length===7||e.length===4)return!1;if(e==="transparent")return!0;let t=e[0];if(t==="#")switch(e.length){case 5:return e[4]!=="f"&&e[4]!=="F";case 9:return e[7]!=="f"&&e[7]!=="F"||e[8]!=="f"&&e[8]!=="F"}else if((t==="r"||t==="h")&&e[3]==="a"){let n=e.lastIndexOf(",");if(n>-1)return parseFloat(e.slice(n+1))<1}return!1}},Zy={number:(e,t)=>ht(e)?e.type==="percent"?e.value*t:e.value:e},bA={},_t={},xe={},sa={},Di={},ov={apply(){Zt.need("filter")}},EA={},Rt={setStyleName:()=>Zt.need("state"),set:()=>Zt.need("state")};var{parse:SA,objectToCanvasData:CA}=rr,{stintSet:ta}=vt,{hasTransparent:$y}=we,Jy={originPaint:{}},Qy=Pt.get("UIData"),_i=class extends Vo{get scale(){let{scaleX:t,scaleY:n}=this;return t!==n?{x:t,y:n}:t}get __strokeWidth(){return this.__getRealStrokeWidth()}get __maxStrokeWidth(){let t=this;return t.__hasMultiStrokeStyle?Math.max(t.__hasMultiStrokeStyle,t.strokeWidth):t.strokeWidth}get __hasMultiPaint(){let t=this;return t.fill&&this.__useStroke||t.__isFills&&t.fill.length>1||t.__isStrokes&&t.stroke.length>1||t.__useEffect}get __clipAfterFill(){let t=this;return t.cornerRadius||t.innerShadow||t.__pathInputed}get __hasSurface(){return this.fill||this.stroke}get __autoWidth(){return!this._width}get __autoHeight(){return!this._height}get __autoSide(){return!this._width||!this._height}get __autoSize(){return!this._width&&!this._height}setVisible(t){this._visible=t;let{leafer:n}=this.__leaf;n&&(n.watcher.hasVisible=!0)}setWidth(t){t<0?(this._width=-t,this.__leaf.scaleX*=-1,Qy.warn("width < 0, instead -scaleX ",this)):this._width=t}setHeight(t){t<0?(this._height=-t,this.__leaf.scaleY*=-1,Qy.warn("height < 0, instead -scaleY",this)):this._height=t}setFill(t){this.__naturalWidth&&this.__removeNaturalSize(),gt(t)||!t?(ta(this,"__isTransparentFill",$y(t)),this.__isFills&&this.__removePaint("fill",!0),this._fill=t):ht(t)&&this.__setPaint("fill",t)}setStroke(t){gt(t)||!t?(ta(this,"__isTransparentStroke",$y(t)),this.__isStrokes&&this.__removePaint("stroke",!0),this._stroke=t):ht(t)&&this.__setPaint("stroke",t)}setPath(t){let n=gt(t);n||t&&ht(t[0])?(this.__setInput("path",t),this._path=n?SA(t):CA(t)):(this.__input&&this.__removeInput("path"),this._path=t)}setShadow(t){nf(this,"shadow",t)}setInnerShadow(t){nf(this,"innerShadow",t)}setFilter(t){nf(this,"filter",t)}__computePaint(){let{fill:t,stroke:n}=this.__input;t&&_t.compute("fill",this.__leaf),n&&_t.compute("stroke",this.__leaf),this.__needComputePaint=void 0}__getRealStrokeWidth(t){let{strokeWidth:n,strokeWidthFixed:i}=this;if(t&&(t.strokeWidth&&(n=t.strokeWidth),J(t.strokeWidthFixed)||(i=t.strokeWidthFixed)),i){let s=this.__leaf.getClampRenderScale();return s>1?n/s:n}return n}__setPaint(t,n){this.__setInput(t,n);let i=this.__leaf.__layout;i.boxChanged||i.boxChange(),Ct(n)&&!n.length?this.__removePaint(t):t==="fill"?(this.__isFills=!0,this._fill||(this._fill=Jy)):(this.__isStrokes=!0,this._stroke||(this._stroke=Jy))}__removePaint(t,n){n&&this.__removeInput(t),xe.recycleImage(t,this),t==="fill"?(ta(this,"__isAlphaPixelFill",void 0),this._fill=this.__isFills=void 0):(ta(this,"__isAlphaPixelStroke",void 0),ta(this,"__hasMultiStrokeStyle",void 0),this._stroke=this.__isStrokes=void 0)}};function nf(e,t,n){e.__setInput(t,n),Ct(n)?(n.some(i=>i.visible===!1)&&(n=n.filter(i=>i.visible!==!1)),n.length||(n=void 0)):n=n&&n.visible!==!1?[n]:void 0,e["_"+t]=n}var Ys=class extends _i{},Pl=class extends Ys{get __boxStroke(){return!this.__pathInputed}get __drawAfterFill(){return this.__single||this.__clipAfterFill}get __clipAfterFill(){let t=this;return t.overflow!=="show"&&t.__leaf.children.length&&(t.__leaf.isOverflow||super.__clipAfterFill)}},of=class extends Ys{__getInputData(t,n){let i=super.__getInputData(t,n);return sn.forEach(s=>delete i[s]),i}},af=class extends Pl{},Bl=class extends _i{get __usePathBox(){return this.points||this.__pathInputed}},ra=class extends _i{get __boxStroke(){return!this.__pathInputed}},hf=class extends _i{get __boxStroke(){return!this.__pathInputed}},lf=class extends Bl{},cf=class extends _i{},uf=class extends _i{get __pathInputed(){return 2}},df=class extends Ys{},TA={thin:100,"extra-light":200,light:300,normal:400,medium:500,"semi-bold":600,bold:700,"extra-bold":800,black:900},ff=class extends _i{get __useNaturalRatio(){return!1}setFontWeight(t){gt(t)?(this.__setInput("fontWeight",t),t=TA[t]||400):this.__input&&this.__removeInput("fontWeight"),this._fontWeight=t}setBoxStyle(t){let n=this.__leaf,i=n.__box;if(t){let{boxStyle:s}=this;if(i)for(let l in s)i[l]=void 0;else i=n.__box=Is.get("Rect",0);let a=n.__layout,h=i.__layout;s||(i.parent=n,i.__world=n.__world,h.boxBounds=a.boxBounds),i.set(t),h.strokeChanged&&a.strokeChange()}else i&&(n.__box=i.parent=null,i.destroy());this._boxStyle=t}__getInputData(t,n){let i=super.__getInputData(t,n);return i.textEditing&&delete i.textEditing,i}},pf=class extends ra{setUrl(t){this.__setImageFill(t),this._url=t}__setImageFill(t){this.fill=t?{type:"image",mode:"stretch",url:t}:void 0}__getData(){let t=super.__getData();return t.url&&delete t.fill,t}__getInputData(t,n){let i=super.__getInputData(t,n);return i.url&&delete i.fill,i}},gf=class extends ra{get __isCanvas(){return!0}get __drawAfterFill(){return!0}__getInputData(t,n){let i=super.__getInputData(t,n);return i.url=this.__leaf.canvas.toDataURL("image/png"),i}},{max:ea,add:rf}=Ds,LA={__updateStrokeSpread(){let e=0,t=0,n=this.__,{strokeAlign:i,__maxStrokeWidth:s}=n,a=this.__box;if((n.stroke||n.hitStroke==="all")&&s&&i!=="inside"&&(t=e=i==="center"?s/2:s,!n.__boxStroke)){let h=n.__isLinePath?0:10*e,l=n.strokeCap==="none"?0:s;e+=Math.max(h,l)}return n.__useArrow&&(e+=5*s),a&&(e=ea(e,a.__layout.strokeSpread=a.__updateStrokeSpread()),t=Math.max(t,a.__layout.strokeBoxSpread)),this.__layout.strokeBoxSpread=t,e},__updateRenderSpread(){let e=0,{shadow:t,innerShadow:n,blur:i,backgroundBlur:s,filter:a,renderSpread:h}=this.__,{strokeSpread:l}=this.__layout,u=this.__box;t&&(e=Di.getShadowRenderSpread(this,t)),i&&(e=ea(e,i)),a&&(e=rf(e,ov.getSpread(a))),h&&(e=rf(e,h)),l&&(e=rf(e,l));let f=e;return n&&(f=ea(f,Di.getInnerShadowSpread(this,n))),s&&(f=ea(f,s)),this.__layout.renderShapeSpread=f,u?ea(u.__updateRenderSpread(),e):e}},{stintSet:Cl}=vt,PA={__updateChange(){let e=this.__;if(e.__useStroke){let t=e.__useStroke=!(!e.stroke||!e.strokeWidth);Cl(this.__world,"half",t&&e.strokeAlign==="center"&&e.strokeWidth%2),Cl(e,"__fillAfterStroke",t&&e.strokeAlign==="outside"&&e.fill&&!e.__isTransparentFill)}if(e.__useEffect){let{shadow:t,fill:n,stroke:i}=e,s=e.innerShadow||e.blur||e.backgroundBlur||e.filter;Cl(e,"__isFastShadow",t&&!s&&t.length<2&&!t[0].spread&&!Di.isTransformShadow(t[0])&&n&&!e.__isTransparentFill&&!(Ct(n)&&n.length>1)&&(this.useFastShadow||!i||i&&e.strokeAlign==="inside")),e.__useEffect=!(!t&&!s)}e.__checkSingle(),Cl(e,"__complex",e.__isFills||e.__isStrokes||e.cornerRadius||e.__useEffect)},__drawFast(e,t){tv(this,e,t)},__draw(e,t,n){let i=this.__;if(i.__complex){i.__needComputePaint&&i.__computePaint();let{fill:s,stroke:a,__drawAfterFill:h,__fillAfterStroke:l,__isFastShadow:u}=i;if(this.__drawRenderPath(e),i.__useEffect&&!u){let f=_t.shape(this,e,t);this.__nowWorld=this.__getNowWorld(t);let{shadow:g,innerShadow:p,filter:v}=i;g&&Di.shadow(this,e,f),l&&(i.__isStrokes?_t.strokes(a,this,e,t):_t.stroke(a,this,e,t)),s&&(i.__isFills?_t.fills(s,this,e,t):_t.fill(s,this,e,t)),h&&this.__drawAfterFill(e,t),p&&Di.innerShadow(this,e,f),a&&!l&&(i.__isStrokes?_t.strokes(a,this,e,t):_t.stroke(a,this,e,t)),v&&ov.apply(v,this,this.__nowWorld,e,n,f),f.worldCanvas&&f.worldCanvas.recycle(),f.canvas.recycle()}else{if(l&&(i.__isStrokes?_t.strokes(a,this,e,t):_t.stroke(a,this,e,t)),u){let f=i.shadow[0],{scaleX:g,scaleY:p}=this.getRenderScaleData(!0,f.scaleFixed);e.save(),e.setWorldShadow(f.x*g,f.y*p,f.blur*g,we.string(f.color))}s&&(i.__isFills?_t.fills(s,this,e,t):_t.fill(s,this,e,t)),u&&e.restore(),h&&this.__drawAfterFill(e,t),a&&!l&&(i.__isStrokes?_t.strokes(a,this,e,t):_t.stroke(a,this,e,t))}}else i.__pathForRender?tv(this,e,t):this.__drawFast(e,t)},__drawShape(e,t){this.__drawRenderPath(e);let n=this.__,{fill:i,stroke:s}=n;i&&!t.ignoreFill&&(n.__isAlphaPixelFill?_t.fills(i,this,e,t):_t.fill("#000000",this,e,t)),n.__isCanvas&&this.__drawAfterFill(e,t),s&&!t.ignoreStroke&&(n.__isAlphaPixelStroke?_t.strokes(s,this,e,t):_t.stroke("#000000",this,e,t))},__drawAfterFill(e,t){this.__.__clipAfterFill?(e.save(),e.clipUI(this),this.__drawContent(e,t),e.restore()):this.__drawContent(e,t)}};function tv(e,t,n){let{fill:i,stroke:s,__drawAfterFill:a,__fillAfterStroke:h}=e.__;e.__drawRenderPath(t),h&&_t.stroke(s,e,t,n),i&&_t.fill(i,e,t,n),a&&e.__drawAfterFill(t,n),s&&!h&&_t.stroke(s,e,t,n)}var BA={__drawFast(e,t){let{x:n,y:i,width:s,height:a}=this.__layout.boxBounds,{fill:h,stroke:l,__drawAfterFill:u}=this.__;if(h&&(e.fillStyle=h,e.fillRect(n,i,s,a)),u&&this.__drawAfterFill(e,t),l){let{strokeAlign:f,__strokeWidth:g}=this.__;if(!g)return;e.setStroke(l,g,this.__);let p=g/2;switch(f){case"center":e.strokeRect(0,0,s,a);break;case"inside":s-=g,a-=g,s<0||a<0?(e.save(),this.__clip(e,t),e.strokeRect(n+p,i+p,s,a),e.restore()):e.strokeRect(n+p,i+p,s,a);break;case"outside":e.strokeRect(n-p,i-p,s+g,a+g)}}}},_f,D=_f=class extends fi{get app(){return this.leafer&&this.leafer.app}get isFrame(){return!1}set scale(e){Kt.assignScale(this,e)}get scale(){return this.__.scale}get isAutoWidth(){let e=this.__;return e.__autoWidth||e.autoWidth}get isAutoHeight(){let e=this.__;return e.__autoHeight||e.autoHeight}get pen(){let{path:e}=this.__;return zs.set(this.path=e||[]),e||this.__drawPathByBox(zs),zs}reset(e){}set(e,t){e&&Object.assign(this,e)}get(e){return gt(e)?this.__.__getInput(e):this.__.__getInputData(e)}createProxyData(){}find(e,t){return Zt.need("find")}findTag(e){return this.find({tag:e})}findOne(e,t){return Zt.need("find")}findId(e){return this.findOne({id:e})}getPath(e,t){this.__layout.update();let n=t?this.__.__pathForRender:this.__.path;return n||(zs.set(n=[]),this.__drawPathByBox(zs,!t)),e?rr.toCanvasData(n,!0):n}getPathString(e,t,n){return rr.stringify(this.getPath(e,t),n)}load(){this.__.__computePaint()}__onUpdateSize(){if(this.__.__input){let e=this.__;!e.lazy||this.__inLazyBounds||EA.running?e.__computePaint():e.__needComputePaint=!0}}__updateRenderPath(){let e=this.__;e.path?(e.__pathForRender=e.cornerRadius?Iy.smooth(e.path,e.cornerRadius,e.cornerSmoothing):e.path,e.__useArrow&&bA.addArrows(this)):e.__pathForRender&&(e.__pathForRender=void 0)}__drawRenderPath(e){e.beginPath(),this.__drawPathByData(e,this.__.__pathForRender)}__drawPath(e){e.beginPath(),this.__drawPathByData(e,this.__.path,!0)}__drawPathByData(e,t,n){t?My.drawPathByData(e,t):this.__drawPathByBox(e,n)}__drawPathByBox(e,t){let{x:n,y:i,width:s,height:a}=this.__layout.boxBounds;if(this.__.cornerRadius&&!t){let{cornerRadius:h}=this.__;e.roundRect(n,i,s,a,Dt(h)?[h]:h)}else e.rect(n,i,s,a);e.closePath()}drawImagePlaceholder(e,t,n){_t.fill(this.__.placeholderColor,this,t,n)}animate(e,t,n,i){return this.set(e),Zt.need("animate")}killAnimate(e,t){}export(e,t){return Zt.need("export")}syncExport(e,t){return Zt.need("export")}clone(e){let t=vt.clone(this.toJSON());return e&&Object.assign(t,e),_f.one(t)}static one(e,t,n,i,s){return Is.get(e.tag||this.prototype.__tag,e,t,n,i,s)}static registerUI(){Re()(this)}static registerData(e){Ie(e)(this.prototype)}static setEditConfig(e){}static setEditOuter(e){}static setEditInner(e){}destroy(){this.fill=this.stroke=null,this.__animate&&this.killAnimate(),super.destroy()}};L([Ie(_i)],D.prototype,"__",void 0),L([xA()],D.prototype,"zoomLayer",void 0),L([Jt("")],D.prototype,"id",void 0),L([Jt("")],D.prototype,"name",void 0),L([Jt("")],D.prototype,"className",void 0),L([Jn("pass-through")],D.prototype,"blendMode",void 0),L([Hy(1)],D.prototype,"opacity",void 0),L([Uy(!0)],D.prototype,"visible",void 0),L([Jn(!1)],D.prototype,"locked",void 0),L([ef(!1)],D.prototype,"dim",void 0),L([ef(!1)],D.prototype,"dimskip",void 0),L([Vy(0)],D.prototype,"zIndex",void 0),L([Xy(!1)],D.prototype,"mask",void 0),L([Gy(!1)],D.prototype,"eraser",void 0),L([Zo(0,!0)],D.prototype,"x",void 0),L([Zo(0,!0)],D.prototype,"y",void 0),L([Tt(100,!0)],D.prototype,"width",void 0),L([Tt(100,!0)],D.prototype,"height",void 0),L([tf(1,!0)],D.prototype,"scaleX",void 0),L([tf(1,!0)],D.prototype,"scaleY",void 0),L([El(0,!0)],D.prototype,"rotation",void 0),L([El(0,!0)],D.prototype,"skewX",void 0),L([El(0,!0)],D.prototype,"skewY",void 0),L([Zo(0,!0)],D.prototype,"offsetX",void 0),L([Zo(0,!0)],D.prototype,"offsetY",void 0),L([Jd(0,!0)],D.prototype,"scrollX",void 0),L([Jd(0,!0)],D.prototype,"scrollY",void 0),L([Qd()],D.prototype,"origin",void 0),L([Qd()],D.prototype,"around",void 0),L([Jt(!1)],D.prototype,"lazy",void 0),L([Fy(1)],D.prototype,"pixelRatio",void 0),L([Sl(0)],D.prototype,"renderSpread",void 0),L([Ny()],D.prototype,"path",void 0),L([He()],D.prototype,"windingRule",void 0),L([He(!0)],D.prototype,"closed",void 0),L([Tt(0)],D.prototype,"padding",void 0),L([Tt(!1)],D.prototype,"lockRatio",void 0),L([Tt()],D.prototype,"widthRange",void 0),L([Tt()],D.prototype,"heightRange",void 0),L([Jt(!1)],D.prototype,"draggable",void 0),L([Jt()],D.prototype,"dragBounds",void 0),L([Jt("auto")],D.prototype,"dragBoundsType",void 0),L([Jt(!1)],D.prototype,"editable",void 0),L([hr(!0)],D.prototype,"hittable",void 0),L([hr("path")],D.prototype,"hitFill",void 0),L([$n("path")],D.prototype,"hitStroke",void 0),L([hr(!1)],D.prototype,"hitBox",void 0),L([hr(!0)],D.prototype,"hitChildren",void 0),L([hr(!0)],D.prototype,"hitSelf",void 0),L([hr()],D.prototype,"hitRadius",void 0),L([Ky("")],D.prototype,"cursor",void 0),L([Jn()],D.prototype,"fill",void 0),L([$n(void 0,!0)],D.prototype,"stroke",void 0),L([$n("inside")],D.prototype,"strokeAlign",void 0),L([$n(1,!0)],D.prototype,"strokeWidth",void 0),L([$n(!1)],D.prototype,"strokeWidthFixed",void 0),L([$n("none")],D.prototype,"strokeCap",void 0),L([$n("miter")],D.prototype,"strokeJoin",void 0),L([$n()],D.prototype,"dashPattern",void 0),L([$n(0)],D.prototype,"dashOffset",void 0),L([$n(10)],D.prototype,"miterLimit",void 0),L([He(0)],D.prototype,"cornerRadius",void 0),L([He()],D.prototype,"cornerSmoothing",void 0),L([Ns()],D.prototype,"shadow",void 0),L([Ns()],D.prototype,"innerShadow",void 0),L([Ns()],D.prototype,"blur",void 0),L([Ns()],D.prototype,"backgroundBlur",void 0),L([Ns()],D.prototype,"grayscale",void 0),L([Ns()],D.prototype,"filter",void 0),L([Jn()],D.prototype,"placeholderColor",void 0),L([Jt(100)],D.prototype,"placeholderDelay",void 0),L([Jt({})],D.prototype,"data",void 0),L([pi(fi.prototype.reset)],D.prototype,"reset",null),D=_f=L([nn(LA),nn(PA),Jo()],D);var zt=class extends D{get __tag(){return"Group"}get isBranch(){return!0}reset(e){this.__setBranch(),super.reset(e)}__setBranch(){this.children||(this.children=[])}set(e,t){if(e)if(e.children){let{children:n}=e;delete e.children,this.children?this.clear():this.__setBranch(),super.set(e,t),n.forEach(i=>this.add(i)),e.children=n}else super.set(e,t)}toJSON(e){let t=super.toJSON(e);return this.childlessJSON||(t.children=this.children.map(n=>n.toJSON(e))),t}pick(e,t){}addAt(e,t){this.add(e,t)}addAfter(e,t){this.add(e,this.children.indexOf(t)+1)}addBefore(e,t){this.add(e,this.children.indexOf(t))}add(e,t){}addMany(...e){}remove(e,t){}removeAll(e){}clear(){}},Ll;L([Ie(Ys)],zt.prototype,"__",void 0),L([Tt(0)],zt.prototype,"width",void 0),L([Tt(0)],zt.prototype,"height",void 0),zt=L([nn(yl),Re()],zt);var RA=Pt.get("Leafer"),Qn=Ll=class extends zt{get __tag(){return"Leafer"}get isApp(){return!1}get app(){return this.parent||this}get isLeafer(){return!0}get imageReady(){return this.viewReady&&nr.isComplete}get layoutLocked(){return!this.layouter.running}get view(){return this.canvas&&this.canvas.view}get FPS(){return this.renderer?this.renderer.FPS:60}get cursorPoint(){return this.interaction&&this.interaction.hoverData||{x:this.width/2,y:this.height/2}}get clientBounds(){return this.canvas&&this.canvas.getClientBounds(!0)||qo()}constructor(e,t){super(t),this.config={start:!0,hittable:!0,smooth:!0,lazySpeard:100},this.leafs=0,this.__eventIds=[],this.__controllers=[],this.__readyWait=[],this.__viewReadyWait=[],this.__viewCompletedWait=[],this.__nextRenderWait=[],this.userConfig=e,e&&(e.view||e.width)&&this.init(e),Ll.list.add(this)}init(e,t){if(this.canvas)return;let n,{config:i}=this;this.__setLeafer(this),t&&(this.parentApp=t,this.__bindApp(t),n=t.running),e&&(this.parent=t,this.initType(e.type),this.parent=void 0,vt.assign(i,e));let s=this.canvas=$t.canvas(i);this.__controllers.push(this.renderer=$t.renderer(this,s,i),this.watcher=$t.watcher(this,i),this.layouter=$t.layouter(this,i)),this.isApp&&this.__setApp(),this.__checkAutoLayout(),t||(this.selector=$t.selector(this),this.interaction=$t.interaction(this,s,this.selector,i),this.interaction&&(this.__controllers.unshift(this.interaction),this.hitCanvasManager=$t.hitCanvasManager()),this.canvasManager=new ks,n=i.start),this.hittable=i.hittable,this.fill=i.fill,this.canvasManager.add(s),this.__listenEvents(),n&&(this.__startTimer=setTimeout(this.start.bind(this))),Fs.run(this.__initWait),this.onInit()}onInit(){}initType(e){}set(e,t){this.waitInit(()=>{super.set(e,t)})}start(){clearTimeout(this.__startTimer),!this.running&&this.canvas&&(this.running=!0,this.ready?this.emitLeafer(wt.RESTART):this.emitLeafer(wt.START),this.__controllers.forEach(e=>e.start()),this.isApp||this.renderer.render())}stop(){clearTimeout(this.__startTimer),this.running&&this.canvas&&(this.__controllers.forEach(e=>e.stop()),this.running=!1,this.emitLeafer(wt.STOP))}unlockLayout(){this.layouter.start(),this.updateLayout()}lockLayout(){this.updateLayout(),this.layouter.stop()}resize(e){let t=vt.copyAttrs({},e,sn);Object.keys(t).forEach(n=>this[n]=t[n])}forceRender(e,t){let{renderer:n}=this;n&&(n.addBlock(e?new It(e):this.canvas.bounds),this.viewReady&&(t?n.render():n.update()))}requestRender(e=!1){this.renderer&&this.renderer.update(e)}updateCursor(e){let t=this.interaction;t&&(e?t.setCursor(e):t.updateCursor())}updateLazyBounds(){this.lazyBounds=this.canvas.bounds.clone().spread(this.config.lazySpeard)}__doResize(e){let{canvas:t}=this;if(!t||t.isSameSize(e))return;let n=vt.copyAttrs({},this.canvas,sn);t.resize(e),this.updateLazyBounds(),this.__onResize(new an(e,n))}__onResize(e){this.emitEvent(e),vt.copyAttrs(this.__,e,sn),setTimeout(()=>{this.canvasManager&&this.canvasManager.clearRecycled()},0)}__setApp(){}__bindApp(e){this.selector=e.selector,this.interaction=e.interaction,this.canvasManager=e.canvasManager,this.hitCanvasManager=e.hitCanvasManager}__setLeafer(e){this.leafer=e,this.__level=1}__checkAutoLayout(){let{config:e,parentApp:t}=this;t||(e.width&&e.height||(this.autoLayout=new gl(e)),this.canvas.startAutoLayout(this.autoLayout,this.__onResize.bind(this)))}__setAttr(e,t){return this.canvas&&(sn.includes(e)?this.__changeCanvasSize(e,t):e==="fill"?this.__changeFill(t):e==="hittable"?this.parent||(this.canvas.hittable=t):e==="zIndex"?(this.canvas.zIndex=t,setTimeout(()=>this.parent&&this.parent.__updateSortChildren())):e==="mode"&&this.emit(wt.UPDATE_MODE,{mode:t})),super.__setAttr(e,t)}__getAttr(e){return this.canvas&&sn.includes(e)?this.canvas[e]:super.__getAttr(e)}__changeCanvasSize(e,t){let{config:n,canvas:i}=this,s=vt.copyAttrs({},i,sn);s[e]=n[e]=t,n.width&&n.height?i.stopAutoLayout():this.__checkAutoLayout(),this.__doResize(s)}__changeFill(e){this.config.fill=e,this.canvas.allowBackgroundColor?this.canvas.backgroundColor=e:this.forceRender()}__onCreated(){this.created=!0}__onReady(){this.ready=!0,this.emitLeafer(wt.BEFORE_READY),this.emitLeafer(wt.READY),this.emitLeafer(wt.AFTER_READY),Fs.run(this.__readyWait)}__onViewReady(){this.viewReady||(this.viewReady=!0,this.emitLeafer(wt.VIEW_READY),Fs.run(this.__viewReadyWait))}__onLayoutEnd(){let{grow:e,width:t,height:n}=this.config;if(e){let{width:i,height:s,pixelRatio:a}=this,h=e==="box"?this.worldBoxBounds:this.__world;t||(i=Math.max(1,h.x+h.width)),n||(s=Math.max(1,h.y+h.height)),this.__doResize({width:i,height:s,pixelRatio:a})}this.ready||this.__onReady()}__onNextRender(){if(this.viewReady){Fs.run(this.__nextRenderWait);let{imageReady:e}=this;e&&!this.viewCompleted&&this.__checkViewCompleted(),e||(this.viewCompleted=!1,this.requestRender())}else this.requestRender()}__checkViewCompleted(e=!0){this.nextRender(()=>{this.imageReady&&(e&&this.emitLeafer(wt.VIEW_COMPLETED),Fs.run(this.__viewCompletedWait),this.viewCompleted=!0)})}__onWatchData(){this.watcher.childrenChanged&&this.interaction&&this.nextRender(()=>this.interaction.updateCursor())}waitInit(e,t){t&&(e=e.bind(t)),this.__initWait||(this.__initWait=[]),this.canvas?e():this.__initWait.push(e)}waitReady(e,t){t&&(e=e.bind(t)),this.ready?e():this.__readyWait.push(e)}waitViewReady(e,t){t&&(e=e.bind(t)),this.viewReady?e():this.__viewReadyWait.push(e)}waitViewCompleted(e,t){t&&(e=e.bind(t)),this.__viewCompletedWait.push(e),this.viewCompleted?this.__checkViewCompleted(!1):this.running||this.start()}nextRender(e,t,n){t&&(e=e.bind(t));let i=this.__nextRenderWait;if(n){for(let s=0;s<i.length;s++)if(i[s]===e){i.splice(s,1);break}}else i.push(e);this.requestRender()}zoom(e,t,n,i){return Zt.need("view")}getValidMove(e,t,n){return{x:e,y:t}}getValidScale(e){return e}getWorldPointByClient(e,t){return this.interaction&&this.interaction.getLocal(e,t)}getPagePointByClient(e,t){return this.getPagePoint(this.getWorldPointByClient(e,t))}getClientPointByWorld(e){let{x:t,y:n}=this.clientBounds;return{x:t+e.x,y:n+e.y}}updateClientBounds(){this.canvas&&this.canvas.updateClientBounds()}receiveEvent(e){}emitLeafer(e){this.emitEvent(new wt(e,this))}__listenEvents(){let e=bn.start("FirstCreate "+this.innerName);this.once([[wt.START,()=>bn.end(e)],[St.START,this.updateLazyBounds,this],[yt.START,this.__onCreated,this],[yt.END,this.__onViewReady,this]]),this.__eventIds.push(this.on_([[zn.DATA,this.__onWatchData,this],[St.END,this.__onLayoutEnd,this],[yt.NEXT,this.__onNextRender,this]]))}__removeListenEvents(){this.off_(this.__eventIds)}destroy(e){let t=()=>{if(!this.destroyed){Ll.list.remove(this);try{this.stop(),this.emitLeafer(wt.END),this.__removeListenEvents(),this.__controllers.forEach(n=>!(this.parent&&n===this.interaction)&&n.destroy()),this.__controllers.length=0,this.parent||(this.selector&&this.selector.destroy(),this.hitCanvasManager&&this.hitCanvasManager.destroy(),this.canvasManager&&this.canvasManager.destroy()),this.canvas&&this.canvas.destroy(),this.config.view=this.parentApp=null,this.userConfig&&(this.userConfig.view=null),super.destroy(),setTimeout(()=>{on.clearRecycled()},100)}catch(n){RA.error(n)}}};e?t():setTimeout(t)}};Qn.list=new Bt,L([Ie(of)],Qn.prototype,"__",void 0),L([Tt()],Qn.prototype,"pixelRatio",void 0),L([Jt("normal")],Qn.prototype,"mode",void 0),Qn=Ll=L([Re()],Qn);var Oe=class extends D{get __tag(){return"Rect"}};L([Ie(ra)],Oe.prototype,"__",void 0),Oe=L([nn(BA),Jo(),Re()],Oe);var{add:ev,includes:OA,scroll:AA}=X,Nr=Oe.prototype,kA=zt.prototype,ee=class extends zt{get __tag(){return"Box"}get isBranchLeaf(){return!0}constructor(e){super(e),this.__layout.renderChanged||this.__layout.renderChange()}__updateStrokeSpread(){return 0}__updateRectRenderSpread(){return 0}__updateRenderSpread(){return this.__updateRectRenderSpread()||-1}__updateRectBoxBounds(){}__updateBoxBounds(e){if(this.children.length&&!this.pathInputed){let t=this.__;if(t.__autoSide){t.__hasSurface&&this.__extraUpdate(),super.__updateBoxBounds();let{boxBounds:n}=this.__layout;t.__autoSize||(t.__autoWidth?(n.width+=n.x,n.x=0,n.height=t.height,n.y=0):(n.height+=n.y,n.y=0,n.width=t.width,n.x=0)),this.__updateNaturalSize()}else this.__updateRectBoxBounds()}else this.__updateRectBoxBounds()}__updateStrokeBounds(){}__updateRenderBounds(){let e,t;if(this.children.length){let n=this.__,i=this.__layout,{renderBounds:s,boxBounds:a}=i,{overflow:h}=n,l=i.childrenRenderBounds||(i.childrenRenderBounds=qo());super.__updateRenderBounds(l),(t=h&&h.includes("scroll"))&&(ev(l,a),AA(l,n)),this.__updateRectRenderBounds(),e=!OA(a,l),e&&h==="show"&&ev(s,l)}else this.__updateRectRenderBounds();vt.stintSet(this,"isOverflow",e),this.__checkScroll(t)}__updateRectRenderBounds(){}__checkScroll(e){}__updateRectChange(){}__updateChange(){super.__updateChange(),this.__updateRectChange()}__renderRect(e,t){}__renderGroup(e,t){}__render(e,t){this.__.__drawAfterFill?this.__renderRect(e,t):(this.__renderRect(e,t),this.children.length&&this.__renderGroup(e,t)),this.hasScroller&&this.scroller.__render(e,t)}__drawContent(e,t){this.__renderGroup(e,t),(this.__.__useStroke||this.__.__useEffect)&&(e.setWorld(this.__nowWorld),this.__drawRenderPath(e))}};L([Ie(Pl)],ee.prototype,"__",void 0),L([Tt(100)],ee.prototype,"width",void 0),L([Tt(100)],ee.prototype,"height",void 0),L([Jt(!1)],ee.prototype,"resizeChildren",void 0),L([Sl("show")],ee.prototype,"overflow",void 0),L([pi(Nr.__updateStrokeSpread)],ee.prototype,"__updateStrokeSpread",null),L([pi(Nr.__updateRenderSpread)],ee.prototype,"__updateRectRenderSpread",null),L([pi(Nr.__updateBoxBounds)],ee.prototype,"__updateRectBoxBounds",null),L([pi(Nr.__updateStrokeBounds)],ee.prototype,"__updateStrokeBounds",null),L([pi(Nr.__updateRenderBounds)],ee.prototype,"__updateRectRenderBounds",null),L([pi(Nr.__updateChange)],ee.prototype,"__updateRectChange",null),L([pi(Nr.__render)],ee.prototype,"__renderRect",null),L([pi(kA.__render)],ee.prototype,"__renderGroup",null),ee=L([Jo(),Re()],ee);var na=class extends ee{get __tag(){return"Frame"}get isFrame(){return!0}};L([Ie(af)],na.prototype,"__",void 0),L([Jn("#FFFFFF")],na.prototype,"fill",void 0),L([Sl("hide")],na.prototype,"overflow",void 0),na=L([Re()],na);var{moveTo:nv,closePath:MA,ellipse:Hs}=or,lr=class extends D{get __tag(){return"Ellipse"}__updatePath(){let{width:e,height:t,innerRadius:n,startAngle:i,endAngle:s}=this.__,a=e/2,h=t/2,l=this.__.path=[];n?i||s?(n<1&&Hs(l,a,h,a*n,h*n,0,i,s,!1),Hs(l,a,h,a,h,0,s,i,!0)):(n<1&&(Hs(l,a,h,a*n,h*n),nv(l,e,h)),Hs(l,a,h,a,h,0,360,0,!0)):i||s?(nv(l,a,h),Hs(l,a,h,a,h,0,i,s,!1)):Hs(l,a,h,a,h),MA(l),N.ellipseToCurve&&(this.__.path=this.getPath(!0))}};L([Ie(hf)],lr.prototype,"__",void 0),L([He(0)],lr.prototype,"innerRadius",void 0),L([He(0)],lr.prototype,"startAngle",void 0),L([He(0)],lr.prototype,"endAngle",void 0),lr=L([Re()],lr);var{sin:DA,cos:IA,PI:iv}=Math,{moveTo:zA,lineTo:WA,closePath:FA,drawPoints:NA}=or,cr=class extends D{get __tag(){return"Polygon"}__updatePath(){let e=this.__,t=e.path=[];if(e.points)NA(t,e.points,e.curve,!0);else{let{width:n,height:i,sides:s}=e,a=n/2,h=i/2;zA(t,a,0);for(let l=1;l<s;l++)WA(t,a+a*DA(2*l*iv/s),h-h*IA(2*l*iv/s));FA(t)}}};L([Ie(lf)],cr.prototype,"__",void 0),L([He(3)],cr.prototype,"sides",void 0),L([He()],cr.prototype,"points",void 0),L([He(0)],cr.prototype,"curve",void 0),cr=L([Jo(),Re()],cr);var{sin:HA,cos:UA,PI:rv}=Math,{moveTo:YA,lineTo:VA,closePath:XA}=or,ia=class extends D{get __tag(){return"Star"}__updatePath(){let{width:e,height:t,corners:n,innerRadius:i}=this.__,s=e/2,a=t/2,h=this.__.path=[];YA(h,s,0);for(let l=1;l<2*n;l++)VA(h,s+(l%2==0?s:s*i)*HA(l*rv/n),a-(l%2==0?a:a*i)*UA(l*rv/n));XA(h)}};L([Ie(cf)],ia.prototype,"__",void 0),L([He(5)],ia.prototype,"corners",void 0),L([He(.382)],ia.prototype,"innerRadius",void 0),ia=L([Re()],ia);var{moveTo:GA,lineTo:KA,drawPoints:qA}=or,{rotate:jA,getAngle:ZA,getDistance:$A,defaultPoint:sv}=j,qe=class extends D{get __tag(){return"Line"}get toPoint(){let{width:e,rotation:t}=this.__,n=Ko();return e&&(n.x=e),t&&jA(n,t),n}set toPoint(e){this.width=$A(sv,e),this.rotation=ZA(sv,e),this.height&&(this.height=0)}__updatePath(){let e=this.__,t=e.path=[];e.points?qA(t,e.points,e.curve,e.closed):(GA(t,0,0),KA(t,this.width,0))}};L([Ie(Bl)],qe.prototype,"__",void 0),L([$o("center")],qe.prototype,"strokeAlign",void 0),L([Tt(0)],qe.prototype,"height",void 0),L([He()],qe.prototype,"points",void 0),L([He(0)],qe.prototype,"curve",void 0),L([He(!1)],qe.prototype,"closed",void 0),qe=L([Re()],qe);var Us=class extends Oe{get __tag(){return"Image"}get ready(){let{image:e}=this;return e&&e.ready}get image(){let{fill:e}=this.__;return Ct(e)&&e[0].image}};L([Ie(pf)],Us.prototype,"__",void 0),L([Tt("")],Us.prototype,"url",void 0),Us=L([Re()],Us);var Mi=class extends Oe{get __tag(){return"Canvas"}get context(){return this.canvas.context}get ready(){return!this.url}constructor(e){super(e),this.canvas=$t.canvas(this.__),e&&e.url&&this.drawImage(e.url)}drawImage(e){new Wr({url:e}).load(t=>{this.context.drawImage(t.view,0,0),this.url=void 0,this.paint(),this.emitEvent(new vn(vn.LOADED,{image:t}))})}draw(e,t,n,i){let s=new ye(e.worldTransform).invert(),a=new ye;t&&a.translate(t.x,t.y),n&&(Dt(n)?a.scale(n):a.scale(n.x,n.y)),i&&a.rotate(i),s.multiplyParent(a),e.__render(this.canvas,{matrix:s.withScale()}),this.paint()}paint(){this.forceRender()}__drawContent(e,t){let{width:n,height:i}=this.__,{view:s}=this.canvas;e.drawImage(s,0,0,s.width,s.height,0,0,n,i)}__updateSize(){let{canvas:e}=this;if(e){let{smooth:t,safeResize:n}=this.__;e.resize(this.__,n),e.smooth!==t&&(e.smooth=t)}}destroy(){this.canvas&&(this.canvas.destroy(),this.canvas=null),super.destroy()}};L([Ie(gf)],Mi.prototype,"__",void 0),L([Qo(100)],Mi.prototype,"width",void 0),L([Qo(100)],Mi.prototype,"height",void 0),L([Qo(1)],Mi.prototype,"pixelRatio",void 0),L([Qo(!0)],Mi.prototype,"smooth",void 0),L([Jt(!1)],Mi.prototype,"safeResize",void 0),L([Qo()],Mi.prototype,"contextSettings",void 0),Mi=L([Re()],Mi);var{copyAndSpread:JA,includes:QA,spread:tk,setList:ek}=X,{stintSet:sf}=vt,st=class extends D{get __tag(){return"Text"}get textDrawData(){return this.updateLayout(),this.__.__textDrawData}__updateTextDrawData(){let e=this.__,{lineHeight:t,letterSpacing:n,fontFamily:i,fontSize:s,fontWeight:a,italic:h,textCase:l,textOverflow:u,padding:f,width:g,height:p}=e;e.__lineHeight=Zy.number(t,s),e.__letterSpacing=Zy.number(n,s),e.__baseLine=e.__lineHeight-(e.__lineHeight-.7*s)/2,e.__font=`${h?"italic ":""}${l==="small-caps"?"small-caps ":""}${a!=="normal"?a+" ":""}${s||12}px ${i||"caption"}`,sf(e,"__padding",f&&Kt.fourNumber(f)),sf(e,"__clipText",u!=="show"&&!e.__autoSize),sf(e,"__isCharMode",g||p||e.__letterSpacing||l!=="none"),e.__textDrawData=mf.getDrawData((e.__isPlacehold=e.placeholder&&e.text==="")?e.placeholder:e.text,this.__)}__updateBoxBounds(){let e=this.__,t=this.__layout,{fontSize:n,italic:i,padding:s,__autoWidth:a,__autoHeight:h}=e;this.__updateTextDrawData();let{bounds:l}=e.__textDrawData,u=t.boxBounds;if(t.contentBounds=l,e.__lineHeight<n&&tk(l,n/2),a||h){if(u.x=a?l.x:0,u.y=h?l.y:0,u.width=a?l.width:e.width,u.height=h?l.height:e.height,s){let[f,g,p,v]=e.__padding;a&&(u.x-=v,u.width+=g+v),h&&(u.y-=f,u.height+=p+f)}this.__updateNaturalSize()}else super.__updateBoxBounds();i&&(u.width+=.16*n),vt.stintSet(this,"isOverflow",!QA(u,l)),this.isOverflow?(ek(e.__textBoxBounds={},[u,l]),t.renderChanged=!0):e.__textBoxBounds=u}__updateRenderSpread(){let e=super.__updateRenderSpread();return e||(e=this.isOverflow?1:0),e}__updateRenderBounds(){let{renderBounds:e,renderSpread:t}=this.__layout;JA(e,this.__.__textBoxBounds,t),this.__box&&(this.__box.__layout.renderBounds=e)}__updateChange(){super.__updateChange();let e=this.__box;e&&(e.__onUpdateSize(),e.__updateChange())}__drawRenderPath(e){e.font=this.__.__font}__draw(e,t,n){let i=this.__box;i&&(i.__nowWorld=this.__nowWorld,i.__draw(e,t,n)),this.textEditing&&!t.exporting||super.__draw(e,t,n)}__drawShape(e,t){t.shape&&this.__box&&this.__box.__drawShape(e,t),super.__drawShape(e,t)}destroy(){this.boxStyle&&(this.boxStyle=null),super.destroy()}};L([Ie(ff)],st.prototype,"__",void 0),L([Tt(0)],st.prototype,"width",void 0),L([Tt(0)],st.prototype,"height",void 0),L([Jn()],st.prototype,"boxStyle",void 0),L([Jt(!1)],st.prototype,"resizeFontSize",void 0),L([Jn("#000000")],st.prototype,"fill",void 0),L([$o("outside")],st.prototype,"strokeAlign",void 0),L([hr("all")],st.prototype,"hitFill",void 0),L([Tt("")],st.prototype,"text",void 0),L([Tt("")],st.prototype,"placeholder",void 0),L([Tt("caption")],st.prototype,"fontFamily",void 0),L([Tt(12)],st.prototype,"fontSize",void 0),L([Tt("normal")],st.prototype,"fontWeight",void 0),L([Tt(!1)],st.prototype,"italic",void 0),L([Tt("none")],st.prototype,"textCase",void 0),L([Tt("none")],st.prototype,"textDecoration",void 0),L([Tt(0)],st.prototype,"letterSpacing",void 0),L([Tt({type:"percent",value:1.5})],st.prototype,"lineHeight",void 0),L([Tt(0)],st.prototype,"paraIndent",void 0),L([Tt(0)],st.prototype,"paraSpacing",void 0),L([Tt("x")],st.prototype,"writingMode",void 0),L([Tt("left")],st.prototype,"textAlign",void 0),L([Tt("top")],st.prototype,"verticalAlign",void 0),L([Tt(!0)],st.prototype,"autoSizeAlign",void 0),L([Tt("normal")],st.prototype,"textWrap",void 0),L([Tt("show")],st.prototype,"textOverflow",void 0),L([Jn(!1)],st.prototype,"textEditing",void 0),st=L([Re()],st);var Hr=class extends D{get __tag(){return"Path"}};L([Ie(uf)],Hr.prototype,"__",void 0),L([$o("center")],Hr.prototype,"strokeAlign",void 0),Hr=L([Re()],Hr);var Tl=class extends zt{get __tag(){return"Pen"}setStyle(e){let t=this.pathElement=new Hr(e);return this.pathStyle=e,this.__path=t.path||(t.path=[]),this.add(t),this}beginPath(){return this}moveTo(e,t){return this}lineTo(e,t){return this}bezierCurveTo(e,t,n,i,s,a){return this}quadraticCurveTo(e,t,n,i){return this}closePath(){return this}rect(e,t,n,i){return this}roundRect(e,t,n,i,s){return this}ellipse(e,t,n,i,s,a,h,l){return this}arc(e,t,n,i,s,a){return this}arcTo(e,t,n,i,s){return this}drawEllipse(e,t,n,i,s,a,h,l){return this}drawArc(e,t,n,i,s,a){return this}drawPoints(e,t,n){return this}clearPath(){return this}paint(){this.pathElement.__layout.boxChanged||this.pathElement.forceUpdate("path")}};L([Ie(df)],Tl.prototype,"__",void 0),L([(e,t)=>{En(e,t,{get(){return this.__path}})}],Tl.prototype,"path",void 0),Tl=L([nn(Go,["set","path","paint"]),Re()],Tl);function mi(e,t,n,i){var s,a=arguments.length,h=a<3?t:i===null?i=Object.getOwnPropertyDescriptor(t,n):i;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")h=Reflect.decorate(e,t,n,i);else for(var l=e.length-1;l>=0;l--)(s=e[l])&&(h=(a<3?s(h):a>3?s(t,n,h):s(t,n))||h);return a>3&&h&&Object.defineProperty(t,n,h),h}var Ol=class extends Qn{get __tag(){return"App"}get isApp(){return!0}constructor(e,t){super(e,t)}init(e,t){if(super.init(e,t),e){let{ground:n,tree:i,sky:s,editor:a}=e;n&&(this.ground=this.addLeafer(n)),(i||a)&&(this.tree=this.addLeafer(i||{type:e.type||"design"})),(s||a)&&(this.sky=this.addLeafer(s)),a&&$t.editor(a,this)}}__setApp(){let{canvas:e}=this,{realCanvas:t,view:n}=this.config;t||n===this.canvas.view||!e.parentView?this.realCanvas=!0:e.unrealCanvas(),this.leafer=this,this.watcher.disable(),this.layouter.disable()}__updateLocalBounds(){this.forEach(e=>e.updateLayout()),super.__updateLocalBounds()}start(){super.start(),this.forEach(e=>e.start())}stop(){this.forEach(e=>e.stop()),super.stop()}unlockLayout(){super.unlockLayout(),this.forEach(e=>e.unlockLayout())}lockLayout(){super.lockLayout(),this.forEach(e=>e.lockLayout())}forceRender(e,t){this.forEach(n=>n.forceRender(e,t))}addLeafer(e){let t=new Qn(e);return this.add(t),t}add(e,t){if(!e.view){if(this.realCanvas&&!this.canvas.bounds)return void setTimeout(()=>this.add(e,t),10);e.init(this.__getChildConfig(e.userConfig),this)}super.add(e,t),J(t)||(e.canvas.childIndex=t),this.__listenChildEvents(e)}forEach(e){this.children.forEach(e)}__onCreated(){this.created=this.children.every(e=>e.created)}__onReady(){this.children.every(e=>e.ready)&&super.__onReady()}__onViewReady(){this.children.every(e=>e.viewReady)&&super.__onViewReady()}__onChildRenderEnd(e){this.renderer.addBlock(e.renderBounds),this.viewReady&&this.renderer.update()}__render(e,t){e.context&&this.forEach(n=>t.matrix?n.__render(e,t):e.copyWorld(n.canvas,t.bounds))}__onResize(e){this.forEach(t=>t.resize(e)),super.__onResize(e)}updateLayout(){this.forEach(e=>e.updateLayout())}__getChildConfig(e){let t=Object.assign({},this.config);return t.hittable=t.realCanvas=void 0,e&&vt.assign(t,e),this.autoLayout&&vt.copyAttrs(t,this,sn),t.view=this.realCanvas?void 0:this.view,t.fill=void 0,t}__listenChildEvents(e){e.once([[St.END,this.__onReady,this],[yt.START,this.__onCreated,this],[yt.END,this.__onViewReady,this]]),this.realCanvas&&this.__eventIds.push(e.on_(yt.END,this.__onChildRenderEnd,this))}};Ol=mi([Re()],Ol);var Rl={},Xs={isHoldSpaceKey:()=>Xs.isHold("Space"),isHold:e=>Rl[e],isHoldKeys:(e,t)=>t?e(t):void 0,setDownCode(e){Rl[e]||(Rl[e]=!0)},setUpCode(e){Rl[e]=!1}},ti={LEFT:1,RIGHT:2,MIDDLE:4,defaultLeft(e){e.buttons||(e.buttons=1)},left:e=>e.buttons===1,right:e=>e.buttons===2,middle:e=>e.buttons===4},ca=class extends Ke{get spaceKey(){return Xs.isHoldSpaceKey()}get left(){return ti.left(this)}get right(){return ti.right(this)}get middle(){return ti.middle(this)}constructor(t){super(t.type),this.bubbles=!0,Object.assign(this,t)}isHoldKeys(t){return Xs.isHoldKeys(t,this)}getBoxPoint(t){return(t||this.current).getBoxPoint(this)}getInnerPoint(t){return(t||this.current).getInnerPoint(this)}getLocalPoint(t){return(t||this.current).getLocalPoint(this)}getPagePoint(){return this.current.getPagePoint(this)}getInner(t){return this.getInnerPoint(t)}getLocal(t){return this.getLocalPoint(t)}getPage(){return this.getPagePoint()}static changeName(t,n){zr.changeName(t,n)}},{min:av,max:yf,abs:hv}=Math,{float:hn,sign:lv}=Kt,{minX:cv,maxX:uv,minY:dv,maxY:fv}=X,ue=new It,Ii=new It,Ur={limitMove(e,t){let{dragBounds:n,dragBoundsType:i}=e;n&&zi.getValidMove(e.__localBoxBounds,zi.getDragBounds(e),i,t,!0),zi.axisMove(e,t)},limitScaleOf(e,t,n,i){let{dragBounds:s,dragBoundsType:a}=e;s&&zi.getValidScaleOf(e.__localBoxBounds,zi.getDragBounds(e),a,e.getLocalPointByInner(e.getInnerPointByBox(t)),n,i,!0)},axisMove(e,t){let{draggable:n}=e;n==="x"&&(t.y=0),n==="y"&&(t.x=0)},getDragBounds(e){let{dragBounds:t}=e;return t==="parent"?e.parent.boxBounds:t},isInnerMode:(e,t,n,i)=>n==="inner"||n==="auto"&&e[i]>t[i],getValidMove(e,t,n,i,s){let a=e.x+i.x,h=e.y+i.y,l=a+e.width,u=h+e.height,f=t.x+t.width,g=t.y+t.height;return s||(i=Object.assign({},i)),zi.isInnerMode(e,t,n,"width")?a>t.x?i.x+=t.x-a:l<f&&(i.x+=f-l):a<t.x?i.x+=t.x-a:l>f&&(i.x+=f-l),zi.isInnerMode(e,t,n,"height")?h>t.y?i.y+=t.y-h:u<g&&(i.y+=g-u):h<t.y?i.y+=t.y-h:u>g&&(i.y+=g-u),i.x=hn(i.x),i.y=hn(i.y),i},getValidScaleOf(e,t,n,i,s,a,h){h||(s=Object.assign({},s)),Ii.set(t),ue.set(e).scaleOf(i,s.x,s.y);let l=(i.x-e.x)/e.width,u=1-l,f=(i.y-e.y)/e.height,g=1-f,p,v,w,E,P=1,S=1;return zi.isInnerMode(e,t,n,"width")?(s.x<0&&ue.scaleOf(i,P=1/s.x,1),w=hn(ue.minX-Ii.minX),E=hn(Ii.maxX-ue.maxX),p=l&&w>0?1+w/(l*ue.width):1,v=u&&E>0?1+E/(u*ue.width):1,P*=yf(p,v)):(s.x<0&&((hn(cv(e)-cv(t))<=0||hn(uv(t)-uv(e))<=0)&&ue.scaleOf(i,P=1/s.x,1),ue.unsign()),w=hn(Ii.minX-ue.minX),E=hn(ue.maxX-Ii.maxX),p=l&&w>0?1-w/(l*ue.width):1,v=u&&E>0?1-E/(u*ue.width):1,P*=av(p,v)),zi.isInnerMode(e,t,n,"height")?(s.y<0&&ue.scaleOf(i,1,S=1/s.y),w=hn(ue.minY-Ii.minY),E=hn(Ii.maxY-ue.maxY),p=f&&w>0?1+w/(f*ue.height):1,v=g&&E>0?1+E/(g*ue.height):1,S*=yf(p,v),a&&(p=yf(hv(P),hv(S)),P=lv(P)*p,S=lv(S)*p)):(s.y<0&&((hn(dv(e)-dv(t))<=0||hn(fv(t)-fv(e))<=0)&&ue.scaleOf(i,1,S=1/s.y),ue.unsign()),w=hn(Ii.minY-ue.minY),E=hn(ue.maxY-Ii.maxY),p=f&&w>0?1-w/(f*ue.height):1,v=g&&E>0?1-E/(g*ue.height):1,S*=av(p,v)),s.x*=wl(P)?P:1,s.y*=wl(S)?S:1,s}},zi=Ur,G=class extends ca{};G.POINTER="pointer",G.BEFORE_DOWN="pointer.before_down",G.BEFORE_MOVE="pointer.before_move",G.BEFORE_UP="pointer.before_up",G.DOWN="pointer.down",G.MOVE="pointer.move",G.UP="pointer.up",G.OVER="pointer.over",G.OUT="pointer.out",G.ENTER="pointer.enter",G.LEAVE="pointer.leave",G.TAP="tap",G.DOUBLE_TAP="double_tap",G.CLICK="click",G.DOUBLE_CLICK="double_click",G.LONG_PRESS="long_press",G.LONG_TAP="long_tap",G.MENU="pointer.menu",G.MENU_TAP="pointer.menu_tap",G=mi([gi()],G);var oa={},dt=class extends G{static setList(e){this.list=e instanceof Bt?e:new Bt(e)}static setData(e){this.data=e}static getValidMove(e,t,n,i=!0){let s=e.getLocalPoint(n,null,!0);return j.move(s,t.x-e.x,t.y-e.y),i&&this.limitMove(e,s),Ur.axisMove(e,s),s}static limitMove(e,t){Ur.limitMove(e,t)}getPageMove(e){return this.assignMove(e),this.current.getPagePoint(oa,null,!0)}getInnerMove(e,t){return e||(e=this.current),this.assignMove(t),e.getInnerPoint(oa,null,!0)}getLocalMove(e,t){return e||(e=this.current),this.assignMove(t),e.getLocalPoint(oa,null,!0)}getPageTotal(){return this.getPageMove(!0)}getInnerTotal(e){return this.getInnerMove(e,!0)}getLocalTotal(e){return this.getLocalMove(e,!0)}getPageBounds(){let e=this.getPageTotal(),t=this.getPagePoint(),n={};return X.set(n,t.x-e.x,t.y-e.y,e.x,e.y),X.unsign(n),n}assignMove(e){oa.x=e?this.totalX:this.moveX,oa.y=e?this.totalY:this.moveY}};dt.BEFORE_DRAG="drag.before_drag",dt.START="drag.start",dt.DRAG="drag",dt.END="drag.end",dt.OVER="drag.over",dt.OUT="drag.out",dt.ENTER="drag.enter",dt.LEAVE="drag.leave",dt=mi([gi()],dt);var la=class extends G{static setList(e){dt.setList(e)}static setData(e){dt.setData(e)}};la.DROP="drop",la=mi([gi()],la);var Ot=class extends dt{};Ot.BEFORE_MOVE="move.before_move",Ot.START="move.start",Ot.MOVE="move",Ot.DRAG_ANIMATE="move.drag_animate",Ot.END="move.end",Ot.PULL_DOWN="move.pull_down",Ot.REACH_BOTTOM="move.reach_bottom",Ot=mi([gi()],Ot);var pv=class extends ca{};pv=mi([gi()],pv);var Ue=class extends G{};Ue.BEFORE_ROTATE="rotate.before_rotate",Ue.START="rotate.start",Ue.ROTATE="rotate",Ue.END="rotate.end",Ue=mi([gi()],Ue);var ei=class extends dt{};ei.SWIPE="swipe",ei.LEFT="swipe.left",ei.RIGHT="swipe.right",ei.UP="swipe.up",ei.DOWN="swipe.down",ei=mi([gi()],ei);var pe=class extends G{};pe.BEFORE_ZOOM="zoom.before_zoom",pe.START="zoom.start",pe.ZOOM="zoom",pe.END="zoom.end",pe=mi([gi()],pe);var fe=class extends ca{};fe.BEFORE_DOWN="key.before_down",fe.BEFORE_UP="key.before_up",fe.DOWN="key.down",fe.HOLD="key.hold",fe.UP="key.up",fe=mi([gi()],fe);var Wn={getDragEventData:(e,t,n)=>Object.assign(Object.assign({},n),{x:n.x,y:n.y,moveX:n.x-t.x,moveY:n.y-t.y,totalX:n.x-e.x,totalY:n.y-e.y}),getDropEventData:(e,t,n)=>Object.assign(Object.assign({},e),{list:t,data:n}),getSwipeDirection:e=>e<-45&&e>-135?ei.UP:e>45&&e<135?ei.DOWN:e<=45&&e>=-45?ei.RIGHT:ei.LEFT,getSwipeEventData:(e,t,n)=>Object.assign(Object.assign({},n),{moveX:t.moveX,moveY:t.moveY,totalX:n.x-e.x,totalY:n.y-e.y,type:nk.getSwipeDirection(j.getAngle(e,n))}),getBase(e){let t=e.button===1?4:e.button;return{altKey:e.altKey,ctrlKey:e.ctrlKey,shiftKey:e.shiftKey,metaKey:e.metaKey,time:Date.now(),buttons:J(e.buttons)?1:e.buttons===0?t:e.buttons,origin:e}},pathHasEventType(e,t){let{list:n}=e;for(let i=0,s=n.length;i<s;i++)if(n[i].hasEvent(t))return!0;return!1},filterPathByEventType(e,t){let n=new Bt,{list:i}=e;for(let s=0,a=i.length;s<a;s++)i[s].hasEvent(t)&&n.add(i[s]);return n},pathCanDrag:e=>e&&e.list.some(t=>Vt.draggable(t)||!t.isLeafer&&t.hasEvent(dt.DRAG)),pathHasOutside:e=>e&&e.list.some(t=>t.isOutside)},nk=Wn,gv=new Bt,{getDragEventData:vf,getDropEventData:ik,getSwipeEventData:rk}=Wn,ua=class{constructor(t){this.dragDataList=[],this.interaction=t}setDragData(t){this.animateWait&&this.dragEndReal(),this.downData=this.interaction.downData,this.dragData=vf(t,t,t),this.canAnimate=this.canDragOut=!0}getList(t,n){let{proxy:i}=this.interaction.selector,s=i&&i.list.length,a=dt.list||this.draggableList||gv;return this.dragging&&(s?t?gv:new Bt(n?[...i.list,...i.dragHoverExclude]:i.list):a)}checkDrag(t,n){let{interaction:i}=this;if(this.moving&&t.buttons<1)return this.canAnimate=!1,void i.pointerCancel();!this.moving&&n&&(this.moving=i.canMove(this.downData)||i.isHoldRightKey||i.isMobileDragEmpty)&&(this.dragData.moveType="drag",i.emit(Ot.START,this.dragData)),this.moving||this.dragStart(t,n),this.drag(t)}dragStart(t,n){this.dragging||(this.dragging=n&&ti.left(t),this.dragging&&(this.interaction.emit(dt.START,this.dragData),this.getDraggableList(this.dragData.path),this.setDragStartPoints(this.realDraggableList=this.getList(!0))))}setDragStartPoints(t){this.dragStartPoints={},t.forEach(n=>this.dragStartPoints[n.innerId]={x:n.x,y:n.y})}getDraggableList(t){let n;for(let i=0,s=t.length;i<s;i++)if(n=t.list[i],Vt.draggable(n)){this.draggableList=new Bt(n);break}}drag(t){let{interaction:n,dragData:i,downData:s}=this,{path:a,throughPath:h}=s;this.dragData=vf(s,i,t),h&&(this.dragData.throughPath=h),this.dragData.path=a,this.dragDataList.push(this.dragData),this.moving?(t.moving=!0,this.dragData.moveType="drag",n.emit(Ot.BEFORE_MOVE,this.dragData),n.emit(Ot.MOVE,this.dragData)):this.dragging&&(t.dragging=!0,this.dragReal(),n.emit(dt.BEFORE_DRAG,this.dragData),n.emit(dt.DRAG,this.dragData))}dragReal(t){let{interaction:n}=this,{running:i}=n,s=this.realDraggableList;if(s.length&&i){let{totalX:a,totalY:h}=this.dragData,{dragLimitAnimate:l}=n.p,u=!l||!!t;s.forEach(f=>{if(f.draggable){let g=gt(f.draggable),p=dt.getValidMove(f,this.dragStartPoints[f.innerId],{x:a,y:h},u||g);l&&!g&&t?Vt.animateMove(f,p,Dt(l)?l:.3):f.move(p)}})}}dragOverOrOut(t){let{interaction:n}=this,{dragOverPath:i}=this,{path:s}=t;this.dragOverPath=s,i?s.indexAt(0)!==i.indexAt(0)&&(n.emit(dt.OUT,t,i),n.emit(dt.OVER,t,s)):n.emit(dt.OVER,t,s)}dragEnterOrLeave(t){let{interaction:n}=this,{dragEnterPath:i}=this,{path:s}=t;n.emit(dt.LEAVE,t,i,s),n.emit(dt.ENTER,t,s,i),this.dragEnterPath=s}dragEnd(t){(this.dragging||this.moving)&&(this.checkDragEndAnimate(t)||this.dragEndReal(t))}dragEndReal(t){let{interaction:n,downData:i,dragData:s}=this;t||(t=s);let{path:a,throughPath:h}=i,l=vf(i,t,t);if(h&&(l.throughPath=h),l.path=a,this.moving&&(this.moving=!1,l.moveType="drag",n.emit(Ot.END,l)),this.dragging){let u=this.getList();this.dragging=!1,n.p.dragLimitAnimate&&this.dragReal(!0),n.emit(dt.END,l),this.swipe(t,i,s,l),this.drop(t,u,this.dragEnterPath)}this.autoMoveCancel(),this.dragReset(),this.animate(null,"off")}swipe(t,n,i,s){let{interaction:a}=this;if(j.getDistance(n,t)>a.config.pointer.swipeDistance){let h=rk(n,i,s);this.interaction.emit(h.type,h)}}drop(t,n,i){let s=ik(t,n,dt.data);s.path=i,this.interaction.emit(la.DROP,s),this.interaction.emit(dt.LEAVE,t,i)}dragReset(){dt.list=dt.data=this.draggableList=this.dragData=this.downData=this.dragOverPath=this.dragEnterPath=null,this.dragDataList=[]}checkDragEndAnimate(t,n){return!1}animate(t,n){}stopAnimate(){}checkDragOut(t){}autoMoveOnDragOut(t){}autoMoveCancel(){}destroy(){this.dragReset()}},sk=Pt.get("emit"),ok=["move","zoom","rotate","key"];function _v(e,t,n,i,s){if(ok.some(a=>t.startsWith(a))&&e.__.hitChildren&&!Ev(e,s)){let a;for(let h=0,l=e.children.length;h<l;h++)a=e.children[h],!n.path.has(a)&&a.__.hittable&&bf(a,t,n,i,s)}}function bf(e,t,n,i,s){if(e.destroyed)return!1;if(e.__.hitSelf&&!Ev(e,s)&&(Rt.updateEventStyle&&!i&&Rt.updateEventStyle(e,t),e.hasEvent(t,i))){n.phase=i?1:e===n.target?2:3;let a=zr.get(t,n);if(e.emitEvent(a,i),a.isStop)return!0}return!1}function Ev(e,t){return t&&t.has(e)}var ak={wheel:{zoomSpeed:.5,moveSpeed:.5,rotateSpeed:.5,delta:{x:20,y:8}},pointer:{type:"pointer",snap:!0,hitRadius:5,tapTime:120,longPressTime:800,transformTime:500,hover:!0,dragHover:!0,dragDistance:2,swipeDistance:20},touch:{preventDefault:"auto"},multiTouch:{},move:{autoDistance:2},zoom:{},cursor:!0,keyEvent:!0},{pathHasEventType:wf,pathCanDrag:hk,pathHasOutside:mv}=Wn,Gs=class{get dragging(){return this.dragger.dragging}get transforming(){return this.transformer.transforming}get moveMode(){return this.m.drag===!0||this.isHoldSpaceKey||this.isHoldMiddleKey||this.isHoldRightKey&&this.dragger.moving||this.isDragEmpty}get canHover(){return this.p.hover&&!this.config.mobile}get isDragEmpty(){return this.m.dragEmpty&&this.isRootPath(this.hoverData)&&(!this.downData||this.isRootPath(this.downData))}get isMobileDragEmpty(){return this.m.dragEmpty&&!this.canHover&&this.downData&&this.isTreePath(this.downData)}get isHoldMiddleKey(){return this.m.holdMiddleKey&&this.downData&&ti.middle(this.downData)}get isHoldRightKey(){return this.m.holdRightKey&&this.downData&&ti.right(this.downData)}get isHoldSpaceKey(){return this.m.holdSpaceKey&&Xs.isHoldSpaceKey()}get m(){return this.config.move}get p(){return this.config.pointer}get hitRadius(){return this.p.hitRadius}constructor(t,n,i,s){this.config=vt.clone(ak),this.tapCount=0,this.downKeyMap={},this.target=t,this.canvas=n,this.selector=i,this.defaultPath=new Bt(t),this.createTransformer(),this.dragger=new ua(this),s&&(this.config=vt.default(s,this.config)),this.__listenEvents()}start(){this.running=!0}stop(){this.running=!1}receive(t){}pointerDown(t,n){t||(t=this.hoverData),t&&(ti.defaultLeft(t),this.updateDownData(t),this.checkPath(t,n),this.downTime=Date.now(),this.emit(G.BEFORE_DOWN,t),this.emit(G.DOWN,t),ti.left(t)&&(this.tapWait(),this.longPressWait(t)),this.waitRightTap=ti.right(t),this.dragger.setDragData(t),this.isHoldRightKey||this.updateCursor(t))}pointerMove(t){if(t||(t=this.hoverData),!t)return;let{downData:n}=this;n&&ti.defaultLeft(t),(this.canvas.bounds.hitPoint(t)||n)&&(this.pointerMoveReal(t),n&&this.dragger.checkDragOut(t))}pointerMoveReal(t){if(this.emit(G.BEFORE_MOVE,t,this.defaultPath),this.downData){let n=j.getDistance(this.downData,t)>this.p.dragDistance;n&&(this.pointerWaitCancel(),this.waitRightTap=!1),this.dragger.checkDrag(t,n)}this.dragger.moving||(this.updateHoverData(t),this.checkPath(t),this.emit(G.MOVE,t),this.pointerHover(t),this.dragging&&(this.dragger.dragOverOrOut(t),this.dragger.dragEnterOrLeave(t))),this.updateCursor(this.downData||t)}pointerUp(t){let{downData:n}=this;if(t||(t=n),!n)return;ti.defaultLeft(t),t.multiTouch=n.multiTouch,this.findPath(t);let i=Object.assign(Object.assign({},t),{path:t.path.clone()});t.path.addList(n.path.list),this.checkPath(t),this.downData=null,this.emit(G.BEFORE_UP,t),this.emit(G.UP,t),this.touchLeave(t),t.isCancel||(this.tap(t),this.menuTap(t)),this.dragger.dragEnd(t),this.updateCursor(i)}pointerCancel(){let t=Object.assign({},this.dragger.dragData);t.isCancel=!0,this.pointerUp(t)}menu(t){this.findPath(t),this.emit(G.MENU,t),this.waitMenuTap=!0,!this.downData&&this.waitRightTap&&this.menuTap(t)}menuTap(t){this.waitRightTap&&this.waitMenuTap&&(this.emit(G.MENU_TAP,t),this.waitRightTap=this.waitMenuTap=!1)}createTransformer(){}move(t){}zoom(t){}rotate(t){}transformEnd(){}wheel(t){}multiTouch(t,n){}keyDown(t){if(!this.config.keyEvent)return;this.emit(fe.BEFORE_DOWN,t,this.defaultPath);let{code:n}=t;this.downKeyMap[n]||(this.downKeyMap[n]=!0,Xs.setDownCode(n),this.emit(fe.HOLD,t,this.defaultPath),this.moveMode&&(this.cancelHover(),this.updateCursor())),this.emit(fe.DOWN,t,this.defaultPath)}keyUp(t){if(!this.config.keyEvent)return;this.emit(fe.BEFORE_UP,t,this.defaultPath);let{code:n}=t;this.downKeyMap[n]=!1,Xs.setUpCode(n),this.emit(fe.UP,t,this.defaultPath),this.cursor==="grab"&&this.updateCursor()}pointerHover(t){!this.canHover||this.dragging&&!this.p.dragHover||(t.path||(t.path=new Bt),this.pointerOverOrOut(t),this.pointerEnterOrLeave(t))}pointerOverOrOut(t){let{path:n}=t,{overPath:i}=this;this.overPath=n,i?n.indexAt(0)!==i.indexAt(0)&&(this.emit(G.OUT,t,i),this.emit(G.OVER,t,n)):this.emit(G.OVER,t,n)}pointerEnterOrLeave(t){let{path:n}=t;this.downData&&!this.moveMode&&(n=n.clone(),this.downData.path.forEach(s=>n.add(s)));let{enterPath:i}=this;this.enterPath=n,this.emit(G.LEAVE,t,i,n),this.emit(G.ENTER,t,n,i)}touchLeave(t){t.pointerType==="touch"&&this.enterPath&&(this.emit(G.LEAVE,t),this.dragger.dragging&&this.emit(la.LEAVE,t))}tap(t){let{pointer:n}=this.config,i=this.longTap(t);if(!n.tapMore&&i||!this.waitTap)return;n.tapMore&&this.emitTap(t);let s=Date.now()-this.downTime,a=[G.DOUBLE_TAP,G.DOUBLE_CLICK].some(h=>wf(t.path,h));s<n.tapTime+50&&a?(this.tapCount++,this.tapCount===2?(this.tapWaitCancel(),this.emitDoubleTap(t)):(clearTimeout(this.tapTimer),this.tapTimer=setTimeout(()=>{n.tapMore||(this.tapWaitCancel(),this.emitTap(t))},n.tapTime))):n.tapMore||(this.tapWaitCancel(),this.emitTap(t))}findPath(t,n){let{hitRadius:i,through:s}=this.p,{bottomList:a,target:h}=this;N.backgrounder||t.origin||h&&h.updateLayout();let l=this.selector.getByPoint(t,i,Object.assign({bottomList:a,name:t.type},n||{through:s}));return l.throughPath&&(t.throughPath=l.throughPath),t.path=l.path,l.path}isRootPath(t){return t&&t.path.list[0].isLeafer}isTreePath(t){let n=this.target.app;return!(!n||!n.isApp)&&n.editor&&!t.path.has(n.editor)&&t.path.has(n.tree)&&!t.target.syncEventer}checkPath(t,n){(n||this.moveMode&&!mv(t.path))&&(t.path=this.defaultPath)}canMove(t){return t&&(this.moveMode||this.m.drag==="auto"&&!hk(t.path))&&!mv(t.path)}isDrag(t){return this.dragger.getList().has(t)}isPress(t){return this.downData&&this.downData.path.has(t)}isHover(t){return this.enterPath&&this.enterPath.has(t)}isFocus(t){return this.focusData===t}cancelHover(){let{hoverData:t}=this;t&&(t.path=this.defaultPath,this.pointerHover(t))}stopDragAnimate(){this.dragger.stopAnimate()}updateDownData(t,n,i){let{downData:s}=this;!t&&s&&(t=s),t&&(this.findPath(t,n),i&&s&&t.path.addList(s.path.list),this.downData=t)}updateHoverData(t){t||(t=this.hoverData),t&&(this.findPath(t,{exclude:this.dragger.getList(!1,!0),name:G.MOVE}),this.hoverData=t)}updateCursor(t){if(!this.config.cursor||!this.canHover)return;if(t||(this.updateHoverData(),t=this.downData||this.hoverData),this.dragger.moving)return this.setCursor("grabbing");if(this.canMove(t))return this.setCursor(this.downData?"grabbing":"grab");if(!t)return;let n,i,{path:s}=t;for(let a=0,h=s.length;a<h&&(n=s.list[a],i=n.syncEventer&&n.syncEventer.cursor||n.cursor,!i);a++);this.setCursor(i)}setCursor(t){this.cursor=t}getLocal(t,n){let i=this.canvas.getClientBounds(n),s={x:t.clientX-i.x,y:t.clientY-i.y},{bounds:a}=this.canvas;return s.x*=a.width/i.width,s.y*=a.height/i.height,this.p.snap&&j.round(s),s}emitTap(t){this.emit(G.TAP,t),this.emit(G.CLICK,t)}emitDoubleTap(t){this.emit(G.DOUBLE_TAP,t),this.emit(G.DOUBLE_CLICK,t)}pointerWaitCancel(){this.tapWaitCancel(),this.longPressWaitCancel()}tapWait(){clearTimeout(this.tapTimer),this.waitTap=!0}tapWaitCancel(){this.waitTap&&(clearTimeout(this.tapTimer),this.waitTap=!1,this.tapCount=0)}longPressWait(t){clearTimeout(this.longPressTimer),this.longPressTimer=setTimeout(()=>{this.longPressed=!0,this.emit(G.LONG_PRESS,t)},this.p.longPressTime)}longTap(t){let n;return this.longPressed&&(this.emit(G.LONG_TAP,t),(wf(t.path,G.LONG_TAP)||wf(t.path,G.LONG_PRESS))&&(n=!0)),this.longPressWaitCancel(),n}longPressWaitCancel(){this.longPressTimer&&(clearTimeout(this.longPressTimer),this.longPressed=!1)}__onResize(){let{dragOut:t}=this.m;this.shrinkCanvasBounds=new It(this.canvas.bounds),this.shrinkCanvasBounds.spread(-(Dt(t)?t:2))}__listenEvents(){let{target:t}=this;this.__eventIds=[t.on_(an.RESIZE,this.__onResize,this)],t.once(wt.READY,()=>this.__onResize())}__removeListenEvents(){this.target.off_(this.__eventIds),this.__eventIds.length=0}emit(t,n,i,s){this.running&&function(a,h,l,u){if(!l&&!h.path)return;let f;h.type=a,l?h=Object.assign(Object.assign({},h),{path:l}):l=h.path,h.target=l.indexAt(0);try{for(let g=l.length-1;g>-1;g--){if(f=l.list[g],bf(f,a,h,!0,u))return;f.isApp&&_v(f,a,h,!0,u)}for(let g=0,p=l.length;g<p;g++)if(f=l.list[g],f.isApp&&_v(f,a,h,!1,u),bf(f,a,h,!1,u))return}catch(g){sk.error(g)}}(t,n,i,s)}destroy(){this.__eventIds.length&&(this.stop(),this.__removeListenEvents(),this.dragger.destroy(),this.transformer&&this.transformer.destroy(),this.downData=this.overPath=this.enterPath=null)}},Sv=(()=>{class e{static set(n,i){this.custom[n]=i}static get(n){return this.custom[n]}}return e.custom={},e})(),Al=class extends ks{constructor(){super(...arguments),this.maxTotal=1e3,this.pathList=new Bt,this.pixelList=new Bt}getPixelType(t,n){return this.__autoClear(),this.pixelList.add(t),$t.hitCanvas(n)}getPathType(t){return this.__autoClear(),this.pathList.add(t),$t.hitCanvas()}clearImageType(){this.__clearLeafList(this.pixelList)}clearPathType(){this.__clearLeafList(this.pathList)}__clearLeafList(t){t.length&&(t.forEach(n=>{n.__hitCanvas&&(n.__hitCanvas.destroy(),n.__hitCanvas=null)}),t.reset())}__autoClear(){this.pathList.length+this.pixelList.length>this.maxTotal&&this.clear()}clear(){this.clearPathType(),this.clearImageType()}};N.getSelector=function(e){return e.leafer?e.leafer.selector:N.selector||(N.selector=$t.selector())};var{toInnerRadiusPointOf:lk,copyRadiusPoint:yv}=j,{hitRadiusPoint:ck,hitPoint:uk}=X,aa={},ha={},Vs=fi.prototype;Vs.hit=function(e,t=0){this.updateLayout(),yv(ha,e,t);let n=this.__world;return!!(t?ck(n,ha):uk(n,ha))&&(this.isBranch?N.getSelector(this).hitPoint(Object.assign({},ha),t,{target:this}):this.__hitWorld(ha))},Vs.__hitWorld=function(e,t){let n=this.__;if(!n.hitSelf)return!1;let i=this.__world,s=this.__layout,a=i.width<10&&i.height<10;if(n.hitRadius&&(yv(aa,e,n.hitRadius),e=aa),lk(e,i,aa),n.hitBox||a){if(X.hitRadiusPoint(s.boxBounds,aa))return!0;if(a)return!1}return!s.hitCanvasChanged&&this.__hitCanvas||(this.__updateHitCanvas(),s.boundsChanged||(s.hitCanvasChanged=!1)),this.__hit(aa,t)},Vs.__hitFill=function(e){let t=this.__hitCanvas;return t&&t.hitFill(e,this.__.windingRule)},Vs.__hitStroke=function(e,t){let n=this.__hitCanvas;return n&&n.hitStroke(e,t)},Vs.__hitPixel=function(e){let t=this.__hitCanvas;return t&&t.hitPixel(e,this.__layout.renderBounds,t.hitScale)},Vs.__drawHitPath=function(e){e&&this.__drawRenderPath(e)};var dk=new ye,vv=D.prototype;vv.__updateHitCanvas=function(){this.__box&&this.__box.__updateHitCanvas();let{hitCanvasManager:e}=this.leafer||this.parent&&this.parent.leafer||{};if(!e)return;let t=this.__,n=(t.__isAlphaPixelFill||t.__isCanvas)&&t.hitFill==="pixel",i=t.__isAlphaPixelStroke&&t.hitStroke==="pixel",s=n||i;this.__hitCanvas||(this.__hitCanvas=s?e.getPixelType(this,{contextSettings:{willReadFrequently:!0}}):e.getPathType(this));let a=this.__hitCanvas;if(s){let{renderBounds:h}=this.__layout,l=N.image.hitCanvasSize,u=a.hitScale=sr.set(0,0,l,l).getFitMatrix(h).a,{x:f,y:g,width:p,height:v}=sr.set(h).scale(u);a.resize({width:p,height:v,pixelRatio:1}),a.clear(),on.patternLocked=!0,this.__renderShape(a,{matrix:dk.setWith(this.__world).scaleWith(1/u).invertWith().translate(-f,-g),ignoreFill:!n,ignoreStroke:!i}),on.patternLocked=!1,a.resetTransform(),t.__isHitPixel=!0}else t.__isHitPixel&&(t.__isHitPixel=!1);this.__drawHitPath(a),a.setStrokeOptions(t)},vv.__hit=function(e,t){if(this.__box&&this.__box.__hit(e))return!0;let n=this.__;if(n.__isHitPixel&&this.__hitPixel(e))return!0;let{hitFill:i}=n,s=(n.fill||n.__isCanvas)&&(i==="path"||i==="pixel"&&!(n.__isAlphaPixelFill||n.__isCanvas))||i==="all"||t;if(s&&this.__hitFill(e))return!0;let{hitStroke:a,__maxStrokeWidth:h}=n,l=n.stroke&&(a==="path"||a==="pixel"&&!n.__isAlphaPixelStroke)||a==="all";if(!s&&!l)return!1;let u=2*e.radiusX,f=u;if(l)switch(n.strokeAlign){case"inside":if(f+=2*h,!s&&this.__hitFill(e)&&this.__hitStroke(e,f))return!0;f=u;break;case"center":f+=h;break;case"outside":if(f+=2*h,!s){if(!this.__hitFill(e)&&this.__hitStroke(e,f))return!0;f=u}}return!!f&&this.__hitStroke(e,f)};var wv=D.prototype,xv=Oe.prototype,bv=ee.prototype;xv.__updateHitCanvas=bv.__updateHitCanvas=function(){this.stroke||this.cornerRadius||(this.fill||this.__.__isCanvas)&&this.hitFill==="pixel"||this.hitStroke==="all"?wv.__updateHitCanvas.call(this):this.__hitCanvas&&(this.__hitCanvas=null)},xv.__hitFill=bv.__hitFill=function(e){return this.__hitCanvas?wv.__hitFill.call(this,e):X.hitRadiusPoint(this.__layout.boxBounds,e)},st.prototype.__drawHitPath=function(e){let{__lineHeight:t,fontSize:n,__baseLine:i,__letterSpacing:s,__textDrawData:a}=this.__;e.beginPath(),s<0?this.__drawPathByBox(e):a.rows.forEach(h=>e.rect(h.x,h.y-i,h.width,t<n?n:t))},zt.prototype.pick=function(e,t){return t||(t=Cy),this.updateLayout(),N.getSelector(this).getByPoint(e,t.hitRadius||0,Object.assign(Object.assign({},t),{target:this}))};var xf=Ms.prototype;xf.hitFill=function(e,t){return t?this.context.isPointInPath(e.x,e.y,t):this.context.isPointInPath(e.x,e.y)},xf.hitStroke=function(e,t){return this.strokeWidth=t,this.context.isPointInStroke(e.x,e.y)},xf.hitPixel=function(e,t,n=1){let{x:i,y:s,radiusX:a,radiusY:h}=e;t&&(i-=t.x,s-=t.y),sr.set(i-a,s-h,2*a,2*h).scale(n).ceil();let{data:l}=this.context.getImageData(sr.x,sr.y,sr.width||1,sr.height||1);for(let u=0,f=l.length;u<f;u+=4)if(l[u+3]>0)return!0;return l[3]>0};var Cv;(function(e){e[e.none=1]="none",e[e.free=2]="free",e[e.mirrorAngle=3]="mirrorAngle",e[e.mirror=4]="mirror"})(Cv||(Cv={}));var Tv=Pt.get("LeaferCanvas"),Ul=class extends Ms{set zIndex(t){let{style:n}=this.view;n.zIndex=t,this.setAbsolute(this.view)}set childIndex(t){let{view:n,parentView:i}=this;if(n&&i){let s=i.children[t];s?(this.setAbsolute(s),i.insertBefore(n,s)):i.appendChild(s)}}init(){let{config:t}=this,n=t.view||t.canvas;n?this.__createViewFrom(n):this.__createView();let{style:i}=this.view;if(i.display||(i.display="block"),this.parentView=this.view.parentElement,this.parentView){let s=this.parentView.style;s.webkitUserSelect=s.userSelect="none",this.view.classList.add("leafer-canvas-view")}N.syncDomFont&&!this.parentView&&(i.display="none",document.body&&document.body.appendChild(this.view)),this.__createContext(),this.autoLayout||this.resize(t)}set backgroundColor(t){this.view.style.backgroundColor=t}get backgroundColor(){return this.view.style.backgroundColor}set hittable(t){this.view.style.pointerEvents=t?"auto":"none"}get hittable(){return this.view.style.pointerEvents!=="none"}__createView(){this.view=document.createElement("canvas")}__createViewFrom(t){let n=gt(t)?document.getElementById(t):t;if(n)if(n instanceof HTMLCanvasElement)this.view=n;else{let i=n;if(n===window||n===document){let a=document.createElement("div"),{style:h}=a;h.position="absolute",h.top=h.bottom=h.left=h.right="0px",document.body.appendChild(a),i=a}this.__createView();let s=this.view;i.hasChildNodes()&&(this.setAbsolute(s),i.style.position||(i.style.position="relative")),i.appendChild(s)}else Tv.error(`no id: ${t}`),this.__createView()}setAbsolute(t){let{style:n}=t;n.position="absolute",n.top=n.left="0px"}updateViewSize(){let{width:t,height:n,pixelRatio:i}=this,{style:s}=this.view;s.width=t+"px",s.height=n+"px",this.unreal||(this.view.width=Math.ceil(t*i),this.view.height=Math.ceil(n*i))}updateClientBounds(){this.view.parentElement&&(this.clientBounds=this.view.getBoundingClientRect())}startAutoLayout(t,n){if(this.resizeListener=n,t){if(this.autoBounds=t,this.resizeObserver)return;try{this.resizeObserver=new ResizeObserver(s=>{this.updateClientBounds();for(let a of s)this.checkAutoBounds(a.contentRect)});let i=this.parentView;i?(this.resizeObserver.observe(i),this.checkAutoBounds(i.getBoundingClientRect())):(this.checkAutoBounds(this.view),Tv.warn("no parent"))}catch{this.imitateResizeObserver()}this.stopListenPixelRatio()}else this.listenPixelRatio(),this.unreal&&this.updateViewSize()}imitateResizeObserver(){this.autoLayout&&(this.parentView&&this.checkAutoBounds(this.parentView.getBoundingClientRect()),N.requestRender(this.imitateResizeObserver.bind(this)))}listenPixelRatio(){this.windowListener||window.addEventListener("resize",this.windowListener=()=>{let t=N.devicePixelRatio;if(!this.config.pixelRatio&&this.pixelRatio!==t){let{width:n,height:i}=this;this.emitResize({width:n,height:i,pixelRatio:t})}})}stopListenPixelRatio(){this.windowListener&&(window.removeEventListener("resize",this.windowListener),this.windowListener=null)}checkAutoBounds(t){let n=this.view,{x:i,y:s,width:a,height:h}=this.autoBounds.getBoundsFrom(t),l={width:a,height:h,pixelRatio:this.config.pixelRatio?this.pixelRatio:N.devicePixelRatio};if(!this.isSameSize(l)){let{style:u}=n;u.marginLeft=i+"px",u.marginTop=s+"px",this.emitResize(l)}}stopAutoLayout(){this.autoLayout=!1,this.resizeObserver&&this.resizeObserver.disconnect(),this.resizeListener=this.resizeObserver=null}emitResize(t){let n={};vt.copyAttrs(n,this,sn),this.resize(t),this.resizeListener&&!J(this.width)&&this.resizeListener(new an(t,n))}unrealCanvas(){if(!this.unreal&&this.parentView){let t=this.view;t&&t.remove(),t=this.view=document.createElement("div"),this.parentView.appendChild(this.view),t.classList.add("leafer-app-view"),this.unreal=!0}}destroy(){let{view:t}=this;t&&(this.stopAutoLayout(),this.stopListenPixelRatio(),t.parentElement&&t.remove(),super.destroy())}};$d(CanvasRenderingContext2D.prototype),$d(Path2D.prototype);var{mineType:Ef,fileType:fk}=As;function pk(e,t){N.origin={createCanvas(n,i){let s=document.createElement("canvas");return s.width=n,s.height=i,s},canvasToDataURL:(n,i,s)=>{let a=Ef(i),h=n.toDataURL(a,s);return a==="image/bmp"?h.replace("image/png;","image/bmp;"):h},canvasToBolb:(n,i,s)=>new Promise(a=>n.toBlob(a,Ef(i),s)),canvasSaveAs:(n,i,s)=>{let a=n.toDataURL(Ef(fk(i)),s);return N.origin.download(a,i)},download:(n,i)=>new Promise(s=>{let a=document.createElement("a");a.href=n,a.download=i,document.body.appendChild(a),a.click(),document.body.removeChild(a),s()}),loadImage:n=>new Promise((i,s)=>{let a=new N.origin.Image,{crossOrigin:h}=N.image;h&&(a.setAttribute("crossOrigin",h),a.crossOrigin=h),a.onload=()=>{i(a)},a.onerror=l=>{s(l)},a.src=N.image.getRealURL(n)}),Image,PointerEvent,DragEvent},N.event={stopDefault(n){n.preventDefault()},stopNow(n){n.stopImmediatePropagation()},stop(n){n.stopPropagation()}},N.canvas=$t.canvas(),N.conicGradientSupport=!!N.canvas.context.createConicGradient}Object.assign($t,{canvas:(e,t)=>new Ul(e,t),image:e=>new Wr(e)}),N.name="web",N.isMobile="ontouchstart"in window,N.requestRender=function(e){window.requestAnimationFrame(e)},En(N,"devicePixelRatio",{get:()=>devicePixelRatio});var{userAgent:kl}=navigator;kl.indexOf("Firefox")>-1?(N.conicGradientRotate90=!0,N.intWheelDeltaY=!0,N.syncDomFont=!0):(/iPhone|iPad|iPod/.test(navigator.userAgent)||/Macintosh/.test(navigator.userAgent)&&/Version\/[\d.]+.*Safari/.test(navigator.userAgent))&&(N.fullImageShadow=!0),kl.indexOf("Windows")>-1?(N.os="Windows",N.intWheelDeltaY=!0):kl.indexOf("Mac")>-1?N.os="Mac":kl.indexOf("Linux")>-1&&(N.os="Linux");var Uf=class{get childrenChanged(){return this.hasAdd||this.hasRemove||this.hasVisible}get updatedList(){if(this.hasRemove&&this.config.usePartLayout){let t=new Bt;return this.__updatedList.list.forEach(n=>{n.leafer&&t.add(n)}),t}return this.__updatedList}constructor(t,n){this.totalTimes=0,this.config={},this.__updatedList=new Bt,this.target=t,n&&(this.config=vt.default(n,this.config)),this.__listenEvents()}start(){this.disabled||(this.running=!0)}stop(){this.running=!1}disable(){this.stop(),this.__removeListenEvents(),this.disabled=!0}update(){this.changed=!0,this.running&&this.target.emit(yt.REQUEST)}__onAttrChange(t){this.config.usePartLayout&&this.__updatedList.add(t.target),this.update()}__onChildEvent(t){this.config.usePartLayout&&(t.type===le.ADD?(this.hasAdd=!0,this.__pushChild(t.child)):(this.hasRemove=!0,this.__updatedList.add(t.parent))),this.update()}__pushChild(t){this.__updatedList.add(t),t.isBranch&&this.__loopChildren(t)}__loopChildren(t){let{children:n}=t;for(let i=0,s=n.length;i<s;i++)this.__pushChild(n[i])}__onRquestData(){this.target.emitEvent(new zn(zn.DATA,{updatedList:this.updatedList})),this.__updatedList=new Bt,this.totalTimes++,this.changed=this.hasVisible=this.hasRemove=this.hasAdd=!1}__listenEvents(){this.__eventIds=[this.target.on_([[rn.CHANGE,this.__onAttrChange,this],[[le.ADD,le.REMOVE],this.__onChildEvent,this],[zn.REQUEST,this.__onRquestData,this]])]}__removeListenEvents(){this.target.off_(this.__eventIds)}destroy(){this.target&&(this.stop(),this.__removeListenEvents(),this.target=this.__updatedList=null)}},{updateAllMatrix:gk,updateBounds:Lv,updateChange:_k}=Vt,{pushAllChildBranch:mk,pushAllParent:Pv}=Ws,{worldBounds:Bv}=Fr,Yl=class{constructor(t){this.updatedBounds=new It,this.beforeBounds=new It,this.afterBounds=new It,Ct(t)&&(t=new Bt(t)),this.updatedList=t}setBefore(){this.beforeBounds.setListWithFn(this.updatedList.list,Bv)}setAfter(){this.afterBounds.setListWithFn(this.updatedList.list,Bv),this.updatedBounds.setList([this.beforeBounds,this.afterBounds])}merge(t){this.updatedList.addList(t.updatedList.list),this.beforeBounds.add(t.beforeBounds),this.afterBounds.add(t.afterBounds),this.updatedBounds.add(t.updatedBounds)}destroy(){this.updatedList=null}},{updateAllMatrix:yk,updateAllChange:vk}=Vt,Sf=Pt.get("Layouter"),Vl=class e{constructor(t,n){this.totalTimes=0,this.config={usePartLayout:!0},this.__levelList=new vl,this.target=t,n&&(this.config=vt.default(n,this.config)),this.__listenEvents()}start(){this.disabled||(this.running=!0)}stop(){this.running=!1}disable(){this.stop(),this.__removeListenEvents(),this.disabled=!0}layout(){if(this.layouting||!this.running)return;let{target:t}=this;this.times=0;try{t.emit(St.START),this.layoutOnce(),t.emitEvent(new St(St.END,this.layoutedBlocks,this.times))}catch(n){Sf.error(n)}this.layoutedBlocks=null}layoutAgain(){this.layouting?this.waitAgain=!0:this.layoutOnce()}layoutOnce(){return this.layouting?Sf.warn("layouting"):this.times>3?Sf.warn("layout max times"):(this.times++,this.totalTimes++,this.layouting=!0,this.target.emit(zn.REQUEST),this.totalTimes>1&&this.config.usePartLayout?this.partLayout():this.fullLayout(),this.layouting=!1,void(this.waitAgain&&(this.waitAgain=!1,this.layoutOnce())))}partLayout(){var t;if(!(!((t=this.__updatedList)===null||t===void 0)&&t.length))return;let n=bn.start("PartLayout"),{target:i,__updatedList:s}=this,{BEFORE:a,LAYOUT:h,AFTER:l}=St,u=this.getBlocks(s);u.forEach(f=>f.setBefore()),i.emitEvent(new St(a,u,this.times)),this.extraBlock=null,s.sort(),function(f,g){let p;f.list.forEach(v=>{p=v.__layout,g.without(v)&&!p.proxyZoom&&(p.matrixChanged?(gk(v,!0),g.add(v),v.isBranch&&mk(v,g),Pv(v,g)):p.boundsChanged&&(g.add(v),v.isBranch&&(v.__tempNumber=0),Pv(v,g)))})}(s,this.__levelList),function(f){let g,p,v;f.sort(!0),f.levels.forEach(w=>{g=f.levelMap[w];for(let E=0,P=g.length;E<P;E++){if(p=g[E],p.isBranch&&p.__tempNumber){v=p.children;for(let S=0,R=v.length;S<R;S++)v[S].isBranch||Lv(v[S])}Lv(p)}})}(this.__levelList),function(f){f.list.forEach(_k)}(s),this.extraBlock&&u.push(this.extraBlock),u.forEach(f=>f.setAfter()),i.emitEvent(new St(h,u,this.times)),i.emitEvent(new St(l,u,this.times)),this.addBlocks(u),this.__levelList.reset(),this.__updatedList=null,bn.end(n)}fullLayout(){let t=bn.start("FullLayout"),{target:n}=this,{BEFORE:i,LAYOUT:s,AFTER:a}=St,h=this.getBlocks(new Bt(n));n.emitEvent(new St(i,h,this.times)),e.fullLayout(n),h.forEach(l=>{l.setAfter()}),n.emitEvent(new St(s,h,this.times)),n.emitEvent(new St(a,h,this.times)),this.addBlocks(h),bn.end(t)}static fullLayout(t){yk(t,!0),t.isBranch?Ws.updateBounds(t):Vt.updateBounds(t),vk(t)}addExtra(t){if(!this.__updatedList.has(t)){let{updatedList:n,beforeBounds:i}=this.extraBlock||(this.extraBlock=new Yl([]));n.length?i.add(t.__world):i.set(t.__world),n.add(t)}}createBlock(t){return new Yl(t)}getBlocks(t){return[this.createBlock(t)]}addBlocks(t){this.layoutedBlocks?this.layoutedBlocks.push(...t):this.layoutedBlocks=t}__onReceiveWatchData(t){this.__updatedList=t.data.updatedList}__listenEvents(){this.__eventIds=[this.target.on_([[St.REQUEST,this.layout,this],[St.AGAIN,this.layoutAgain,this],[zn.DATA,this.__onReceiveWatchData,this]])]}__removeListenEvents(){this.target.off_(this.__eventIds)}destroy(){this.target&&(this.stop(),this.__removeListenEvents(),this.target=this.config=null)}},Ks=Pt.get("Renderer"),wk=(()=>{class e{get needFill(){return!(this.canvas.allowBackgroundColor||!this.config.fill)}constructor(n,i,s){this.FPS=60,this.totalTimes=0,this.times=0,this.config={usePartRender:!0,maxFPS:120},this.frames=[],this.target=n,this.canvas=i,s&&(this.config=vt.default(s,this.config)),this.__listenEvents()}start(){this.running=!0,this.update(!1)}stop(){this.running=!1}update(n=!0){this.changed||(this.changed=n),this.requestTime||this.__requestRender()}requestLayout(){this.target.emit(St.REQUEST)}checkRender(){if(this.running){let{target:n}=this;n.isApp&&(n.emit(yt.CHILD_START,n),n.children.forEach(i=>{i.renderer.FPS=this.FPS,i.renderer.checkRender()}),n.emit(yt.CHILD_END,n)),this.changed&&this.canvas.view&&this.render(),this.target.emit(yt.NEXT)}}render(n){if(!this.running||!this.canvas.view)return this.update();let{target:i}=this;this.times=0,this.totalBounds=new It,Ks.log(i.innerName,"--->");try{this.emitRender(yt.START),this.renderOnce(n),this.emitRender(yt.END,this.totalBounds),on.clearRecycled()}catch(s){this.rendering=!1,Ks.error(s)}Ks.log("-------------|")}renderAgain(){this.rendering?this.waitAgain=!0:this.renderOnce()}renderOnce(n){if(this.rendering)return Ks.warn("rendering");if(this.times>3)return Ks.warn("render max times");if(this.times++,this.totalTimes++,this.rendering=!0,this.changed=!1,this.renderBounds=new It,this.renderOptions={},n)this.emitRender(yt.BEFORE),n();else{if(this.requestLayout(),this.ignore)return void(this.ignore=this.rendering=!1);this.emitRender(yt.BEFORE),this.config.usePartRender&&this.totalTimes>1?this.partRender():this.fullRender()}this.emitRender(yt.RENDER,this.renderBounds,this.renderOptions),this.emitRender(yt.AFTER,this.renderBounds,this.renderOptions),this.updateBlocks=null,this.rendering=!1,this.waitAgain&&(this.waitAgain=!1,this.renderOnce())}partRender(){let{canvas:n,updateBlocks:i}=this;i&&(this.mergeBlocks(),i.forEach(s=>{n.bounds.hit(s)&&!s.isEmpty()&&this.clipRender(s)}))}clipRender(n){let i=bn.start("PartRender"),{canvas:s}=this,a=n.getIntersect(s.bounds),h=new It(a);s.save(),a.spread(e.clipSpread).ceil(),s.clearWorld(a),s.clipWorld(a),this.__render(a,h),s.restore(),bn.end(i)}fullRender(){let n=bn.start("FullRender"),{canvas:i}=this;i.save(),i.clear(),this.__render(i.bounds),i.restore(),bn.end(n)}__render(n,i){let{canvas:s,target:a}=this,h=n.includes(a.__world),l=h?{includes:h}:{bounds:n,includes:h};this.needFill&&s.fillWorld(n,this.config.fill),Pt.showRepaint&&Pt.drawRepaint(s,n),this.config.useCellRender&&(l.cellList=this.getCellList()),N.render(a,s,l),this.renderBounds=i=i||n,this.renderOptions=l,this.totalBounds.isEmpty()?this.totalBounds=i:this.totalBounds.add(i),s.updateRender(i)}getCellList(){}addBlock(n){this.updateBlocks||(this.updateBlocks=[]),this.updateBlocks.push(n)}mergeBlocks(){let{updateBlocks:n}=this;if(n){let i=new It;i.setList(n),n.length=0,n.push(i)}}__requestRender(){let n=this.target;if(this.requestTime||!n)return;if(n.parentApp)return n.parentApp.requestRender(!1);this.requestTime=this.frameTime||Date.now();let i=()=>{let s=1e3/((this.frameTime=Date.now())-this.requestTime),{maxFPS:a}=this.config;if(a&&s>a)return N.requestRender(i);let{frames:h}=this;h.length>30&&h.shift(),h.push(s),this.FPS=Math.round(h.reduce((l,u)=>l+u,0)/h.length),this.requestTime=0,this.checkRender()};N.requestRender(i)}__onResize(n){if(!this.canvas.unreal){if(n.bigger||!n.samePixelRatio){let{width:i,height:s}=n.old;if(!new It(0,0,i,s).includes(this.target.__world)||this.needFill||!n.samePixelRatio)return this.addBlock(this.canvas.bounds),void this.target.forceUpdate("surface")}this.addBlock(new It(0,0,1,1)),this.update()}}__onLayoutEnd(n){n.data&&n.data.map(i=>{let s;i.updatedList&&i.updatedList.list.some(a=>(s=!a.__world.width||!a.__world.height,s&&(a.isLeafer||Ks.tip(a.innerName,": empty"),s=!a.isBranch||a.isBranchLeaf),s)),this.addBlock(s?this.canvas.bounds:i.updatedBounds)})}emitRender(n,i,s){this.target.emitEvent(new yt(n,this.times,i,s))}__listenEvents(){this.__eventIds=[this.target.on_([[yt.REQUEST,this.update,this],[St.END,this.__onLayoutEnd,this],[yt.AGAIN,this.renderAgain,this],[an.RESIZE,this.__onResize,this]])]}__removeListenEvents(){this.target.off_(this.__eventIds)}destroy(){this.target&&(this.stop(),this.__removeListenEvents(),this.config={},this.target=this.canvas=null)}}return e.clipSpread=10,e})(),xk={},{copyRadiusPoint:bk}=j,{hitRadiusPoint:Ek}=X,Yf=class{constructor(t,n){this.target=t,this.selector=n}getByPoint(t,n,i){n||(n=0),i||(i={});let s=i.through||!1,a=i.ignoreHittable||!1,h=i.target||this.target;this.exclude=i.exclude||null,this.point={x:t.x,y:t.y,radiusX:n,radiusY:n},this.findList=new Bt(i.findList),i.findList||this.hitBranch(h.isBranchLeaf?{children:[h]}:h);let{list:l}=this.findList,u=this.getBestMatchLeaf(l,i.bottomList,a,!!i.findList),f=a?this.getPath(u):this.getHitablePath(u);return this.clear(),s?{path:f,target:u,throughPath:l.length?this.getThroughPath(l):f}:{path:f,target:u}}hitPoint(t,n,i){return!!this.getByPoint(t,n,i).target}getBestMatchLeaf(t,n,i,s){let a=this.findList=new Bt;if(t.length){let h,{x:l,y:u}=this.point,f={x:l,y:u,radiusX:0,radiusY:0};for(let g=0,p=t.length;g<p;g++)if(h=t[g],(i||Vt.worldHittable(h))&&(this.hitChild(h,f),a.length)){if(h.isBranchLeaf&&t.some(v=>v!==h&&Vt.hasParent(v,h))){a.reset();break}return a.list[0]}}if(n){for(let h=0,l=n.length;h<l;h++)if(this.hitChild(n[h].target,this.point,n[h].proxy),a.length)return a.list[0]}return s?null:i?t[0]:t.find(h=>Vt.worldHittable(h))}getPath(t){let n=new Bt,i=[],{target:s}=this;for(;t&&(t.syncEventer&&i.push(t.syncEventer),n.add(t),(t=t.parent)!==s););return i.length&&i.forEach(a=>{for(;a&&(a.__.hittable&&n.add(a),(a=a.parent)!==s););}),s&&n.add(s),n}getHitablePath(t){let n=this.getPath(t&&t.hittable?t:null),i,s=new Bt;for(let a=n.list.length-1;a>-1&&(i=n.list[a],i.__.hittable)&&(s.addAt(i,0),i.__.hitChildren&&(!i.isLeafer||i.mode!=="draw"));a--);return s}getThroughPath(t){let n=new Bt,i=[];for(let l=t.length-1;l>-1;l--)i.push(this.getPath(t[l]));let s,a,h;for(let l=0,u=i.length;l<u;l++){s=i[l],a=i[l+1];for(let f=0,g=s.length;f<g&&(h=s.list[f],!a||!a.has(h));f++)n.add(h)}return n}hitBranch(t){this.eachFind(t.children,t.__onlyHitMask)}eachFind(t,n){let i,s,a,{point:h}=this;for(let l=t.length-1;l>-1;l--)if(i=t[l],a=i.__,a.visible&&(!n||a.mask))if(s=Ek(i.__world,a.hitRadius?bk(xk,h,a.hitRadius):h),i.isBranch){if(s||i.__ignoreHitWorld){if(i.isBranchLeaf&&a.__clipAfterFill&&!i.__hitWorld(h,!0))continue;i.topChildren&&this.eachFind(i.topChildren,!1),this.eachFind(i.children,i.__onlyHitMask),i.isBranchLeaf&&this.hitChild(i,h)}}else s&&this.hitChild(i,h)}hitChild(t,n,i){if((!this.exclude||!this.exclude.has(t))&&t.__hitWorld(n)){let{parent:s}=t;if(s&&s.__hasMask&&!t.__.mask){let a,h=[],{children:l}=s;for(let u=0,f=l.length;u<f;u++)if(a=l[u],a.__.mask&&h.push(a),a===t){if(h&&!h.every(g=>g.__hitWorld(n)))return;break}}this.findList.add(i||t)}}clear(){this.point=null,this.findList=null,this.exclude=null}destroy(){this.clear()}},Vf=class{constructor(t,n){this.config={},n&&(this.config=vt.default(n,this.config)),this.picker=new Yf(this.target=t,this),this.finder=$t.finder&&$t.finder()}getByPoint(t,n,i){let{target:s,picker:a}=this;return N.backgrounder&&s&&s.updateLayout(),a.getByPoint(t,n,i)}hitPoint(t,n,i){return this.picker.hitPoint(t,n,i)}getBy(t,n,i,s){return this.finder?this.finder.getBy(t,n,i,s):Zt.need("find")}destroy(){this.picker.destroy(),this.finder&&this.finder.destroy()}};Object.assign($t,{watcher:(e,t)=>new Uf(e,t),layouter:(e,t)=>new Vl(e,t),renderer:(e,t,n)=>new wk(e,t,n),selector:(e,t)=>new Vf(e,t)}),N.layout=Vl.fullLayout,N.render=function(e,t,n){let i=Object.assign(Object.assign({},n),{topRendering:!0});n.topList=new Bt,e.__render(t,n),n.topList.length&&n.topList.forEach(s=>s.__render(t,i))};var ln={convert(e,t){let n=Wn.getBase(e),{x:i,y:s}=t,a=Object.assign(Object.assign({},n),{x:i,y:s,width:e.width,height:e.height,pointerType:e.pointerType,pressure:e.pressure});return a.pointerType==="pen"&&(a.tangentialPressure=e.tangentialPressure,a.tiltX=e.tiltX,a.tiltY=e.tiltY,a.twist=e.twist),a},convertMouse(e,t){let n=Wn.getBase(e),{x:i,y:s}=t;return Object.assign(Object.assign({},n),{x:i,y:s,width:1,height:1,pointerType:"mouse",pressure:.5})},convertTouch(e,t){let n=ln.getTouch(e),i=Wn.getBase(e),{x:s,y:a}=t;return Object.assign(Object.assign({},i),{x:s,y:a,width:1,height:1,pointerType:"touch",multiTouch:e.touches.length>1,pressure:n.force})},getTouch:e=>e.targetTouches[0]||e.changedTouches[0]},Rv={convert(e){let t=Wn.getBase(e);return Object.assign(Object.assign({},t),{code:e.code,key:e.key})}},{pathCanDrag:Sk}=Wn,Xf=class extends Gs{get notPointer(){let{p:t}=this;return t.type!=="pointer"||t.touch||this.useMultiTouch}get notTouch(){let{p:t}=this;return t.type==="mouse"||this.usePointer}get notMouse(){return this.usePointer||this.useTouch}__listenEvents(){super.__listenEvents();let t=this.view=this.canvas.view;this.viewEvents={pointerdown:this.onPointerDown,mousedown:this.onMouseDown,touchstart:this.onTouchStart,pointerleave:this.onPointerLeave,contextmenu:this.onContextMenu,wheel:this.onWheel,gesturestart:this.onGesturestart,gesturechange:this.onGesturechange,gestureend:this.onGestureend},this.windowEvents={pointermove:this.onPointerMove,pointerup:this.onPointerUp,pointercancel:this.onPointerCancel,mousemove:this.onMouseMove,mouseup:this.onMouseUp,touchmove:this.onTouchMove,touchend:this.onTouchEnd,touchcancel:this.onTouchCancel,keydown:this.onKeyDown,keyup:this.onKeyUp,scroll:this.onScroll};let{viewEvents:n,windowEvents:i}=this;for(let s in n)n[s]=n[s].bind(this),t.addEventListener(s,n[s]);for(let s in i)i[s]=i[s].bind(this),window.addEventListener(s,i[s])}__removeListenEvents(){super.__removeListenEvents();let{viewEvents:t,windowEvents:n}=this;for(let i in t)this.view.removeEventListener(i,t[i]),this.viewEvents={};for(let i in n)window.removeEventListener(i,n[i]),this.windowEvents={}}getTouches(t){let n=[];for(let i=0,s=t.length;i<s;i++)n.push(t[i]);return n}preventDefaultPointer(t){let{pointer:n}=this.config;n.preventDefault&&t.preventDefault()}preventDefaultWheel(t){let{wheel:n}=this.config;n.preventDefault&&t.preventDefault()}preventWindowPointer(t){return!this.downData&&t.target!==this.view}onKeyDown(t){this.keyDown(Rv.convert(t))}onKeyUp(t){this.keyUp(Rv.convert(t))}onContextMenu(t){this.config.pointer.preventDefaultMenu&&t.preventDefault(),this.menu(ln.convert(t,this.getLocal(t)))}onScroll(){this.canvas.updateClientBounds()}onPointerDown(t){this.preventDefaultPointer(t),this.notPointer||(this.usePointer||(this.usePointer=!0),this.pointerDown(ln.convert(t,this.getLocal(t))))}onPointerMove(t,n){if(this.notPointer||this.preventWindowPointer(t))return;this.usePointer||(this.usePointer=!0);let i=ln.convert(t,this.getLocal(t,!0));n?this.pointerHover(i):this.pointerMove(i)}onPointerLeave(t){this.onPointerMove(t,!0)}onPointerUp(t){this.downData&&this.preventDefaultPointer(t),this.notPointer||this.preventWindowPointer(t)||this.pointerUp(ln.convert(t,this.getLocal(t)))}onPointerCancel(){this.useMultiTouch||this.pointerCancel()}onMouseDown(t){this.preventDefaultPointer(t),this.notMouse||this.pointerDown(ln.convertMouse(t,this.getLocal(t)))}onMouseMove(t){this.notMouse||this.preventWindowPointer(t)||this.pointerMove(ln.convertMouse(t,this.getLocal(t,!0)))}onMouseUp(t){this.downData&&this.preventDefaultPointer(t),this.notMouse||this.preventWindowPointer(t)||this.pointerUp(ln.convertMouse(t,this.getLocal(t)))}onMouseCancel(){this.notMouse||this.pointerCancel()}onTouchStart(t){let n=ln.getTouch(t),i=this.getLocal(n,!0),{preventDefault:s}=this.config.touch;(s===!0||s==="auto"&&Sk(this.findPath(i)))&&t.preventDefault(),this.multiTouchStart(t),this.notTouch||(this.touchTimer&&(window.clearTimeout(this.touchTimer),this.touchTimer=0),this.useTouch=!0,this.pointerDown(ln.convertTouch(t,i)))}onTouchMove(t){if(this.multiTouchMove(t),this.notTouch||this.preventWindowPointer(t))return;let n=ln.getTouch(t);this.pointerMove(ln.convertTouch(t,this.getLocal(n)))}onTouchEnd(t){if(this.multiTouchEnd(),this.notTouch||this.preventWindowPointer(t))return;this.touchTimer&&clearTimeout(this.touchTimer),this.touchTimer=setTimeout(()=>{this.useTouch=!1},500);let n=ln.getTouch(t);this.pointerUp(ln.convertTouch(t,this.getLocal(n)))}onTouchCancel(){this.notTouch||this.pointerCancel()}multiTouchStart(t){this.useMultiTouch=t.touches.length>1,this.touches=this.useMultiTouch?this.getTouches(t.touches):void 0,this.useMultiTouch&&this.pointerCancel()}multiTouchMove(t){if(this.useMultiTouch&&t.touches.length>1){let n=this.getTouches(t.touches),i=this.getKeepTouchList(this.touches,n);i.length>1&&(this.multiTouch(Wn.getBase(t),i),this.touches=n)}}multiTouchEnd(){this.touches=null,this.useMultiTouch=!1,this.transformEnd()}getKeepTouchList(t,n){let i,s=[];return t.forEach(a=>{i=n.find(h=>h.identifier===a.identifier),i&&s.push({from:this.getLocal(a),to:this.getLocal(i)})}),s}getLocalTouchs(t){return t.map(n=>this.getLocal(n))}onWheel(t){this.preventDefaultWheel(t),this.wheel(Object.assign(Object.assign(Object.assign({},Wn.getBase(t)),this.getLocal(t)),{deltaX:t.deltaX,deltaY:t.deltaY}))}onGesturestart(t){this.useMultiTouch||(this.preventDefaultWheel(t),this.lastGestureScale=1,this.lastGestureRotation=0)}onGesturechange(t){if(this.useMultiTouch)return;this.preventDefaultWheel(t);let n=Wn.getBase(t);Object.assign(n,this.getLocal(t));let i=t.scale/this.lastGestureScale,s=(t.rotation-this.lastGestureRotation)/Math.PI*180*(Kt.within(this.config.wheel.rotateSpeed,0,1)/4+.1);this.zoom(Object.assign(Object.assign({},n),{scale:i*i})),this.rotate(Object.assign(Object.assign({},n),{rotation:s})),this.lastGestureScale=t.scale,this.lastGestureRotation=t.rotation}onGestureend(t){this.useMultiTouch||(this.preventDefaultWheel(t),this.transformEnd())}setCursor(t){super.setCursor(t);let n=[];this.eachCursor(t,n),ht(n[n.length-1])&&n.push("default"),this.canvas.view.style.cursor=n.map(i=>ht(i)?`url(${i.url}) ${i.x||0} ${i.y||0}`:i).join(",")}eachCursor(t,n,i=0){if(i++,Ct(t))t.forEach(s=>this.eachCursor(s,n,i));else{let s=gt(t)&&Sv.get(t);s&&i<2?this.eachCursor(s,n,i):n.push(t)}}destroy(){this.view&&(super.destroy(),this.view=null,this.touches=null)}};function da(e,t,n){e.__.__font?_t.fillText(e,t,n):e.__.windingRule?t.fill(e.__.windingRule):t.fill()}function Ml(e,t,n,i,s){let a=n.__;ht(e)?_t.drawStrokesStyle(e,t,!1,n,i,s):(i.setStroke(e,a.__strokeWidth*t,a),i.stroke()),a.__useArrow&&_t.strokeArrow(e,n,i,s)}function Gf(e,t,n,i,s){let a=n.__;ht(e)?_t.drawStrokesStyle(e,t,!0,n,i,s):(i.setStroke(e,a.__strokeWidth*t,a),_t.drawTextStroke(n,i,s))}function Ov(e,t,n,i,s){let a=i.getSameCanvas(!0,!0);a.font=n.__.__font,Gf(e,2,n,a,s),a.blendMode=t==="outside"?"destination-out":"destination-in",_t.fillText(n,a,s),a.blendMode="normal",Vt.copyCanvasByWorld(n,i,a),a.recycle(n.__nowWorld)}var{getSpread:Ck,copyAndSpread:Tk,toOuterOf:Lk,getOuterOf:Av,getByMove:Pk,move:Bk,getIntersectData:Rk}=X,kv={},Kf,{stintSet:fa}=vt,{hasTransparent:Ok}=we;function Ak(e,t,n){if(!ht(t)||t.visible===!1||t.opacity===0)return;let i,{boxBounds:s}=n.__layout;switch(t.type){case"image":if(!t.url)return;i=xe.image(n,e,t,s,!Kf||!Kf[t.url]);break;case"linear":i=sa.linearGradient(t,s);break;case"radial":i=sa.radialGradient(t,s);break;case"angular":i=sa.conicGradient(t,s);break;case"solid":let{type:a,color:h,opacity:l}=t;i={type:a,style:we.string(h,l)};break;default:J(t.r)||(i={type:"solid",style:we.string(t)})}if(i&&(i.originPaint=t,gt(i.style)&&Ok(i.style)&&(i.isTransparent=!0),t.style)){if(t.style.strokeWidth===0)return;i.strokeStyle=t.style}return i}var kk={compute:function(e,t){let n=t.__,i=[],s,a,h,l=n.__input[e];Ct(l)||(l=[l]),Kf=xe.recycleImage(e,n);for(let u,f=0,g=l.length;f<g;f++)(u=Ak(e,l[f],t))&&(i.push(u),u.strokeStyle&&(h||(h=1),u.strokeStyle.strokeWidth&&(h=Math.max(h,u.strokeStyle.strokeWidth))));n["_"+e]=i.length?i:void 0,i.length?(i.every(u=>u.isTransparent)&&(i.some(u=>u.image)&&(s=!0),a=!0),e==="fill"?(fa(n,"__isAlphaPixelFill",s),fa(n,"__isTransparentFill",a)):(fa(n,"__isAlphaPixelStroke",s),fa(n,"__isTransparentStroke",a),fa(n,"__hasMultiStrokeStyle",h))):n.__removePaint(e,!1)},fill:function(e,t,n,i){n.fillStyle=e,da(t,n,i)},fills:function(e,t,n,i){let s,a,h;for(let l=0,u=e.length;l<u;l++){if(s=e[l],a=s.originPaint,s.image){if(h?h++:h=1,xe.checkImage(s,!t.__.__font,t,n,i))continue;if(!s.style){h===1&&s.image.isPlacehold&&t.drawImagePlaceholder(s,n,i);continue}}if(n.fillStyle=s.style,s.transform||a.scaleFixed){if(n.save(),s.transform&&n.transform(s.transform),a.scaleFixed){let{scaleX:f,scaleY:g}=t.getRenderScaleData(!0);(a.scaleFixed===!0||a.scaleFixed==="zoom-in"&&f>1&&g>1)&&n.scale(1/f,1/g)}a.blendMode&&(n.blendMode=a.blendMode),da(t,n,i),n.restore()}else a.blendMode?(n.saveBlendMode(a.blendMode),da(t,n,i),n.restoreBlendMode()):da(t,n,i)}},fillPathOrText:da,fillText:function(e,t,n){let i=e.__,{rows:s,decorationY:a}=i.__textDrawData,h;i.__isPlacehold&&i.placeholderColor&&(t.fillStyle=i.placeholderColor);for(let l=0,u=s.length;l<u;l++)h=s[l],h.text?t.fillText(h.text,h.x,h.y):h.data&&h.data.forEach(f=>{t.fillText(f.char,f.x,h.y)});if(a){let{decorationColor:l,decorationHeight:u}=i.__textDrawData;l&&(t.fillStyle=l),s.forEach(f=>a.forEach(g=>t.fillRect(f.x,f.y+g,f.width,u)))}},stroke:function(e,t,n,i){let s=t.__;if(s.__strokeWidth)if(s.__font)_t.strokeText(e,t,n,i);else switch(s.strokeAlign){case"center":Ml(e,1,t,n,i);break;case"inside":(function(a,h,l,u){l.save(),l.clipUI(h),Ml(a,2,h,l,u),l.restore()})(e,t,n,i);break;case"outside":(function(a,h,l,u){let f=h.__;if(f.__fillAfterStroke)Ml(a,2,h,l,u);else{let{renderBounds:g}=h.__layout,p=l.getSameCanvas(!0,!0);h.__drawRenderPath(p),Ml(a,2,h,p,u),p.clipUI(f),p.clearWorld(g),Vt.copyCanvasByWorld(h,l,p),p.recycle(h.__nowWorld)}})(e,t,n,i)}},strokes:function(e,t,n,i){_t.stroke(e,t,n,i)},strokeText:function(e,t,n,i){switch(t.__.strokeAlign){case"center":Gf(e,1,t,n,i);break;case"inside":Ov(e,"inside",t,n,i);break;case"outside":t.__.__fillAfterStroke?Gf(e,2,t,n,i):Ov(e,"outside",t,n,i)}},drawTextStroke:function(e,t,n){let i,s=e.__.__textDrawData,{rows:a,decorationY:h}=s;for(let l=0,u=a.length;l<u;l++)i=a[l],i.text?t.strokeText(i.text,i.x,i.y):i.data&&i.data.forEach(f=>{t.strokeText(f.char,f.x,i.y)});if(h){let{decorationHeight:l}=s;a.forEach(u=>h.forEach(f=>t.strokeRect(u.x,u.y+f,u.width,l)))}},drawStrokesStyle:function(e,t,n,i,s,a){let h,l=i.__,{__hasMultiStrokeStyle:u}=l;u||s.setStroke(void 0,l.__strokeWidth*t,l);for(let f=0,g=e.length;f<g;f++)if(h=e[f],(!h.image||!xe.checkImage(h,!1,i,s,a))&&h.style){if(u){let{strokeStyle:p}=h;p?s.setStroke(h.style,l.__getRealStrokeWidth(p)*t,l,p):s.setStroke(h.style,l.__strokeWidth*t,l)}else s.strokeStyle=h.style;h.originPaint.blendMode?(s.saveBlendMode(h.originPaint.blendMode),n?_t.drawTextStroke(i,s,a):s.stroke(),s.restoreBlendMode()):n?_t.drawTextStroke(i,s,a):s.stroke()}},shape:function(e,t,n){let i=t.getSameCanvas(),s=t.bounds,a=e.__nowWorld,h=e.__layout,l=e.__nowWorldShapeBounds||(e.__nowWorldShapeBounds={}),u,f,g,p,v,w;Lk(h.strokeSpread?(Tk(kv,h.boxBounds,h.strokeSpread),kv):h.boxBounds,a,l);let{scaleX:E,scaleY:P}=e.getRenderScaleData(!0);if(s.includes(l))w=i,u=v=l,f=a;else{let S;if(N.fullImageShadow)S=l;else{let W=h.renderShapeSpread?Ck(s,Ds.swapAndScale(h.renderShapeSpread,E,P)):s;S=Rk(W,l)}p=s.getFitMatrix(S);let{a:R,d:A}=p;p.a<1&&(w=t.getSameCanvas(),e.__renderShape(w,n),E*=R,P*=A),v=Av(l,p),u=Pk(v,-p.e,-p.f),f=Av(a,p),Bk(f,-p.e,-p.f);let I=n.matrix;I?(g=new ye(p),g.multiply(I),R*=I.scaleX,A*=I.scaleY):g=p,g.withScale(R,A),n=Object.assign(Object.assign({},n),{matrix:g})}return e.__renderShape(i,n),{canvas:i,matrix:g,fitMatrix:p,bounds:u,renderBounds:f,worldCanvas:w,shapeBounds:v,scaleX:E,scaleY:P}}},pa,Mk=new It,{isSame:Dk}=X;function Mv(e,t,n,i,s,a){if(t==="fill"&&!e.__.__naturalWidth){let h=e.__;if(h.__naturalWidth=i.width/h.pixelRatio,h.__naturalHeight=i.height/h.pixelRatio,h.__autoSide)return e.forceUpdate("width"),e.__proxyData&&(e.setProxyAttr("width",h.width),e.setProxyAttr("height",h.height)),!1}return s.data||xe.createData(s,i,n,a),!0}function Dv(e,t){$f(e,vn.LOAD,t)}function Iv(e,t){$f(e,vn.LOADED,t)}function zv(e,t,n){t.error=n,e.forceUpdate("surface"),$f(e,vn.ERROR,t)}function $f(e,t,n){e.hasEvent(t)&&e.emitEvent(new vn(t,n))}function Cf(e,t){let{leafer:n}=e;n&&n.viewReady&&(n.renderer.ignore=t)}var{get:Ik,translate:zk}=rt,Wk=new It,Tf={},Ae={};function Wv(e,t,n,i){let s=gt(e)||i?(i?n-i*t:n%t)/((i||Math.floor(n/t))-1):e;return e==="auto"&&s<0?0:s}var ga={},Lf=jo(),{get:Dl,set:Fk,rotateOfOuter:Fv,translate:Xr,scaleOfOuter:Pf,multiplyParent:Nk,scale:qf,rotate:i1,skew:Hk}=rt;function Nv(e,t,n,i,s,a,h,l){h&&i1(e,h),l&&Hk(e,l.x,l.y),s&&qf(e,s,a),Xr(e,t.x+n,t.y+i)}function Uk(e,t,n,i){return new(n||(n=Promise))(function(s,a){function h(f){try{u(i.next(f))}catch(g){a(g)}}function l(f){try{u(i.throw(f))}catch(g){a(g)}}function u(f){var g;f.done?s(f.value):(g=f.value,g instanceof n?g:new n(function(p){p(g)})).then(h,l)}u((i=i.apply(e,t||[])).next())})}var{get:Yk,scale:Vk,copy:Xk}=rt,{getFloorScale:Hv}=Kt,{abs:Uv}=Math,Gk={image:function(e,t,n,i,s){let a,h,l=on.get(n);return pa&&n===pa.paint&&Dk(i,pa.boxBounds)?a=pa.leafPaint:(a={type:n.type,image:l},l.hasAlphaPixel&&(a.isTransparent=!0),pa=l.use>1?{leafPaint:a,paint:n,boxBounds:Mk.set(i)}:null),(s||l.loading)&&(h={image:l,attrName:t,attrValue:n}),l.ready?(Mv(e,t,n,l,a,i),s&&(Dv(e,h),Iv(e,h))):l.error?s&&zv(e,h,l.error):(s&&(Cf(e,!0),Dv(e,h)),a.loadId=l.load(()=>{Cf(e,!1),e.destroyed||(Mv(e,t,n,l,a,i)&&(l.hasAlphaPixel&&(e.__layout.hitCanvasChanged=!0),e.forceUpdate("surface")),Iv(e,h)),a.loadId=void 0},u=>{Cf(e,!1),zv(e,h,u),a.loadId=void 0},n.lod&&l.getThumbSize(n.lod)),e.placeholderColor&&(e.placeholderDelay?setTimeout(()=>{l.ready||(l.isPlacehold=!0,e.forceUpdate("surface"))},e.placeholderDelay):l.isPlacehold=!0)),a},checkImage:function(e,t,n,i,s){let{scaleX:a,scaleY:h}=xe.getImageRenderScaleData(e,n,i,s),{image:l,data:u,originPaint:f}=e,{exporting:g}=s;return!(!u||e.patternId===a+"-"+h&&!g)&&(t&&(u.repeat?t=!1:f.changeful||N.name==="miniapp"&&an.isResizing(n)||g||(t=N.image.isLarge(l,a,h)||l.width*a>8096||l.height*h>8096)),t?(n.__.__isFastShadow&&(i.fillStyle=e.style||"#000",i.fill()),xe.drawImage(e,a,h,n,i,s),!0):(!e.style||f.sync||g?xe.createPattern(e,n,i,s):xe.createPatternTask(e,n,i,s),!1))},drawImage:function(e,t,n,i,s,a){let{data:h,image:l}=e,{blendMode:u}=e.originPaint,{opacity:f,transform:g}=h,p=l.getFull(h.filters),v=i.__,w,{width:E,height:P}=l;(w=g&&!g.onlyScale||v.path||v.cornerRadius)||f||u?(s.save(),w&&s.clipUI(i),u&&(s.blendMode=u),f&&(s.opacity*=f),g&&s.transform(g),s.drawImage(p,0,0,E,P),s.restore()):(h.scaleX&&(E*=h.scaleX,P*=h.scaleY),s.drawImage(p,0,0,E,P))},getImageRenderScaleData:function(e,t,n,i){let s=t.getRenderScaleData(!0,e.originPaint.scaleFixed),{data:a}=e;if(n){let{pixelRatio:h}=n;s.scaleX*=h,s.scaleY*=h}return a&&a.scaleX&&(s.scaleX*=Math.abs(a.scaleX),s.scaleY*=Math.abs(a.scaleY)),s},recycleImage:function(e,t){let n=t["_"+e];if(Ct(n)){let i,s,a,h,l;for(let u=0,f=n.length;u<f;u++)i=n[u],s=i.image,l=s&&s.url,l&&(a||(a={}),a[l]=!0,on.recyclePaint(i),s.loading&&(h||(h=t.__input&&t.__input[e]||[],Ct(h)||(h=[h])),s.unload(n[u].loadId,!h.some(g=>g.url===l))));return a}return null},createPatternTask:function(e,t,n,i){e.patternTask||(e.patternTask=on.patternTasker.add(()=>Uk(this,void 0,void 0,function*(){xe.createPattern(e,t,n,i),t.forceUpdate("surface")}),0,()=>(e.patternTask=null,n.bounds.hit(t.__nowWorld))))},createPattern:function(e,t,n,i){let{scaleX:s,scaleY:a}=xe.getImageRenderScaleData(e,t,n,i),h=s+"-"+a;if(e.patternId!==h&&!t.destroyed&&(!N.image.isLarge(e.image,s,a)||e.data.repeat)){let{image:l,data:u}=e,{transform:f,gap:g}=u,p=xe.getPatternFixScale(e,s,a),v,w,E,{width:P,height:S}=l;p&&(s*=p,a*=p),P*=s,S*=a,g&&(w=g.x*s/Uv(u.scaleX||1),E=g.y*a/Uv(u.scaleY||1)),(f||s!==1||a!==1)&&(s*=Hv(P+(w||0)),a*=Hv(S+(E||0)),v=Yk(),f&&Xk(v,f),Vk(v,1/s,1/a));let R=l.getCanvas(P,S,u.opacity,u.filters,w,E,t.leafer&&t.leafer.config.smooth),A=l.getPattern(R,u.repeat||N.origin.noRepeat||"no-repeat",v,e);e.style=A,e.patternId=h}},getPatternFixScale:function(e,t,n){let{image:i}=e,s,a=N.image.maxPatternSize,h=i.width*i.height;return i.isSVG?t>1&&(s=Math.ceil(t)/t):a>h&&(a=h),(h*=t*n)>a&&(s=Math.sqrt(a/h)),s},createData:function(e,t,n,i){e.data=xe.getPatternData(n,i,t)},getPatternData:function(e,t,n){e.padding&&(t=Wk.set(t).shrink(e.padding)),e.mode==="strench"&&(e.mode="stretch");let{width:i,height:s}=n,{opacity:a,mode:h,align:l,offset:u,scale:f,size:g,rotation:p,skew:v,clipSize:w,repeat:E,gap:P,filters:S}=e,R=t.width===i&&t.height===s,A={mode:h},I=l!=="center"&&(p||0)%180==90,W,F;switch(X.set(Ae,0,0,I?s:i,I?i:s),h&&h!=="cover"&&h!=="fit"?((f||g)&&(Kt.getScaleData(f,g,n,Tf),W=Tf.scaleX,F=Tf.scaleY),(l||P||E)&&(W&&X.scale(Ae,W,F,!0),l&&jd.toPoint(l,Ae,t,Ae,!0,!0))):R&&!p||(W=F=X.getFitScale(t,Ae,h!=="fit"),X.put(t,n,l,W,!1,Ae),X.scale(Ae,W,F,!0)),u&&j.move(Ae,u),h){case"stretch":R?W&&(W=F=void 0):(W=t.width/i,F=t.height/s,xe.stretchMode(A,t,W,F));break;case"normal":case"clip":if(Ae.x||Ae.y||W||w||p||v){let V,K;w&&(V=t.width/w.width,K=t.height/w.height),xe.clipMode(A,t,Ae.x,Ae.y,W,F,p,v,V,K),V&&(W=W?W*V:V,F=F?F*K:K)}break;case"repeat":(!R||W||p||v)&&xe.repeatMode(A,t,i,s,Ae.x,Ae.y,W,F,p,v,l,e.freeTransform),E||(A.repeat="repeat");let H=ht(E);(P||H)&&(A.gap=function(V,K,ct,ft,it){let Y,ot;return ht(V)?(Y=V.x,ot=V.y):Y=ot=V,{x:Wv(Y,ct,it.width,K&&K.x),y:Wv(ot,ft,it.height,K&&K.y)}}(P,H&&E,Ae.width,Ae.height,t));break;default:W&&xe.fillOrFitMode(A,t,Ae.x,Ae.y,W,F,p)}return A.transform||(t.x||t.y)&&zk(A.transform=Ik(),t.x,t.y),W&&(A.scaleX=W,A.scaleY=F),a&&a<1&&(A.opacity=a),S&&(A.filters=S),E&&(A.repeat=gt(E)?E==="x"?"repeat-x":"repeat-y":"repeat"),A},stretchMode:function(e,t,n,i){let s=Dl(),{x:a,y:h}=t;a||h?Xr(s,a,h):s.onlyScale=!0,qf(s,n,i),e.transform=s},fillOrFitMode:function(e,t,n,i,s,a,h){let l=Dl();Xr(l,t.x+n,t.y+i),qf(l,s,a),h&&Fv(l,{x:t.x+t.width/2,y:t.y+t.height/2},h),e.transform=l},clipMode:function(e,t,n,i,s,a,h,l,u,f){let g=Dl();Nv(g,t,n,i,s,a,h,l),u&&(h||l?(Fk(Lf),Pf(Lf,t,u,f),Nk(g,Lf)):Pf(g,t,u,f)),e.transform=g},repeatMode:function(e,t,n,i,s,a,h,l,u,f,g,p){let v=Dl();if(p)Nv(v,t,s,a,h,l,u,f);else{if(u)if(g==="center")Fv(v,{x:n/2,y:i/2},u);else switch(i1(v,u),u){case 90:Xr(v,i,0);break;case 180:Xr(v,n,i);break;case 270:Xr(v,0,n)}ga.x=t.x+s,ga.y=t.y+a,Xr(v,ga.x,ga.y),h&&Pf(v,ga,h,l)}e.transform=v}},{toPoint:Yv}=xn,{hasTransparent:Kk}=we,Bf={},Rf={};function Of(e,t,n,i){if(n){let s,a,h,l;for(let u=0,f=n.length;u<f;u++)s=n[u],gt(s)?(h=u/(f-1),a=we.string(s,i)):(h=s.offset,a=we.string(s.color,i)),t.addColorStop(h,a),!l&&Kk(a)&&(l=!0);l&&(e.isTransparent=!0)}}var{getAngle:qk,getDistance:jk}=j,{get:Zk,rotateOfOuter:Vv,scaleOfOuter:Xv}=rt,{toPoint:Gv}=xn,Yr={},Af={};function kf(e,t,n,i,s){let a,{width:h,height:l}=e;if(h!==l||i){let u=qk(t,n);a=Zk(),s?(Xv(a,t,h/l*(i||1),1),Vv(a,t,u+90)):(Xv(a,t,1,h/l*(i||1)),Vv(a,t,u))}return a}var{getDistance:$k}=j,{toPoint:Kv}=xn,Wi={},Mf={},Jk={linearGradient:function(e,t){let{from:n,to:i,type:s,opacity:a}=e;Yv(n||"top",t,Bf),Yv(i||"bottom",t,Rf);let h=N.canvas.createLinearGradient(Bf.x,Bf.y,Rf.x,Rf.y),l={type:s,style:h};return Of(l,h,e.stops,a),l},radialGradient:function(e,t){let{from:n,to:i,type:s,opacity:a,stretch:h}=e;Gv(n||"center",t,Yr),Gv(i||"bottom",t,Af);let l=N.canvas.createRadialGradient(Yr.x,Yr.y,0,Yr.x,Yr.y,jk(Yr,Af)),u={type:s,style:l};Of(u,l,e.stops,a);let f=kf(t,Yr,Af,h,!0);return f&&(u.transform=f),u},conicGradient:function(e,t){let{from:n,to:i,type:s,opacity:a,stretch:h}=e;Kv(n||"center",t,Wi),Kv(i||"bottom",t,Mf);let l=N.conicGradientSupport?N.canvas.createConicGradient(0,Wi.x,Wi.y):N.canvas.createRadialGradient(Wi.x,Wi.y,0,Wi.x,Wi.y,$k(Wi,Mf)),u={type:s,style:l};Of(u,l,e.stops,a);let f=kf(t,Wi,Mf,h||1,N.conicGradientRotate90);return f&&(u.transform=f),u},getTransform:kf},{copy:Qk,move:t2,toOffsetOutBounds:e2}=X,{max:Il,abs:n2}=Math,Df={},qv=new ye,_a={};function r1(e,t){let n,i,s,a,h=0,l=0,u=0,f=0;return t.forEach(g=>{n=g.x||0,i=g.y||0,a=1.5*(g.blur||0),s=n2(g.spread||0),h=Il(h,s+a-i),l=Il(l,s+a+n),u=Il(u,s+a+i),f=Il(f,s+a-n)}),h===l&&l===u&&u===f?h:[h,l,u,f]}function jv(e,t,n){let{shapeBounds:i}=n,s,a;N.fullImageShadow?(Qk(Df,e.bounds),t2(Df,t.x-i.x,t.y-i.y),s=e.bounds,a=Df):(s=i,a=t),e.copyWorld(n.canvas,s,a)}var{toOffsetOutBounds:i2}=X,ma={},r2=r1,s2={shadow:function(e,t,n){let i,s,{__nowWorld:a}=e,{shadow:h}=e.__,{worldCanvas:l,bounds:u,renderBounds:f,shapeBounds:g,scaleX:p,scaleY:v}=n,w=t.getSameCanvas(),E=h.length-1;e2(u,_a,f),h.forEach((P,S)=>{let R=1;if(P.scaleFixed){let A=Math.abs(a.scaleX);A>1&&(R=1/A)}w.setWorldShadow(_a.offsetX+(P.x||0)*p*R,_a.offsetY+(P.y||0)*v*R,(P.blur||0)*p*R,we.string(P.color)),s=Di.getShadowTransform(e,w,n,P,_a,R),s&&w.setTransform(s),jv(w,_a,n),s&&w.resetTransform(),i=f,P.box&&(w.restore(),w.save(),l&&(w.copyWorld(w,f,a,"copy"),i=a),l?w.copyWorld(l,a,a,"destination-out"):w.copyWorld(n.canvas,g,u,"destination-out")),Vt.copyCanvasByWorld(e,t,w,i,P.blendMode),E&&S<E&&w.clearWorld(i)}),w.recycle(i)},innerShadow:function(e,t,n){let i,s,{__nowWorld:a}=e,{innerShadow:h}=e.__,{worldCanvas:l,bounds:u,renderBounds:f,shapeBounds:g,scaleX:p,scaleY:v}=n,w=t.getSameCanvas(),E=h.length-1;i2(u,ma,f),h.forEach((P,S)=>{let R=1;if(P.scaleFixed){let A=Math.abs(a.scaleX);A>1&&(R=1/A)}w.save(),w.setWorldShadow(ma.offsetX+(P.x||0)*p*R,ma.offsetY+(P.y||0)*v*R,(P.blur||0)*p*R),s=Di.getShadowTransform(e,w,n,P,ma,R,!0),s&&w.setTransform(s),jv(w,ma,n),w.restore(),l?(w.copyWorld(w,f,a,"copy"),w.copyWorld(l,a,a,"source-out"),i=a):(w.copyWorld(n.canvas,g,u,"source-out"),i=f),w.fillWorld(i,we.string(P.color),"source-in"),Vt.copyCanvasByWorld(e,t,w,i,P.blendMode),E&&S<E&&w.clearWorld(i)}),w.recycle(i)},blur:function(e,t,n){let{blur:i}=e.__;n.setWorldBlur(i*e.__nowWorld.a),n.copyWorldToInner(t,e.__nowWorld,e.__layout.renderBounds),n.filter="none"},backgroundBlur:function(e,t,n){},getShadowRenderSpread:r1,getShadowTransform:function(e,t,n,i,s,a,h){if(i.spread){let l=2*i.spread*a*(h?-1:1),{width:u,height:f}=e.__layout.strokeBounds;return qv.set().scaleOfOuter({x:(s.x+s.width/2)*t.pixelRatio,y:(s.y+s.height/2)*t.pixelRatio},1+l/u,1+l/f),qv}},isTransformShadow(e){},getInnerShadowSpread:r2},{excludeRenderBounds:Zv}=Fr,jf;function zl(e,t,n,i,s,a,h,l){switch(t){case"grayscale":jf||(jf=!0,s.useGrayscaleAlpha(e.__nowWorld));case"alpha":(function(u,f,g,p,v,w){let E=u.__nowWorld;g.resetTransform(),g.opacity=1,g.useMask(p,E),w&&p.recycle(E),$v(u,f,g,1,v,w)})(e,n,i,s,h,l);break;case"opacity-path":$v(e,n,i,a,h,l);break;case"path":l&&n.restore()}}function If(e){return e.getSameCanvas(!1,!0)}function $v(e,t,n,i,s,a){let h=e.__nowWorld;t.resetTransform(),t.opacity=i,t.copyWorld(n,h,void 0,s),a?n.recycle(h):n.clearWorld(h)}zt.prototype.__renderMask=function(e,t){let n,i,s,a,h,l,{children:u}=this;for(let f=0,g=u.length;f<g;f++){if(n=u[f],l=n.__.mask,l){h&&(zl(this,h,e,s,i,a,void 0,!0),i=s=null),l!=="clipping"&&l!=="clipping-path"||Zv(n,t)||n.__render(e,t),a=n.__.opacity,jf=!1,l==="path"||l==="clipping-path"?(a<1?(h="opacity-path",s||(s=If(e))):(h="path",e.save()),n.__clip(s||e,t)):(h=l==="grayscale"?"grayscale":"alpha",i||(i=If(e)),s||(s=If(e)),n.__render(i,t));continue}let p=a===1&&n.__.__blendMode;p&&zl(this,h,e,s,i,a,void 0,!1),Zv(n,t)||n.__render(s||e,t),p&&zl(this,h,e,s,i,a,p,!1)}zl(this,h,e,s,i,a,void 0,!0)};var s1=`>)]}%!?,.:;'"\u300B\uFF09\u300D\u3009\u300F\u3017\u3011\u3015\uFF5D\u2510\uFF1E\u2019\u201D\uFF01\uFF1F\uFF0C\u3001\u3002\uFF1A\uFF1B\u2030`,o2=s1+"_#~&*+\\=|\u226E\u226F\u2248\u2260\uFF1D\u2026",a2=new RegExp([[19968,40959],[13312,19903],[131072,173791],[173824,177983],[177984,178207],[178208,183983],[183984,191471],[196608,201551],[201552,205743],[11904,12031],[12032,12255],[12272,12287],[12288,12351],[12736,12783],[12800,13055],[13056,13311],[63744,64255],[65072,65103],[127488,127743],[194560,195103]].map(([e,t])=>`[\\u${e.toString(16)}-\\u${t.toString(16)}]`).join("|"));function Sa(e){let t={};return e.split("").forEach(n=>t[n]=!0),t}var h2=Sa("ABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789abcdefghijklmnopqrstuvwxyz"),l2=Sa(`{[(<'"\u300A\uFF08\u300C\u3008\u300E\u3016\u3010\u3014\uFF5B\u250C\uFF1C\u2018\u201C\uFF1D\xA5\uFFE5\uFF04\u20AC\xA3\uFFE1\xA2\uFFE0`),c2=Sa(s1),u2=Sa(o2),d2=Sa("- \u2014\uFF0F\uFF5E\uFF5C\u2506\xB7"),Xl;(function(e){e[e.Letter=0]="Letter",e[e.Single=1]="Single",e[e.Before=2]="Before",e[e.After=3]="After",e[e.Symbol=4]="Symbol",e[e.Break=5]="Break"})(Xl||(Xl={}));var{Letter:Jv,Single:f2,Before:p2,After:g2,Symbol:_2,Break:m2}=Xl;function y2(e){return h2[e]?Jv:d2[e]?m2:l2[e]?p2:c2[e]?g2:u2[e]?_2:a2.test(e)?f2:Jv}var v2={trimRight(e){let{words:t}=e,n,i=0,s=t.length;for(let a=s-1;a>-1&&(n=t[a].data[0],n.char===" ");a--)i++,e.width-=n.width;i&&t.splice(s-i,i)}};function w2(e,t,n){switch(t){case"title":return n?e.toUpperCase():e;case"upper":return e.toUpperCase();case"lower":return e.toLowerCase();default:return e}}var{trimRight:x2}=v2,{Letter:zf,Single:ya,Before:Qv,After:Wf,Symbol:b2,Break:t1}=Xl,xa,yi,je,cn,Ff,ni,Fi,ba,Zs,Fn,ur,Nf,va,js,Ea,Hl,Zf,qs=[];function Hf(e,t){Zs&&!ba&&(ba=Zs),xa.data.push({char:e,width:t}),je+=t}function Vr(){cn+=je,xa.width=je,yi.words.push(xa),xa={data:[]},je=0}function wa(){js&&(Ea.paraNumber++,yi.paraStart=!0,js=!1),Zs&&(yi.startCharSize=ba,yi.endCharSize=Zs,ba=0),yi.width=cn,Hl.width?x2(yi):Zf&&o1(),qs.push(yi),yi={words:[]},cn=0}function o1(){cn>(Ea.maxWidth||0)&&(Ea.maxWidth=cn)}var{top:Wl,right:e1,bottom:n1,left:Fl}=pl;function Nl(e,t,n){let{bounds:i,rows:s}=e;i[t]+=n;for(let a=0;a<s.length;a++)s[a][t]+=n}var E2={getDrawData:function(e,t){gt(e)||(e=String(e));let n=0,i=0,s=t.__getInput("width")||0,a=t.__getInput("height")||0,{__padding:h}=t;h&&(s?(n=h[Fl],s-=h[e1]+h[Fl],!s&&(s=.01)):t.autoSizeAlign||(n=h[Fl]),a?(i=h[Wl],a-=h[Wl]+h[n1],!a&&(a=.01)):t.autoSizeAlign||(i=h[Wl]));let l={bounds:{x:n,y:i,width:s,height:a},rows:[],paraNumber:0,font:N.canvas.font=t.__font};return function(u,f,g){Ea=u,qs=u.rows,Hl=u.bounds,Zf=!Hl.width&&!g.autoSizeAlign;let{__letterSpacing:p,paraIndent:v,textCase:w}=g,{canvas:E}=N,{width:P}=Hl;if(g.__isCharMode){let S=g.textWrap!=="none",R=g.textWrap==="break";js=!0,ur=null,ba=Fi=Zs=je=cn=0,xa={data:[]},yi={words:[]},p&&(f=[...f]);for(let A=0,I=f.length;A<I;A++)ni=f[A],ni===`
`?(je&&Vr(),yi.paraEnd=!0,wa(),js=!0):(Fn=y2(ni),Fn===zf&&w!=="none"&&(ni=w2(ni,w,!je)),Fi=E.measureText(ni).width,p&&(p<0&&(Zs=Fi),Fi+=p),Nf=Fn===ya&&(ur===ya||ur===zf)||ur===ya&&Fn!==Wf,va=!(Fn!==Qv&&Fn!==ya||ur!==b2&&ur!==Wf),Ff=js&&v?P-v:P,S&&P&&cn+je+Fi>Ff&&(R?(je&&Vr(),cn&&wa()):(va||(va=Fn===zf&&ur==Wf),(Nf||va||Fn===t1||Fn===Qv||Fn===ya||je+Fi>Ff)&&je&&Vr(),cn&&wa())),ni===" "&&js!==!0&&cn+je===0||(Fn===t1?(ni===" "&&je&&Vr(),Hf(ni,Fi),Vr()):((Nf||va)&&je&&Vr(),Hf(ni,Fi))),ur=Fn);je&&Vr(),cn&&wa(),qs.length>0&&(qs[qs.length-1].paraEnd=!0)}else f.split(`
`).forEach(S=>{Ea.paraNumber++,cn=E.measureText(S).width,qs.push({x:v||0,text:S,width:cn,paraStart:!0}),Zf&&o1()})}(l,e,t),h&&function(u,f,g,p,v){if(!p&&g.autoSizeAlign)switch(g.textAlign){case"left":Nl(f,"x",u[Fl]);break;case"right":Nl(f,"x",-u[e1])}if(!v&&g.autoSizeAlign)switch(g.verticalAlign){case"top":Nl(f,"y",u[Wl]);break;case"bottom":Nl(f,"y",-u[n1])}}(h,l,t,s,a),function(u,f){let{rows:g,bounds:p}=u,v=g.length,{__lineHeight:w,__baseLine:E,__letterSpacing:P,__clipText:S,textAlign:R,verticalAlign:A,paraSpacing:I,autoSizeAlign:W}=f,{x:F,y:H,width:V,height:K}=p,ct=w*v+(I?I*(u.paraNumber-1):0),ft=E;if(S&&ct>K)ct=Math.max(K,w),v>1&&(u.overflow=v);else if(K||W)switch(A){case"middle":H+=(K-ct)/2;break;case"bottom":H+=K-ct}ft+=H;let it,Y,ot,Wt=V||W?V:u.maxWidth;for(let xt=0,Te=v;xt<Te;xt++){if(it=g[xt],it.x=F,it.width<V||it.width>V&&!S)switch(R){case"center":it.x+=(Wt-it.width)/2;break;case"right":it.x+=Wt-it.width}it.paraStart&&I&&xt>0&&(ft+=I),it.y=ft,ft+=w,u.overflow>xt&&ft>ct&&(it.isOverflow=!0,u.overflow=xt+1),Y=it.x,ot=it.width,P<0&&(it.width<0?(ot=-it.width+f.fontSize+P,Y-=ot,ot+=f.fontSize):ot-=P),Y<p.x&&(p.x=Y),ot>p.width&&(p.width=ot),S&&V&&V<ot&&(it.isOverflow=!0,u.overflow||(u.overflow=g.length))}p.y=H,p.height=ct}(l,t),t.__isCharMode&&function(u,f,g){let{rows:p}=u,{textAlign:v,paraIndent:w,letterSpacing:E}=f,P=g&&v.includes("both"),S=P||g&&v.includes("justify"),R=S&&v.includes("letter"),A,I,W,F,H,V,K,ct,ft,it;p.forEach(Y=>{Y.words&&(H=w&&Y.paraStart?w:0,ct=Y.words.length,S&&(it=!Y.paraEnd||P,I=g-Y.width-H,R?F=I/(Y.words.reduce((ot,Wt)=>ot+Wt.data.length,0)-1):W=ct>1?I/(ct-1):0),V=E||Y.isOverflow||R?0:W?1:2,Y.isOverflow&&!E&&(Y.textMode=!0),V===2?(Y.x+=H,function(ot){ot.text="",ot.words.forEach(Wt=>{Wt.data.forEach(xt=>{ot.text+=xt.char})})}(Y)):(Y.x+=H,A=Y.x,Y.data=[],Y.words.forEach((ot,Wt)=>{V===1?(K={char:"",x:A},A=function(xt,Te,Ye){return xt.forEach(ke=>{Ye.char+=ke.char,Te+=ke.width}),Te}(ot.data,A,K),(Y.isOverflow||K.char!==" ")&&Y.data.push(K)):A=function(xt,Te,Ye,ke,Hi){return xt.forEach(Cn=>{(ke||Cn.char!==" ")&&(Cn.x=Te,Ye.push(Cn)),Te+=Cn.width,Hi&&(Te+=Hi)}),Te}(ot.data,A,Y.data,Y.isOverflow,it&&F),it&&(ft=Wt===ct-1,W?ft||(A+=W,Y.width+=W):F&&(Y.width+=F*(ot.data.length-(ft?1:0))))})),Y.words=null)})}(l,t,s),l.overflow&&function(u,f,g,p){if(!p)return;let{rows:v,overflow:w}=u,{textOverflow:E}=f;if(v.splice(w),E&&E!=="show"){let P,S;E==="hide"?E="":E==="ellipsis"&&(E="...");let R=E?N.canvas.measureText(E).width:0,A=g+p-R;(f.textWrap==="none"?v:[v[w-1]]).forEach(I=>{if(I.isOverflow&&I.data){let W=I.data.length-1;for(let F=W;F>-1&&(P=I.data[F],S=P.x+P.width,!(F===W&&S<A));F--){if(S<A&&P.char!==" "||!F){I.data.splice(F+1),I.width-=P.width;break}I.width-=P.width}I.width+=R,I.data.push({char:E,x:S}),I.textMode&&function(F){F.text="",F.data.forEach(H=>{F.text+=H.char}),F.data=null}(I)}})}}(l,t,n,s),t.textDecoration!=="none"&&function(u,f){let g,p=0,{fontSize:v,textDecoration:w}=f;switch(u.decorationHeight=v/11,ht(w)?(g=w.type,w.color&&(u.decorationColor=we.string(w.color)),w.offset&&(p=Math.min(.3*v,Math.max(w.offset,.15*-v)))):g=w,g){case"under":u.decorationY=[.15*v+p];break;case"delete":u.decorationY=[.35*-v];break;case"under-delete":u.decorationY=[.15*v+p,.35*-v]}}(l,t),l}},S2={string:function(e,t){if(!e)return"#000";let n=Dt(t)&&t<1;if(gt(e)){if(!n||!we.object)return e;e=we.object(e)}let i=J(e.a)?1:e.a;n&&(i*=t);let s=e.r+","+e.g+","+e.b;return i===1?"rgb("+s+")":"rgba("+s+","+i+")"}};Object.assign(mf,E2),Object.assign(we,S2),Object.assign(_t,kk),Object.assign(xe,Gk),Object.assign(sa,Jk),Object.assign(Di,s2),Object.assign($t,{interaction:(e,t,n,i)=>new Xf(e,t,n,i),hitCanvas:(e,t)=>new Ul(e,t),hitCanvasManager:()=>new Al}),pk();var{M:C2,L:T2,C:L2,Q:P2,Z:B2,N:R2,D:O2,X:A2,G:a1,F:h1,O:k2,P:M2,U:D2}=wn,Qf={scale(e,t,n){if(!e)return;let i,s=0,a=e.length;for(;s<a;)switch(i=e[s],i){case C2:case T2:ii(e,t,n,s,1),s+=3;break;case L2:ii(e,t,n,s,3),s+=7;break;case P2:ii(e,t,n,s,2),s+=5;break;case B2:s+=1;break;case R2:ii(e,t,n,s,2),s+=5;break;case O2:ii(e,t,n,s,2),s+=9;break;case A2:ii(e,t,n,s,2),s+=6;break;case a1:ii(e,t,n,s,2),s+=9;break;case h1:ii(e,t,n,s,2),s+=5;break;case k2:e[s]=a1,e.splice(s+4,0,e[s+3],0),ii(e,t,n,s,2),s+=9,a+=2;break;case M2:e[s]=h1,e.splice(s+4,0,e[s+3]),ii(e,t,n,s,2),s+=5,a+=1;break;case D2:ii(e,t,n,s,2),s+=6}},scalePoints(e,t,n,i,s){for(let a=s?i+1:0,h=s?a+2*s:e.length;a<h;a+=2)e[a]*=t,e[a+1]*=n}},{scalePoints:ii}=Qf,Jf=rt.get(),{topLeft:I2,top:z2,topRight:W2,right:F2,bottom:N2,left:H2}=ir;function Gl(e,t,n){e.pathInputed?ql(e,t,n):(t!==1&&(e.width*=t),n!==1&&(e.height*=n))}function U2(e,t,n,i){let s=t;if(!J(i)){let l=e.__layout,{width:u,height:f}=l.boxBounds;switch(u*=n-t,f*=t-n,i){case z2:case N2:s=n,l.affectScaleOrRotation?e.moveInner(-u/2,0):e.x-=u/2;break;case H2:case F2:l.affectScaleOrRotation?e.moveInner(0,-f/2):e.y-=f/2;break;case I2:case W2:l.affectScaleOrRotation?e.moveInner(0,-f):e.y-=f}}e.fontSize*=s;let a=e.__,{padding:h}=a;h&&(e.padding=Ct(h)?h.map(l=>l*s):h*s),a.__autoWidth||(e.width*=s),a.__autoHeight||(e.height*=s)}function ql(e,t,n){Qf.scale(e.__.path,t,n),e.path=e.__.path}function l1(e,t,n){let{points:i}=e;ht(i[0])?i.forEach(s=>{s.x*=t,s.y*=n}):Qf.scalePoints(i,t,n),e.points=i}function c1(e,t,n){let{children:i}=e;for(let s=0;s<i.length;s++)Jf.a=t,Jf.d=n,i[s].transform(Jf,!0)}var Kl=fi.prototype;Kl.scaleResize=function(e,t=e,n){let i=this;n||i.editConfig&&i.editConfig.editSize==="scale"?(i.scaleX*=e,i.scaleY*=t):(e<0&&(i.scaleX*=-1,e=-e),t<0&&(i.scaleY*=-1,t=-t),this.__scaleResize(e,t))},Kl.__scaleResize=function(e,t){Gl(this,e,t)},Kl.resizeWidth=function(e){let t=e/this.getBounds("box","local").width||1;this.scaleOf(this.__layout.boxBounds,t,this.__.lockRatio?t:1,!0)},Kl.resizeHeight=function(e){let t=e/this.getBounds("box","local").height||1;this.scaleOf(this.__layout.boxBounds,this.__.lockRatio?t:1,t,!0)},st.prototype.__scaleResize=function(e,t){let{app:n,editConfig:i}=this,s=n&&n.editor,a=s&&s.dragPoint;if(this.__.resizeFontSize||i&&i.editSize==="font-size"||a&&s.mergedConfig.editSize==="font-size")U2(this,e,t,a&&a.direction);else{let{__autoWidth:h,__autoHeight:l,textAlign:u,verticalAlign:f}=this.__,{boxBounds:g}=this.__layout;h&&u!=="left"&&e!==1&&(this.x+=g.x),l&&f!=="top"&&t!==1&&(this.y+=g.y),Gl(this,e,t)}},Hr.prototype.__scaleResize=function(e,t){ql(this,e,t)},qe.prototype.__scaleResize=function(e,t){this.pathInputed?ql(this,e,t):this.points?l1(this,e,t):this.width*=e},cr.prototype.__scaleResize=function(e,t){this.pathInputed?ql(this,e,t):this.points?l1(this,e,t):Gl(this,e,t)},zt.prototype.__scaleResize=function(e,t){c1(this,e,t)},ee.prototype.__scaleResize=function(e,t){let{resizeChildren:n,__autoSize:i}=this.__;i&&n||Gl(this,e,t),n&&c1(this,e,t)},Zt.add("resize");function fr(e,t,n,i){var s,a=arguments.length,h=a<3?t:i===null?i=Object.getOwnPropertyDescriptor(t,n):i;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")h=Reflect.decorate(e,t,n,i);else for(var l=e.length-1;l>=0;l--)(s=e[l])&&(h=(a<3?s(h):a>3?s(t,n,h):s(t,n))||h);return a>3&&h&&Object.defineProperty(t,n,h),h}function u1(e){return e?Ct(e)?e:[e]:[]}var Xt=class extends Ke{get list(){return u1(this.value)}get oldList(){return u1(this.oldValue)}constructor(t,n){super(t),n&&Object.assign(this,n)}};function hp(e){return(t,n)=>{let i="_"+n;En(t,n,{get(){return this[i]},set(s){let a=this[i];if(a!==s){let h=this;if(h.config){let l=n==="target";if(l){let{beforeSelect:f}=h.config;if(f){let g=f({target:s});if(ht(g))s=g;else if(g===!1)return}h.setDimOthers(!1),h.setBright(!1),Ct(s)&&s.length>1&&s[0].locked&&s.splice(0,1),h.single&&(delete h.element.syncEventer,delete h.element.__world.ignorePixelSnap)}let u=l?Xt.BEFORE_SELECT:Xt.BEFORE_HOVER;this.hasEvent(u)&&this.emitEvent(new Xt(u,{editor:h,value:s,oldValue:a}))}this[i]=s,e(this,a)}}})}}Xt.BEFORE_SELECT="editor.before_select",Xt.SELECT="editor.select",Xt.AFTER_SELECT="editor.after_select",Xt.BEFORE_HOVER="editor.before_hover",Xt.HOVER="editor.hover";var{abs:d1}=Math,{copy:Y2}=rt,{setListWithFn:V2}=X,{worldBounds:X2}=Fr,tp=jo(),f1=qo(),Qs=class extends D{constructor(){super(),this.list=[],this.visible=0,this.hittable=!1,this.strokeAlign="center"}setTarget(t,n){n&&this.set(n),this.target=t,this.update()}update(t){let{list:n}=this;n.length?(V2(f1,n,X2),t&&this.set(t),this.set(f1),this.visible=!0):this.visible=0}__draw(t,n){let{list:i}=this;if(i.length){let s,a=this.__,{stroke:h,strokeWidth:l,fill:u}=a,{bounds:f}=n;for(let g=0;g<i.length;g++){s=i[g];let{worldTransform:p,worldRenderBounds:v}=s;if(v.width&&v.height&&(!f||f.hit(v,n.matrix))){let w=d1(p.scaleX),E=d1(p.scaleY);Y2(tp,p),tp.half=l%2,t.setWorld(tp,n.matrix),t.beginPath(),this.strokePathType==="path"||s.__.__useArrow?s.__drawPath(t):s.__.__pathForRender?s.__drawRenderPath(t):s.__drawPathByBox(t),a.strokeWidth=l/Math.max(w,E),h&&(gt(h)?_t.stroke(h,this,t,n):_t.strokes(h,this,t,n)),u&&(gt(u)?_t.fill(u,this,t,n):_t.fills(u,this,t,n))}}a.strokeWidth=l}}destroy(){this.target=null,super.destroy()}};fr([hp(function(e){let t=e.target;e.list=t?Ct(t)?t:[t]:[]})],Qs.prototype,"target",void 0),fr([Jn("render-path")],Qs.prototype,"strokePathType",void 0);var lp=class extends zt{constructor(t){super(t),this.strokeArea=new Oe({strokeAlign:"center"}),this.fillArea=new Oe,this.visible=0,this.hittable=!1,this.addMany(this.fillArea,this.strokeArea)}setStyle(t,n){let{visible:i,stroke:s,strokeWidth:a}=t;this.visible=i,this.strokeArea.reset(Object.assign({stroke:s,strokeWidth:a},n||{})),this.fillArea.reset({visible:!n,fill:s,opacity:.2})}setBounds(t){this.strokeArea.set(t),this.fillArea.set(t)}},G2={findOne:e=>e.list.find(t=>t.editable),findByBounds(e,t){let n=[];return b1([e],n,t),n}};function b1(e,t,n){let i,s;for(let a=0,h=e.length;a<h;a++)if(i=e[a],s=i.__,s.hittable&&s.visible&&!s.locked&&n.hit(i.__world)){if(s.editable){if(i.isBranch&&!s.hitChildren){s.hitSelf&&t.push(i);continue}if(i.isFrame){if(n.includes(i.__layout.boxBounds,i.__world)){t.push(i);continue}}else n.hit(i.__layout.boxBounds,i.__world)&&s.hitSelf&&t.push(i)}i.isBranch&&b1(i.children,t,n)}}var{findOne:ep,findByBounds:K2}=G2,cp=class extends zt{get dragging(){return!!this.originList}get running(){let{editor:t,app:n}=this;return this.hittable&&t.visible&&t.hittable&&t.mergeConfig.selector&&n&&n.mode==="normal"}get isMoveMode(){let{app:t}=this;return t&&t.interaction.moveMode}constructor(t){super(),this.hoverStroker=new Qs,this.targetStroker=new Qs,this.bounds=new It,this.selectArea=new lp,this.__eventIds=[],this.editor=t,this.addMany(this.targetStroker,this.hoverStroker,this.selectArea),this.__listenEvents()}onHover(){let{editor:t}=this;if(!this.running||this.dragging||t.dragging)this.hoverStroker.target=null;else{let{hoverTarget:n,mergeConfig:i}=t,s=Object.assign({},i);n&&n.editConfig&&Object.assign(s,n.editConfig);let{stroke:a,strokeWidth:h,hover:l,hoverStyle:u}=s;this.hoverStroker.setTarget(l?n:null,Object.assign({stroke:a,strokeWidth:h},u||{}))}}onSelect(){this.running&&(this.targetStroker.setTarget(this.editor.list),this.hoverStroker.target=null)}update(){this.hoverStroker.update();let{stroke:t,strokeWidth:n,selectedPathType:i,selectedStyle:s}=this.editor.mergedConfig;this.targetStroker.update(Object.assign({stroke:t,strokeWidth:n&&Math.max(1,n/2),strokePathType:i},s||{}))}onPointerMove(t){let{app:n,editor:i}=this;if(this.running&&!this.isMoveMode&&n.interaction.canHover&&!n.interaction.dragging){let s=this.findUI(t);i.hoverTarget=i.hasItem(s)?null:s}this.isMoveMode&&(i.hoverTarget=null)}onBeforeDown(t){if(t.multiTouch)return;let{select:n}=this.editor.mergeConfig;n==="press"&&(this.app.config.mobile?this.waitSelect=()=>this.checkAndSelect(t):this.checkAndSelect(t))}onTap(t){if(t.multiTouch)return;let{editor:n}=this,{select:i,selectKeep:s}=n.mergeConfig;i==="tap"?this.checkAndSelect(t):this.waitSelect&&this.waitSelect(),this.needRemoveItem?n.removeItem(this.needRemoveItem):this.isMoveMode&&(s||(n.target=null))}checkAndSelect(t){if(this.needRemoveItem=null,this.allowSelect(t)){let{editor:n}=this,i=this.findUI(t);i?this.isMultipleSelect(t)?n.hasItem(i)?this.needRemoveItem=i:n.addItem(i):n.target=i:this.allow(t.target)&&(this.isHoldMultipleSelectKey(t)||this.editor.mergedConfig.selectKeep||(n.target=null))}}onDragStart(t){if(!t.multiTouch&&(this.waitSelect&&this.waitSelect(),this.allowDrag(t))){let{editor:n}=this,{stroke:i,area:s}=n.mergeConfig,{x:a,y:h}=t.getInnerPoint(this);this.bounds.set(a,h),this.selectArea.setStyle({visible:!0,stroke:i,x:a,y:h},s),this.selectArea.setBounds(this.bounds.get()),this.originList=n.leafList.clone()}}onDrag(t){if(!t.multiTouch){if(this.editor.dragging)return this.onDragEnd(t);if(this.dragging){let{editor:n}=this,i=t.getInnerTotal(this),s=this.bounds.clone().unsign(),a=new Bt(K2(n.app,s));if(this.bounds.width=i.x,this.bounds.height=i.y,this.selectArea.setBounds(s.get()),a.length){let h=[];this.originList.forEach(l=>{a.has(l)||h.push(l)}),a.forEach(l=>{this.originList.has(l)||h.push(l)}),(h.length!==n.list.length||n.list.some((l,u)=>l!==h[u]))&&(n.target=h)}else n.target=this.originList.list}}}onDragEnd(t){t.multiTouch||this.dragging&&(this.originList=null,this.selectArea.visible=0)}onAutoMove(t){if(this.dragging){let{x:n,y:i}=t.getLocalMove(this);this.bounds.x+=n,this.bounds.y+=i}}allow(t){return t.leafer!==this.editor.leafer}allowDrag(t){let{boxSelect:n,multipleSelect:i}=this.editor.mergeConfig;return!(!(this.running&&i&&n)||t.target.draggable)&&(!this.editor.editing&&this.allow(t.target)||this.isHoldMultipleSelectKey(t)&&!ep(t.path))}allowSelect(t){return this.running&&!this.isMoveMode&&!t.middle}findDeepOne(t){let n={exclude:new Bt(this.editor.editBox.rect)};return ep(t.target.leafer.interaction.findPath(t,n))}findUI(t){return this.isMultipleSelect(t)?this.findDeepOne(t):ep(t.path)}isMultipleSelect(t){let{multipleSelect:n,continuousSelect:i}=this.editor.mergeConfig;return n&&(this.isHoldMultipleSelectKey(t)||i)}isHoldMultipleSelectKey(t){let{multipleSelectKey:n}=this.editor.mergedConfig;return n?t.isHoldKeys(n):t.shiftKey}__listenEvents(){let{editor:t}=this;t.waitLeafer(()=>{let{app:n}=t;n.selector.proxy=t,this.__eventIds=[t.on_([[Xt.HOVER,this.onHover,this],[Xt.SELECT,this.onSelect,this]]),n.on_([[G.MOVE,this.onPointerMove,this],[G.BEFORE_DOWN,this.onBeforeDown,this],[G.TAP,this.onTap,this],[dt.START,this.onDragStart,this,!0],[dt.DRAG,this.onDrag,this],[dt.END,this.onDragEnd,this],[Ot.MOVE,this.onAutoMove,this],[[pe.ZOOM,Ot.MOVE],()=>{this.editor.hoverTarget=null}]])]})}__removeListenEvents(){this.off_(this.__eventIds)}destroy(){this.editor=this.originList=this.needRemoveItem=null,this.__removeListenEvents(),super.destroy()}},{topLeft:Gr,top:Ca,topRight:Kr,right:Ta,bottomRight:qr,bottom:La,bottomLeft:jr,left:Pa}=ir,{toPoint:np}=xn,{within:p1,sign:dr}=Kt,{abs:Ba}=Math,Zr={getScaleData(e,t,n,i,s,a,h,l){let u,f,g={},p=1,v=1,{boxBounds:w,widthRange:E,heightRange:P,dragBounds:S,worldBoxBounds:R}=e,{width:A,height:I}=t,W=e.scaleX/t.scaleX,F=e.scaleY/t.scaleY,H=dr(W),V=dr(F),K=l?W:H*w.width/A,ct=l?F:V*w.height/I;if(Dt(i))p=v=Math.sqrt(i);else{a&&(i.x*=2,i.y*=2),i.x*=l?W:H,i.y*=l?F:V;let Y=(-i.y+I)/I,ot=(i.x+A)/A,Wt=(i.y+I)/I,xt=(-i.x+A)/A;switch(n){case Ca:v=Y,u="bottom";break;case Ta:p=ot,u="left";break;case La:v=Wt,u="top";break;case Pa:p=xt,u="right";break;case Gr:v=Y,p=xt,u="bottom-right";break;case Kr:v=Y,p=ot,u="bottom-left";break;case qr:v=Wt,p=ot,u="top-left";break;case jr:v=Wt,p=xt,u="top-right"}if(s)if(s==="corner"&&n%2)s=!1;else switch(n){case Ca:case La:p=v;break;case Pa:case Ta:v=p;break;default:f=Math.sqrt(Ba(p*v)),p=dr(p)*f,v=dr(v)*f}}let ft=p!==1,it=v!==1;if(ft&&(p/=K),it&&(v/=ct),!h){let{worldTransform:Y}=e;p<0&&(p=1/w.width/Y.scaleX),v<0&&(v=1/w.height/Y.scaleY)}if(np(a||u,w,g,!0),S){let Y={x:p,y:v};Ur.limitScaleOf(e,g,Y,s),p=Y.x,v=Y.y}if(ft&&E){let Y=w.width*e.scaleX;p=p1(Y*p,E)/Y}if(it&&P){let Y=w.height*e.scaleY;v=p1(Y*v,P)/Y}return ft&&Ba(p*R.width)<1&&(p=dr(p)/R.width),it&&Ba(v*R.height)<1&&(v=dr(v)/R.height),s&&p!==v&&(f=Math.min(Ba(p),Ba(v)),p=dr(p)*f,v=dr(v)*f),isFinite(p)||(p=1),isFinite(v)||(v=1),{origin:g,scaleX:p,scaleY:v,direction:n,lockRatio:s,around:a}},getRotateData(e,t,n,i,s){let a,h={};switch(t){case Gr:a="bottom-right";break;case Kr:a="bottom-left";break;case qr:a="top-left";break;case jr:a="top-right";break;default:a="center"}return np(s||a,e.boxBounds,h,!0),{origin:h,rotation:j.getRotation(i,e.getWorldPointByBox(h),n)}},getSkewData(e,t,n,i){let s,a,h={},l=0,u=0;switch(t){case Ca:case Gr:a={x:.5,y:0},s="bottom",l=1;break;case La:case qr:a={x:.5,y:1},s="top",l=1;break;case Pa:case jr:a={x:0,y:.5},s="right",u=1;break;case Ta:case Kr:a={x:1,y:.5},s="left",u=1}let{width:f,height:g}=e;a.x=a.x*f,a.y=a.y*g,np(i||s,e,h,!0);let p=j.getRotation(a,h,{x:a.x+(l?n.x:0),y:a.y+(u?n.y:0)});return l?l=-p:u=p,{origin:h,skewX:l,skewY:u}},getAround:(e,t)=>t&&!e?"center":e,getRotateDirection:(e,t,n=8)=>((e=(e+Math.round(t/(360/n)))%n)<0&&(e+=n),e),getFlipDirection(e,t,n){if(t)switch(e){case Pa:e=Ta;break;case Gr:e=Kr;break;case jr:e=qr;break;case Ta:e=Pa;break;case Kr:e=Gr;break;case qr:e=jr}if(n)switch(e){case Ca:e=La;break;case Gr:e=jr;break;case Kr:e=qr;break;case La:e=Ca;break;case jr:e=Gr;break;case qr:e=Kr}return e}},ip={};function rp(e,t){let{enterPoint:n,dragging:i,skewing:s,resizing:a,flippedX:h,flippedY:l}=e;if(!n||!e.editor.editing||!e.canUse)return;if(n.name==="rect")return E1(e);if(n.name==="circle")return;let{rotation:u}=e,{pointType:f}=n,{moveCursor:g,resizeCursor:p,rotateCursor:v,skewCursor:w,moveable:E,resizeable:P,rotateable:S,skewable:R}=e.mergeConfig;if(f==="move")return n.cursor=g,void(E||(n.visible=!1));if(f==="button")return void(n.cursor||(n.cursor="pointer"));let A=f.includes("resize");A&&S&&(e.isHoldRotateKey(t)||!P)&&(A=!1);let I=R&&!A&&(n.name==="resize-line"||f==="skew"),W=i?s?w:a?p:v:I?w:A?p:v;u+=45*(Zr.getFlipDirection(n.direction,h,l)+1),u=2*Math.round(Kt.formatRotation(u,!0)/2);let{url:F,x:H,y:V}=W,K=F+u;ip[K]?n.cursor=ip[K]:ip[K]=n.cursor={url:q2(F,u),x:H,y:V}}function E1(e){let{moveCursor:t,moveable:n}=e.mergeConfig;e.canUse&&(e.rect.cursor=n?t:void 0)}function q2(e,t){return'"data:image/svg+xml,'+encodeURIComponent(e.replace("{{rotation}}",t.toString()))+'"'}var $r=class extends ee{constructor(t){super(t),this.useFastShadow=!0}},g1=["top","right","bottom","left"],_1=void 0,up=class extends zt{get mergeConfig(){let{config:t}=this,{mergeConfig:n,editBox:i}=this.editor;return this.mergedConfig=t&&i!==this?Object.assign(Object.assign({},n),t):n}get target(){return this._target||this.editor.element}set target(t){this._target=t}get single(){return!!this._target||this.editor.single}get transformTool(){return this._transformTool||this.editor}set transformTool(t){this._transformTool=t}get flipped(){return this.flippedX||this.flippedY}get flippedX(){return this.scaleX<0}get flippedY(){return this.scaleY<0}get flippedOne(){return this.scaleX*this.scaleY<0}get canUse(){return this.app&&this.editor.editing}get canGesture(){if(!this.canUse)return!1;let{moveable:t,resizeable:n,rotateable:i}=this.mergeConfig;return gt(t)||gt(n)||gt(i)}get canDragLimitAnimate(){return this.moving&&this.mergeConfig.dragLimitAnimate&&this.target.dragBounds}constructor(t){super(),this.view=new zt,this.rect=new $r({name:"rect",hitFill:"all",hitStroke:"none",strokeAlign:"center",hitRadius:5}),this.circle=new $r({name:"circle",strokeAlign:"center",around:"center",cursor:"crosshair",hitRadius:5}),this.buttons=new zt({around:"center",hitSelf:!1,visible:0}),this.resizePoints=[],this.rotatePoints=[],this.resizeLines=[],this.dragStartData={},this.__eventIds=[],this.editor=t,this.visible=!1,this.create(),this.__listenEvents()}create(){let t,n,i,{view:s,resizePoints:a,rotatePoints:h,resizeLines:l,rect:u,circle:f,buttons:g}=this,p=["bottom-right","bottom","bottom-left","left","top-left","top","top-right","right"];for(let v=0;v<8;v++)t=new $r({name:"rotate-point",around:p[v],width:15,height:15,hitFill:"all"}),h.push(t),this.listenPointEvents(t,"rotate",v),v%2&&(n=new $r({name:"resize-line",around:"center",width:10,height:10,hitFill:"all"}),l.push(n),this.listenPointEvents(n,"resize",v)),i=new $r({name:"resize-point",hitRadius:5}),a.push(i),this.listenPointEvents(i,"resize",v);this.listenPointEvents(f,"rotate",2),this.listenPointEvents(u,"move",8),s.addMany(...h,u,f,g,...l,...a),this.add(s)}load(){let{target:t,mergeConfig:n,single:i,rect:s,circle:a,resizePoints:h,resizeLines:l}=this,{stroke:u,strokeWidth:f,ignorePixelSnap:g}=n,p=this.getPointsStyle(),v=this.getMiddlePointsStyle(),w=this.getResizeLinesStyle(),E;this.visible=!t.locked;for(let S=0;S<8;S++)E=h[S],E.set(this.getPointStyle(S%2?v[(S-1)/2%v.length]:p[S/2%p.length])),E.rotation=(S-(S%2?1:0))/2*90,S%2&&l[(S-1)/2].set(Object.assign({pointType:"resize",rotation:(S-1)/2*90},w[(S-1)/2%w.length]||{}));a.set(this.getPointStyle(n.circle||n.rotatePoint||p[0])),s.set(Object.assign({stroke:u,strokeWidth:f,opacity:1,editConfig:_1},n.rect||{}));let P=Be(n.rectThrough)?i:n.rectThrough;s.hittable=!P,P&&(t.syncEventer=s,this.app.interaction.bottomList=[{target:s,proxy:t}]),i&&vt.stintSet(t.__world,"ignorePixelSnap",g),E1(this)}update(){let{editor:t}=this,{x:n,y:i,scaleX:s,scaleY:a,rotation:h,skewX:l,skewY:u,width:f,height:g}=this.target.getLayoutBounds("box",t,!0);this.visible=!this.target.locked,this.set({x:n,y:i,scaleX:s,scaleY:a,rotation:h,skewX:l,skewY:u}),this.updateBounds({x:0,y:0,width:f,height:g})}unload(){this.visible=!1,this.app&&(this.rect.syncEventer=this.app.interaction.bottomList=null)}updateBounds(t){let{editor:n,mergeConfig:i,single:s,rect:a,circle:h,buttons:l,resizePoints:u,rotatePoints:f,resizeLines:g}=this,{editMask:p}=n,{middlePoint:v,resizeable:w,rotateable:E,hideOnSmall:P,editBox:S,mask:R,dimOthers:A,bright:I,spread:W,hideRotatePoints:F,hideResizeLines:H}=i;if(p.visible=!!R||0,n.setDimOthers(A),n.setBright(!!A||I),W&&X.spread(t,W),this.view.worldOpacity){let{width:V,height:K}=t,ct=Dt(P)?P:10,ft=S&&!(P&&V<ct&&K<ct),it,Y,ot,Wt={};for(let xt=0;xt<8;xt++)xn.toPoint(xn.directionData[xt],t,Wt),Y=u[xt],it=f[xt],Y.set(Wt),it.set(Wt),Y.visible=ft&&!(!w&&!E),it.visible=ft&&E&&w&&!F,xt%2&&(ot=g[(xt-1)/2],ot.set(Wt),ot.visible=Y.visible&&!H,Y.visible=it.visible=ft&&!!v,(xt+1)/2%2?(ot.width=V+ot.height,P&&2*Y.width>V&&(Y.visible=!1)):(ot.width=K+ot.height,P&&2*Y.width>K&&(Y.visible=!1)));h.visible=ft&&E&&!(!i.circle&&!i.rotatePoint),h.visible&&this.layoutCircle(),a.path&&(a.path=null),a.set(Object.assign(Object.assign({},t),{visible:!s||S})),l.visible=ft&&l.children.length>0||0,l.visible&&this.layoutButtons()}else a.set(t)}layoutCircle(){let{circleDirection:t,circleMargin:n,buttonsMargin:i,buttonsDirection:s,middlePoint:a}=this.mergedConfig,h=g1.indexOf(t||(this.buttons.children.length&&s==="bottom"?"top":"bottom"));this.setButtonPosition(this.circle,h,n||i,!!a)}layoutButtons(){let{buttons:t}=this,{buttonsDirection:n,buttonsFixed:i,buttonsMargin:s,middlePoint:a}=this.mergedConfig,{flippedX:h,flippedY:l}=this,u=g1.indexOf(n);(u%2&&h||(u+1)%2&&l)&&i&&(u=(u+2)%4);let f=i?Zr.getRotateDirection(u,this.flippedOne?this.rotation:-this.rotation,4):u;this.setButtonPosition(t,f,s,!!a),i&&(t.rotation=90*(f-u)),t.scaleX=h?-1:1,t.scaleY=l?-1:1}setButtonPosition(t,n,i,s){let a=this.resizePoints[2*n+1],h=n%2,l=n&&n!==3?1:-1,u=(i+(n%2?(s?a.width:0)+t.boxBounds.width:(s?a.height:0)+t.boxBounds.height)/2)*l;h?(t.x=a.x+u,t.y=a.y):(t.x=a.x,t.y=a.y+u)}getPointStyle(t){let{stroke:n,strokeWidth:i,pointFill:s,pointSize:a,pointRadius:h}=this.mergedConfig,l={fill:s,stroke:n,strokeWidth:i,around:"center",strokeAlign:"center",opacity:1,width:a,height:a,cornerRadius:h,offsetX:0,offsetY:0,editConfig:_1};return t?Object.assign(l,t):l}getPointsStyle(){let{point:t}=this.mergedConfig;return Ct(t)?t:[t]}getMiddlePointsStyle(){let{middlePoint:t}=this.mergedConfig;return Ct(t)?t:t?[t]:this.getPointsStyle()}getResizeLinesStyle(){let{resizeLine:t}=this.mergedConfig;return Ct(t)?t:[t]}onDragStart(t){this.dragging=!0;let n=this.dragPoint=t.current,{pointType:i}=n,{moveable:s,resizeable:a,rotateable:h,skewable:l}=this.mergeConfig;i==="move"?s&&(this.moving=!0):(i.includes("rotate")||this.isHoldRotateKey(t)||!a?(h&&(this.rotating=!0),i==="resize-rotate"?a&&(this.resizing=!0):n.name==="resize-line"&&(l&&(this.skewing=!0),this.rotating=!1)):i==="resize"&&a&&(this.resizing=!0),i==="skew"&&l&&(this.skewing=!0)),this.onTransformStart(t)}onDrag(t){let{transformTool:n,moving:i,resizing:s,rotating:a,skewing:h}=this;if(i)n.onMove(t);else if(s||a||h){let l=t.current;l.pointType&&(this.enterPoint=l),a&&n.onRotate(t),s&&n.onScale(t),h&&n.onSkew(t)}rp(this,t)}onDragEnd(t){this.onTransformEnd(t),this.dragPoint=null}onTransformStart(t){(this.moving||this.gesturing)&&(this.editor.opacity=this.mergedConfig.hideOnMove?0:1),this.resizing&&(an.resizingKeys=this.editor.leafList.keys);let{dragStartData:n,target:i}=this;n.x=t.x,n.y=t.y,n.totalOffset=Ko(),n.point={x:i.x,y:i.y},n.bounds=Object.assign({},i.getLayoutBounds("box","local")),n.rotation=i.rotation}onTransformEnd(t){this.canDragLimitAnimate&&(t instanceof dt||t instanceof Ot)&&this.transformTool.onMove(t),this.resizing&&(an.resizingKeys=null),this.dragging=this.gesturing=this.moving=this.resizing=this.rotating=this.skewing=!1,this.editor.opacity=1,this.editor.update()}onMove(t){if(this.canGesture&&t.moveType!=="drag"&&(t.stop(),gt(this.mergedConfig.moveable)))switch(this.gesturing=this.moving=!0,t.type){case Ot.START:this.onTransformStart(t);break;case Ot.END:this.onTransformEnd(t);break;default:this.transformTool.onMove(t)}}onScale(t){if(this.canGesture&&(t.stop(),gt(this.mergedConfig.resizeable)))switch(this.gesturing=this.resizing=!0,t.type){case pe.START:this.onTransformStart(t);break;case pe.END:this.onTransformEnd(t);break;default:this.transformTool.onScale(t)}}onRotate(t){if(this.canGesture&&(t.stop(),gt(this.mergedConfig.rotateable)))switch(this.gesturing=this.rotating=!0,t.type){case pe.START:this.onTransformStart(t);break;case pe.END:this.onTransformEnd(t);break;default:this.transformTool.onRotate(t)}}isHoldRotateKey(t){let{rotateKey:n}=this.mergedConfig;return n?t.isHoldKeys(n):t.metaKey||t.ctrlKey}onKey(t){rp(this,t)}onArrow(t){if(this.canUse&&this.mergeConfig.keyEvent){let n=0,i=0,s=t.shiftKey?10:1;switch(t.code){case"ArrowDown":i=s;break;case"ArrowUp":i=-s;break;case"ArrowLeft":n=-s;break;case"ArrowRight":n=s}(n||i)&&this.transformTool.move(n,i)}}onDoubleTap(t){let{openInner:n,preventEditInner:i}=this.mergeConfig;n!=="double"||i||this.openInner(t)}onLongPress(t){let{openInner:n,preventEditInner:i}=this.mergeConfig;n==="long"&&i&&this.openInner(t)}openInner(t){let{editor:n,target:i}=this;if(this.single){if(i.locked)return;if(i.isBranch&&!i.editInner){if(i.textBox){let{children:s}=i,a=s.find(h=>h.editable&&h instanceof st)||s.find(h=>h instanceof st);if(a)return n.openInnerEditor(a)}n.openGroup(i),n.target=n.selector.findDeepOne(t)}else n.openInnerEditor()}}listenPointEvents(t,n,i){t.direction=i,t.pointType=n,this.__eventIds.push(t.on_([[dt.START,this.onDragStart,this],[dt.DRAG,this.onDrag,this],[dt.END,this.onDragEnd,this],[G.ENTER,s=>{this.enterPoint=t,rp(this,s)}],[G.LEAVE,()=>{this.enterPoint=null}]]))}__listenEvents(){let{rect:t,editor:n,__eventIds:i}=this;i.push(t.on_([[G.DOUBLE_TAP,this.onDoubleTap,this],[G.LONG_PRESS,this.onLongPress,this]])),this.waitLeafer(()=>{i.push(n.app.on_([[[fe.HOLD,fe.UP],this.onKey,this],[fe.DOWN,this.onArrow,this],[[Ot.START,Ot.BEFORE_MOVE,Ot.END],this.onMove,this,!0],[[pe.START,pe.BEFORE_ZOOM,pe.END],this.onScale,this,!0],[[Ue.START,Ue.BEFORE_ROTATE,Ue.END],this.onRotate,this,!0]]))})}__removeListenEvents(){this.off_(this.__eventIds)}destroy(){this.editor=null,this.__removeListenEvents(),super.destroy()}},m1={x:0,y:0,width:1e5,height:1e5},dp=class extends D{constructor(t){super(),this.editor=t,this.hittable=!1,this.visible=0}__updateWorldBounds(){Object.assign(this.__local,m1),Object.assign(this.__world,m1)}__draw(t,n){let{editor:i}=this,{mask:s}=i.mergedConfig;if(s&&i.editing){if(t.fillWorld(t.bounds,s===!0?"rgba(0,0,0,0.8)":s),n.bounds&&!n.bounds.hit(i.editBox.rect.__world,n.matrix))return;t.saveBlendMode("destination-out"),n=Object.assign(Object.assign({},n),{shape:!0}),i.list.forEach(a=>{a.__render(t,n);let{parent:h}=a;h&&h.textBox&&h.__renderShape(t,n)}),t.restoreBlendMode()}}destroy(){this.editor=null,super.destroy()}},sp=`
<feOffset dy="1"/>
<feGaussianBlur stdDeviation="1.5"/>
<feColorMatrix type="matrix" values="0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0.2 0"/>
<feBlend mode="normal" in="SourceGraphic" result="shape"/>`,j2={editSize:"size",keyEvent:!0,stroke:"#836DFF",strokeWidth:2,pointFill:"#FFFFFF",pointSize:10,pointRadius:16,rotateGap:45,buttonsDirection:"bottom",buttonsMargin:12,hideOnSmall:!0,moveCursor:"move",resizeCursor:{url:`
<svg width="24" height="24" xmlns="http://www.w3.org/2000/svg">
<g filter="url(#f)">
<g transform="rotate({{rotation}},12,12)">
<path d="M7.5 8.0H8.5V5.9L6.8 7.2L7.5 8.0ZM3 11.4L2.3 10.6L1.3 11.4L2.3 12.2L3 11.4ZM7.5 10.4H6.5V11.4H7.5V10.4ZM16.5 10.4V11.4H17.5V10.4H16.5ZM16.5 8.0L17.1 7.2L15.5 5.9V8.0H16.5ZM21 11.4L21.6 12.2L22.6 11.4L21.6 10.6L21 11.4ZM16.5 14.9H15.5V16.9L17.1 15.7L16.5 14.9ZM16.5 12.4H17.5V11.4H16.5V12.4ZM7.5 12.4V11.4H6.5V12.4H7.5ZM7.5 14.9L6.8 15.7L8.5 16.9V14.9H7.5ZM6.8 7.2L2.3 10.6L3.6 12.2L8.1 8.7L6.8 7.2ZM8.5 10.4V8.0H6.5V10.4H8.5ZM16.5 9.4H7.5V11.4H16.5V9.4ZM17.5 10.4V8.0H15.5V10.4H17.5ZM15.8 8.7L20.3 12.2L21.6 10.6L17.1 7.2L15.8 8.7ZM20.3 10.6L15.8 14.1L17.1 15.7L21.6 12.2L20.3 10.6ZM17.5 14.9V12.4H15.5V14.9H17.5ZM7.5 13.4H16.5V11.4H7.5V13.4ZM8.5 14.9V12.4H6.5V14.9H8.5ZM2.3 12.2L6.8 15.7L8.1 14.1L3.6 10.6L2.3 12.2Z" fill="white"/>
<path fill-rule="evenodd" d="M3 11.4L7.5 8.0V10.4H16.5V8.0L21 11.4L16.5 14.9V12.4H7.5V14.9L3 11.4Z" fill="black"/>
</g>
</g>
<defs>
<filter id="f" x="-1.6" y="3.9" width="27.2" height="16.9" filterUnits="userSpaceOnUse">
${sp}
</filter>
</defs>
</svg>
`,x:12,y:12},rotateCursor:{url:`
<svg width="24" height="24" xmlns="http://www.w3.org/2000/svg">
<g filter="url(#f)">
<g transform="rotate(135,12,12),rotate({{rotation}},12,12)">
<path d="M20.4 8H21.4L20.8 7.1L17.3 2.6L17 2.1L16.6 2.6L13.1 7.1L12.5 8H13.5H15.4C14.9 11.8 11.8 14.9 8 15.4V13.5V12.5L7.1 13.1L2.6 16.6L2.1 17L2.6 17.3L7.1 20.8L8 21.4V20.4V18.4C13.5 17.9 17.9 13.5 18.4 8H20.4Z" stroke="white"/>
<path fill-rule="evenodd" d="M17 3L20.4 7.5H17.9C17.7 13.1 13.1 17.7 7.5 17.9V20.4L3 17L7.5 13.5V15.9C12.0 15.7 15.7 12.0 15.9 7.5H13.5L17 3Z" fill="black"/>
</g>
</g>
<defs>
<filter id="f" x="-1.6" y="-0.6" width="27.1" height="27.1" filterUnits="userSpaceOnUse">
${sp}
</filter>
</defs>
</svg>
`,x:12,y:12},skewCursor:{url:`
<svg width="24" height="24" xmlns="http://www.w3.org/2000/svg">
<g filter="url(#f)">
<g transform="rotate(90,12,12),rotate({{rotation}},12,12)">
<path d="M21 10.4L21 11.4L23.8 11.4L21.6 9.6L21 10.4ZM17 10.4V11.4L17 11.4L17 10.4ZM15.5 6L16.1 5.2L14.5 3.9V6H15.5ZM15.5 8.4V9.4H16.5V8.4H15.5ZM6 8.4V7.4H5V8.4H6ZM6 10.4H5V11.4H6V10.4ZM7 14.4V13.4L7 13.4L7 14.4ZM3 14.4L3 13.4L0.1 13.4L2.3 15.2L3 14.4ZM8.5 18.9L7.8 19.7L9.5 21.0V18.9H8.5ZM8.5 16.4V15.4H7.5V16.4H8.5ZM19 16.4V17.4H20V16.4H19ZM19 14.4H20V13.4H19V14.4ZM21 9.4L17 9.4L17 11.4L21 11.4L21 9.4ZM14.8 6.7L20.3 11.2L21.6 9.6L16.1 5.2L14.8 6.7ZM16.5 8.4V6H14.5V8.4H16.5ZM6 9.4H15.5V7.4H6V9.4ZM7 10.4V8.4H5V10.4H7ZM15.5 9.4H6V11.4H15.5V9.4ZM17 9.4H15.5V11.4H17V9.4ZM7 15.4H8.5V13.4H7V15.4ZM3 15.4L7 15.4L7 13.4L3 13.4L3 15.4ZM9.1 18.1L3.6 13.6L2.3 15.2L7.8 19.7L9.1 18.1ZM7.5 16.4V18.9H9.5V16.4H7.5ZM19 15.4H8.5V17.4H19V15.4ZM18 14.4V16.4H20V14.4H18ZM8.5 15.4H19V13.4H8.5V15.4Z" fill="white"/>
<path fill-rule="evenodd" d="M17 10.4L21 10.4L15.5 6V8.4H6V10.4H15.5H17ZM8.5 14.4H7L3 14.4L8.5 18.9V16.4H19V14.4H8.5Z" fill="black"/>
</g>
</g>
<defs>
<filter x="-2.8" y="1.9" width="29.6" height="23.1" filterUnits="userSpaceOnUse" >
${sp}
</filter>
</defs>
</svg>
`,x:12,y:12},selector:!0,editBox:!0,hover:!0,select:"press",openInner:"double",multipleSelect:!0,boxSelect:!0,moveable:!0,resizeable:!0,flipable:!0,rotateable:!0,skewable:!0},$s=new It;function S1(e){let{simulateTarget:t,list:n}=e,{zoomLayer:i}=n[0].leafer;t.safeChange(()=>{$s.setListWithFn(n,s=>s.getBounds("box","page")),$s.width===0&&($s.width=.1),$s.height===0&&($s.height=.1),t.reset($s.get())}),i.add(t)}var y1=(e,t)=>e.parent.children.indexOf(e)-t.parent.children.indexOf(t),v1=(e,t)=>t.parent.children.indexOf(t)-e.parent.children.indexOf(e),jl={group(e,t,n){e.sort(v1);let{app:i,parent:s}=e[0],a;a=n&&n.add?n:new zt(n),s.addAt(a,s.children.indexOf(e[0])),e.sort(y1);let h=new ye(t.worldTransform);return h.divideParent(s.scrollWorldTransform),a.setTransform(h),a.editable=!0,a.hitChildren=!1,i.lockLayout(),e.forEach(l=>l.dropTo(a)),i.unlockLayout(),a},ungroup(e){let{app:t}=e[0],n=[];return t.lockLayout(),e.forEach(i=>{if(i.isBranch){let{parent:s,children:a}=i;for(;a.length;)n.push(a[0]),a[0].dropTo(s,s.children.indexOf(i));i.isBranchLeaf?n.push(i):i.remove()}else n.push(i)}),t.unlockLayout(),n},toTop(e){e.sort(y1),e.forEach(t=>{t.parent&&t.parent.add(t)})},toBottom(e){e.sort(v1),e.forEach(t=>{t.parent&&t.parent.addAt(t,0)})}},Z2=Pt.get("EditToolCreator");function _p(){return e=>{pr.register(e)}}var C1=_p,pr={list:{},register(e){let{tag:t}=e.prototype;op[t]&&Z2.repeat(t),op[t]=e},get:(e,t)=>new op[e](t)},{list:op}=pr,ri=class extends Xt{constructor(t,n){super(t,n)}};ri.BEFORE_OPEN="innerEditor.before_open",ri.OPEN="innerEditor.open",ri.BEFORE_CLOSE="innerEditor.before_close",ri.CLOSE="innerEditor.close";var Ce=class extends Xt{constructor(t,n){super(t,n)}};Ce.BEFORE_GROUP="editor.before_group",Ce.GROUP="editor.group",Ce.BEFORE_UNGROUP="editor.before_ungroup",Ce.UNGROUP="editor.ungroup",Ce.BEFORE_OPEN="editor.before_open_group",Ce.OPEN="editor.open_group",Ce.BEFORE_CLOSE="editor.before_close_group",Ce.CLOSE="editor.close_group";var{updateMatrix:ap}=Vt,$2={x:1,y:1,scaleX:1,scaleY:1,rotation:1,skewX:1,skewY:1},Ra="top-left",fp=class extends Oe{get __tag(){return"SimulateElement"}constructor(t){super(),this.checkChange=!0,this.canChange=!0,this.visible=this.hittable=!1,this.on(rn.CHANGE,n=>{if(this.checkChange&&$2[n.attrName]){let{attrName:i,newValue:s,oldValue:a}=n,h=i[0]==="s"?(s||1)/(a||1):(s||0)-(a||0);this.canChange=!1;let l=this.__;l[i]=a,ap(this.parent),ap(this);let u=new ye(this.__world);switch(l[i]=s,this.__layout.rotationChange(),ap(this),this.changedTransform=new ye(this.__world).divide(u),i){case"x":t.move(h,0);break;case"y":t.move(0,h);break;case"rotation":t.rotateOf(Ra,h);break;case"scaleX":t.scaleOf(Ra,h,1);break;case"scaleY":t.scaleOf(Ra,1,h);break;case"skewX":t.skewOf(Ra,h,0);break;case"skewY":t.skewOf(Ra,0,h)}this.canChange=!0}})}safeChange(t){this.canChange&&(this.checkChange=!1,t(),this.checkChange=!0)}},un=class extends Xt{constructor(t,n){super(t,n)}};un.BEFORE_MOVE="editor.before_move",un.MOVE="editor.move";var ve=class extends Xt{constructor(t,n){super(t,n)}};ve.BEFORE_SCALE="editor.before_scale",ve.SCALE="editor.scale";var gr=class extends Xt{constructor(t,n){super(t,n)}};gr.BEFORE_ROTATE="editor.before_rotate",gr.ROTATE="editor.rotate";var _r=class extends Xt{constructor(t,n){super(t,n)}};_r.BEFORE_SKEW="editor.before_skew",_r.SKEW="editor.skew";var pp=class{onMove(t){let{target:n,mergeConfig:i,dragStartData:s}=this.editBox,a,{dragLimitAnimate:h}=i,l=t.type===Ot.END||t.type===dt.END,u=gt(n.draggable),f=!h||l||u,g={x:t.totalX,y:t.totalY};t instanceof Ot&&j.move(g,n.getWorldPointByLocal(s.totalOffset,null,!0)),t.shiftKey&&(Math.abs(g.x)>Math.abs(g.y)?g.y=0:g.x=0),a=dt.getValidMove(n,s.point,g,f),(a.x||a.y)&&(h&&!u&&l?Vt.animateMove(this,a,Dt(h)?h:.3):this.move(a))}onScale(t){let{target:n,mergeConfig:i,single:s,dragStartData:a}=this.editBox,h,{around:l,lockRatio:u,flipable:f,editSize:g}=i;t instanceof pe?(l||(l=n.getBoxPoint(t)),h=t.totalScale):h=t.getInnerTotal(n);let{direction:p}=t.current;(t.shiftKey||n.lockRatio)&&(u=!0);let v=Zr.getScaleData(n,a.bounds,p,h,u,Zr.getAround(l,t.altKey),f,!s||g==="scale"),w=n.x,E=n.y;t instanceof dt&&this.editTool&&this.editTool.onScaleWithDrag?(v.drag=t,this.scaleWithDrag(v)):this.scaleOf(v.origin,v.scaleX,v.scaleY),j.move(a.totalOffset,n.x-w,n.y-E)}onRotate(t){let{target:n,mergeConfig:i,dragStartData:s}=this.editBox,{around:a,rotateAround:h,rotateGap:l,diagonalRotateKey:u}=i,{direction:f}=t.current,g,p;if(t instanceof Ue)p=t.rotation,g=h?xn.getPoint(h,n.boxBounds):n.getBoxPoint(t);else{let E=u?t.isHoldKeys(u):t.shiftKey,P=Zr.getRotateData(n,f,t,s,E?null:h||n.around||n.origin||a||"center");p=s.rotation+P.rotation-n.rotation,g=P.origin}if(p=Kt.float(Kt.getGapRotation(p,l,n.rotation),2),!p)return;let v=n.x,w=n.y;this.rotateOf(g,p),j.move(s.totalOffset,n.x-v,n.y-w)}onSkew(t){let{target:n,mergeConfig:i}=this.editBox,{around:s}=i,{origin:a,skewX:h,skewY:l}=Zr.getSkewData(n.boxBounds,t.current.direction,t.getInnerMove(n),Zr.getAround(s,t.altKey));(h||l)&&this.skewOf(a,h,l)}move(t,n=0){if(!this.checkTransform("moveable"))return;ht(t)&&(n=t.y,t=t.x);let{target:i,mergeConfig:s,single:a,editor:h}=this.editBox,{beforeMove:l}=s;if(l){let p=l({target:i,x:t,y:n});if(ht(p))t=p.x,n=p.y;else if(p===!1)return}let u=i.getWorldPointByLocal({x:t,y:n},null,!0);a||i.safeChange(()=>i.move(t,n));let f={target:i,editor:h,moveX:u.x,moveY:u.y};this.emitEvent(new un(un.BEFORE_MOVE,f));let g=new un(un.MOVE,f);this.doMove(g),this.emitEvent(g)}scaleWithDrag(t){if(!this.checkTransform("resizeable"))return;let{target:n,mergeConfig:i,editor:s}=this.editBox,{beforeScale:a}=i;if(a){let{origin:l,scaleX:u,scaleY:f,drag:g}=t;if(a({target:n,drag:g,origin:l,scaleX:u,scaleY:f})===!1)return}t=Object.assign(Object.assign({},t),{target:n,editor:s,worldOrigin:n.getWorldPoint(t.origin)}),this.emitEvent(new ve(ve.BEFORE_SCALE,t));let h=new ve(ve.SCALE,t);this.editTool.onScaleWithDrag(h),this.emitEvent(h)}scaleOf(t,n,i=n,s){if(!this.checkTransform("resizeable"))return;let{target:a,mergeConfig:h,single:l,editor:u}=this.editBox,{beforeScale:f}=h;if(f){let E=f({target:a,origin:t,scaleX:n,scaleY:i});if(ht(E))n=E.scaleX,i=E.scaleY;else if(E===!1)return}let g=this.getWorldOrigin(t),p=!l&&this.getChangedTransform(()=>a.safeChange(()=>a.scaleOf(t,n,i))),v={target:a,editor:u,worldOrigin:g,scaleX:n,scaleY:i,transform:p};this.emitEvent(new ve(ve.BEFORE_SCALE,v));let w=new ve(ve.SCALE,v);this.doScale(w),this.emitEvent(w)}flip(t){if(!this.checkTransform("resizeable"))return;let{target:n,single:i,editor:s}=this.editBox,a=this.getWorldOrigin("center"),h=i?new ye(Vt.getFlipTransform(n,t)):this.getChangedTransform(()=>n.safeChange(()=>n.flip(t))),l={target:n,editor:s,worldOrigin:a,scaleX:t==="x"?-1:1,scaleY:t==="y"?-1:1,transform:h};this.emitEvent(new ve(ve.BEFORE_SCALE,l));let u=new ve(ve.SCALE,l);this.doScale(u),this.emitEvent(u)}rotateOf(t,n){if(!this.checkTransform("rotateable"))return;let{target:i,mergeConfig:s,single:a,editor:h}=this.editBox,{beforeRotate:l}=s;if(l){let v=l({target:i,origin:t,rotation:n});if(Dt(v))n=v;else if(v===!1)return}let u=this.getWorldOrigin(t),f=!a&&this.getChangedTransform(()=>i.safeChange(()=>i.rotateOf(t,n))),g={target:i,editor:h,worldOrigin:u,rotation:n,transform:f};this.emitEvent(new gr(gr.BEFORE_ROTATE,g));let p=new gr(gr.ROTATE,g);this.doRotate(p),this.emitEvent(p)}skewOf(t,n,i=0,s){if(!this.checkTransform("skewable"))return;let{target:a,mergeConfig:h,single:l,editor:u}=this.editBox,{beforeSkew:f}=h;if(f){let E=f({target:a,origin:t,skewX:n,skewY:i});if(ht(E))n=E.skewX,i=E.skewY;else if(E===!1)return}let g=this.getWorldOrigin(t),p=!l&&this.getChangedTransform(()=>a.safeChange(()=>a.skewOf(t,n,i))),v={target:a,editor:u,worldOrigin:g,skewX:n,skewY:i,transform:p};this.emitEvent(new _r(_r.BEFORE_SKEW,v));let w=new _r(_r.SKEW,v);this.doSkew(w),this.emitEvent(w)}doMove(t){this.editTool.onMove(t)}doScale(t){this.editTool.onScale(t)}doRotate(t){this.editTool.onRotate(t)}doSkew(t){this.editTool.onSkew(t)}checkTransform(t){let{target:n,mergeConfig:i}=this.editBox;return n&&!n.locked&&i[t]}getWorldOrigin(t){let{target:n}=this.editBox;return n.getWorldPoint(Vt.getInnerOrigin(n,t))}getChangedTransform(t){let{target:n,single:i}=this.editBox;if(!i&&!n.canChange)return n.changedTransform;let s=new ye(n.worldTransform);return t(),new ye(n.worldTransform).divide(s)}emitEvent(t,n){this.editBox.editor.emitEvent(t,n)}},Js=class extends zt{get list(){return this.leafList.list}get dragHoverExclude(){return[this.editBox.rect]}get editing(){return!!this.list.length}get groupOpening(){return!!this.openedGroupList.length}get multiple(){return this.list.length>1}get single(){return this.list.length===1}get dragPoint(){return this.editBox.dragPoint}get dragging(){return this.editBox.dragging}get gesturing(){return this.editBox.gesturing}get moving(){return this.editBox.moving}get resizing(){return this.editBox.resizing}get rotating(){return this.editBox.rotating}get skewing(){return this.editBox.skewing}get element(){return this.multiple?this.simulateTarget:this.list[0]}get buttons(){return this.editBox.buttons}get targetLeafer(){let e=this.list[0];return e&&e.leafer}constructor(e,t){super(t),this.leafList=new Bt,this.openedGroupList=new Bt,this.simulateTarget=new fp(this),this.editBox=new up(this),this.editToolList={},this.selector=new cp(this),this.editMask=new dp(this),this.targetEventIds=[];let n=vt.clone(j2);e&&(n=vt.default(e,n)),this.mergedConfig=this.config=n,this.addMany(this.editMask,this.selector,this.editBox),Zt.has("resize")||(this.config.editSize="scale")}select(e){this.target=e}cancel(){this.target=null}hasItem(e){return this.leafList.has(e)}getItem(e){return this.list[e||0]}addItem(e){this.hasItem(e)||e.locked||(this.leafList.add(e),this.target=this.leafList.list)}removeItem(e){this.hasItem(e)&&(this.leafList.remove(e),this.target=this.leafList.list)}shiftItem(e){this.hasItem(e)?this.removeItem(e):this.addItem(e)}setDimOthers(e,t="dim",n){if(!n){let{dimTarget:i,targetLeafer:s}=this;n=i?Ct(i)?i:[i]:[s]}n[0]&&n[0][t]!==(e||!1)&&n.forEach(i=>vt.stintSet(i,t,e))}setBright(e){this.setDimOthers(e,"bright",this.list)}update(){if(this.editing){if(!this.element.parent)return this.cancel();this.innerEditing&&this.innerEditor.update(),this.editTool.update(),this.selector.update()}}updateEditBox(){this.multiple&&S1(this),this.update()}getEditTool(e){return this.editToolList[e]=this.editToolList[e]||pr.get(e,this)}updateEditTool(){if(this.unloadEditTool(),this.editing){let e=this.element,t=e.editOuter||"EditTool",{beforeEditOuter:n}=this.mergeConfig;if(n){let i=n({target:e,name:t});if(gt(i))t=i;else if(i===!1)return}if(pr.list[t]){let i=this.editTool=this.getEditTool(t);this.editBox.load(),i.load(),this.update()}}}unloadEditTool(){let e=this.editTool;e&&(this.editBox.unload(),e.unload(),this.editTool=null)}getEditSize(e){return this.mergeConfig.editSize}onMove(e){}onScale(e){}onRotate(e){}onSkew(e){}move(e,t=0){}scaleWithDrag(e){}scaleOf(e,t,n=t,i){}flip(e){}rotateOf(e,t){}skewOf(e,t,n=0,i){}checkTransform(e){}getWorldOrigin(e){}getChangedTransform(e){}group(e){return this.multiple&&(this.emitGroupEvent(Ce.BEFORE_GROUP),this.target=jl.group(this.list,this.element,e),this.emitGroupEvent(Ce.GROUP,this.target)),this.target}ungroup(){let{list:e}=this;return e.length&&(e.forEach(t=>t.isBranch&&this.emitGroupEvent(Ce.BEFORE_UNGROUP,t)),this.target=jl.ungroup(e),e.forEach(t=>t.isBranch&&this.emitGroupEvent(Ce.UNGROUP,t))),this.list}openGroup(e){this.emitGroupEvent(Ce.BEFORE_OPEN,e),this.openedGroupList.add(e),e.hitChildren=!0,this.emitGroupEvent(Ce.OPEN,e)}closeGroup(e){this.emitGroupEvent(Ce.BEFORE_CLOSE,e),this.openedGroupList.remove(e),e.hitChildren=!1,this.emitGroupEvent(Ce.CLOSE,e)}checkOpenedGroups(){let e=this.openedGroupList;if(e.length){let{list:t}=e;this.editing&&(t=[],e.forEach(n=>this.list.every(i=>!Vt.hasParent(i,n))&&t.push(n))),t.forEach(n=>this.closeGroup(n))}this.editing&&!this.selector.dragging&&this.checkDeepSelect()}checkDeepSelect(){let e,{list:t}=this;for(let n=0;n<t.length;n++)for(e=t[n].parent;e&&!e.hitChildren;)this.openGroup(e),e=e.parent}emitGroupEvent(e,t){let n=new Ce(e,{editTarget:t});this.emitEvent(n),t&&t.emitEvent(n)}getInnerEditor(e){return this.editToolList[e]=this.editToolList[e]||pr.get(e,this)}openInnerEditor(e,t,n){let i;if(gt(t)?i=t:n||(n=t),e&&n&&(this.target=e),this.single){e||(e=this.element),i||(i=e.editInner);let{beforeEditInner:s}=this.mergeConfig;if(s){let a=s({target:e,name:i});if(gt(a))i=a;else if(a===!1)return}pr.list[i]&&(this.editTool.unload(),this.innerEditing=!0,this.innerEditor=this.getInnerEditor(i),this.innerEditor.editTarget=e,this.emitInnerEvent(ri.BEFORE_OPEN),this.innerEditor.load(),this.emitInnerEvent(ri.OPEN))}}closeInnerEditor(e){this.innerEditing&&(this.innerEditing=!1,this.emitInnerEvent(ri.BEFORE_CLOSE),this.innerEditor.unload(),this.emitInnerEvent(ri.CLOSE),e||this.updateEditTool(),this.innerEditor=null)}emitInnerEvent(e){let{innerEditor:t}=this,{editTarget:n}=t,i=new ri(e,{editTarget:n,innerEditor:t});this.emitEvent(i),n.emitEvent(i)}lock(){this.list.forEach(e=>e.locked=!0),this.update()}unlock(){this.list.forEach(e=>e.locked=!1),this.update()}toTop(){this.list.length&&(jl.toTop(this.list),this.leafList.update())}toBottom(){this.list.length&&(jl.toBottom(this.list),this.leafList.update())}onAppRenderStart(e){(this.targetChanged=e.children.some(t=>t!==this.leafer&&t.renderer.changed))&&this.editBox.forceRender()}onRenderStart(){this.targetChanged&&this.update()}onChildScroll(){this.multiple&&this.updateEditBox()}listenTargetEvents(){if(!this.targetEventIds.length){let{app:e,leafer:t,targetLeafer:n,editMask:i}=this;this.targetEventIds=[t.on_(yt.START,this.onRenderStart,this),n&&n.on_(rn.SCROLL,this.onChildScroll,this),e.on_(yt.CHILD_START,this.onAppRenderStart,this),e.on_(wt.UPDATE_MODE,s=>{s.mode&&s.mode!=="normal"&&this.cancel()})],i.visible&&i.forceRender()}}removeTargetEvents(){let{targetEventIds:e,editMask:t}=this;e.length&&(this.off_(e),t.visible&&t.forceRender())}destroy(){this.destroyed||(this.target=this.hoverTarget=null,Object.values(this.editToolList).forEach(e=>e.destroy()),this.simulateTarget.destroy(),this.editToolList={},this.simulateTarget=this.editTool=this.innerEditor=null,super.destroy())}};fr([(e,t)=>{En(e,t,{get(){let{config:n,element:i,dragPoint:s,editBox:a,app:h}=this,l=Object.assign({},n);if(i&&i.editConfig){let{editConfig:u}=i;(u.hover||u.hoverStyle)&&(u=Object.assign({},u),delete u.hover,delete u.hoverStyle),Object.assign(l,u)}return a.config&&Object.assign(l,a.config),s&&(s.editConfig&&Object.assign(l,s.editConfig),l.editSize==="font-size"&&(l.lockRatio=!0),s.pointType==="resize-rotate"&&(l.around||(l.around="center"),Be(l.lockRatio)&&(l.lockRatio=!0))),J(l.dragLimitAnimate)&&(l.dragLimitAnimate=h&&h.config.pointer.dragLimitAnimate),this.mergedConfig=l}})}],Js.prototype,"mergeConfig",void 0),fr([hp(function(e,t){let{target:n}=e;n?(e.leafList=n instanceof Bt?n:new Bt(n),e.multiple&&S1(e)):(e.simulateTarget.remove(),e.leafList.reset()),e.closeInnerEditor(!0),e.unloadEditTool();let i={editor:e,value:n,oldValue:t};e.emitEvent(new Xt(Xt.SELECT,i)),e.checkOpenedGroups(),e.editing?e.waitLeafer(()=>{e.updateEditTool(),e.listenTargetEvents()}):(e.updateEditTool(),e.removeTargetEvents()),e.emitEvent(new Xt(Xt.AFTER_SELECT,i))})],Js.prototype,"target",void 0),fr([hp(function(e,t){e.emitEvent(new Xt(Xt.HOVER,{editor:e,value:e.hoverTarget,oldValue:t}))})],Js.prototype,"hoverTarget",void 0),Js=fr([nn(pp,["editBox","editTool","emitEvent"])],Js);var Oa=class{static registerInnerEditor(){pr.register(this)}get tag(){return"InnerEditor"}get mode(){return"focus"}get editBox(){return this.editor.editBox}constructor(t){this.eventIds=[],this.editor=t,this.create()}onCreate(){}create(){this.view=new zt,this.onCreate()}onLoad(){}load(){let{editor:t}=this;t&&(t.app&&this.mode==="focus"&&(t.selector.hittable=t.app.tree.hitChildren=!1),this.onLoad())}onUpdate(){}update(){this.onUpdate()}onUnload(){}unload(){let{editor:t}=this;t&&(t.app&&this.mode==="focus"&&(t.selector.hittable=t.app.tree.hitChildren=!0),this.onUnload())}onDestroy(){}destroy(){this.onDestroy(),this.editor&&(this.view&&this.view.destroy(),this.eventIds&&this.editor.off_(this.eventIds),this.editor=this.view=this.eventIds=null)}},gp=class extends Oa{static registerEditTool(){pr.register(this)}get tag(){return"EditTool"}onMove(e){let{moveX:t,moveY:n,editor:i}=e,{app:s,list:a}=i;s.lockLayout(),a.forEach(h=>{h.moveWorld(t,n)}),s.unlockLayout()}onScale(e){let{scaleX:t,scaleY:n,transform:i,worldOrigin:s,editor:a}=e,{app:h,list:l}=a;h.lockLayout(),l.forEach(u=>{let f=a.getEditSize(u)!=="scale";i?u.transformWorld(i,f):u.scaleOfWorld(s,t,n,f)}),h.unlockLayout()}onRotate(e){let{rotation:t,transform:n,worldOrigin:i,editor:s}=e,{app:a,list:h}=s;a.lockLayout(),h.forEach(l=>{let u=s.getEditSize(l)!=="scale";n?l.transformWorld(n,u):l.rotateOfWorld(i,t)}),a.unlockLayout()}onSkew(e){let{skewX:t,skewY:n,transform:i,worldOrigin:s,editor:a}=e,{app:h,list:l}=a;h.lockLayout(),l.forEach(u=>{let f=a.getEditSize(u)!=="scale";i?u.transformWorld(i,f):u.skewOfWorld(s,t,n,f)}),h.unlockLayout()}load(){this.editBox.view.visible=!0,this.onLoad()}update(){this.editBox.update(),this.onUpdate()}unload(){this.editBox.view.visible=!1,this.onUnload()}};gp=fr([_p()],gp);var{left:w1,right:J2}=ir,{move:Zl,copy:$l,toNumberPoints:Q2}=j,x1=class extends gp{constructor(){super(...arguments),this.scaleOfEvent=!0}get tag(){return"LineEditTool"}onScaleWithDrag(e){let{drag:t,direction:n,lockRatio:i,around:s}=e,a=e.target,h=n===w1;if(a.pathInputed){let{path:l}=a.__,{from:u,to:f}=this.getFromToByPath(l);this.dragPoint(u,f,h,s,this.getInnerMove(a,t,i)),l[1]=u.x,l[2]=u.y,l[4]=f.x,l[5]=f.y,a.path=l}else if(a.points){let{points:l}=a,{from:u,to:f}=this.getFromToByPoints(l);this.dragPoint(u,f,h,s,this.getInnerMove(a,t,i)),l[0]=u.x,l[1]=u.y,l[2]=f.x,l[3]=f.y,a.points=l}else{let l=Ko(),{toPoint:u}=a;a.rotation=0,this.dragPoint(l,u,h,s,this.getInnerMove(a,t,i)),a.getLocalPointByInner(l,null,null,!0),a.getLocalPointByInner(u,null,null,!0),a.x=l.x,a.y=l.y,a.getInnerPointByLocal(u,null,null,!0),a.toPoint=u}}getInnerMove(e,t,n){let i=t.getInnerMove(e);return n&&(Math.abs(i.x)>Math.abs(i.y)?i.y=0:i.x=0),i}getFromToByPath(e){return{from:{x:e[1],y:e[2]},to:{x:e[4],y:e[5]}}}getFromToByPoints(e){let t=Q2(e);return{from:{x:t[0],y:t[1]},to:{x:t[2],y:t[3]}}}dragPoint(e,t,n,i,s){let{x:a,y:h}=s;n?(Zl(e,a,h),i&&Zl(t,-a,-h)):(i&&Zl(e,-a,-h),Zl(t,a,h))}onSkew(e){}onUpdate(){let{editBox:e}=this,{rotatePoints:t,resizeLines:n,resizePoints:i,rect:s}=e,a=this.editor.element,h,l;if(a.pathInputed?h=this.getFromToByPath(a.__.path):a.points&&(h=this.getFromToByPoints(a.__.points)),h){let{from:u,to:f}=h;a.innerToWorld(u,u,!1,e),a.innerToWorld(f,f,!1,e),s.pen.clearPath().moveTo(u.x,u.y).lineTo(f.x,f.y),$l(i[7],u),$l(t[7],u),$l(i[3],f),$l(t[3],f)}for(let u=0;u<8;u++)u<4&&(n[u].visible=!1),l=u===w1||u===J2,i[u].visible=l,t[u].visible=!h&&l}};x1=fr([_p()],x1),Zt.add("editor","resize"),$t.editor=function(e,t){let n=new Js(e);return t&&t.sky.add(t.editor=n),n},ee.addAttr("textBox",!1,Jt),D.addAttr("editConfig",void 0,Jt),D.addAttr("editOuter",e=>(e.updateLayout(),e.__.__isLinePath?"LineEditTool":"EditTool"),Jt),D.addAttr("editInner","PathEditor",Jt),zt.addAttr("editInner","",Jt),st.addAttr("editInner","TextEditor",Jt),D.setEditConfig=function(e){this.changeAttr("editConfig",e)},D.setEditOuter=function(e){this.changeAttr("editOuter",e)},D.setEditInner=function(e){this.changeAttr("editInner",e)};var Aa=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};function tM(e){return e&&e.__esModule&&Object.prototype.hasOwnProperty.call(e,"default")?e.default:e}var Jl={exports:{}};Jl.exports;(function(e,t){(function(){var n,i="4.17.21",s=200,a="Unsupported core-js use. Try https://npms.io/search?q=ponyfill.",h="Expected a function",l="Invalid `variable` option passed into `_.template`",u="__lodash_hash_undefined__",f=500,g="__lodash_placeholder__",p=1,v=2,w=4,E=1,P=2,S=1,R=2,A=4,I=8,W=16,F=32,H=64,V=128,K=256,ct=512,ft=30,it="...",Y=800,ot=16,Wt=1,xt=2,Te=3,Ye=1/0,ke=9007199254740991,Hi=17976931348623157e292,Cn=NaN,si=4294967295,tx=si-1,ex=si>>>1,nx=[["ary",V],["bind",S],["bindKey",R],["curry",I],["curryRight",W],["flip",ct],["partial",F],["partialRight",H],["rearg",K]],ss="[object Arguments]",Va="[object Array]",ix="[object AsyncFunction]",oo="[object Boolean]",ao="[object Date]",rx="[object DOMException]",Xa="[object Error]",Ga="[object Function]",sg="[object GeneratorFunction]",Un="[object Map]",ho="[object Number]",sx="[object Null]",vi="[object Object]",og="[object Promise]",ox="[object Proxy]",lo="[object RegExp]",Yn="[object Set]",co="[object String]",Ka="[object Symbol]",ax="[object Undefined]",uo="[object WeakMap]",hx="[object WeakSet]",fo="[object ArrayBuffer]",os="[object DataView]",Cc="[object Float32Array]",Tc="[object Float64Array]",Lc="[object Int8Array]",Pc="[object Int16Array]",Bc="[object Int32Array]",Rc="[object Uint8Array]",Oc="[object Uint8ClampedArray]",Ac="[object Uint16Array]",kc="[object Uint32Array]",lx=/\b__p \+= '';/g,cx=/\b(__p \+=) '' \+/g,ux=/(__e\(.*?\)|\b__t\)) \+\n'';/g,ag=/&(?:amp|lt|gt|quot|#39);/g,hg=/[&<>"']/g,dx=RegExp(ag.source),fx=RegExp(hg.source),px=/<%-([\s\S]+?)%>/g,gx=/<%([\s\S]+?)%>/g,lg=/<%=([\s\S]+?)%>/g,_x=/\.|\[(?:[^[\]]*|(["'])(?:(?!\1)[^\\]|\\.)*?\1)\]/,mx=/^\w*$/,yx=/[^.[\]]+|\[(?:(-?\d+(?:\.\d+)?)|(["'])((?:(?!\2)[^\\]|\\.)*?)\2)\]|(?=(?:\.|\[\])(?:\.|\[\]|$))/g,Mc=/[\\^$.*+?()[\]{}|]/g,vx=RegExp(Mc.source),Dc=/^\s+/,wx=/\s/,xx=/\{(?:\n\/\* \[wrapped with .+\] \*\/)?\n?/,bx=/\{\n\/\* \[wrapped with (.+)\] \*/,Ex=/,? & /,Sx=/[^\x00-\x2f\x3a-\x40\x5b-\x60\x7b-\x7f]+/g,Cx=/[()=,{}\[\]\/\s]/,Tx=/\\(\\)?/g,Lx=/\$\{([^\\}]*(?:\\.[^\\}]*)*)\}/g,cg=/\w*$/,Px=/^[-+]0x[0-9a-f]+$/i,Bx=/^0b[01]+$/i,Rx=/^\[object .+?Constructor\]$/,Ox=/^0o[0-7]+$/i,Ax=/^(?:0|[1-9]\d*)$/,kx=/[\xc0-\xd6\xd8-\xf6\xf8-\xff\u0100-\u017f]/g,qa=/($^)/,Mx=/['\n\r\u2028\u2029\\]/g,ja="\\ud800-\\udfff",Dx="\\u0300-\\u036f",Ix="\\ufe20-\\ufe2f",zx="\\u20d0-\\u20ff",ug=Dx+Ix+zx,dg="\\u2700-\\u27bf",fg="a-z\\xdf-\\xf6\\xf8-\\xff",Wx="\\xac\\xb1\\xd7\\xf7",Fx="\\x00-\\x2f\\x3a-\\x40\\x5b-\\x60\\x7b-\\xbf",Nx="\\u2000-\\u206f",Hx=" \\t\\x0b\\f\\xa0\\ufeff\\n\\r\\u2028\\u2029\\u1680\\u180e\\u2000\\u2001\\u2002\\u2003\\u2004\\u2005\\u2006\\u2007\\u2008\\u2009\\u200a\\u202f\\u205f\\u3000",pg="A-Z\\xc0-\\xd6\\xd8-\\xde",gg="\\ufe0e\\ufe0f",_g=Wx+Fx+Nx+Hx,Ic="['\u2019]",Ux="["+ja+"]",mg="["+_g+"]",Za="["+ug+"]",yg="\\d+",Yx="["+dg+"]",vg="["+fg+"]",wg="[^"+ja+_g+yg+dg+fg+pg+"]",zc="\\ud83c[\\udffb-\\udfff]",Vx="(?:"+Za+"|"+zc+")",xg="[^"+ja+"]",Wc="(?:\\ud83c[\\udde6-\\uddff]){2}",Fc="[\\ud800-\\udbff][\\udc00-\\udfff]",as="["+pg+"]",bg="\\u200d",Eg="(?:"+vg+"|"+wg+")",Xx="(?:"+as+"|"+wg+")",Sg="(?:"+Ic+"(?:d|ll|m|re|s|t|ve))?",Cg="(?:"+Ic+"(?:D|LL|M|RE|S|T|VE))?",Tg=Vx+"?",Lg="["+gg+"]?",Gx="(?:"+bg+"(?:"+[xg,Wc,Fc].join("|")+")"+Lg+Tg+")*",Kx="\\d*(?:1st|2nd|3rd|(?![123])\\dth)(?=\\b|[A-Z_])",qx="\\d*(?:1ST|2ND|3RD|(?![123])\\dTH)(?=\\b|[a-z_])",Pg=Lg+Tg+Gx,jx="(?:"+[Yx,Wc,Fc].join("|")+")"+Pg,Zx="(?:"+[xg+Za+"?",Za,Wc,Fc,Ux].join("|")+")",$x=RegExp(Ic,"g"),Jx=RegExp(Za,"g"),Nc=RegExp(zc+"(?="+zc+")|"+Zx+Pg,"g"),Qx=RegExp([as+"?"+vg+"+"+Sg+"(?="+[mg,as,"$"].join("|")+")",Xx+"+"+Cg+"(?="+[mg,as+Eg,"$"].join("|")+")",as+"?"+Eg+"+"+Sg,as+"+"+Cg,qx,Kx,yg,jx].join("|"),"g"),tb=RegExp("["+bg+ja+ug+gg+"]"),eb=/[a-z][A-Z]|[A-Z]{2}[a-z]|[0-9][a-zA-Z]|[a-zA-Z][0-9]|[^a-zA-Z0-9 ]/,nb=["Array","Buffer","DataView","Date","Error","Float32Array","Float64Array","Function","Int8Array","Int16Array","Int32Array","Map","Math","Object","Promise","RegExp","Set","String","Symbol","TypeError","Uint8Array","Uint8ClampedArray","Uint16Array","Uint32Array","WeakMap","_","clearTimeout","isFinite","parseInt","setTimeout"],ib=-1,ie={};ie[Cc]=ie[Tc]=ie[Lc]=ie[Pc]=ie[Bc]=ie[Rc]=ie[Oc]=ie[Ac]=ie[kc]=!0,ie[ss]=ie[Va]=ie[fo]=ie[oo]=ie[os]=ie[ao]=ie[Xa]=ie[Ga]=ie[Un]=ie[ho]=ie[vi]=ie[lo]=ie[Yn]=ie[co]=ie[uo]=!1;var Qt={};Qt[ss]=Qt[Va]=Qt[fo]=Qt[os]=Qt[oo]=Qt[ao]=Qt[Cc]=Qt[Tc]=Qt[Lc]=Qt[Pc]=Qt[Bc]=Qt[Un]=Qt[ho]=Qt[vi]=Qt[lo]=Qt[Yn]=Qt[co]=Qt[Ka]=Qt[Rc]=Qt[Oc]=Qt[Ac]=Qt[kc]=!0,Qt[Xa]=Qt[Ga]=Qt[uo]=!1;var rb={\u00C0:"A",\u00C1:"A",\u00C2:"A",\u00C3:"A",\u00C4:"A",\u00C5:"A",\u00E0:"a",\u00E1:"a",\u00E2:"a",\u00E3:"a",\u00E4:"a",\u00E5:"a",\u00C7:"C",\u00E7:"c",\u00D0:"D",\u00F0:"d",\u00C8:"E",\u00C9:"E",\u00CA:"E",\u00CB:"E",\u00E8:"e",\u00E9:"e",\u00EA:"e",\u00EB:"e",\u00CC:"I",\u00CD:"I",\u00CE:"I",\u00CF:"I",\u00EC:"i",\u00ED:"i",\u00EE:"i",\u00EF:"i",\u00D1:"N",\u00F1:"n",\u00D2:"O",\u00D3:"O",\u00D4:"O",\u00D5:"O",\u00D6:"O",\u00D8:"O",\u00F2:"o",\u00F3:"o",\u00F4:"o",\u00F5:"o",\u00F6:"o",\u00F8:"o",\u00D9:"U",\u00DA:"U",\u00DB:"U",\u00DC:"U",\u00F9:"u",\u00FA:"u",\u00FB:"u",\u00FC:"u",\u00DD:"Y",\u00FD:"y",\u00FF:"y",\u00C6:"Ae",\u00E6:"ae",\u00DE:"Th",\u00FE:"th",\u00DF:"ss",\u0100:"A",\u0102:"A",\u0104:"A",\u0101:"a",\u0103:"a",\u0105:"a",\u0106:"C",\u0108:"C",\u010A:"C",\u010C:"C",\u0107:"c",\u0109:"c",\u010B:"c",\u010D:"c",\u010E:"D",\u0110:"D",\u010F:"d",\u0111:"d",\u0112:"E",\u0114:"E",\u0116:"E",\u0118:"E",\u011A:"E",\u0113:"e",\u0115:"e",\u0117:"e",\u0119:"e",\u011B:"e",\u011C:"G",\u011E:"G",\u0120:"G",\u0122:"G",\u011D:"g",\u011F:"g",\u0121:"g",\u0123:"g",\u0124:"H",\u0126:"H",\u0125:"h",\u0127:"h",\u0128:"I",\u012A:"I",\u012C:"I",\u012E:"I",\u0130:"I",\u0129:"i",\u012B:"i",\u012D:"i",\u012F:"i",\u0131:"i",\u0134:"J",\u0135:"j",\u0136:"K",\u0137:"k",\u0138:"k",\u0139:"L",\u013B:"L",\u013D:"L",\u013F:"L",\u0141:"L",\u013A:"l",\u013C:"l",\u013E:"l",\u0140:"l",\u0142:"l",\u0143:"N",\u0145:"N",\u0147:"N",\u014A:"N",\u0144:"n",\u0146:"n",\u0148:"n",\u014B:"n",\u014C:"O",\u014E:"O",\u0150:"O",\u014D:"o",\u014F:"o",\u0151:"o",\u0154:"R",\u0156:"R",\u0158:"R",\u0155:"r",\u0157:"r",\u0159:"r",\u015A:"S",\u015C:"S",\u015E:"S",\u0160:"S",\u015B:"s",\u015D:"s",\u015F:"s",\u0161:"s",\u0162:"T",\u0164:"T",\u0166:"T",\u0163:"t",\u0165:"t",\u0167:"t",\u0168:"U",\u016A:"U",\u016C:"U",\u016E:"U",\u0170:"U",\u0172:"U",\u0169:"u",\u016B:"u",\u016D:"u",\u016F:"u",\u0171:"u",\u0173:"u",\u0174:"W",\u0175:"w",\u0176:"Y",\u0177:"y",\u0178:"Y",\u0179:"Z",\u017B:"Z",\u017D:"Z",\u017A:"z",\u017C:"z",\u017E:"z",\u0132:"IJ",\u0133:"ij",\u0152:"Oe",\u0153:"oe",\u0149:"'n",\u017F:"s"},sb={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#39;"},ob={"&amp;":"&","&lt;":"<","&gt;":">","&quot;":'"',"&#39;":"'"},ab={"\\":"\\","'":"'","\n":"n","\r":"r","\u2028":"u2028","\u2029":"u2029"},hb=parseFloat,lb=parseInt,Bg=typeof Aa=="object"&&Aa&&Aa.Object===Object&&Aa,cb=typeof self=="object"&&self&&self.Object===Object&&self,Me=Bg||cb||Function("return this")(),Hc=t&&!t.nodeType&&t,xr=Hc&&!0&&e&&!e.nodeType&&e,Rg=xr&&xr.exports===Hc,Uc=Rg&&Bg.process,Tn=function(){try{var C=xr&&xr.require&&xr.require("util").types;return C||Uc&&Uc.binding&&Uc.binding("util")}catch{}}(),Og=Tn&&Tn.isArrayBuffer,Ag=Tn&&Tn.isDate,kg=Tn&&Tn.isMap,Mg=Tn&&Tn.isRegExp,Dg=Tn&&Tn.isSet,Ig=Tn&&Tn.isTypedArray;function dn(C,O,B){switch(B.length){case 0:return C.call(O);case 1:return C.call(O,B[0]);case 2:return C.call(O,B[0],B[1]);case 3:return C.call(O,B[0],B[1],B[2])}return C.apply(O,B)}function ub(C,O,B,q){for(var at=-1,Mt=C==null?0:C.length;++at<Mt;){var Ee=C[at];O(q,Ee,B(Ee),C)}return q}function Ln(C,O){for(var B=-1,q=C==null?0:C.length;++B<q&&O(C[B],B,C)!==!1;);return C}function db(C,O){for(var B=C==null?0:C.length;B--&&O(C[B],B,C)!==!1;);return C}function zg(C,O){for(var B=-1,q=C==null?0:C.length;++B<q;)if(!O(C[B],B,C))return!1;return!0}function Ui(C,O){for(var B=-1,q=C==null?0:C.length,at=0,Mt=[];++B<q;){var Ee=C[B];O(Ee,B,C)&&(Mt[at++]=Ee)}return Mt}function $a(C,O){var B=C==null?0:C.length;return!!B&&hs(C,O,0)>-1}function Yc(C,O,B){for(var q=-1,at=C==null?0:C.length;++q<at;)if(B(O,C[q]))return!0;return!1}function oe(C,O){for(var B=-1,q=C==null?0:C.length,at=Array(q);++B<q;)at[B]=O(C[B],B,C);return at}function Yi(C,O){for(var B=-1,q=O.length,at=C.length;++B<q;)C[at+B]=O[B];return C}function Vc(C,O,B,q){var at=-1,Mt=C==null?0:C.length;for(q&&Mt&&(B=C[++at]);++at<Mt;)B=O(B,C[at],at,C);return B}function fb(C,O,B,q){var at=C==null?0:C.length;for(q&&at&&(B=C[--at]);at--;)B=O(B,C[at],at,C);return B}function Xc(C,O){for(var B=-1,q=C==null?0:C.length;++B<q;)if(O(C[B],B,C))return!0;return!1}var pb=Gc("length");function gb(C){return C.split("")}function _b(C){return C.match(Sx)||[]}function Wg(C,O,B){var q;return B(C,function(at,Mt,Ee){if(O(at,Mt,Ee))return q=Mt,!1}),q}function Ja(C,O,B,q){for(var at=C.length,Mt=B+(q?1:-1);q?Mt--:++Mt<at;)if(O(C[Mt],Mt,C))return Mt;return-1}function hs(C,O,B){return O===O?Pb(C,O,B):Ja(C,Fg,B)}function mb(C,O,B,q){for(var at=B-1,Mt=C.length;++at<Mt;)if(q(C[at],O))return at;return-1}function Fg(C){return C!==C}function Ng(C,O){var B=C==null?0:C.length;return B?qc(C,O)/B:Cn}function Gc(C){return function(O){return O==null?n:O[C]}}function Kc(C){return function(O){return C==null?n:C[O]}}function Hg(C,O,B,q,at){return at(C,function(Mt,Ee,qt){B=q?(q=!1,Mt):O(B,Mt,Ee,qt)}),B}function yb(C,O){var B=C.length;for(C.sort(O);B--;)C[B]=C[B].value;return C}function qc(C,O){for(var B,q=-1,at=C.length;++q<at;){var Mt=O(C[q]);Mt!==n&&(B=B===n?Mt:B+Mt)}return B}function jc(C,O){for(var B=-1,q=Array(C);++B<C;)q[B]=O(B);return q}function vb(C,O){return oe(O,function(B){return[B,C[B]]})}function Ug(C){return C&&C.slice(0,Gg(C)+1).replace(Dc,"")}function fn(C){return function(O){return C(O)}}function Zc(C,O){return oe(O,function(B){return C[B]})}function po(C,O){return C.has(O)}function Yg(C,O){for(var B=-1,q=C.length;++B<q&&hs(O,C[B],0)>-1;);return B}function Vg(C,O){for(var B=C.length;B--&&hs(O,C[B],0)>-1;);return B}function wb(C,O){for(var B=C.length,q=0;B--;)C[B]===O&&++q;return q}var xb=Kc(rb),bb=Kc(sb);function Eb(C){return"\\"+ab[C]}function Sb(C,O){return C==null?n:C[O]}function ls(C){return tb.test(C)}function Cb(C){return eb.test(C)}function Tb(C){for(var O,B=[];!(O=C.next()).done;)B.push(O.value);return B}function $c(C){var O=-1,B=Array(C.size);return C.forEach(function(q,at){B[++O]=[at,q]}),B}function Xg(C,O){return function(B){return C(O(B))}}function Vi(C,O){for(var B=-1,q=C.length,at=0,Mt=[];++B<q;){var Ee=C[B];(Ee===O||Ee===g)&&(C[B]=g,Mt[at++]=B)}return Mt}function Qa(C){var O=-1,B=Array(C.size);return C.forEach(function(q){B[++O]=q}),B}function Lb(C){var O=-1,B=Array(C.size);return C.forEach(function(q){B[++O]=[q,q]}),B}function Pb(C,O,B){for(var q=B-1,at=C.length;++q<at;)if(C[q]===O)return q;return-1}function Bb(C,O,B){for(var q=B+1;q--;)if(C[q]===O)return q;return q}function cs(C){return ls(C)?Ob(C):pb(C)}function Vn(C){return ls(C)?Ab(C):gb(C)}function Gg(C){for(var O=C.length;O--&&wx.test(C.charAt(O)););return O}var Rb=Kc(ob);function Ob(C){for(var O=Nc.lastIndex=0;Nc.test(C);)++O;return O}function Ab(C){return C.match(Nc)||[]}function kb(C){return C.match(Qx)||[]}var Mb=function C(O){O=O==null?Me:us.defaults(Me.Object(),O,us.pick(Me,nb));var B=O.Array,q=O.Date,at=O.Error,Mt=O.Function,Ee=O.Math,qt=O.Object,Jc=O.RegExp,Db=O.String,Pn=O.TypeError,th=B.prototype,Ib=Mt.prototype,ds=qt.prototype,eh=O["__core-js_shared__"],nh=Ib.toString,Ut=ds.hasOwnProperty,zb=0,Kg=function(){var r=/[^.]+$/.exec(eh&&eh.keys&&eh.keys.IE_PROTO||"");return r?"Symbol(src)_1."+r:""}(),ih=ds.toString,Wb=nh.call(qt),Fb=Me._,Nb=Jc("^"+nh.call(Ut).replace(Mc,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$"),rh=Rg?O.Buffer:n,Xi=O.Symbol,sh=O.Uint8Array,qg=rh?rh.allocUnsafe:n,oh=Xg(qt.getPrototypeOf,qt),jg=qt.create,Zg=ds.propertyIsEnumerable,ah=th.splice,$g=Xi?Xi.isConcatSpreadable:n,go=Xi?Xi.iterator:n,br=Xi?Xi.toStringTag:n,hh=function(){try{var r=Lr(qt,"defineProperty");return r({},"",{}),r}catch{}}(),Hb=O.clearTimeout!==Me.clearTimeout&&O.clearTimeout,Ub=q&&q.now!==Me.Date.now&&q.now,Yb=O.setTimeout!==Me.setTimeout&&O.setTimeout,lh=Ee.ceil,ch=Ee.floor,Qc=qt.getOwnPropertySymbols,Vb=rh?rh.isBuffer:n,Jg=O.isFinite,Xb=th.join,Gb=Xg(qt.keys,qt),Se=Ee.max,ze=Ee.min,Kb=q.now,qb=O.parseInt,Qg=Ee.random,jb=th.reverse,tu=Lr(O,"DataView"),_o=Lr(O,"Map"),eu=Lr(O,"Promise"),fs=Lr(O,"Set"),mo=Lr(O,"WeakMap"),yo=Lr(qt,"create"),uh=mo&&new mo,ps={},Zb=Pr(tu),$b=Pr(_o),Jb=Pr(eu),Qb=Pr(fs),tE=Pr(mo),dh=Xi?Xi.prototype:n,vo=dh?dh.valueOf:n,t_=dh?dh.toString:n;function m(r){if(de(r)&&!lt(r)&&!(r instanceof Et)){if(r instanceof Bn)return r;if(Ut.call(r,"__wrapped__"))return e0(r)}return new Bn(r)}var gs=function(){function r(){}return function(o){if(!ce(o))return{};if(jg)return jg(o);r.prototype=o;var c=new r;return r.prototype=n,c}}();function fh(){}function Bn(r,o){this.__wrapped__=r,this.__actions__=[],this.__chain__=!!o,this.__index__=0,this.__values__=n}m.templateSettings={escape:px,evaluate:gx,interpolate:lg,variable:"",imports:{_:m}},m.prototype=fh.prototype,m.prototype.constructor=m,Bn.prototype=gs(fh.prototype),Bn.prototype.constructor=Bn;function Et(r){this.__wrapped__=r,this.__actions__=[],this.__dir__=1,this.__filtered__=!1,this.__iteratees__=[],this.__takeCount__=si,this.__views__=[]}function eE(){var r=new Et(this.__wrapped__);return r.__actions__=Ze(this.__actions__),r.__dir__=this.__dir__,r.__filtered__=this.__filtered__,r.__iteratees__=Ze(this.__iteratees__),r.__takeCount__=this.__takeCount__,r.__views__=Ze(this.__views__),r}function nE(){if(this.__filtered__){var r=new Et(this);r.__dir__=-1,r.__filtered__=!0}else r=this.clone(),r.__dir__*=-1;return r}function iE(){var r=this.__wrapped__.value(),o=this.__dir__,c=lt(r),d=o<0,_=c?r.length:0,y=gS(0,_,this.__views__),x=y.start,b=y.end,T=b-x,k=d?b:x-1,M=this.__iteratees__,z=M.length,U=0,Z=ze(T,this.__takeCount__);if(!c||!d&&_==T&&Z==T)return S_(r,this.__actions__);var et=[];t:for(;T--&&U<Z;){k+=o;for(var pt=-1,nt=r[k];++pt<z;){var bt=M[pt],Lt=bt.iteratee,_n=bt.type,Ge=Lt(nt);if(_n==xt)nt=Ge;else if(!Ge){if(_n==Wt)continue t;break t}}et[U++]=nt}return et}Et.prototype=gs(fh.prototype),Et.prototype.constructor=Et;function Er(r){var o=-1,c=r==null?0:r.length;for(this.clear();++o<c;){var d=r[o];this.set(d[0],d[1])}}function rE(){this.__data__=yo?yo(null):{},this.size=0}function sE(r){var o=this.has(r)&&delete this.__data__[r];return this.size-=o?1:0,o}function oE(r){var o=this.__data__;if(yo){var c=o[r];return c===u?n:c}return Ut.call(o,r)?o[r]:n}function aE(r){var o=this.__data__;return yo?o[r]!==n:Ut.call(o,r)}function hE(r,o){var c=this.__data__;return this.size+=this.has(r)?0:1,c[r]=yo&&o===n?u:o,this}Er.prototype.clear=rE,Er.prototype.delete=sE,Er.prototype.get=oE,Er.prototype.has=aE,Er.prototype.set=hE;function wi(r){var o=-1,c=r==null?0:r.length;for(this.clear();++o<c;){var d=r[o];this.set(d[0],d[1])}}function lE(){this.__data__=[],this.size=0}function cE(r){var o=this.__data__,c=ph(o,r);if(c<0)return!1;var d=o.length-1;return c==d?o.pop():ah.call(o,c,1),--this.size,!0}function uE(r){var o=this.__data__,c=ph(o,r);return c<0?n:o[c][1]}function dE(r){return ph(this.__data__,r)>-1}function fE(r,o){var c=this.__data__,d=ph(c,r);return d<0?(++this.size,c.push([r,o])):c[d][1]=o,this}wi.prototype.clear=lE,wi.prototype.delete=cE,wi.prototype.get=uE,wi.prototype.has=dE,wi.prototype.set=fE;function xi(r){var o=-1,c=r==null?0:r.length;for(this.clear();++o<c;){var d=r[o];this.set(d[0],d[1])}}function pE(){this.size=0,this.__data__={hash:new Er,map:new(_o||wi),string:new Er}}function gE(r){var o=Th(this,r).delete(r);return this.size-=o?1:0,o}function _E(r){return Th(this,r).get(r)}function mE(r){return Th(this,r).has(r)}function yE(r,o){var c=Th(this,r),d=c.size;return c.set(r,o),this.size+=c.size==d?0:1,this}xi.prototype.clear=pE,xi.prototype.delete=gE,xi.prototype.get=_E,xi.prototype.has=mE,xi.prototype.set=yE;function Sr(r){var o=-1,c=r==null?0:r.length;for(this.__data__=new xi;++o<c;)this.add(r[o])}function vE(r){return this.__data__.set(r,u),this}function wE(r){return this.__data__.has(r)}Sr.prototype.add=Sr.prototype.push=vE,Sr.prototype.has=wE;function Xn(r){var o=this.__data__=new wi(r);this.size=o.size}function xE(){this.__data__=new wi,this.size=0}function bE(r){var o=this.__data__,c=o.delete(r);return this.size=o.size,c}function EE(r){return this.__data__.get(r)}function SE(r){return this.__data__.has(r)}function CE(r,o){var c=this.__data__;if(c instanceof wi){var d=c.__data__;if(!_o||d.length<s-1)return d.push([r,o]),this.size=++c.size,this;c=this.__data__=new xi(d)}return c.set(r,o),this.size=c.size,this}Xn.prototype.clear=xE,Xn.prototype.delete=bE,Xn.prototype.get=EE,Xn.prototype.has=SE,Xn.prototype.set=CE;function e_(r,o){var c=lt(r),d=!c&&Br(r),_=!c&&!d&&Zi(r),y=!c&&!d&&!_&&vs(r),x=c||d||_||y,b=x?jc(r.length,Db):[],T=b.length;for(var k in r)(o||Ut.call(r,k))&&!(x&&(k=="length"||_&&(k=="offset"||k=="parent")||y&&(k=="buffer"||k=="byteLength"||k=="byteOffset")||Ci(k,T)))&&b.push(k);return b}function n_(r){var o=r.length;return o?r[du(0,o-1)]:n}function TE(r,o){return Lh(Ze(r),Cr(o,0,r.length))}function LE(r){return Lh(Ze(r))}function nu(r,o,c){(c!==n&&!Gn(r[o],c)||c===n&&!(o in r))&&bi(r,o,c)}function wo(r,o,c){var d=r[o];(!(Ut.call(r,o)&&Gn(d,c))||c===n&&!(o in r))&&bi(r,o,c)}function ph(r,o){for(var c=r.length;c--;)if(Gn(r[c][0],o))return c;return-1}function PE(r,o,c,d){return Gi(r,function(_,y,x){o(d,_,c(_),x)}),d}function i_(r,o){return r&&ai(o,Le(o),r)}function BE(r,o){return r&&ai(o,Je(o),r)}function bi(r,o,c){o=="__proto__"&&hh?hh(r,o,{configurable:!0,enumerable:!0,value:c,writable:!0}):r[o]=c}function iu(r,o){for(var c=-1,d=o.length,_=B(d),y=r==null;++c<d;)_[c]=y?n:zu(r,o[c]);return _}function Cr(r,o,c){return r===r&&(c!==n&&(r=r<=c?r:c),o!==n&&(r=r>=o?r:o)),r}function Rn(r,o,c,d,_,y){var x,b=o&p,T=o&v,k=o&w;if(c&&(x=_?c(r,d,_,y):c(r)),x!==n)return x;if(!ce(r))return r;var M=lt(r);if(M){if(x=mS(r),!b)return Ze(r,x)}else{var z=We(r),U=z==Ga||z==sg;if(Zi(r))return L_(r,b);if(z==vi||z==ss||U&&!_){if(x=T||U?{}:G_(r),!b)return T?oS(r,BE(x,r)):sS(r,i_(x,r))}else{if(!Qt[z])return _?r:{};x=yS(r,z,b)}}y||(y=new Xn);var Z=y.get(r);if(Z)return Z;y.set(r,x),x0(r)?r.forEach(function(nt){x.add(Rn(nt,o,c,nt,r,y))}):v0(r)&&r.forEach(function(nt,bt){x.set(bt,Rn(nt,o,c,bt,r,y))});var et=k?T?Eu:bu:T?Je:Le,pt=M?n:et(r);return Ln(pt||r,function(nt,bt){pt&&(bt=nt,nt=r[bt]),wo(x,bt,Rn(nt,o,c,bt,r,y))}),x}function RE(r){var o=Le(r);return function(c){return r_(c,r,o)}}function r_(r,o,c){var d=c.length;if(r==null)return!d;for(r=qt(r);d--;){var _=c[d],y=o[_],x=r[_];if(x===n&&!(_ in r)||!y(x))return!1}return!0}function s_(r,o,c){if(typeof r!="function")throw new Pn(h);return Lo(function(){r.apply(n,c)},o)}function xo(r,o,c,d){var _=-1,y=$a,x=!0,b=r.length,T=[],k=o.length;if(!b)return T;c&&(o=oe(o,fn(c))),d?(y=Yc,x=!1):o.length>=s&&(y=po,x=!1,o=new Sr(o));t:for(;++_<b;){var M=r[_],z=c==null?M:c(M);if(M=d||M!==0?M:0,x&&z===z){for(var U=k;U--;)if(o[U]===z)continue t;T.push(M)}else y(o,z,d)||T.push(M)}return T}var Gi=A_(oi),o_=A_(su,!0);function OE(r,o){var c=!0;return Gi(r,function(d,_,y){return c=!!o(d,_,y),c}),c}function gh(r,o,c){for(var d=-1,_=r.length;++d<_;){var y=r[d],x=o(y);if(x!=null&&(b===n?x===x&&!gn(x):c(x,b)))var b=x,T=y}return T}function AE(r,o,c,d){var _=r.length;for(c=ut(c),c<0&&(c=-c>_?0:_+c),d=d===n||d>_?_:ut(d),d<0&&(d+=_),d=c>d?0:E0(d);c<d;)r[c++]=o;return r}function a_(r,o){var c=[];return Gi(r,function(d,_,y){o(d,_,y)&&c.push(d)}),c}function De(r,o,c,d,_){var y=-1,x=r.length;for(c||(c=wS),_||(_=[]);++y<x;){var b=r[y];o>0&&c(b)?o>1?De(b,o-1,c,d,_):Yi(_,b):d||(_[_.length]=b)}return _}var ru=k_(),h_=k_(!0);function oi(r,o){return r&&ru(r,o,Le)}function su(r,o){return r&&h_(r,o,Le)}function _h(r,o){return Ui(o,function(c){return Ti(r[c])})}function Tr(r,o){o=qi(o,r);for(var c=0,d=o.length;r!=null&&c<d;)r=r[hi(o[c++])];return c&&c==d?r:n}function l_(r,o,c){var d=o(r);return lt(r)?d:Yi(d,c(r))}function Ve(r){return r==null?r===n?ax:sx:br&&br in qt(r)?pS(r):LS(r)}function ou(r,o){return r>o}function kE(r,o){return r!=null&&Ut.call(r,o)}function ME(r,o){return r!=null&&o in qt(r)}function DE(r,o,c){return r>=ze(o,c)&&r<Se(o,c)}function au(r,o,c){for(var d=c?Yc:$a,_=r[0].length,y=r.length,x=y,b=B(y),T=1/0,k=[];x--;){var M=r[x];x&&o&&(M=oe(M,fn(o))),T=ze(M.length,T),b[x]=!c&&(o||_>=120&&M.length>=120)?new Sr(x&&M):n}M=r[0];var z=-1,U=b[0];t:for(;++z<_&&k.length<T;){var Z=M[z],et=o?o(Z):Z;if(Z=c||Z!==0?Z:0,!(U?po(U,et):d(k,et,c))){for(x=y;--x;){var pt=b[x];if(!(pt?po(pt,et):d(r[x],et,c)))continue t}U&&U.push(et),k.push(Z)}}return k}function IE(r,o,c,d){return oi(r,function(_,y,x){o(d,c(_),y,x)}),d}function bo(r,o,c){o=qi(o,r),r=Z_(r,o);var d=r==null?r:r[hi(An(o))];return d==null?n:dn(d,r,c)}function c_(r){return de(r)&&Ve(r)==ss}function zE(r){return de(r)&&Ve(r)==fo}function WE(r){return de(r)&&Ve(r)==ao}function Eo(r,o,c,d,_){return r===o?!0:r==null||o==null||!de(r)&&!de(o)?r!==r&&o!==o:FE(r,o,c,d,Eo,_)}function FE(r,o,c,d,_,y){var x=lt(r),b=lt(o),T=x?Va:We(r),k=b?Va:We(o);T=T==ss?vi:T,k=k==ss?vi:k;var M=T==vi,z=k==vi,U=T==k;if(U&&Zi(r)){if(!Zi(o))return!1;x=!0,M=!1}if(U&&!M)return y||(y=new Xn),x||vs(r)?Y_(r,o,c,d,_,y):dS(r,o,T,c,d,_,y);if(!(c&E)){var Z=M&&Ut.call(r,"__wrapped__"),et=z&&Ut.call(o,"__wrapped__");if(Z||et){var pt=Z?r.value():r,nt=et?o.value():o;return y||(y=new Xn),_(pt,nt,c,d,y)}}return U?(y||(y=new Xn),fS(r,o,c,d,_,y)):!1}function NE(r){return de(r)&&We(r)==Un}function hu(r,o,c,d){var _=c.length,y=_,x=!d;if(r==null)return!y;for(r=qt(r);_--;){var b=c[_];if(x&&b[2]?b[1]!==r[b[0]]:!(b[0]in r))return!1}for(;++_<y;){b=c[_];var T=b[0],k=r[T],M=b[1];if(x&&b[2]){if(k===n&&!(T in r))return!1}else{var z=new Xn;if(d)var U=d(k,M,T,r,o,z);if(!(U===n?Eo(M,k,E|P,d,z):U))return!1}}return!0}function u_(r){if(!ce(r)||bS(r))return!1;var o=Ti(r)?Nb:Rx;return o.test(Pr(r))}function HE(r){return de(r)&&Ve(r)==lo}function UE(r){return de(r)&&We(r)==Yn}function YE(r){return de(r)&&kh(r.length)&&!!ie[Ve(r)]}function d_(r){return typeof r=="function"?r:r==null?Qe:typeof r=="object"?lt(r)?g_(r[0],r[1]):p_(r):M0(r)}function lu(r){if(!To(r))return Gb(r);var o=[];for(var c in qt(r))Ut.call(r,c)&&c!="constructor"&&o.push(c);return o}function VE(r){if(!ce(r))return TS(r);var o=To(r),c=[];for(var d in r)d=="constructor"&&(o||!Ut.call(r,d))||c.push(d);return c}function cu(r,o){return r<o}function f_(r,o){var c=-1,d=$e(r)?B(r.length):[];return Gi(r,function(_,y,x){d[++c]=o(_,y,x)}),d}function p_(r){var o=Cu(r);return o.length==1&&o[0][2]?q_(o[0][0],o[0][1]):function(c){return c===r||hu(c,r,o)}}function g_(r,o){return Lu(r)&&K_(o)?q_(hi(r),o):function(c){var d=zu(c,r);return d===n&&d===o?Wu(c,r):Eo(o,d,E|P)}}function mh(r,o,c,d,_){r!==o&&ru(o,function(y,x){if(_||(_=new Xn),ce(y))XE(r,o,x,c,mh,d,_);else{var b=d?d(Bu(r,x),y,x+"",r,o,_):n;b===n&&(b=y),nu(r,x,b)}},Je)}function XE(r,o,c,d,_,y,x){var b=Bu(r,c),T=Bu(o,c),k=x.get(T);if(k){nu(r,c,k);return}var M=y?y(b,T,c+"",r,o,x):n,z=M===n;if(z){var U=lt(T),Z=!U&&Zi(T),et=!U&&!Z&&vs(T);M=T,U||Z||et?lt(b)?M=b:ge(b)?M=Ze(b):Z?(z=!1,M=L_(T,!0)):et?(z=!1,M=P_(T,!0)):M=[]:Po(T)||Br(T)?(M=b,Br(b)?M=S0(b):(!ce(b)||Ti(b))&&(M=G_(T))):z=!1}z&&(x.set(T,M),_(M,T,d,y,x),x.delete(T)),nu(r,c,M)}function __(r,o){var c=r.length;if(c)return o+=o<0?c:0,Ci(o,c)?r[o]:n}function m_(r,o,c){o.length?o=oe(o,function(y){return lt(y)?function(x){return Tr(x,y.length===1?y[0]:y)}:y}):o=[Qe];var d=-1;o=oe(o,fn(tt()));var _=f_(r,function(y,x,b){var T=oe(o,function(k){return k(y)});return{criteria:T,index:++d,value:y}});return yb(_,function(y,x){return rS(y,x,c)})}function GE(r,o){return y_(r,o,function(c,d){return Wu(r,d)})}function y_(r,o,c){for(var d=-1,_=o.length,y={};++d<_;){var x=o[d],b=Tr(r,x);c(b,x)&&So(y,qi(x,r),b)}return y}function KE(r){return function(o){return Tr(o,r)}}function uu(r,o,c,d){var _=d?mb:hs,y=-1,x=o.length,b=r;for(r===o&&(o=Ze(o)),c&&(b=oe(r,fn(c)));++y<x;)for(var T=0,k=o[y],M=c?c(k):k;(T=_(b,M,T,d))>-1;)b!==r&&ah.call(b,T,1),ah.call(r,T,1);return r}function v_(r,o){for(var c=r?o.length:0,d=c-1;c--;){var _=o[c];if(c==d||_!==y){var y=_;Ci(_)?ah.call(r,_,1):gu(r,_)}}return r}function du(r,o){return r+ch(Qg()*(o-r+1))}function qE(r,o,c,d){for(var _=-1,y=Se(lh((o-r)/(c||1)),0),x=B(y);y--;)x[d?y:++_]=r,r+=c;return x}function fu(r,o){var c="";if(!r||o<1||o>ke)return c;do o%2&&(c+=r),o=ch(o/2),o&&(r+=r);while(o);return c}function mt(r,o){return Ru(j_(r,o,Qe),r+"")}function jE(r){return n_(ws(r))}function ZE(r,o){var c=ws(r);return Lh(c,Cr(o,0,c.length))}function So(r,o,c,d){if(!ce(r))return r;o=qi(o,r);for(var _=-1,y=o.length,x=y-1,b=r;b!=null&&++_<y;){var T=hi(o[_]),k=c;if(T==="__proto__"||T==="constructor"||T==="prototype")return r;if(_!=x){var M=b[T];k=d?d(M,T,b):n,k===n&&(k=ce(M)?M:Ci(o[_+1])?[]:{})}wo(b,T,k),b=b[T]}return r}var w_=uh?function(r,o){return uh.set(r,o),r}:Qe,$E=hh?function(r,o){return hh(r,"toString",{configurable:!0,enumerable:!1,value:Nu(o),writable:!0})}:Qe;function JE(r){return Lh(ws(r))}function On(r,o,c){var d=-1,_=r.length;o<0&&(o=-o>_?0:_+o),c=c>_?_:c,c<0&&(c+=_),_=o>c?0:c-o>>>0,o>>>=0;for(var y=B(_);++d<_;)y[d]=r[d+o];return y}function QE(r,o){var c;return Gi(r,function(d,_,y){return c=o(d,_,y),!c}),!!c}function yh(r,o,c){var d=0,_=r==null?d:r.length;if(typeof o=="number"&&o===o&&_<=ex){for(;d<_;){var y=d+_>>>1,x=r[y];x!==null&&!gn(x)&&(c?x<=o:x<o)?d=y+1:_=y}return _}return pu(r,o,Qe,c)}function pu(r,o,c,d){var _=0,y=r==null?0:r.length;if(y===0)return 0;o=c(o);for(var x=o!==o,b=o===null,T=gn(o),k=o===n;_<y;){var M=ch((_+y)/2),z=c(r[M]),U=z!==n,Z=z===null,et=z===z,pt=gn(z);if(x)var nt=d||et;else k?nt=et&&(d||U):b?nt=et&&U&&(d||!Z):T?nt=et&&U&&!Z&&(d||!pt):Z||pt?nt=!1:nt=d?z<=o:z<o;nt?_=M+1:y=M}return ze(y,tx)}function x_(r,o){for(var c=-1,d=r.length,_=0,y=[];++c<d;){var x=r[c],b=o?o(x):x;if(!c||!Gn(b,T)){var T=b;y[_++]=x===0?0:x}}return y}function b_(r){return typeof r=="number"?r:gn(r)?Cn:+r}function pn(r){if(typeof r=="string")return r;if(lt(r))return oe(r,pn)+"";if(gn(r))return t_?t_.call(r):"";var o=r+"";return o=="0"&&1/r==-Ye?"-0":o}function Ki(r,o,c){var d=-1,_=$a,y=r.length,x=!0,b=[],T=b;if(c)x=!1,_=Yc;else if(y>=s){var k=o?null:cS(r);if(k)return Qa(k);x=!1,_=po,T=new Sr}else T=o?[]:b;t:for(;++d<y;){var M=r[d],z=o?o(M):M;if(M=c||M!==0?M:0,x&&z===z){for(var U=T.length;U--;)if(T[U]===z)continue t;o&&T.push(z),b.push(M)}else _(T,z,c)||(T!==b&&T.push(z),b.push(M))}return b}function gu(r,o){return o=qi(o,r),r=Z_(r,o),r==null||delete r[hi(An(o))]}function E_(r,o,c,d){return So(r,o,c(Tr(r,o)),d)}function vh(r,o,c,d){for(var _=r.length,y=d?_:-1;(d?y--:++y<_)&&o(r[y],y,r););return c?On(r,d?0:y,d?y+1:_):On(r,d?y+1:0,d?_:y)}function S_(r,o){var c=r;return c instanceof Et&&(c=c.value()),Vc(o,function(d,_){return _.func.apply(_.thisArg,Yi([d],_.args))},c)}function _u(r,o,c){var d=r.length;if(d<2)return d?Ki(r[0]):[];for(var _=-1,y=B(d);++_<d;)for(var x=r[_],b=-1;++b<d;)b!=_&&(y[_]=xo(y[_]||x,r[b],o,c));return Ki(De(y,1),o,c)}function C_(r,o,c){for(var d=-1,_=r.length,y=o.length,x={};++d<_;){var b=d<y?o[d]:n;c(x,r[d],b)}return x}function mu(r){return ge(r)?r:[]}function yu(r){return typeof r=="function"?r:Qe}function qi(r,o){return lt(r)?r:Lu(r,o)?[r]:t0(Ft(r))}var tS=mt;function ji(r,o,c){var d=r.length;return c=c===n?d:c,!o&&c>=d?r:On(r,o,c)}var T_=Hb||function(r){return Me.clearTimeout(r)};function L_(r,o){if(o)return r.slice();var c=r.length,d=qg?qg(c):new r.constructor(c);return r.copy(d),d}function vu(r){var o=new r.constructor(r.byteLength);return new sh(o).set(new sh(r)),o}function eS(r,o){var c=o?vu(r.buffer):r.buffer;return new r.constructor(c,r.byteOffset,r.byteLength)}function nS(r){var o=new r.constructor(r.source,cg.exec(r));return o.lastIndex=r.lastIndex,o}function iS(r){return vo?qt(vo.call(r)):{}}function P_(r,o){var c=o?vu(r.buffer):r.buffer;return new r.constructor(c,r.byteOffset,r.length)}function B_(r,o){if(r!==o){var c=r!==n,d=r===null,_=r===r,y=gn(r),x=o!==n,b=o===null,T=o===o,k=gn(o);if(!b&&!k&&!y&&r>o||y&&x&&T&&!b&&!k||d&&x&&T||!c&&T||!_)return 1;if(!d&&!y&&!k&&r<o||k&&c&&_&&!d&&!y||b&&c&&_||!x&&_||!T)return-1}return 0}function rS(r,o,c){for(var d=-1,_=r.criteria,y=o.criteria,x=_.length,b=c.length;++d<x;){var T=B_(_[d],y[d]);if(T){if(d>=b)return T;var k=c[d];return T*(k=="desc"?-1:1)}}return r.index-o.index}function R_(r,o,c,d){for(var _=-1,y=r.length,x=c.length,b=-1,T=o.length,k=Se(y-x,0),M=B(T+k),z=!d;++b<T;)M[b]=o[b];for(;++_<x;)(z||_<y)&&(M[c[_]]=r[_]);for(;k--;)M[b++]=r[_++];return M}function O_(r,o,c,d){for(var _=-1,y=r.length,x=-1,b=c.length,T=-1,k=o.length,M=Se(y-b,0),z=B(M+k),U=!d;++_<M;)z[_]=r[_];for(var Z=_;++T<k;)z[Z+T]=o[T];for(;++x<b;)(U||_<y)&&(z[Z+c[x]]=r[_++]);return z}function Ze(r,o){var c=-1,d=r.length;for(o||(o=B(d));++c<d;)o[c]=r[c];return o}function ai(r,o,c,d){var _=!c;c||(c={});for(var y=-1,x=o.length;++y<x;){var b=o[y],T=d?d(c[b],r[b],b,c,r):n;T===n&&(T=r[b]),_?bi(c,b,T):wo(c,b,T)}return c}function sS(r,o){return ai(r,Tu(r),o)}function oS(r,o){return ai(r,V_(r),o)}function wh(r,o){return function(c,d){var _=lt(c)?ub:PE,y=o?o():{};return _(c,r,tt(d,2),y)}}function _s(r){return mt(function(o,c){var d=-1,_=c.length,y=_>1?c[_-1]:n,x=_>2?c[2]:n;for(y=r.length>3&&typeof y=="function"?(_--,y):n,x&&Xe(c[0],c[1],x)&&(y=_<3?n:y,_=1),o=qt(o);++d<_;){var b=c[d];b&&r(o,b,d,y)}return o})}function A_(r,o){return function(c,d){if(c==null)return c;if(!$e(c))return r(c,d);for(var _=c.length,y=o?_:-1,x=qt(c);(o?y--:++y<_)&&d(x[y],y,x)!==!1;);return c}}function k_(r){return function(o,c,d){for(var _=-1,y=qt(o),x=d(o),b=x.length;b--;){var T=x[r?b:++_];if(c(y[T],T,y)===!1)break}return o}}function aS(r,o,c){var d=o&S,_=Co(r);function y(){var x=this&&this!==Me&&this instanceof y?_:r;return x.apply(d?c:this,arguments)}return y}function M_(r){return function(o){o=Ft(o);var c=ls(o)?Vn(o):n,d=c?c[0]:o.charAt(0),_=c?ji(c,1).join(""):o.slice(1);return d[r]()+_}}function ms(r){return function(o){return Vc(A0(O0(o).replace($x,"")),r,"")}}function Co(r){return function(){var o=arguments;switch(o.length){case 0:return new r;case 1:return new r(o[0]);case 2:return new r(o[0],o[1]);case 3:return new r(o[0],o[1],o[2]);case 4:return new r(o[0],o[1],o[2],o[3]);case 5:return new r(o[0],o[1],o[2],o[3],o[4]);case 6:return new r(o[0],o[1],o[2],o[3],o[4],o[5]);case 7:return new r(o[0],o[1],o[2],o[3],o[4],o[5],o[6])}var c=gs(r.prototype),d=r.apply(c,o);return ce(d)?d:c}}function hS(r,o,c){var d=Co(r);function _(){for(var y=arguments.length,x=B(y),b=y,T=ys(_);b--;)x[b]=arguments[b];var k=y<3&&x[0]!==T&&x[y-1]!==T?[]:Vi(x,T);if(y-=k.length,y<c)return F_(r,o,xh,_.placeholder,n,x,k,n,n,c-y);var M=this&&this!==Me&&this instanceof _?d:r;return dn(M,this,x)}return _}function D_(r){return function(o,c,d){var _=qt(o);if(!$e(o)){var y=tt(c,3);o=Le(o),c=function(b){return y(_[b],b,_)}}var x=r(o,c,d);return x>-1?_[y?o[x]:x]:n}}function I_(r){return Si(function(o){var c=o.length,d=c,_=Bn.prototype.thru;for(r&&o.reverse();d--;){var y=o[d];if(typeof y!="function")throw new Pn(h);if(_&&!x&&Ch(y)=="wrapper")var x=new Bn([],!0)}for(d=x?d:c;++d<c;){y=o[d];var b=Ch(y),T=b=="wrapper"?Su(y):n;T&&Pu(T[0])&&T[1]==(V|I|F|K)&&!T[4].length&&T[9]==1?x=x[Ch(T[0])].apply(x,T[3]):x=y.length==1&&Pu(y)?x[b]():x.thru(y)}return function(){var k=arguments,M=k[0];if(x&&k.length==1&&lt(M))return x.plant(M).value();for(var z=0,U=c?o[z].apply(this,k):M;++z<c;)U=o[z].call(this,U);return U}})}function xh(r,o,c,d,_,y,x,b,T,k){var M=o&V,z=o&S,U=o&R,Z=o&(I|W),et=o&ct,pt=U?n:Co(r);function nt(){for(var bt=arguments.length,Lt=B(bt),_n=bt;_n--;)Lt[_n]=arguments[_n];if(Z)var Ge=ys(nt),mn=wb(Lt,Ge);if(d&&(Lt=R_(Lt,d,_,Z)),y&&(Lt=O_(Lt,y,x,Z)),bt-=mn,Z&&bt<k){var _e=Vi(Lt,Ge);return F_(r,o,xh,nt.placeholder,c,Lt,_e,b,T,k-bt)}var Kn=z?c:this,Pi=U?Kn[r]:r;return bt=Lt.length,b?Lt=PS(Lt,b):et&&bt>1&&Lt.reverse(),M&&T<bt&&(Lt.length=T),this&&this!==Me&&this instanceof nt&&(Pi=pt||Co(Pi)),Pi.apply(Kn,Lt)}return nt}function z_(r,o){return function(c,d){return IE(c,r,o(d),{})}}function bh(r,o){return function(c,d){var _;if(c===n&&d===n)return o;if(c!==n&&(_=c),d!==n){if(_===n)return d;typeof c=="string"||typeof d=="string"?(c=pn(c),d=pn(d)):(c=b_(c),d=b_(d)),_=r(c,d)}return _}}function wu(r){return Si(function(o){return o=oe(o,fn(tt())),mt(function(c){var d=this;return r(o,function(_){return dn(_,d,c)})})})}function Eh(r,o){o=o===n?" ":pn(o);var c=o.length;if(c<2)return c?fu(o,r):o;var d=fu(o,lh(r/cs(o)));return ls(o)?ji(Vn(d),0,r).join(""):d.slice(0,r)}function lS(r,o,c,d){var _=o&S,y=Co(r);function x(){for(var b=-1,T=arguments.length,k=-1,M=d.length,z=B(M+T),U=this&&this!==Me&&this instanceof x?y:r;++k<M;)z[k]=d[k];for(;T--;)z[k++]=arguments[++b];return dn(U,_?c:this,z)}return x}function W_(r){return function(o,c,d){return d&&typeof d!="number"&&Xe(o,c,d)&&(c=d=n),o=Li(o),c===n?(c=o,o=0):c=Li(c),d=d===n?o<c?1:-1:Li(d),qE(o,c,d,r)}}function Sh(r){return function(o,c){return typeof o=="string"&&typeof c=="string"||(o=kn(o),c=kn(c)),r(o,c)}}function F_(r,o,c,d,_,y,x,b,T,k){var M=o&I,z=M?x:n,U=M?n:x,Z=M?y:n,et=M?n:y;o|=M?F:H,o&=~(M?H:F),o&A||(o&=~(S|R));var pt=[r,o,_,Z,z,et,U,b,T,k],nt=c.apply(n,pt);return Pu(r)&&$_(nt,pt),nt.placeholder=d,J_(nt,r,o)}function xu(r){var o=Ee[r];return function(c,d){if(c=kn(c),d=d==null?0:ze(ut(d),292),d&&Jg(c)){var _=(Ft(c)+"e").split("e"),y=o(_[0]+"e"+(+_[1]+d));return _=(Ft(y)+"e").split("e"),+(_[0]+"e"+(+_[1]-d))}return o(c)}}var cS=fs&&1/Qa(new fs([,-0]))[1]==Ye?function(r){return new fs(r)}:Yu;function N_(r){return function(o){var c=We(o);return c==Un?$c(o):c==Yn?Lb(o):vb(o,r(o))}}function Ei(r,o,c,d,_,y,x,b){var T=o&R;if(!T&&typeof r!="function")throw new Pn(h);var k=d?d.length:0;if(k||(o&=~(F|H),d=_=n),x=x===n?x:Se(ut(x),0),b=b===n?b:ut(b),k-=_?_.length:0,o&H){var M=d,z=_;d=_=n}var U=T?n:Su(r),Z=[r,o,c,d,_,M,z,y,x,b];if(U&&CS(Z,U),r=Z[0],o=Z[1],c=Z[2],d=Z[3],_=Z[4],b=Z[9]=Z[9]===n?T?0:r.length:Se(Z[9]-k,0),!b&&o&(I|W)&&(o&=~(I|W)),!o||o==S)var et=aS(r,o,c);else o==I||o==W?et=hS(r,o,b):(o==F||o==(S|F))&&!_.length?et=lS(r,o,c,d):et=xh.apply(n,Z);var pt=U?w_:$_;return J_(pt(et,Z),r,o)}function H_(r,o,c,d){return r===n||Gn(r,ds[c])&&!Ut.call(d,c)?o:r}function U_(r,o,c,d,_,y){return ce(r)&&ce(o)&&(y.set(o,r),mh(r,o,n,U_,y),y.delete(o)),r}function uS(r){return Po(r)?n:r}function Y_(r,o,c,d,_,y){var x=c&E,b=r.length,T=o.length;if(b!=T&&!(x&&T>b))return!1;var k=y.get(r),M=y.get(o);if(k&&M)return k==o&&M==r;var z=-1,U=!0,Z=c&P?new Sr:n;for(y.set(r,o),y.set(o,r);++z<b;){var et=r[z],pt=o[z];if(d)var nt=x?d(pt,et,z,o,r,y):d(et,pt,z,r,o,y);if(nt!==n){if(nt)continue;U=!1;break}if(Z){if(!Xc(o,function(bt,Lt){if(!po(Z,Lt)&&(et===bt||_(et,bt,c,d,y)))return Z.push(Lt)})){U=!1;break}}else if(!(et===pt||_(et,pt,c,d,y))){U=!1;break}}return y.delete(r),y.delete(o),U}function dS(r,o,c,d,_,y,x){switch(c){case os:if(r.byteLength!=o.byteLength||r.byteOffset!=o.byteOffset)return!1;r=r.buffer,o=o.buffer;case fo:return!(r.byteLength!=o.byteLength||!y(new sh(r),new sh(o)));case oo:case ao:case ho:return Gn(+r,+o);case Xa:return r.name==o.name&&r.message==o.message;case lo:case co:return r==o+"";case Un:var b=$c;case Yn:var T=d&E;if(b||(b=Qa),r.size!=o.size&&!T)return!1;var k=x.get(r);if(k)return k==o;d|=P,x.set(r,o);var M=Y_(b(r),b(o),d,_,y,x);return x.delete(r),M;case Ka:if(vo)return vo.call(r)==vo.call(o)}return!1}function fS(r,o,c,d,_,y){var x=c&E,b=bu(r),T=b.length,k=bu(o),M=k.length;if(T!=M&&!x)return!1;for(var z=T;z--;){var U=b[z];if(!(x?U in o:Ut.call(o,U)))return!1}var Z=y.get(r),et=y.get(o);if(Z&&et)return Z==o&&et==r;var pt=!0;y.set(r,o),y.set(o,r);for(var nt=x;++z<T;){U=b[z];var bt=r[U],Lt=o[U];if(d)var _n=x?d(Lt,bt,U,o,r,y):d(bt,Lt,U,r,o,y);if(!(_n===n?bt===Lt||_(bt,Lt,c,d,y):_n)){pt=!1;break}nt||(nt=U=="constructor")}if(pt&&!nt){var Ge=r.constructor,mn=o.constructor;Ge!=mn&&"constructor"in r&&"constructor"in o&&!(typeof Ge=="function"&&Ge instanceof Ge&&typeof mn=="function"&&mn instanceof mn)&&(pt=!1)}return y.delete(r),y.delete(o),pt}function Si(r){return Ru(j_(r,n,r0),r+"")}function bu(r){return l_(r,Le,Tu)}function Eu(r){return l_(r,Je,V_)}var Su=uh?function(r){return uh.get(r)}:Yu;function Ch(r){for(var o=r.name+"",c=ps[o],d=Ut.call(ps,o)?c.length:0;d--;){var _=c[d],y=_.func;if(y==null||y==r)return _.name}return o}function ys(r){var o=Ut.call(m,"placeholder")?m:r;return o.placeholder}function tt(){var r=m.iteratee||Hu;return r=r===Hu?d_:r,arguments.length?r(arguments[0],arguments[1]):r}function Th(r,o){var c=r.__data__;return xS(o)?c[typeof o=="string"?"string":"hash"]:c.map}function Cu(r){for(var o=Le(r),c=o.length;c--;){var d=o[c],_=r[d];o[c]=[d,_,K_(_)]}return o}function Lr(r,o){var c=Sb(r,o);return u_(c)?c:n}function pS(r){var o=Ut.call(r,br),c=r[br];try{r[br]=n;var d=!0}catch{}var _=ih.call(r);return d&&(o?r[br]=c:delete r[br]),_}var Tu=Qc?function(r){return r==null?[]:(r=qt(r),Ui(Qc(r),function(o){return Zg.call(r,o)}))}:Vu,V_=Qc?function(r){for(var o=[];r;)Yi(o,Tu(r)),r=oh(r);return o}:Vu,We=Ve;(tu&&We(new tu(new ArrayBuffer(1)))!=os||_o&&We(new _o)!=Un||eu&&We(eu.resolve())!=og||fs&&We(new fs)!=Yn||mo&&We(new mo)!=uo)&&(We=function(r){var o=Ve(r),c=o==vi?r.constructor:n,d=c?Pr(c):"";if(d)switch(d){case Zb:return os;case $b:return Un;case Jb:return og;case Qb:return Yn;case tE:return uo}return o});function gS(r,o,c){for(var d=-1,_=c.length;++d<_;){var y=c[d],x=y.size;switch(y.type){case"drop":r+=x;break;case"dropRight":o-=x;break;case"take":o=ze(o,r+x);break;case"takeRight":r=Se(r,o-x);break}}return{start:r,end:o}}function _S(r){var o=r.match(bx);return o?o[1].split(Ex):[]}function X_(r,o,c){o=qi(o,r);for(var d=-1,_=o.length,y=!1;++d<_;){var x=hi(o[d]);if(!(y=r!=null&&c(r,x)))break;r=r[x]}return y||++d!=_?y:(_=r==null?0:r.length,!!_&&kh(_)&&Ci(x,_)&&(lt(r)||Br(r)))}function mS(r){var o=r.length,c=new r.constructor(o);return o&&typeof r[0]=="string"&&Ut.call(r,"index")&&(c.index=r.index,c.input=r.input),c}function G_(r){return typeof r.constructor=="function"&&!To(r)?gs(oh(r)):{}}function yS(r,o,c){var d=r.constructor;switch(o){case fo:return vu(r);case oo:case ao:return new d(+r);case os:return eS(r,c);case Cc:case Tc:case Lc:case Pc:case Bc:case Rc:case Oc:case Ac:case kc:return P_(r,c);case Un:return new d;case ho:case co:return new d(r);case lo:return nS(r);case Yn:return new d;case Ka:return iS(r)}}function vS(r,o){var c=o.length;if(!c)return r;var d=c-1;return o[d]=(c>1?"& ":"")+o[d],o=o.join(c>2?", ":" "),r.replace(xx,`{
/* [wrapped with `+o+`] */
`)}function wS(r){return lt(r)||Br(r)||!!($g&&r&&r[$g])}function Ci(r,o){var c=typeof r;return o=o??ke,!!o&&(c=="number"||c!="symbol"&&Ax.test(r))&&r>-1&&r%1==0&&r<o}function Xe(r,o,c){if(!ce(c))return!1;var d=typeof o;return(d=="number"?$e(c)&&Ci(o,c.length):d=="string"&&o in c)?Gn(c[o],r):!1}function Lu(r,o){if(lt(r))return!1;var c=typeof r;return c=="number"||c=="symbol"||c=="boolean"||r==null||gn(r)?!0:mx.test(r)||!_x.test(r)||o!=null&&r in qt(o)}function xS(r){var o=typeof r;return o=="string"||o=="number"||o=="symbol"||o=="boolean"?r!=="__proto__":r===null}function Pu(r){var o=Ch(r),c=m[o];if(typeof c!="function"||!(o in Et.prototype))return!1;if(r===c)return!0;var d=Su(c);return!!d&&r===d[0]}function bS(r){return!!Kg&&Kg in r}var ES=eh?Ti:Xu;function To(r){var o=r&&r.constructor,c=typeof o=="function"&&o.prototype||ds;return r===c}function K_(r){return r===r&&!ce(r)}function q_(r,o){return function(c){return c==null?!1:c[r]===o&&(o!==n||r in qt(c))}}function SS(r){var o=Oh(r,function(d){return c.size===f&&c.clear(),d}),c=o.cache;return o}function CS(r,o){var c=r[1],d=o[1],_=c|d,y=_<(S|R|V),x=d==V&&c==I||d==V&&c==K&&r[7].length<=o[8]||d==(V|K)&&o[7].length<=o[8]&&c==I;if(!(y||x))return r;d&S&&(r[2]=o[2],_|=c&S?0:A);var b=o[3];if(b){var T=r[3];r[3]=T?R_(T,b,o[4]):b,r[4]=T?Vi(r[3],g):o[4]}return b=o[5],b&&(T=r[5],r[5]=T?O_(T,b,o[6]):b,r[6]=T?Vi(r[5],g):o[6]),b=o[7],b&&(r[7]=b),d&V&&(r[8]=r[8]==null?o[8]:ze(r[8],o[8])),r[9]==null&&(r[9]=o[9]),r[0]=o[0],r[1]=_,r}function TS(r){var o=[];if(r!=null)for(var c in qt(r))o.push(c);return o}function LS(r){return ih.call(r)}function j_(r,o,c){return o=Se(o===n?r.length-1:o,0),function(){for(var d=arguments,_=-1,y=Se(d.length-o,0),x=B(y);++_<y;)x[_]=d[o+_];_=-1;for(var b=B(o+1);++_<o;)b[_]=d[_];return b[o]=c(x),dn(r,this,b)}}function Z_(r,o){return o.length<2?r:Tr(r,On(o,0,-1))}function PS(r,o){for(var c=r.length,d=ze(o.length,c),_=Ze(r);d--;){var y=o[d];r[d]=Ci(y,c)?_[y]:n}return r}function Bu(r,o){if(!(o==="constructor"&&typeof r[o]=="function")&&o!="__proto__")return r[o]}var $_=Q_(w_),Lo=Yb||function(r,o){return Me.setTimeout(r,o)},Ru=Q_($E);function J_(r,o,c){var d=o+"";return Ru(r,vS(d,BS(_S(d),c)))}function Q_(r){var o=0,c=0;return function(){var d=Kb(),_=ot-(d-c);if(c=d,_>0){if(++o>=Y)return arguments[0]}else o=0;return r.apply(n,arguments)}}function Lh(r,o){var c=-1,d=r.length,_=d-1;for(o=o===n?d:o;++c<o;){var y=du(c,_),x=r[y];r[y]=r[c],r[c]=x}return r.length=o,r}var t0=SS(function(r){var o=[];return r.charCodeAt(0)===46&&o.push(""),r.replace(yx,function(c,d,_,y){o.push(_?y.replace(Tx,"$1"):d||c)}),o});function hi(r){if(typeof r=="string"||gn(r))return r;var o=r+"";return o=="0"&&1/r==-Ye?"-0":o}function Pr(r){if(r!=null){try{return nh.call(r)}catch{}try{return r+""}catch{}}return""}function BS(r,o){return Ln(nx,function(c){var d="_."+c[0];o&c[1]&&!$a(r,d)&&r.push(d)}),r.sort()}function e0(r){if(r instanceof Et)return r.clone();var o=new Bn(r.__wrapped__,r.__chain__);return o.__actions__=Ze(r.__actions__),o.__index__=r.__index__,o.__values__=r.__values__,o}function RS(r,o,c){(c?Xe(r,o,c):o===n)?o=1:o=Se(ut(o),0);var d=r==null?0:r.length;if(!d||o<1)return[];for(var _=0,y=0,x=B(lh(d/o));_<d;)x[y++]=On(r,_,_+=o);return x}function OS(r){for(var o=-1,c=r==null?0:r.length,d=0,_=[];++o<c;){var y=r[o];y&&(_[d++]=y)}return _}function AS(){var r=arguments.length;if(!r)return[];for(var o=B(r-1),c=arguments[0],d=r;d--;)o[d-1]=arguments[d];return Yi(lt(c)?Ze(c):[c],De(o,1))}var kS=mt(function(r,o){return ge(r)?xo(r,De(o,1,ge,!0)):[]}),MS=mt(function(r,o){var c=An(o);return ge(c)&&(c=n),ge(r)?xo(r,De(o,1,ge,!0),tt(c,2)):[]}),DS=mt(function(r,o){var c=An(o);return ge(c)&&(c=n),ge(r)?xo(r,De(o,1,ge,!0),n,c):[]});function IS(r,o,c){var d=r==null?0:r.length;return d?(o=c||o===n?1:ut(o),On(r,o<0?0:o,d)):[]}function zS(r,o,c){var d=r==null?0:r.length;return d?(o=c||o===n?1:ut(o),o=d-o,On(r,0,o<0?0:o)):[]}function WS(r,o){return r&&r.length?vh(r,tt(o,3),!0,!0):[]}function FS(r,o){return r&&r.length?vh(r,tt(o,3),!0):[]}function NS(r,o,c,d){var _=r==null?0:r.length;return _?(c&&typeof c!="number"&&Xe(r,o,c)&&(c=0,d=_),AE(r,o,c,d)):[]}function n0(r,o,c){var d=r==null?0:r.length;if(!d)return-1;var _=c==null?0:ut(c);return _<0&&(_=Se(d+_,0)),Ja(r,tt(o,3),_)}function i0(r,o,c){var d=r==null?0:r.length;if(!d)return-1;var _=d-1;return c!==n&&(_=ut(c),_=c<0?Se(d+_,0):ze(_,d-1)),Ja(r,tt(o,3),_,!0)}function r0(r){var o=r==null?0:r.length;return o?De(r,1):[]}function HS(r){var o=r==null?0:r.length;return o?De(r,Ye):[]}function US(r,o){var c=r==null?0:r.length;return c?(o=o===n?1:ut(o),De(r,o)):[]}function YS(r){for(var o=-1,c=r==null?0:r.length,d={};++o<c;){var _=r[o];d[_[0]]=_[1]}return d}function s0(r){return r&&r.length?r[0]:n}function VS(r,o,c){var d=r==null?0:r.length;if(!d)return-1;var _=c==null?0:ut(c);return _<0&&(_=Se(d+_,0)),hs(r,o,_)}function XS(r){var o=r==null?0:r.length;return o?On(r,0,-1):[]}var GS=mt(function(r){var o=oe(r,mu);return o.length&&o[0]===r[0]?au(o):[]}),KS=mt(function(r){var o=An(r),c=oe(r,mu);return o===An(c)?o=n:c.pop(),c.length&&c[0]===r[0]?au(c,tt(o,2)):[]}),qS=mt(function(r){var o=An(r),c=oe(r,mu);return o=typeof o=="function"?o:n,o&&c.pop(),c.length&&c[0]===r[0]?au(c,n,o):[]});function jS(r,o){return r==null?"":Xb.call(r,o)}function An(r){var o=r==null?0:r.length;return o?r[o-1]:n}function ZS(r,o,c){var d=r==null?0:r.length;if(!d)return-1;var _=d;return c!==n&&(_=ut(c),_=_<0?Se(d+_,0):ze(_,d-1)),o===o?Bb(r,o,_):Ja(r,Fg,_,!0)}function $S(r,o){return r&&r.length?__(r,ut(o)):n}var JS=mt(o0);function o0(r,o){return r&&r.length&&o&&o.length?uu(r,o):r}function QS(r,o,c){return r&&r.length&&o&&o.length?uu(r,o,tt(c,2)):r}function tC(r,o,c){return r&&r.length&&o&&o.length?uu(r,o,n,c):r}var eC=Si(function(r,o){var c=r==null?0:r.length,d=iu(r,o);return v_(r,oe(o,function(_){return Ci(_,c)?+_:_}).sort(B_)),d});function nC(r,o){var c=[];if(!(r&&r.length))return c;var d=-1,_=[],y=r.length;for(o=tt(o,3);++d<y;){var x=r[d];o(x,d,r)&&(c.push(x),_.push(d))}return v_(r,_),c}function Ou(r){return r==null?r:jb.call(r)}function iC(r,o,c){var d=r==null?0:r.length;return d?(c&&typeof c!="number"&&Xe(r,o,c)?(o=0,c=d):(o=o==null?0:ut(o),c=c===n?d:ut(c)),On(r,o,c)):[]}function rC(r,o){return yh(r,o)}function sC(r,o,c){return pu(r,o,tt(c,2))}function oC(r,o){var c=r==null?0:r.length;if(c){var d=yh(r,o);if(d<c&&Gn(r[d],o))return d}return-1}function aC(r,o){return yh(r,o,!0)}function hC(r,o,c){return pu(r,o,tt(c,2),!0)}function lC(r,o){var c=r==null?0:r.length;if(c){var d=yh(r,o,!0)-1;if(Gn(r[d],o))return d}return-1}function cC(r){return r&&r.length?x_(r):[]}function uC(r,o){return r&&r.length?x_(r,tt(o,2)):[]}function dC(r){var o=r==null?0:r.length;return o?On(r,1,o):[]}function fC(r,o,c){return r&&r.length?(o=c||o===n?1:ut(o),On(r,0,o<0?0:o)):[]}function pC(r,o,c){var d=r==null?0:r.length;return d?(o=c||o===n?1:ut(o),o=d-o,On(r,o<0?0:o,d)):[]}function gC(r,o){return r&&r.length?vh(r,tt(o,3),!1,!0):[]}function _C(r,o){return r&&r.length?vh(r,tt(o,3)):[]}var mC=mt(function(r){return Ki(De(r,1,ge,!0))}),yC=mt(function(r){var o=An(r);return ge(o)&&(o=n),Ki(De(r,1,ge,!0),tt(o,2))}),vC=mt(function(r){var o=An(r);return o=typeof o=="function"?o:n,Ki(De(r,1,ge,!0),n,o)});function wC(r){return r&&r.length?Ki(r):[]}function xC(r,o){return r&&r.length?Ki(r,tt(o,2)):[]}function bC(r,o){return o=typeof o=="function"?o:n,r&&r.length?Ki(r,n,o):[]}function Au(r){if(!(r&&r.length))return[];var o=0;return r=Ui(r,function(c){if(ge(c))return o=Se(c.length,o),!0}),jc(o,function(c){return oe(r,Gc(c))})}function a0(r,o){if(!(r&&r.length))return[];var c=Au(r);return o==null?c:oe(c,function(d){return dn(o,n,d)})}var EC=mt(function(r,o){return ge(r)?xo(r,o):[]}),SC=mt(function(r){return _u(Ui(r,ge))}),CC=mt(function(r){var o=An(r);return ge(o)&&(o=n),_u(Ui(r,ge),tt(o,2))}),TC=mt(function(r){var o=An(r);return o=typeof o=="function"?o:n,_u(Ui(r,ge),n,o)}),LC=mt(Au);function PC(r,o){return C_(r||[],o||[],wo)}function BC(r,o){return C_(r||[],o||[],So)}var RC=mt(function(r){var o=r.length,c=o>1?r[o-1]:n;return c=typeof c=="function"?(r.pop(),c):n,a0(r,c)});function h0(r){var o=m(r);return o.__chain__=!0,o}function OC(r,o){return o(r),r}function Ph(r,o){return o(r)}var AC=Si(function(r){var o=r.length,c=o?r[0]:0,d=this.__wrapped__,_=function(y){return iu(y,r)};return o>1||this.__actions__.length||!(d instanceof Et)||!Ci(c)?this.thru(_):(d=d.slice(c,+c+(o?1:0)),d.__actions__.push({func:Ph,args:[_],thisArg:n}),new Bn(d,this.__chain__).thru(function(y){return o&&!y.length&&y.push(n),y}))});function kC(){return h0(this)}function MC(){return new Bn(this.value(),this.__chain__)}function DC(){this.__values__===n&&(this.__values__=b0(this.value()));var r=this.__index__>=this.__values__.length,o=r?n:this.__values__[this.__index__++];return{done:r,value:o}}function IC(){return this}function zC(r){for(var o,c=this;c instanceof fh;){var d=e0(c);d.__index__=0,d.__values__=n,o?_.__wrapped__=d:o=d;var _=d;c=c.__wrapped__}return _.__wrapped__=r,o}function WC(){var r=this.__wrapped__;if(r instanceof Et){var o=r;return this.__actions__.length&&(o=new Et(this)),o=o.reverse(),o.__actions__.push({func:Ph,args:[Ou],thisArg:n}),new Bn(o,this.__chain__)}return this.thru(Ou)}function FC(){return S_(this.__wrapped__,this.__actions__)}var NC=wh(function(r,o,c){Ut.call(r,c)?++r[c]:bi(r,c,1)});function HC(r,o,c){var d=lt(r)?zg:OE;return c&&Xe(r,o,c)&&(o=n),d(r,tt(o,3))}function UC(r,o){var c=lt(r)?Ui:a_;return c(r,tt(o,3))}var YC=D_(n0),VC=D_(i0);function XC(r,o){return De(Bh(r,o),1)}function GC(r,o){return De(Bh(r,o),Ye)}function KC(r,o,c){return c=c===n?1:ut(c),De(Bh(r,o),c)}function l0(r,o){var c=lt(r)?Ln:Gi;return c(r,tt(o,3))}function c0(r,o){var c=lt(r)?db:o_;return c(r,tt(o,3))}var qC=wh(function(r,o,c){Ut.call(r,c)?r[c].push(o):bi(r,c,[o])});function jC(r,o,c,d){r=$e(r)?r:ws(r),c=c&&!d?ut(c):0;var _=r.length;return c<0&&(c=Se(_+c,0)),Mh(r)?c<=_&&r.indexOf(o,c)>-1:!!_&&hs(r,o,c)>-1}var ZC=mt(function(r,o,c){var d=-1,_=typeof o=="function",y=$e(r)?B(r.length):[];return Gi(r,function(x){y[++d]=_?dn(o,x,c):bo(x,o,c)}),y}),$C=wh(function(r,o,c){bi(r,c,o)});function Bh(r,o){var c=lt(r)?oe:f_;return c(r,tt(o,3))}function JC(r,o,c,d){return r==null?[]:(lt(o)||(o=o==null?[]:[o]),c=d?n:c,lt(c)||(c=c==null?[]:[c]),m_(r,o,c))}var QC=wh(function(r,o,c){r[c?0:1].push(o)},function(){return[[],[]]});function tT(r,o,c){var d=lt(r)?Vc:Hg,_=arguments.length<3;return d(r,tt(o,4),c,_,Gi)}function eT(r,o,c){var d=lt(r)?fb:Hg,_=arguments.length<3;return d(r,tt(o,4),c,_,o_)}function nT(r,o){var c=lt(r)?Ui:a_;return c(r,Ah(tt(o,3)))}function iT(r){var o=lt(r)?n_:jE;return o(r)}function rT(r,o,c){(c?Xe(r,o,c):o===n)?o=1:o=ut(o);var d=lt(r)?TE:ZE;return d(r,o)}function sT(r){var o=lt(r)?LE:JE;return o(r)}function oT(r){if(r==null)return 0;if($e(r))return Mh(r)?cs(r):r.length;var o=We(r);return o==Un||o==Yn?r.size:lu(r).length}function aT(r,o,c){var d=lt(r)?Xc:QE;return c&&Xe(r,o,c)&&(o=n),d(r,tt(o,3))}var hT=mt(function(r,o){if(r==null)return[];var c=o.length;return c>1&&Xe(r,o[0],o[1])?o=[]:c>2&&Xe(o[0],o[1],o[2])&&(o=[o[0]]),m_(r,De(o,1),[])}),Rh=Ub||function(){return Me.Date.now()};function lT(r,o){if(typeof o!="function")throw new Pn(h);return r=ut(r),function(){if(--r<1)return o.apply(this,arguments)}}function u0(r,o,c){return o=c?n:o,o=r&&o==null?r.length:o,Ei(r,V,n,n,n,n,o)}function d0(r,o){var c;if(typeof o!="function")throw new Pn(h);return r=ut(r),function(){return--r>0&&(c=o.apply(this,arguments)),r<=1&&(o=n),c}}var ku=mt(function(r,o,c){var d=S;if(c.length){var _=Vi(c,ys(ku));d|=F}return Ei(r,d,o,c,_)}),f0=mt(function(r,o,c){var d=S|R;if(c.length){var _=Vi(c,ys(f0));d|=F}return Ei(o,d,r,c,_)});function p0(r,o,c){o=c?n:o;var d=Ei(r,I,n,n,n,n,n,o);return d.placeholder=p0.placeholder,d}function g0(r,o,c){o=c?n:o;var d=Ei(r,W,n,n,n,n,n,o);return d.placeholder=g0.placeholder,d}function _0(r,o,c){var d,_,y,x,b,T,k=0,M=!1,z=!1,U=!0;if(typeof r!="function")throw new Pn(h);o=kn(o)||0,ce(c)&&(M=!!c.leading,z="maxWait"in c,y=z?Se(kn(c.maxWait)||0,o):y,U="trailing"in c?!!c.trailing:U);function Z(_e){var Kn=d,Pi=_;return d=_=n,k=_e,x=r.apply(Pi,Kn),x}function et(_e){return k=_e,b=Lo(bt,o),M?Z(_e):x}function pt(_e){var Kn=_e-T,Pi=_e-k,D0=o-Kn;return z?ze(D0,y-Pi):D0}function nt(_e){var Kn=_e-T,Pi=_e-k;return T===n||Kn>=o||Kn<0||z&&Pi>=y}function bt(){var _e=Rh();if(nt(_e))return Lt(_e);b=Lo(bt,pt(_e))}function Lt(_e){return b=n,U&&d?Z(_e):(d=_=n,x)}function _n(){b!==n&&T_(b),k=0,d=T=_=b=n}function Ge(){return b===n?x:Lt(Rh())}function mn(){var _e=Rh(),Kn=nt(_e);if(d=arguments,_=this,T=_e,Kn){if(b===n)return et(T);if(z)return T_(b),b=Lo(bt,o),Z(T)}return b===n&&(b=Lo(bt,o)),x}return mn.cancel=_n,mn.flush=Ge,mn}var cT=mt(function(r,o){return s_(r,1,o)}),uT=mt(function(r,o,c){return s_(r,kn(o)||0,c)});function dT(r){return Ei(r,ct)}function Oh(r,o){if(typeof r!="function"||o!=null&&typeof o!="function")throw new Pn(h);var c=function(){var d=arguments,_=o?o.apply(this,d):d[0],y=c.cache;if(y.has(_))return y.get(_);var x=r.apply(this,d);return c.cache=y.set(_,x)||y,x};return c.cache=new(Oh.Cache||xi),c}Oh.Cache=xi;function Ah(r){if(typeof r!="function")throw new Pn(h);return function(){var o=arguments;switch(o.length){case 0:return!r.call(this);case 1:return!r.call(this,o[0]);case 2:return!r.call(this,o[0],o[1]);case 3:return!r.call(this,o[0],o[1],o[2])}return!r.apply(this,o)}}function fT(r){return d0(2,r)}var pT=tS(function(r,o){o=o.length==1&&lt(o[0])?oe(o[0],fn(tt())):oe(De(o,1),fn(tt()));var c=o.length;return mt(function(d){for(var _=-1,y=ze(d.length,c);++_<y;)d[_]=o[_].call(this,d[_]);return dn(r,this,d)})}),Mu=mt(function(r,o){var c=Vi(o,ys(Mu));return Ei(r,F,n,o,c)}),m0=mt(function(r,o){var c=Vi(o,ys(m0));return Ei(r,H,n,o,c)}),gT=Si(function(r,o){return Ei(r,K,n,n,n,o)});function _T(r,o){if(typeof r!="function")throw new Pn(h);return o=o===n?o:ut(o),mt(r,o)}function mT(r,o){if(typeof r!="function")throw new Pn(h);return o=o==null?0:Se(ut(o),0),mt(function(c){var d=c[o],_=ji(c,0,o);return d&&Yi(_,d),dn(r,this,_)})}function yT(r,o,c){var d=!0,_=!0;if(typeof r!="function")throw new Pn(h);return ce(c)&&(d="leading"in c?!!c.leading:d,_="trailing"in c?!!c.trailing:_),_0(r,o,{leading:d,maxWait:o,trailing:_})}function vT(r){return u0(r,1)}function wT(r,o){return Mu(yu(o),r)}function xT(){if(!arguments.length)return[];var r=arguments[0];return lt(r)?r:[r]}function bT(r){return Rn(r,w)}function ET(r,o){return o=typeof o=="function"?o:n,Rn(r,w,o)}function ST(r){return Rn(r,p|w)}function CT(r,o){return o=typeof o=="function"?o:n,Rn(r,p|w,o)}function TT(r,o){return o==null||r_(r,o,Le(o))}function Gn(r,o){return r===o||r!==r&&o!==o}var LT=Sh(ou),PT=Sh(function(r,o){return r>=o}),Br=c_(function(){return arguments}())?c_:function(r){return de(r)&&Ut.call(r,"callee")&&!Zg.call(r,"callee")},lt=B.isArray,BT=Og?fn(Og):zE;function $e(r){return r!=null&&kh(r.length)&&!Ti(r)}function ge(r){return de(r)&&$e(r)}function RT(r){return r===!0||r===!1||de(r)&&Ve(r)==oo}var Zi=Vb||Xu,OT=Ag?fn(Ag):WE;function AT(r){return de(r)&&r.nodeType===1&&!Po(r)}function kT(r){if(r==null)return!0;if($e(r)&&(lt(r)||typeof r=="string"||typeof r.splice=="function"||Zi(r)||vs(r)||Br(r)))return!r.length;var o=We(r);if(o==Un||o==Yn)return!r.size;if(To(r))return!lu(r).length;for(var c in r)if(Ut.call(r,c))return!1;return!0}function MT(r,o){return Eo(r,o)}function DT(r,o,c){c=typeof c=="function"?c:n;var d=c?c(r,o):n;return d===n?Eo(r,o,n,c):!!d}function Du(r){if(!de(r))return!1;var o=Ve(r);return o==Xa||o==rx||typeof r.message=="string"&&typeof r.name=="string"&&!Po(r)}function IT(r){return typeof r=="number"&&Jg(r)}function Ti(r){if(!ce(r))return!1;var o=Ve(r);return o==Ga||o==sg||o==ix||o==ox}function y0(r){return typeof r=="number"&&r==ut(r)}function kh(r){return typeof r=="number"&&r>-1&&r%1==0&&r<=ke}function ce(r){var o=typeof r;return r!=null&&(o=="object"||o=="function")}function de(r){return r!=null&&typeof r=="object"}var v0=kg?fn(kg):NE;function zT(r,o){return r===o||hu(r,o,Cu(o))}function WT(r,o,c){return c=typeof c=="function"?c:n,hu(r,o,Cu(o),c)}function FT(r){return w0(r)&&r!=+r}function NT(r){if(ES(r))throw new at(a);return u_(r)}function HT(r){return r===null}function UT(r){return r==null}function w0(r){return typeof r=="number"||de(r)&&Ve(r)==ho}function Po(r){if(!de(r)||Ve(r)!=vi)return!1;var o=oh(r);if(o===null)return!0;var c=Ut.call(o,"constructor")&&o.constructor;return typeof c=="function"&&c instanceof c&&nh.call(c)==Wb}var Iu=Mg?fn(Mg):HE;function YT(r){return y0(r)&&r>=-ke&&r<=ke}var x0=Dg?fn(Dg):UE;function Mh(r){return typeof r=="string"||!lt(r)&&de(r)&&Ve(r)==co}function gn(r){return typeof r=="symbol"||de(r)&&Ve(r)==Ka}var vs=Ig?fn(Ig):YE;function VT(r){return r===n}function XT(r){return de(r)&&We(r)==uo}function GT(r){return de(r)&&Ve(r)==hx}var KT=Sh(cu),qT=Sh(function(r,o){return r<=o});function b0(r){if(!r)return[];if($e(r))return Mh(r)?Vn(r):Ze(r);if(go&&r[go])return Tb(r[go]());var o=We(r),c=o==Un?$c:o==Yn?Qa:ws;return c(r)}function Li(r){if(!r)return r===0?r:0;if(r=kn(r),r===Ye||r===-Ye){var o=r<0?-1:1;return o*Hi}return r===r?r:0}function ut(r){var o=Li(r),c=o%1;return o===o?c?o-c:o:0}function E0(r){return r?Cr(ut(r),0,si):0}function kn(r){if(typeof r=="number")return r;if(gn(r))return Cn;if(ce(r)){var o=typeof r.valueOf=="function"?r.valueOf():r;r=ce(o)?o+"":o}if(typeof r!="string")return r===0?r:+r;r=Ug(r);var c=Bx.test(r);return c||Ox.test(r)?lb(r.slice(2),c?2:8):Px.test(r)?Cn:+r}function S0(r){return ai(r,Je(r))}function jT(r){return r?Cr(ut(r),-ke,ke):r===0?r:0}function Ft(r){return r==null?"":pn(r)}var ZT=_s(function(r,o){if(To(o)||$e(o)){ai(o,Le(o),r);return}for(var c in o)Ut.call(o,c)&&wo(r,c,o[c])}),C0=_s(function(r,o){ai(o,Je(o),r)}),Dh=_s(function(r,o,c,d){ai(o,Je(o),r,d)}),$T=_s(function(r,o,c,d){ai(o,Le(o),r,d)}),JT=Si(iu);function QT(r,o){var c=gs(r);return o==null?c:i_(c,o)}var tL=mt(function(r,o){r=qt(r);var c=-1,d=o.length,_=d>2?o[2]:n;for(_&&Xe(o[0],o[1],_)&&(d=1);++c<d;)for(var y=o[c],x=Je(y),b=-1,T=x.length;++b<T;){var k=x[b],M=r[k];(M===n||Gn(M,ds[k])&&!Ut.call(r,k))&&(r[k]=y[k])}return r}),eL=mt(function(r){return r.push(n,U_),dn(T0,n,r)});function nL(r,o){return Wg(r,tt(o,3),oi)}function iL(r,o){return Wg(r,tt(o,3),su)}function rL(r,o){return r==null?r:ru(r,tt(o,3),Je)}function sL(r,o){return r==null?r:h_(r,tt(o,3),Je)}function oL(r,o){return r&&oi(r,tt(o,3))}function aL(r,o){return r&&su(r,tt(o,3))}function hL(r){return r==null?[]:_h(r,Le(r))}function lL(r){return r==null?[]:_h(r,Je(r))}function zu(r,o,c){var d=r==null?n:Tr(r,o);return d===n?c:d}function cL(r,o){return r!=null&&X_(r,o,kE)}function Wu(r,o){return r!=null&&X_(r,o,ME)}var uL=z_(function(r,o,c){o!=null&&typeof o.toString!="function"&&(o=ih.call(o)),r[o]=c},Nu(Qe)),dL=z_(function(r,o,c){o!=null&&typeof o.toString!="function"&&(o=ih.call(o)),Ut.call(r,o)?r[o].push(c):r[o]=[c]},tt),fL=mt(bo);function Le(r){return $e(r)?e_(r):lu(r)}function Je(r){return $e(r)?e_(r,!0):VE(r)}function pL(r,o){var c={};return o=tt(o,3),oi(r,function(d,_,y){bi(c,o(d,_,y),d)}),c}function gL(r,o){var c={};return o=tt(o,3),oi(r,function(d,_,y){bi(c,_,o(d,_,y))}),c}var _L=_s(function(r,o,c){mh(r,o,c)}),T0=_s(function(r,o,c,d){mh(r,o,c,d)}),mL=Si(function(r,o){var c={};if(r==null)return c;var d=!1;o=oe(o,function(y){return y=qi(y,r),d||(d=y.length>1),y}),ai(r,Eu(r),c),d&&(c=Rn(c,p|v|w,uS));for(var _=o.length;_--;)gu(c,o[_]);return c});function yL(r,o){return L0(r,Ah(tt(o)))}var vL=Si(function(r,o){return r==null?{}:GE(r,o)});function L0(r,o){if(r==null)return{};var c=oe(Eu(r),function(d){return[d]});return o=tt(o),y_(r,c,function(d,_){return o(d,_[0])})}function wL(r,o,c){o=qi(o,r);var d=-1,_=o.length;for(_||(_=1,r=n);++d<_;){var y=r==null?n:r[hi(o[d])];y===n&&(d=_,y=c),r=Ti(y)?y.call(r):y}return r}function xL(r,o,c){return r==null?r:So(r,o,c)}function bL(r,o,c,d){return d=typeof d=="function"?d:n,r==null?r:So(r,o,c,d)}var P0=N_(Le),B0=N_(Je);function EL(r,o,c){var d=lt(r),_=d||Zi(r)||vs(r);if(o=tt(o,4),c==null){var y=r&&r.constructor;_?c=d?new y:[]:ce(r)?c=Ti(y)?gs(oh(r)):{}:c={}}return(_?Ln:oi)(r,function(x,b,T){return o(c,x,b,T)}),c}function SL(r,o){return r==null?!0:gu(r,o)}function CL(r,o,c){return r==null?r:E_(r,o,yu(c))}function TL(r,o,c,d){return d=typeof d=="function"?d:n,r==null?r:E_(r,o,yu(c),d)}function ws(r){return r==null?[]:Zc(r,Le(r))}function LL(r){return r==null?[]:Zc(r,Je(r))}function PL(r,o,c){return c===n&&(c=o,o=n),c!==n&&(c=kn(c),c=c===c?c:0),o!==n&&(o=kn(o),o=o===o?o:0),Cr(kn(r),o,c)}function BL(r,o,c){return o=Li(o),c===n?(c=o,o=0):c=Li(c),r=kn(r),DE(r,o,c)}function RL(r,o,c){if(c&&typeof c!="boolean"&&Xe(r,o,c)&&(o=c=n),c===n&&(typeof o=="boolean"?(c=o,o=n):typeof r=="boolean"&&(c=r,r=n)),r===n&&o===n?(r=0,o=1):(r=Li(r),o===n?(o=r,r=0):o=Li(o)),r>o){var d=r;r=o,o=d}if(c||r%1||o%1){var _=Qg();return ze(r+_*(o-r+hb("1e-"+((_+"").length-1))),o)}return du(r,o)}var OL=ms(function(r,o,c){return o=o.toLowerCase(),r+(c?R0(o):o)});function R0(r){return Fu(Ft(r).toLowerCase())}function O0(r){return r=Ft(r),r&&r.replace(kx,xb).replace(Jx,"")}function AL(r,o,c){r=Ft(r),o=pn(o);var d=r.length;c=c===n?d:Cr(ut(c),0,d);var _=c;return c-=o.length,c>=0&&r.slice(c,_)==o}function kL(r){return r=Ft(r),r&&fx.test(r)?r.replace(hg,bb):r}function ML(r){return r=Ft(r),r&&vx.test(r)?r.replace(Mc,"\\$&"):r}var DL=ms(function(r,o,c){return r+(c?"-":"")+o.toLowerCase()}),IL=ms(function(r,o,c){return r+(c?" ":"")+o.toLowerCase()}),zL=M_("toLowerCase");function WL(r,o,c){r=Ft(r),o=ut(o);var d=o?cs(r):0;if(!o||d>=o)return r;var _=(o-d)/2;return Eh(ch(_),c)+r+Eh(lh(_),c)}function FL(r,o,c){r=Ft(r),o=ut(o);var d=o?cs(r):0;return o&&d<o?r+Eh(o-d,c):r}function NL(r,o,c){r=Ft(r),o=ut(o);var d=o?cs(r):0;return o&&d<o?Eh(o-d,c)+r:r}function HL(r,o,c){return c||o==null?o=0:o&&(o=+o),qb(Ft(r).replace(Dc,""),o||0)}function UL(r,o,c){return(c?Xe(r,o,c):o===n)?o=1:o=ut(o),fu(Ft(r),o)}function YL(){var r=arguments,o=Ft(r[0]);return r.length<3?o:o.replace(r[1],r[2])}var VL=ms(function(r,o,c){return r+(c?"_":"")+o.toLowerCase()});function XL(r,o,c){return c&&typeof c!="number"&&Xe(r,o,c)&&(o=c=n),c=c===n?si:c>>>0,c?(r=Ft(r),r&&(typeof o=="string"||o!=null&&!Iu(o))&&(o=pn(o),!o&&ls(r))?ji(Vn(r),0,c):r.split(o,c)):[]}var GL=ms(function(r,o,c){return r+(c?" ":"")+Fu(o)});function KL(r,o,c){return r=Ft(r),c=c==null?0:Cr(ut(c),0,r.length),o=pn(o),r.slice(c,c+o.length)==o}function qL(r,o,c){var d=m.templateSettings;c&&Xe(r,o,c)&&(o=n),r=Ft(r),o=Dh({},o,d,H_);var _=Dh({},o.imports,d.imports,H_),y=Le(_),x=Zc(_,y),b,T,k=0,M=o.interpolate||qa,z="__p += '",U=Jc((o.escape||qa).source+"|"+M.source+"|"+(M===lg?Lx:qa).source+"|"+(o.evaluate||qa).source+"|$","g"),Z="//# sourceURL="+(Ut.call(o,"sourceURL")?(o.sourceURL+"").replace(/\s/g," "):"lodash.templateSources["+ ++ib+"]")+`
`;r.replace(U,function(nt,bt,Lt,_n,Ge,mn){return Lt||(Lt=_n),z+=r.slice(k,mn).replace(Mx,Eb),bt&&(b=!0,z+=`' +
__e(`+bt+`) +
'`),Ge&&(T=!0,z+=`';
`+Ge+`;
__p += '`),Lt&&(z+=`' +
((__t = (`+Lt+`)) == null ? '' : __t) +
'`),k=mn+nt.length,nt}),z+=`';
`;var et=Ut.call(o,"variable")&&o.variable;if(!et)z=`with (obj) {
`+z+`
}
`;else if(Cx.test(et))throw new at(l);z=(T?z.replace(lx,""):z).replace(cx,"$1").replace(ux,"$1;"),z="function("+(et||"obj")+`) {
`+(et?"":`obj || (obj = {});
`)+"var __t, __p = ''"+(b?", __e = _.escape":"")+(T?`, __j = Array.prototype.join;
function print() { __p += __j.call(arguments, '') }
`:`;
`)+z+`return __p
}`;var pt=k0(function(){return Mt(y,Z+"return "+z).apply(n,x)});if(pt.source=z,Du(pt))throw pt;return pt}function jL(r){return Ft(r).toLowerCase()}function ZL(r){return Ft(r).toUpperCase()}function $L(r,o,c){if(r=Ft(r),r&&(c||o===n))return Ug(r);if(!r||!(o=pn(o)))return r;var d=Vn(r),_=Vn(o),y=Yg(d,_),x=Vg(d,_)+1;return ji(d,y,x).join("")}function JL(r,o,c){if(r=Ft(r),r&&(c||o===n))return r.slice(0,Gg(r)+1);if(!r||!(o=pn(o)))return r;var d=Vn(r),_=Vg(d,Vn(o))+1;return ji(d,0,_).join("")}function QL(r,o,c){if(r=Ft(r),r&&(c||o===n))return r.replace(Dc,"");if(!r||!(o=pn(o)))return r;var d=Vn(r),_=Yg(d,Vn(o));return ji(d,_).join("")}function tP(r,o){var c=ft,d=it;if(ce(o)){var _="separator"in o?o.separator:_;c="length"in o?ut(o.length):c,d="omission"in o?pn(o.omission):d}r=Ft(r);var y=r.length;if(ls(r)){var x=Vn(r);y=x.length}if(c>=y)return r;var b=c-cs(d);if(b<1)return d;var T=x?ji(x,0,b).join(""):r.slice(0,b);if(_===n)return T+d;if(x&&(b+=T.length-b),Iu(_)){if(r.slice(b).search(_)){var k,M=T;for(_.global||(_=Jc(_.source,Ft(cg.exec(_))+"g")),_.lastIndex=0;k=_.exec(M);)var z=k.index;T=T.slice(0,z===n?b:z)}}else if(r.indexOf(pn(_),b)!=b){var U=T.lastIndexOf(_);U>-1&&(T=T.slice(0,U))}return T+d}function eP(r){return r=Ft(r),r&&dx.test(r)?r.replace(ag,Rb):r}var nP=ms(function(r,o,c){return r+(c?" ":"")+o.toUpperCase()}),Fu=M_("toUpperCase");function A0(r,o,c){return r=Ft(r),o=c?n:o,o===n?Cb(r)?kb(r):_b(r):r.match(o)||[]}var k0=mt(function(r,o){try{return dn(r,n,o)}catch(c){return Du(c)?c:new at(c)}}),iP=Si(function(r,o){return Ln(o,function(c){c=hi(c),bi(r,c,ku(r[c],r))}),r});function rP(r){var o=r==null?0:r.length,c=tt();return r=o?oe(r,function(d){if(typeof d[1]!="function")throw new Pn(h);return[c(d[0]),d[1]]}):[],mt(function(d){for(var _=-1;++_<o;){var y=r[_];if(dn(y[0],this,d))return dn(y[1],this,d)}})}function sP(r){return RE(Rn(r,p))}function Nu(r){return function(){return r}}function oP(r,o){return r==null||r!==r?o:r}var aP=I_(),hP=I_(!0);function Qe(r){return r}function Hu(r){return d_(typeof r=="function"?r:Rn(r,p))}function lP(r){return p_(Rn(r,p))}function cP(r,o){return g_(r,Rn(o,p))}var uP=mt(function(r,o){return function(c){return bo(c,r,o)}}),dP=mt(function(r,o){return function(c){return bo(r,c,o)}});function Uu(r,o,c){var d=Le(o),_=_h(o,d);c==null&&!(ce(o)&&(_.length||!d.length))&&(c=o,o=r,r=this,_=_h(o,Le(o)));var y=!(ce(c)&&"chain"in c)||!!c.chain,x=Ti(r);return Ln(_,function(b){var T=o[b];r[b]=T,x&&(r.prototype[b]=function(){var k=this.__chain__;if(y||k){var M=r(this.__wrapped__),z=M.__actions__=Ze(this.__actions__);return z.push({func:T,args:arguments,thisArg:r}),M.__chain__=k,M}return T.apply(r,Yi([this.value()],arguments))})}),r}function fP(){return Me._===this&&(Me._=Fb),this}function Yu(){}function pP(r){return r=ut(r),mt(function(o){return __(o,r)})}var gP=wu(oe),_P=wu(zg),mP=wu(Xc);function M0(r){return Lu(r)?Gc(hi(r)):KE(r)}function yP(r){return function(o){return r==null?n:Tr(r,o)}}var vP=W_(),wP=W_(!0);function Vu(){return[]}function Xu(){return!1}function xP(){return{}}function bP(){return""}function EP(){return!0}function SP(r,o){if(r=ut(r),r<1||r>ke)return[];var c=si,d=ze(r,si);o=tt(o),r-=si;for(var _=jc(d,o);++c<r;)o(c);return _}function CP(r){return lt(r)?oe(r,hi):gn(r)?[r]:Ze(t0(Ft(r)))}function TP(r){var o=++zb;return Ft(r)+o}var LP=bh(function(r,o){return r+o},0),PP=xu("ceil"),BP=bh(function(r,o){return r/o},1),RP=xu("floor");function OP(r){return r&&r.length?gh(r,Qe,ou):n}function AP(r,o){return r&&r.length?gh(r,tt(o,2),ou):n}function kP(r){return Ng(r,Qe)}function MP(r,o){return Ng(r,tt(o,2))}function DP(r){return r&&r.length?gh(r,Qe,cu):n}function IP(r,o){return r&&r.length?gh(r,tt(o,2),cu):n}var zP=bh(function(r,o){return r*o},1),WP=xu("round"),FP=bh(function(r,o){return r-o},0);function NP(r){return r&&r.length?qc(r,Qe):0}function HP(r,o){return r&&r.length?qc(r,tt(o,2)):0}return m.after=lT,m.ary=u0,m.assign=ZT,m.assignIn=C0,m.assignInWith=Dh,m.assignWith=$T,m.at=JT,m.before=d0,m.bind=ku,m.bindAll=iP,m.bindKey=f0,m.castArray=xT,m.chain=h0,m.chunk=RS,m.compact=OS,m.concat=AS,m.cond=rP,m.conforms=sP,m.constant=Nu,m.countBy=NC,m.create=QT,m.curry=p0,m.curryRight=g0,m.debounce=_0,m.defaults=tL,m.defaultsDeep=eL,m.defer=cT,m.delay=uT,m.difference=kS,m.differenceBy=MS,m.differenceWith=DS,m.drop=IS,m.dropRight=zS,m.dropRightWhile=WS,m.dropWhile=FS,m.fill=NS,m.filter=UC,m.flatMap=XC,m.flatMapDeep=GC,m.flatMapDepth=KC,m.flatten=r0,m.flattenDeep=HS,m.flattenDepth=US,m.flip=dT,m.flow=aP,m.flowRight=hP,m.fromPairs=YS,m.functions=hL,m.functionsIn=lL,m.groupBy=qC,m.initial=XS,m.intersection=GS,m.intersectionBy=KS,m.intersectionWith=qS,m.invert=uL,m.invertBy=dL,m.invokeMap=ZC,m.iteratee=Hu,m.keyBy=$C,m.keys=Le,m.keysIn=Je,m.map=Bh,m.mapKeys=pL,m.mapValues=gL,m.matches=lP,m.matchesProperty=cP,m.memoize=Oh,m.merge=_L,m.mergeWith=T0,m.method=uP,m.methodOf=dP,m.mixin=Uu,m.negate=Ah,m.nthArg=pP,m.omit=mL,m.omitBy=yL,m.once=fT,m.orderBy=JC,m.over=gP,m.overArgs=pT,m.overEvery=_P,m.overSome=mP,m.partial=Mu,m.partialRight=m0,m.partition=QC,m.pick=vL,m.pickBy=L0,m.property=M0,m.propertyOf=yP,m.pull=JS,m.pullAll=o0,m.pullAllBy=QS,m.pullAllWith=tC,m.pullAt=eC,m.range=vP,m.rangeRight=wP,m.rearg=gT,m.reject=nT,m.remove=nC,m.rest=_T,m.reverse=Ou,m.sampleSize=rT,m.set=xL,m.setWith=bL,m.shuffle=sT,m.slice=iC,m.sortBy=hT,m.sortedUniq=cC,m.sortedUniqBy=uC,m.split=XL,m.spread=mT,m.tail=dC,m.take=fC,m.takeRight=pC,m.takeRightWhile=gC,m.takeWhile=_C,m.tap=OC,m.throttle=yT,m.thru=Ph,m.toArray=b0,m.toPairs=P0,m.toPairsIn=B0,m.toPath=CP,m.toPlainObject=S0,m.transform=EL,m.unary=vT,m.union=mC,m.unionBy=yC,m.unionWith=vC,m.uniq=wC,m.uniqBy=xC,m.uniqWith=bC,m.unset=SL,m.unzip=Au,m.unzipWith=a0,m.update=CL,m.updateWith=TL,m.values=ws,m.valuesIn=LL,m.without=EC,m.words=A0,m.wrap=wT,m.xor=SC,m.xorBy=CC,m.xorWith=TC,m.zip=LC,m.zipObject=PC,m.zipObjectDeep=BC,m.zipWith=RC,m.entries=P0,m.entriesIn=B0,m.extend=C0,m.extendWith=Dh,Uu(m,m),m.add=LP,m.attempt=k0,m.camelCase=OL,m.capitalize=R0,m.ceil=PP,m.clamp=PL,m.clone=bT,m.cloneDeep=ST,m.cloneDeepWith=CT,m.cloneWith=ET,m.conformsTo=TT,m.deburr=O0,m.defaultTo=oP,m.divide=BP,m.endsWith=AL,m.eq=Gn,m.escape=kL,m.escapeRegExp=ML,m.every=HC,m.find=YC,m.findIndex=n0,m.findKey=nL,m.findLast=VC,m.findLastIndex=i0,m.findLastKey=iL,m.floor=RP,m.forEach=l0,m.forEachRight=c0,m.forIn=rL,m.forInRight=sL,m.forOwn=oL,m.forOwnRight=aL,m.get=zu,m.gt=LT,m.gte=PT,m.has=cL,m.hasIn=Wu,m.head=s0,m.identity=Qe,m.includes=jC,m.indexOf=VS,m.inRange=BL,m.invoke=fL,m.isArguments=Br,m.isArray=lt,m.isArrayBuffer=BT,m.isArrayLike=$e,m.isArrayLikeObject=ge,m.isBoolean=RT,m.isBuffer=Zi,m.isDate=OT,m.isElement=AT,m.isEmpty=kT,m.isEqual=MT,m.isEqualWith=DT,m.isError=Du,m.isFinite=IT,m.isFunction=Ti,m.isInteger=y0,m.isLength=kh,m.isMap=v0,m.isMatch=zT,m.isMatchWith=WT,m.isNaN=FT,m.isNative=NT,m.isNil=UT,m.isNull=HT,m.isNumber=w0,m.isObject=ce,m.isObjectLike=de,m.isPlainObject=Po,m.isRegExp=Iu,m.isSafeInteger=YT,m.isSet=x0,m.isString=Mh,m.isSymbol=gn,m.isTypedArray=vs,m.isUndefined=VT,m.isWeakMap=XT,m.isWeakSet=GT,m.join=jS,m.kebabCase=DL,m.last=An,m.lastIndexOf=ZS,m.lowerCase=IL,m.lowerFirst=zL,m.lt=KT,m.lte=qT,m.max=OP,m.maxBy=AP,m.mean=kP,m.meanBy=MP,m.min=DP,m.minBy=IP,m.stubArray=Vu,m.stubFalse=Xu,m.stubObject=xP,m.stubString=bP,m.stubTrue=EP,m.multiply=zP,m.nth=$S,m.noConflict=fP,m.noop=Yu,m.now=Rh,m.pad=WL,m.padEnd=FL,m.padStart=NL,m.parseInt=HL,m.random=RL,m.reduce=tT,m.reduceRight=eT,m.repeat=UL,m.replace=YL,m.result=wL,m.round=WP,m.runInContext=C,m.sample=iT,m.size=oT,m.snakeCase=VL,m.some=aT,m.sortedIndex=rC,m.sortedIndexBy=sC,m.sortedIndexOf=oC,m.sortedLastIndex=aC,m.sortedLastIndexBy=hC,m.sortedLastIndexOf=lC,m.startCase=GL,m.startsWith=KL,m.subtract=FP,m.sum=NP,m.sumBy=HP,m.template=qL,m.times=SP,m.toFinite=Li,m.toInteger=ut,m.toLength=E0,m.toLower=jL,m.toNumber=kn,m.toSafeInteger=jT,m.toString=Ft,m.toUpper=ZL,m.trim=$L,m.trimEnd=JL,m.trimStart=QL,m.truncate=tP,m.unescape=eP,m.uniqueId=TP,m.upperCase=nP,m.upperFirst=Fu,m.each=l0,m.eachRight=c0,m.first=s0,Uu(m,function(){var r={};return oi(m,function(o,c){Ut.call(m.prototype,c)||(r[c]=o)}),r}(),{chain:!1}),m.VERSION=i,Ln(["bind","bindKey","curry","curryRight","partial","partialRight"],function(r){m[r].placeholder=m}),Ln(["drop","take"],function(r,o){Et.prototype[r]=function(c){c=c===n?1:Se(ut(c),0);var d=this.__filtered__&&!o?new Et(this):this.clone();return d.__filtered__?d.__takeCount__=ze(c,d.__takeCount__):d.__views__.push({size:ze(c,si),type:r+(d.__dir__<0?"Right":"")}),d},Et.prototype[r+"Right"]=function(c){return this.reverse()[r](c).reverse()}}),Ln(["filter","map","takeWhile"],function(r,o){var c=o+1,d=c==Wt||c==Te;Et.prototype[r]=function(_){var y=this.clone();return y.__iteratees__.push({iteratee:tt(_,3),type:c}),y.__filtered__=y.__filtered__||d,y}}),Ln(["head","last"],function(r,o){var c="take"+(o?"Right":"");Et.prototype[r]=function(){return this[c](1).value()[0]}}),Ln(["initial","tail"],function(r,o){var c="drop"+(o?"":"Right");Et.prototype[r]=function(){return this.__filtered__?new Et(this):this[c](1)}}),Et.prototype.compact=function(){return this.filter(Qe)},Et.prototype.find=function(r){return this.filter(r).head()},Et.prototype.findLast=function(r){return this.reverse().find(r)},Et.prototype.invokeMap=mt(function(r,o){return typeof r=="function"?new Et(this):this.map(function(c){return bo(c,r,o)})}),Et.prototype.reject=function(r){return this.filter(Ah(tt(r)))},Et.prototype.slice=function(r,o){r=ut(r);var c=this;return c.__filtered__&&(r>0||o<0)?new Et(c):(r<0?c=c.takeRight(-r):r&&(c=c.drop(r)),o!==n&&(o=ut(o),c=o<0?c.dropRight(-o):c.take(o-r)),c)},Et.prototype.takeRightWhile=function(r){return this.reverse().takeWhile(r).reverse()},Et.prototype.toArray=function(){return this.take(si)},oi(Et.prototype,function(r,o){var c=/^(?:filter|find|map|reject)|While$/.test(o),d=/^(?:head|last)$/.test(o),_=m[d?"take"+(o=="last"?"Right":""):o],y=d||/^find/.test(o);_&&(m.prototype[o]=function(){var x=this.__wrapped__,b=d?[1]:arguments,T=x instanceof Et,k=b[0],M=T||lt(x),z=function(bt){var Lt=_.apply(m,Yi([bt],b));return d&&U?Lt[0]:Lt};M&&c&&typeof k=="function"&&k.length!=1&&(T=M=!1);var U=this.__chain__,Z=!!this.__actions__.length,et=y&&!U,pt=T&&!Z;if(!y&&M){x=pt?x:new Et(this);var nt=r.apply(x,b);return nt.__actions__.push({func:Ph,args:[z],thisArg:n}),new Bn(nt,U)}return et&&pt?r.apply(this,b):(nt=this.thru(z),et?d?nt.value()[0]:nt.value():nt)})}),Ln(["pop","push","shift","sort","splice","unshift"],function(r){var o=th[r],c=/^(?:push|sort|unshift)$/.test(r)?"tap":"thru",d=/^(?:pop|shift)$/.test(r);m.prototype[r]=function(){var _=arguments;if(d&&!this.__chain__){var y=this.value();return o.apply(lt(y)?y:[],_)}return this[c](function(x){return o.apply(lt(x)?x:[],_)})}}),oi(Et.prototype,function(r,o){var c=m[o];if(c){var d=c.name+"";Ut.call(ps,d)||(ps[d]=[]),ps[d].push({name:o,func:c})}}),ps[xh(n,R).name]=[{name:"wrapper",func:n}],Et.prototype.clone=eE,Et.prototype.reverse=nE,Et.prototype.value=iE,m.prototype.at=AC,m.prototype.chain=kC,m.prototype.commit=MC,m.prototype.next=DC,m.prototype.plant=zC,m.prototype.reverse=WC,m.prototype.toJSON=m.prototype.valueOf=m.prototype.value=FC,m.prototype.first=m.prototype.head,go&&(m.prototype[go]=IC),m},us=Mb();xr?((xr.exports=us)._=us,Hc._=us):Me._=us}).call(Aa)})(Jl,Jl.exports);var eM=Jl.exports,nM=tM(eM),iM=Math.PI/180,mp={px:1,gaps:[5e3,2500,1e3,500,200,100,50,20,10],defaultGap:1e4},rM={enabled:!0,theme:"light",ruleSize:20,fontSize:10,unit:"px",themes:{light:{backgroundColor:"#fff",textColor:"#444",borderColor:"#ccc",highlightColor:"#165dff3b"},dark:{backgroundColor:"#242424",textColor:"#ddd",borderColor:"#555",highlightColor:"rgba(22,93,255,0.55)"}},conversionFactors:{px:{px:1,gaps:[5e3,2500,1e3,500,200,100,50,20,10],defaultGap:1e4},in:{px:96,gaps:[100,50,30,20,6,1,2,.8,.5],defaultGap:1e3},cm:{px:96/2.54,gaps:[100,50,30,20,6,4,2,1,.5],defaultGap:1e3},mm:{px:96/25.4,gaps:[1e3,500,200,100,50,20,10,5,2],defaultGap:2e3},pt:{px:96/72,gaps:[5e3,2500,1e3,500,200,100,50,20,10],defaultGap:1e4},pc:{px:96/6,gaps:[100,80,50,30,15,12,8,6,4],defaultGap:1e3}}},Ql=class{constructor(t,n){this.app=t,this.rulerLeafer=t.addLeafer(),this.contextContainer=this.rulerLeafer.canvas.context,this.config=nM.merge({},rM,n),this.forceRender=this.forceRender.bind(this),this.resize=this.resize.bind(this),this.enabled=this.config.enabled}set theme(t){this.config.theme=t,this.forceRender()}get theme(){return this.config.theme}addTheme(t,n){this.config.themes[t]=n}removeTheme(t){delete this.config.themes[t]}changeTheme(t){this.theme=t}addUnit(t,n){this.config.conversionFactors[t]=n}removeUnit(t){delete this.config.conversionFactors[t]}changeUnit(t){this.config.unit=t,this.forceRender()}changeEnabled(t){this.enabled=t}get enabled(){return this.config.enabled}set enabled(t){var n,i;this.config.enabled=t,t?(this.app.tree.on(St.AFTER,this.forceRender),this.app.tree.on(an.RESIZE,this.resize),(n=this.app.editor)===null||n===void 0||n.on(Xt.SELECT,this.forceRender),this.resize()):(this.app.tree.off(St.AFTER,this.forceRender),this.app.tree.off(an.RESIZE,this.resize),(i=this.app.editor)===null||i===void 0||i.off(Xt.SELECT,this.forceRender),this.rulerLeafer.forceRender())}forceRender(){this.enabled&&this.render({ctx:this.contextContainer})}resize(){setTimeout(()=>{this.enabled&&this.render({ctx:this.contextContainer})},100)}getSize(){return{width:this.app.width,height:this.app.height}}render({ctx:t}){this.rulerLeafer.canvas.setWorld({a:1,b:0,c:0,d:1,e:0,f:0});let{worldTransform:n}=this.app.tree,i=[n.a,n.b,n.c,n.d,n.e,n.f];this.calcObjectRect(),this.draw({ctx:t,isHorizontal:!0,rulerLength:this.getSize().width,startCalibration:-(i[4]/i[0]),unit:this.config.unit||"px"}),this.draw({ctx:t,isHorizontal:!1,rulerLength:this.getSize().height,startCalibration:-(i[5]/i[3]),unit:this.config.unit||"px"});let s=this.config.themes[this.config.theme];this.darwRect(t,{left:0,top:0,width:this.config.ruleSize,height:this.config.ruleSize,fill:s.backgroundColor,stroke:s.borderColor}),this.darwText(t,{text:this.config.unit||"px",left:this.config.ruleSize/2,top:this.config.ruleSize/2,align:"center",baseline:"middle",fill:s.textColor}),this.app.tree.emit(yt.END,{renderBounds:this.app.tree.canvas.bounds})}draw(t){let{ctx:n,isHorizontal:i,rulerLength:s,startCalibration:a,unit:h}=t,l=this.getZoom(),u=this.getGap(l,h),f=Math.ceil(s/l),g=Math.floor(a/u)*u,p=g-a,v=this.getSize(),w=this.config.themes[this.config.theme],{ruleSize:E}=this.config,P=2.5;this.darwRect(n,{left:0,top:0,width:i?v.width:E,height:i?E:v.height,fill:w.backgroundColor,stroke:w.borderColor});for(let S=0;S+p<=f;S+=u)for(let R=0;R<10;R++){let A=Math.round((p+S+u*R/10)*l),I=R===0,[W,F]=i?[A,I?0:E-8]:[I?0:E-8,A],[H,V]=i?[0,E-F]:[E-W,0];this.darwLine(n,{left:W,top:F,width:H,height:V,stroke:w.borderColor})}if(this.objectRect){let S=i?"x":"y";this.objectRect[S].forEach(R=>{if(R.skip===S)return;let[A,I,W,F]=i?[(R.left-a)*l,0,R.width*l,E]:[0,(R.top-a)*l,E,R.height*l];this.darwRect(n,{left:A,top:I,width:W,height:F,fill:w.highlightColor})})}for(let S=0;S+p<=f;S+=u){let R=(p+S)*l,A=(g+S)/this.convertUnitsToPx(1,h),[I,W,F]=i?[R+6,P,0]:[P,R-6,-90];this.darwText(n,{text:`${Number(A.toFixed(2))}`,left:I,top:W,fill:w.textColor,angle:F})}}getGap(t,n){let i=this.config.conversionFactors[n].gaps||mp.gaps,s=this.config.conversionFactors[n].px||mp.px,a=[.02,.03,.05,.1,.2,.5,1,2,5],h=0;for(;h<a.length&&a[h]<t;)h++;return i[h-1]*s||this.config.conversionFactors[n].defaultGap*s}convertUnitsToPx(t,n){return t*this.config.conversionFactors[n].px||mp.px}darwRect(t,{left:n,top:i,width:s,height:a,fill:h,stroke:l,strokeWidth:u}){t.save(),t.beginPath(),h&&(t.fillStyle=h),t.rect(n,i,s,a),t.fill(),l&&(t.strokeStyle=l,t.lineWidth=u??1,t.stroke()),t.restore()}darwText(t,{left:n,top:i,text:s,fill:a,align:h,angle:l,fontSize:u,baseline:f}){t.save(),a&&(t.fillStyle=a),t.textAlign=h??"left",t.textBaseline=f??"top",t.font=`${u??12}px Helvetica`,l&&(t.translate(n,i),t.rotate(iM*l),t.translate(-n,-i)),t.fillText(s,n,i),t.restore()}darwLine(t,{left:n,top:i,width:s,height:a,stroke:h,lineWidth:l}){t.save(),t.beginPath(),h&&(t.strokeStyle=h),t.lineWidth=l??1,t.moveTo(n,i),t.lineTo(n+s,i+a),t.stroke(),t.restore()}calcObjectRect(){var t;let n=((t=this.app.editor)===null||t===void 0?void 0:t.list)||[];if(n.length===0){this.objectRect=void 0;return}let i=n.reduce((s,a)=>{let h=a.getBounds("box",this.app.tree),l={left:h.x,top:h.y,width:h.width,height:h.height};return s.push(l),s},[]);i.length!==0&&(this.objectRect={x:this.mergeLines(i,!0),y:this.mergeLines(i,!1)})}mergeLines(t,n){let i=n?"left":"top",s=n?"width":"height";t.sort((l,u)=>l[i]-u[i]);let a=[],h=Object.assign({},t[0]);for(let l=1;l<t.length;l++){let u=Object.assign({},t[l]);h[i]+h[s]>=u[i]?h[s]=Math.max(h[i]+h[s],u[i]+u[s])-h[i]:(a.push(h),h=Object.assign({},u))}return a.push(h),a}getZoom(){return this.app.tree&&typeof this.app.tree.scale=="number"?this.app.tree.scale:1}dispose(){this.rulerLeafer.destroy(),this.enabled=!1}};var sM={attachEvents:["move"],parentContainer:null,filter:()=>!0,snapSize:5,pointSize:4,lineColor:"#E03E1A",showLine:!0,strokeWidth:1,dashPattern:null,showLinePoints:!0,showDistanceLabels:!0,distanceLabelStyle:{line:{dashPattern:[4,2]},box:{fill:"#E03E1A",cornerRadius:4},text:{fill:"#fff",fontSize:10,textAlign:"center",verticalAlign:"middle",padding:[1,4]}},showEqualSpacingBoxes:!0,createEqualSpacingBox(){let e=this.lineColor;return new ee({fill:e,opacity:.3,zIndex:5,visible:!1})}};function ka(e,t=0){let n=10**t;return Math.round(Number(e)*n)/n}function oM(e,t){return Math.round(e)<=t}function Sn(e,t){let n=e.getLayoutPoints("box",t),i=n.map(p=>p.x),s=n.map(p=>p.y),a=Math.min(...i),h=Math.max(...i),l=Math.min(...s),u=Math.max(...s),f=(a+h)/2,g=(l+u)/2;return{tl:{x:a,y:l},tr:{x:h,y:l},bl:{x:a,y:u},br:{x:h,y:u},ml:{x:a,y:g},mr:{x:h,y:g},mt:{x:f,y:l},mb:{x:f,y:u}}}function aM(e){return[e,...e?.children||[]].filter(hM)||[]}function hM(e){return!e.isLeafer&&e.tag!=="SimulateElement"}function lM(e,t){let n=Sn(e,t);return{left:n.ml,right:n.mr,top:n.mt,bottom:n.mb}}function cM(e,t,n,i){if(e.length===0)return[];let s=[];e.forEach(R=>{s.push(...O1(n,R.collisionPoints))});let a=n==="x",[h,l]=a?[t.top,t.bottom]:[t.left,t.right],[u,f]=a?["top","bottom"]:["left","right"],g=null,p=null,v=1/0,w=1/0;for(let R of s){let A=a?R.y:R.x,I=a?h.y:h.x,W=a?l.y:l.x,F=Math.abs(A-I);A<I&&F<v&&(v=F,g=R);let H=Math.abs(A-W);A>W&&H<w&&(w=H,p=R)}let E=null,P=null;g&&(E=T1(g,u,t,i)),p&&(P=T1(p,f,t,i));let S=[];return E&&P&&E.distance===P.distance?S.push(E,P):E&&(!P||E.distance<P.distance)?S.push(E):P&&S.push(P),S}function uM(e,t,n,i){let s=lM(e,n);return Object.entries(t).map(([a,h])=>cM(h,s,a,i)).flat()}function T1(e,t,n,i){let s=n[t],a;t==="left"||t==="right"?a={x:e.x,y:s.y}:a={x:s.x,y:e.y};let h={x:(s.x+a.x)/2,y:(s.y+a.y)/2},l=20/i,u=li({},h);t==="left"||t==="right"?u={x:h.x,y:h.y+l}:u={x:h.x+l,y:h.y};let f=Math.abs(t==="left"||t==="right"?s.x-a.x:s.y-a.y);return{snapPoint:e,position:u,start:s,end:a,mid:h,distance:ka(f,0),direction:t,text:`${ka(f,0)}`}}function dM(e,t,n){let i=[];if(!e||!t?.length)return i;let s=1;function a(l){let u=l==="x",f=S=>u?S.tl.x:S.tl.y,g=S=>u?S.br.x:S.bl.y,p=S=>{let R=Sn(S,n),A=Sn(e,n),I=u?R.tl.y:R.tl.x,W=u?R.bl.y:R.br.x,F=u?A.tl.y:A.tl.x,H=u?A.bl.y:A.br.x;return!(W<=F||I>=H)},v=[...t,e].filter(p).sort((S,R)=>f(Sn(S,n))-f(Sn(R,n))),w=v.indexOf(e);if(w===-1)return;let E=[];for(let S=0;S<v.length-1;S++){let R=Sn(v[S],n),A=Sn(v[S+1],n),I=ka(f(A)-g(R));I>0&&E.push({start:S,end:S+1,spacing:I})}let P=new Map;for(let{start:S,end:R,spacing:A}of E){let I=!1;for(let[W]of P)if(Math.abs(A-W)<=s){P.get(W).push({start:S,end:R}),I=!0;break}I||P.set(A,[{start:S,end:R}])}for(let[S,R]of P){if(R.length<2||!R.some(W=>W.start===w||W.end===w))continue;if(h(R,w))for(let{start:W,end:F}of R){let H=v[W],V=v[F],K=Sn(H,n),ct=Sn(V,n),ft=Math.max(u?K.tl.y:K.tl.x,u?ct.tl.y:ct.tl.x),it=Math.min(u?K.bl.y:K.br.x,u?ct.bl.y:ct.br.x),Y=Math.max(0,it-ft);Y&&i.push({axis:l,prevElement:H,nextElement:V,prevSpacing:S,nextSpacing:S,equalSpacing:S,box:u?{x:K.br.x,y:ft,width:S,height:Y}:{x:ft,y:K.bl.y,width:Y,height:S},label:u?{x:K.br.x+S/2,y:ft+(it-ft)/2}:{x:ft+(it-ft)/2,y:K.bl.y+S/2}})}}}function h(l,u){if(l.filter(v=>v.start===u||v.end===u).length===0)return!1;let g=l.filter(v=>v.end<=u),p=l.filter(v=>v.start>=u);return g.length>0&&p.length>0||g.length>=2||p.length>=2}return a("x"),a("y"),i}function yp(e,t){let n=[],i=t(e);return Object.entries(i).forEach(([s,a])=>{n.push({x:a.x,y:a.y,type:s,element:e})}),n}function vp(e){let t=new Map,n=new Map,i=[];return e.forEach(s=>{t.has(s.x)||t.set(s.x,[]),t.get(s.x).push(s),n.has(s.y)||n.set(s.y,[]),n.get(s.y).push(s)}),t.forEach((s,a)=>{s.length>=1&&i.push({type:"vertical",value:a,points:s.sort((h,l)=>h.y-l.y)})}),n.forEach((s,a)=>{s.length>=1&&i.push({type:"horizontal",value:a,points:s.sort((h,l)=>h.x-l.x)})}),i}function L1(e,t,n,i){let s=[],a=1/0,h=0,l=!1;for(let f of t){let g=f[n]-e.value,p=Math.abs(g);oM(p,i)&&(l=!0,p<a&&(a=p,h=g),s.push(f))}if(!l)return null;let u=Array.from(new Set(e.points.map(f=>`${f.x},${f.y}`))).map(f=>{let[g,p]=f.split(",").map(Number);return e.points.find(v=>v.x===g&&v.y===p)});return{line:e,collisionPoints:u,targetPoints:s,offset:h,distance:a}}function P1(e){return e.length?(e.sort((t,n)=>t.distance-n.distance),e[0]):null}function B1(e,t,n){let i={x:[],y:[]},s=Object.values(e);return t.filter(a=>a.type==="vertical").forEach(a=>{let h=L1(a,s,"x",n);h&&i.x.push(h)}),t.filter(a=>a.type==="horizontal").forEach(a=>{let h=L1(a,s,"y",n);h&&i.y.push(h)}),i}function O1(e,t){return t.filter(n=>e==="x"?!["ml","mr"].includes(n.type):e==="y"?!["mt","mb"].includes(n.type):!0)}function R1(e,t,n,i,s){e.forEach((a,h)=>{let l=n[h];l||(l=fM(t,s),n.push(l),i.sky?.add(l)),pM(l,a,i,s)})}function fM(e,t){return new qe({stroke:t.lineColor,strokeWidth:t.strokeWidth,className:`snap-line-${e}`,visible:!1,dashPattern:t.dashPattern,zIndex:2})}function pM(e,t,n,i){let[s,a,h,l]=t,u=n.tree?.getWorldPoint({x:s,y:a}),f=n.tree?.getWorldPoint({x:h,y:l});u&&f&&e.set({points:[u.x,u.y,f.x,f.y],visible:!0,stroke:i.lineColor,strokeWidth:i.strokeWidth,dashPattern:i.dashPattern})}function gM(e,t,n,i){e.filter((a,h,l)=>l.findIndex(u=>Math.abs(u.x-a.x)<1&&Math.abs(u.y-a.y)<1)===h).forEach((a,h)=>{let l=t[h];l||(l=_M(i),t.push(l),n.sky?.add(l)),mM(l,a,n)})}function _M(e){let{lineColor:t,pointSize:n,strokeWidth:i}=e,s=new qe({stroke:t,strokeWidth:i,points:[0,0,n,n],className:"snap-point-line"}),a=new qe({stroke:t,strokeWidth:i,points:[0,n,n,0],className:"snap-point-line"});return new zt({className:"snap-point",children:[s,a],around:"center",visible:!1,zIndex:3})}function mM(e,t,n){let i=n.tree?.getWorldPoint(t);i&&e.set({visible:!0,x:i.x,y:i.y})}function yM(e,t,n,i){e.forEach((s,a)=>{let h=t[a];h||(h=new qe(Bo(li({stroke:i.lineColor,strokeWidth:i.strokeWidth},i?.distanceLabelStyle?.line||{}),{className:"distance-line",visible:!1,zIndex:1})),t.push(h),n.sky?.add(h));let l=n.tree?.getWorldPoint(s.start),u=n.tree?.getWorldPoint(s.end);l&&u&&h.set({points:[l.x,l.y,u.x,u.y],visible:!0})})}function vM(e,t,n,i){e.forEach((s,a)=>{let h=t[a];h||(h=wM(i),t.push(h),n.sky?.add(h)),xM(h,s,n)})}function wM(e){return new ee(Bo(li({},e.distanceLabelStyle?.box),{className:"distance-label",children:[new st(Bo(li({},e.distanceLabelStyle?.text),{className:"distance-label-text",visible:!0}))],zIndex:3,visible:!0}))}function xM(e,t,n){let i=n.tree?.getWorldPoint(t.position);i&&(e.children[0].set({text:t.text,visible:!0}),e.set({visible:!0,x:i.x,y:i.y}))}function bM(e,t,n,i){e.forEach((s,a)=>{let h=n.tree?.getWorldBounds(s.box),l=t[a];l||(l=i.createEqualSpacingBox(s,h),t.push(l),n.sky?.add(l)),l.set(Bo(li({},h),{visible:!0}))});for(let s=e.length;s<t.length;s++)t[s].visible=!1}function EM(e){e.forEach(t=>t.destroy())}function SM(e){e.forEach(t=>t.visible=0)}D.addAttr("isSnap",!0,Jt);var tc=class{app;config;snapElements=[];snapPoints=[];snapLines=[];snapLines4SpacingBoxes=[];isSnapping=!1;isKeyEvent=!1;isEnabled=!1;verticalLines=[];horizontalLines=[];linePointGroups=[];distanceLabels=[];distanceLines=[];equalSpacingBoxes=[];get cachedElements(){return[this.verticalLines,this.horizontalLines,this.linePointGroups,this.distanceLabels,this.distanceLines,this.equalSpacingBoxes]}get cachedSnaps(){return[this.snapPoints,this.snapLines,this.snapLines4SpacingBoxes,this.snapElements]}constructor(t,n){if(!t?.isApp)throw new Error("\u53C2\u6570\u5FC5\u987B\u662F\u6709\u6548\u7684 App \u5B9E\u4F8B");if(!t.tree)throw new Error("App \u5FC5\u987B\u5305\u542B tree \u5C42");if(!t.editor)throw new Error("App \u5FC5\u987B\u5305\u542B editor");this.app=t,this.config=li(li({},sM),n),this.bindEventHandlers()}get parentContainer(){return this.config.parentContainer||this.app.tree}get parentScale(){try{return this.parentContainer.scale||1}catch{return 1}}get layerScale(){return this.app.zoomLayer?.scaleX||1}bindEventHandlers(){this.handleCollectElements=this.handleCollectElements.bind(this),this.handleMove=this.handleMove.bind(this),this.handleScale=this.handleScale.bind(this),this.clear=this.clear.bind(this),this.destroy=this.destroy.bind(this),this.handleKeyEvent=this.handleKeyEvent.bind(this)}enable(t){this.isEnabled!==t&&(this.isEnabled=t,t?this.attachEvents():(this.detachEvents(),this.destroy()))}updateConfig(t){this.config=li(li({},this.config),t)}attachEvents(){let{editor:t}=this.app;t?.on(un.BEFORE_MOVE,this.handleCollectElements),t?.on(ve.BEFORE_SCALE,this.handleCollectElements),t?.on(un.MOVE,this.handleMove),t?.on(ve.SCALE,this.handleScale),this.app.on(G.UP,this.destroy),this.app.tree?.on(St.AFTER,this.clear),this.app.on([fe.DOWN,fe.UP],this.handleKeyEvent,{capture:!0})}isAttached(t){return this.config.attachEvents.includes(t)}detachEvents(){let{editor:t}=this.app;t?.off(un.BEFORE_MOVE,this.handleCollectElements),t?.off(ve.BEFORE_SCALE,this.handleCollectElements),t?.off(un.MOVE,this.handleMove),t?.off(ve.SCALE,this.handleScale),this.app.off(G.UP,this.destroy),this.app.tree?.off(St.AFTER,this.clear),this.app.off([fe.DOWN,fe.UP],this.handleKeyEvent,{capture:!0})}handleCollectElements(t){!this.isEnabled||this.isSnapping||(this.snapElements=this.collectSnapElements(),this.snapPoints=this.snapElements.map(n=>yp(n,i=>Sn(i,this.app.tree))).flat(),this.snapLines=vp(this.snapPoints),this.isSnapping=!0)}handleMove(t){if(!this.isEnabled||!this.isAttached("move"))return;let{moveX:n,moveY:i}=t;!n&&!i||this.executeAction(t)}handleScale(t){if(!this.isEnabled||!this.isAttached("scale"))return;let{scaleX:n,scaleY:i}=t;!n&&!i||this.executeAction(t)}executeAction(t){let{target:n}=t;this.isSnapping&&SM([...this.verticalLines,...this.horizontalLines,...this.distanceLabels,...this.equalSpacingBoxes]);let i=Sn(n,this.app.tree);if(t.type===un.MOVE){let a=B1(i,[...this.snapLines,...this.snapLines4SpacingBoxes],this.config.snapSize);this.applySnapOffset(n,{x:P1(a.x),y:P1(a.y)})}let s=B1(i,this.snapLines,this.config.snapSize);if(this.config.showLine&&(s.x.length||s.y.length)&&this.renderSnapLines(n,s),this.config.showEqualSpacingBoxes){let a=this.snapElements.filter(l=>l!==this.parentContainer),h=dM(n,a,this.app.tree);bM(h,this.equalSpacingBoxes,this.app,this.config)}}handleKeyEvent(t){["ArrowDown","ArrowUp","ArrowLeft","ArrowRight"].includes(t.code)&&(this.isKeyEvent=t.type===fe.DOWN)}clear(){if(this.config.showEqualSpacingBoxes){let t=this.equalSpacingBoxes.map(n=>yp(n,i=>Sn(i,this.app.tree))).flat();this.snapLines4SpacingBoxes=vp(t)}EM(this.cachedElements.flat()),this.cachedElements.forEach(t=>t.length=0)}destroy(){this.clear(),this.cachedSnaps.forEach(t=>t.length=0),this.isSnapping=!1}collectSnapElements(){let t=this.app.editor?.list||[];return aM(this.parentContainer).filter(i=>t.includes(i)||!i.isSnap?!1:this.config.filter(i))}applySnapOffset(t,n){if(this.isKeyEvent)return;let i=(s,a,h)=>{s[a]=s[a]-h.offset/this.parentScale};Object.entries(n).forEach(([s,a])=>{if(a){let h=this.app.editor;h.list.forEach(l=>i(l,s,a)),h.multiple&&t.safeChange?.(()=>i(t,s,a))}})}renderSnapLines(t,n){let i={vertical:[],horizontal:[]},s=[],a=yp(t,u=>Sn(u,this.app.tree)),h=vp(a),l={x:[],y:[]};if(Object.entries(n).forEach(([u,f])=>{f.forEach(g=>{let{line:p,collisionPoints:v}=g,w=h.filter(E=>E.type===p.type&&ka(E.value,0)===ka(p.value,0));if(w.length>0){let E=O1(u,[...v,...w.map(S=>S.points).flat()]),P=u==="x"?"y":"x";if(E.length>0){l[u].push(g);let S=Math.min(...E.map(A=>A[P])),R=Math.max(...E.map(A=>A[P]));u==="x"?i.vertical.push([p.value,S,p.value,R]):i.horizontal.push([S,p.value,R,p.value]),s.push(...E)}}})}),R1(i.vertical,"vertical",this.verticalLines,this.app,this.config),R1(i.horizontal,"horizontal",this.horizontalLines,this.app,this.config),this.config.showLinePoints&&gM(s,this.linePointGroups,this.app,this.config),this.config.showDistanceLabels){let u=uM(t,l,this.app.tree,this.layerScale);yM(u,this.distanceLines,this.app,this.config),vM(u,this.distanceLabels,this.app,this.config)}}};function wp(e,t){return te(e,n=>({set(i){this.__setAttr(n,i),this.leaferIsReady?t?Rt.setStyleName(this,t,i):Rt.set(this,i):this.__layout.stateStyleChanged=!0}}))}function Jr(e){return te(e,t=>({set(n){this.__setAttr(t,n),this.__layout.stateStyleChanged=!0}}))}function rc(e,t){if(t&&t!==!0)return t;if(!e.button){let{parent:n}=e;for(let i=0;i<2;i++)if(n){if(n.button)return n;n=n.parent}}return null}function I1(e,t){ht(t)||(t=void 0),Lp(e,t,"in")}function z1(e,t){let{normalStyle:n}=e;ht(t)||(t=void 0),n&&(t||(t=n),Lp(e,t,"out"))}var A1={};function Lp(e,t,n){let{normalStyle:i}=e;t||(t=A1),t.scale&&(Kt.assignScale(t,t.scale),delete t.scale),t!==A1&&Rt.canAnimate||(n=null);let s=!!n&&function(l,u,f){let g=l==="in"?"transition":"transitionOut";return l==="out"&&Be(f[g])&&Be(u[g])&&(g="transition"),Be(u[g])?f[g]:u[g]}(n,t,e),a=s?function(l,u){let f=k1(u,l),g=l.animate();return g&&k1(f,l,g.fromStyle),f}(e,t):void 0;Rt.canAnimate&&Ep(e)&&e.killAnimate("transition"),i&&e.set(i,"temp");let h=Ep(e);if(h){let{animation:l}=h;if(l){let u=e.animate(l,void 0,"animation",!0);Object.assign(h,u.endingStyle),n!=="in"||t.animation!==l?u.kill():s=!1,delete h.animation}e.normalStyle=Sp(h,e),e.set(h,"temp")}else e.normalStyle=void 0;if(s){let l=Sp(a,e);e.set(a,"temp"),e.animate([a,l],s,"transition",!0)}e.__layout.stateStyleChanged=!1}function Ep(e){let t,n={},i=rc(e),s=i?e.state||i.state:e.state,a=s&&e.states[s];a&&Rt.isState(s,e,i)&&(t=Qr(n,a));let h=n.selectedStyle||e.selectedStyle;h&&Rt.isSelected(e,i)&&(t=Qr(n,h));let l=n.placeholderStyle||e.placeholderStyle;if(l&&Rt.isPlacehold(e,i)&&(t=Qr(n,l)),Rt.isDisabled(e,i)){let u=n.disabledStyle||e.disabledStyle;u&&(t=Qr(n,u))}else{let u=n.focusStyle||e.focusStyle;u&&Rt.isFocus(e,i)&&(t=Qr(n,u));let f=n.hoverStyle||e.hoverStyle;f&&Rt.isHover(e,i)&&(t=Qr(n,f));let g=n.pressStyle||e.pressStyle;g&&Rt.isPress(e,i)&&(t=Qr(n,g))}return t?n:void 0}function Sp(e,t,n,i){let s=n?e:{},a=n||e;for(let h in a)i&&Rt.animateExcludes[h]||(s[h]=t[h]);return s}function k1(e,t,n){return Sp(e,t,n,!0)}function Qr(e,t){return Object.assign(e,t),!0}function nc(e,t){let n=e[t];n&&I1(e,n),e.button&&Pp(e.children,t)}function Cp(e,t,n){n||(n=e.states[t]),I1(e,n),e.button&&Pp(e.children,null,t)}function Pp(e,t,n){if(!e)return;let i,s;for(let a=0,h=e.length;a<h;a++){if(i=e[a],t){switch(s=!0,t){case"hoverStyle":Rt.isHover(i)&&(s=!1);break;case"pressStyle":Rt.isPress(i)&&(s=!1);break;case"focusStyle":Rt.isFocus(i)&&(s=!1)}s&&nc(i,t)}else J(n)||Cp(i,n);i.isBranch&&Pp(i.children,t,n)}}function ic(e,t){let n=e[t];n&&z1(e,n),e.button&&Bp(e.children,t)}function Tp(e,t,n){z1(e,n),e.button&&Bp(e.children,null,t)}function Bp(e,t,n){if(!e)return;let i;for(let s=0,a=e.length;s<a;s++)i=e[s],t?ic(i,t):J(n)||Tp(i,n),i.isBranch&&Bp(i.children,t,n)}function ec(e,t,n){let i,s=t.leafer?t.leafer.interaction:null;if(s&&(i=s[e](t),!i&&n)){let a=rc(t,n);a&&(i=s[e](a))}return i}function M1(e,t,n){let i=t[e];if(!i&&n){let s=rc(t,n);s&&(i=s[e])}return i}Zt.add("state"),Rt.animateExcludes={animation:1,animationOut:1,transition:1,transitionOut:1,states:1,state:1,placeholder:1,normalStyle:1,hoverStyle:1,pressStyle:1,focusStyle:1,selectedStyle:1,disabledStyle:1,placeholderStyle:1},Rt.isState=function(e,t,n){return function(i,s,a){let h=s.states[i];if(!h&&a){let l=rc(s,a);l&&(h=l.states[i])}return!!h}(e,t,n)},Rt.isSelected=function(e,t){return M1("selected",e,t)},Rt.isDisabled=function(e,t){return M1("disabled",e,t)},Rt.isFocus=function(e,t){return ec("isFocus",e,t)},Rt.isHover=function(e,t){return ec("isHover",e,t)},Rt.isPress=function(e,t){return ec("isPress",e,t)},Rt.isPlacehold=function(e,t){return e.__.__isPlacehold},Rt.isDrag=function(e,t){return ec("isDrag",e,t)},Rt.setStyleName=function(e,t,n){n?Cp(e,t,e[t]):Tp(e,t,e[t])},Rt.set=function(e,t){let n=e.states[t];n?Cp(e,t,n):Tp(e,t,n)},Rt.getStyle=Ep,Rt.updateStyle=Lp,Rt.updateEventStyle=function(e,t){switch(t){case G.ENTER:nc(e,"hoverStyle");break;case G.LEAVE:ic(e,"hoverStyle");break;case G.DOWN:nc(e,"pressStyle");break;case G.UP:ic(e,"pressStyle")}};var xp=D.prototype;D.addAttr("selected",!1,wp,"selectedStyle"),D.addAttr("disabled",!1,wp,"disabledStyle"),D.addAttr("states",{},Jr),D.addAttr("state","",wp),D.addAttr("normalStyle",void 0,Jt),D.addAttr("hoverStyle",void 0,Jr),D.addAttr("pressStyle",void 0,Jr),D.addAttr("focusStyle",void 0,Jr),D.addAttr("selectedStyle",void 0,Jr),D.addAttr("disabledStyle",void 0,Jr),D.addAttr("placeholderStyle",void 0,Jr),D.addAttr("button",!1,Jt),xp.set=function(e,t){e&&(t?t==="temp"?(this.lockNormalStyle=!0,Object.assign(this,e),this.lockNormalStyle=!1):this.animate(e,t):Object.assign(this,e))},xp.focus=function(e=!0){this.waitLeafer(()=>{let{focusData:t}=this.app.interaction;e?(t&&t.focus(!1),t=this):t=null,this.app.interaction.focusData=t,e?nc(this,"focusStyle"):ic(this,"focusStyle")})},xp.updateState=function(){Rt.updateStyle(this,void 0,"in")};var D1=st.prototype,bp="text";En(D1,bp,Object.assign(Object.assign({},bl(D1,bp)),{set(e){let t=this,n=t.text;t.__setAttr(bp,e)&&(ar(t),t.placeholderStyle&&t.placeholder&&(n===""||e==="")&&(t.__layout.stateStyleChanged=!0))}}));function G1(e){let{scroll:t,disabled:n}=e.app.config.move;return!t||n?"":t===!0?"free":t}function sc(e,t,n){CM(e.parentApp?e.parentApp:e,t),e.isApp||n||e.__eventIds.push(e.on_(Ot.BEFORE_MOVE,i=>{let s=e.getValidMove(i.moveX,i.moveY,!1);if(G1(e).includes("limit")){let a=e.getValidMove(0,0);if(a.x||a.y){let u=i.moveType==="drag"?.3:.05;Math.abs(a.x)>100?s.x=0:s.x*=u,Math.abs(a.y)>200?s.y=0:s.y*=u}}e.zoomLayer.move(s)}),e.on_(Ot.DRAG_ANIMATE,()=>{let i=e.getValidMove(0,0);(i.x||i.y)&&e.interaction.stopDragAnimate()}),e.on_(Ot.END,i=>{Vt.animateMove(e.zoomLayer,e.getValidMove(i.moveX,i.moveY))}),e.on_(pe.BEFORE_ZOOM,i=>{let{zoomLayer:s}=e,a=e.getValidScale(i.scale);a!==1&&s.scaleOfWorld(i,a)}))}function CM(e,t){let n={wheel:{preventDefault:!0},touch:{preventDefault:!0},pointer:{preventDefaultMenu:!0}};t&&vt.assign(n,t),vt.assign(e.config,n,e.userConfig)}var TM=Pt.get("LeaferTypeCreator"),K1={list:{},register(e,t){Rp[e]&&TM.repeat(e),Rp[e]=t},run(e,t){let n=Rp[e];n&&n(t)}},{list:Rp,register:oc}=K1;oc("viewport",sc),oc("custom",function(e){sc(e,null,!0)}),oc("design",function(e){sc(e,{zoom:{min:.01,max:256},move:{holdSpaceKey:!0,holdMiddleKey:!0}})}),oc("document",function(e){sc(e,{zoom:{min:1},move:{scroll:"limit"}})});var Da={state:{type:"none",typeCount:0,startTime:0,totalData:null,center:{}},getData(e){let t=e[0],n=e[1],i=j.getCenter(t.from,n.from),s=j.getCenter(t.to,n.to),a={x:s.x-i.x,y:s.y-i.y},h=j.getDistance(t.from,n.from);return{move:a,scale:j.getDistance(t.to,n.to)/h,rotation:j.getRotation(t.from,n.from,t.to,n.to),center:s}},getType(e,t){let n=Math.hypot(e.move.x,e.move.y)/(t.move||5),i=Math.abs(e.scale-1)/(t.scale||.03),s=Math.abs(e.rotation)/(t.rotation||2);return n<1&&i<1&&s<1?"none":n>=i&&n>=s?"move":i>=s?"zoom":"rotate"},detect(e,t){let{state:n}=Ma,i=Ma.getType(e,t);if(n.totalData||(n.startTime=Date.now(),n.center=e.center),Ma.add(e,n.totalData),n.totalData=e,i===n.type){if(n.typeCount++,n.typeCount>=(t.count||3)&&i!=="none")return i}else n.type=i,n.typeCount=1;return Date.now()-n.startTime>=(t.time||160)?Ma.getType(n.totalData,t):"none"},add(e,t){t&&(j.move(e.move,t.move),e.scale*=t.scale,e.rotation+=t.rotation,e.center=t.center)},reset(){let{state:e}=Ma;e.type="none",e.typeCount=0,e.startTime=0,e.totalData=null}},Ma=Da,{abs:Op,max:W1}=Math,{sign:F1,within:N1}=Kt,H1={getMove(e,t){let{moveSpeed:n}=t,{deltaX:i,deltaY:s}=e;e.shiftKey&&!i&&(i=s,s=0);let a=Op(i),h=Op(s);return a>50&&(i=W1(50,a/3)*F1(i)),h>50&&(s=W1(50,h/3)*F1(s)),{x:-i*n*2,y:-s*n*2}},getScale(e,t){let n,i=1,{zoomMode:s,zoomSpeed:a}=t,h=e.deltaY||e.deltaX;if(s?(n=s==="mouse"||!e.deltaX&&(N.intWheelDeltaY?Math.abs(h)>17:Math.ceil(h)!==h),(e.shiftKey||e.metaKey||e.ctrlKey)&&(n=!0)):n=!e.shiftKey&&(e.metaKey||e.ctrlKey),n){a=N1(a,0,1);let l=e.deltaY?t.delta.y:t.delta.x,u=N1(1-Op(h)/(4*l)*a,.5,2);i=h>0?u:1/u}return i}},ac,hc,lc,cc,kp=class{get transforming(){return this.moving||this.zooming||this.rotating}get moving(){return!!this.moveData}get zooming(){return!!this.zoomData}get rotating(){return!!this.rotateData}constructor(t){this.interaction=t}move(t){let{interaction:n}=this;t.moveType||(t.moveType="move"),this.moveData||(this.setPath(t),ac=0,hc=0,this.moveData=Object.assign(Object.assign({},t),{moveX:0,moveY:0,totalX:ac,totalY:hc}),n.emit(Ot.START,this.moveData)),t.path=this.moveData.path,t.totalX=ac+=t.moveX,t.totalY=hc+=t.moveY,n.emit(Ot.BEFORE_MOVE,t),n.emit(Ot.MOVE,t),this.transformEndWait()}zoom(t){let{interaction:n}=this;this.zoomData||(this.setPath(t),lc=1,this.zoomData=Object.assign(Object.assign({},t),{scale:1,totalScale:lc}),n.emit(pe.START,this.zoomData)),t.path=this.zoomData.path,t.totalScale=lc*=t.scale,n.emit(pe.BEFORE_ZOOM,t),n.emit(pe.ZOOM,t),this.transformEndWait()}rotate(t){let{interaction:n}=this;this.rotateData||(this.setPath(t),cc=0,this.rotateData=Object.assign(Object.assign({},t),{rotation:0,totalRotation:cc}),n.emit(Ue.START,this.rotateData)),t.path=this.rotateData.path,t.totalRotation=cc+=t.rotation,n.emit(Ue.BEFORE_ROTATE,t),n.emit(Ue.ROTATE,t),this.transformEndWait()}setPath(t){let{interaction:n}=this,{path:i}=n.selector.getByPoint(t,n.hitRadius);t.path=i,n.cancelHover()}transformEndWait(){clearTimeout(this.transformTimer),this.transformTimer=setTimeout(()=>{this.transformEnd()},this.interaction.p.transformTime)}transformEnd(){let{interaction:t,moveData:n,zoomData:i,rotateData:s}=this;n&&t.emit(Ot.END,Object.assign(Object.assign({},n),{totalX:ac,totalY:hc})),i&&t.emit(pe.END,Object.assign(Object.assign({},i),{totalScale:lc})),s&&t.emit(Ue.END,Object.assign(Object.assign({},s),{totalRotation:cc})),this.reset()}reset(){this.zoomData=this.moveData=this.rotateData=null}destroy(){this.reset()}},Ap=Qn.prototype,U1=new It,Nn=new Xo;function Y1(e,t){return Object.assign(Object.assign({},t),{moveX:e.x,moveY:e.y})}function V1(e,t){return Object.assign(Object.assign({},t),{scale:e})}Ap.initType=function(e){K1.run(e,this)},Ap.getValidMove=function(e,t,n=!0){let{disabled:i}=this.app.config.move;Nn.set(e,t);let s=G1(this);return s&&(s.includes("x")?Nn.y=0:s.includes("y")?Nn.x=0:Math.abs(Nn.x)>Math.abs(Nn.y)?Nn.y=0:Nn.x=0,n&&s.includes("limit")&&(U1.set(this.__world).addPoint(this.zoomLayer),Ur.getValidMove(U1,this.canvas.bounds,"auto",Nn,!0),s.includes("x")?Nn.y=0:s.includes("y")&&(Nn.x=0))),{x:i?0:Nn.x,y:i?0:Nn.y}},Ap.getValidScale=function(e){let{scaleX:t}=this.zoomLayer.__,{min:n,max:i,disabled:s}=this.app.config.zoom,a=Math.abs(t*e);return n&&a<n?e=n/t:i&&a>i&&(e=i/t),s?1:e};var ts=Gs.prototype;ts.createTransformer=function(){this.transformer=new kp(this)},ts.move=function(e){this.transformer.move(e)},ts.zoom=function(e){this.transformer.zoom(e)},ts.rotate=function(e){this.transformer.rotate(e)},ts.transformEnd=function(){this.transformer.transformEnd()},ts.wheel=function(e){let{wheel:t,pointer:n}=this.config,{posDeltaSpeed:i,negDeltaSpeed:s}=t;if(t.disabled)return;e.deltaX>0?i&&(e.deltaX*=i):s&&(e.deltaX*=s),e.deltaY>0?i&&(e.deltaY*=i):s&&(e.deltaY*=s);let a=t.getScale?t.getScale(e,t):H1.getScale(e,t);if(a!==1)this.zoom(V1(a,e));else{let h=t.getMove?t.getMove(e,t):H1.getMove(e,t);n.snap&&j.round(h),this.move(Y1(h,e))}},ts.multiTouch=function(e,t){let{disabled:n,singleGesture:i}=this.config.multiTouch;if(n)return;this.pointerWaitCancel();let s=Da.getData(t),{moving:a,zooming:h,rotating:l}=this.transformer;if(i){if(!this.transformer.transforming){switch(Da.detect(s,ht(i)?i:{})){case"move":a=!0;break;case"zoom":h=!0;break;case"rotate":l=!0;break;default:return}Da.reset()}a||(s.center=Da.state.center)}else a=h=l=!0;var u,f;Object.assign(e,s.center),e.multiTouch=!0,l&&this.rotate((u=s.rotation,f=e,Object.assign(Object.assign({},f),{rotation:u}))),h&&this.zoom(V1(s.scale,e)),a&&this.move(Y1(s.move,e))};var to=ua.prototype,{abs:uc,min:LM,max:X1,hypot:PM}=Math;to.checkDragEndAnimate=function(e){let{interaction:t}=this,n=this.canAnimate&&this.moving&&t.m.dragAnimate;if(n){let i=Dt(n)?n:.95,s=.15,a=150,h,l,u,f=0,g=0,p=0,v=0,w=3,{dragDataList:E}=this,P=E.length;for(let A=P-1;A>=X1(P-3,0)&&(u=E[A],!(u.time&&Date.now()-u.time>100));A--)h=w--,f+=u.moveX*h,g+=u.moveY*h,v+=h,l=PM(u.moveX,u.moveY),l>p&&(p=l);if(v&&(f/=v,g/=v),p>8){let A=1.15+LM((p-8)/17,1)*.4500000000000002;f*=A,g*=A}let S=X1(uc(f),uc(g));S>a&&(l=a/S,f*=l,g*=l);let R=()=>{if(f*=i,g*=i,e=Object.assign({},e),uc(f)<s&&uc(g)<s)return this.dragEndReal(e);j.move(e,f,g),this.drag(e),this.animate(R),t.emit(Ot.DRAG_ANIMATE,e)};this.animate(R)}return n},to.animate=function(e,t){let n=e||this.animateWait;n&&this.interaction.target.nextRender(n,null,t),this.animateWait=e},to.stopAnimate=function(){this.animate(null,"off"),this.interaction.target.nextRender(()=>{this.dragData&&this.dragEndReal(this.dragData)})},to.checkDragOut=function(e){let{interaction:t}=this;this.autoMoveCancel(),this.dragging&&!t.shrinkCanvasBounds.hitPoint(e)&&this.autoMoveOnDragOut(e)},to.autoMoveOnDragOut=function(e){let{interaction:t,downData:n,canDragOut:i}=this,{autoDistance:s,dragOut:a}=t.m;if(!a||!i||!s)return;let h=t.shrinkCanvasBounds,{x:l,y:u}=h,f=X.maxX(h),g=X.maxY(h),p=e.x<l?s:f<e.x?-s:0,v=e.y<u?s:g<e.y?-s:0,w=0,E=0;this.autoMoveTimer=setInterval(()=>{w+=p,E+=v,j.move(n,p,v),j.move(this.dragData,p,v),t.move(Object.assign(Object.assign({},e),{moveX:p,moveY:v,totalX:w,totalY:E,moveType:"drag"})),t.pointerMoveReal(e)},10)},to.autoMoveCancel=function(){this.autoMoveTimer&&(clearInterval(this.autoMoveTimer),this.autoMoveTimer=0)},Zt.add("viewport");var BM={none:"none",title:"capitalize",upper:"uppercase",lower:"lowercase","small-caps":"small-caps"},RM={top:"flex-start",middle:"center",bottom:"flex-end"},OM={none:"none",under:"underline",delete:"line-through","under-delete":"underline line-through"};function AM(e,t,n){let{style:i}=e,{fill:s,padding:a,textWrap:h,textOverflow:l,textDecoration:u}=t,f;i.fontFamily=t.fontFamily,i.fontSize=t.fontSize*n+"px",function(g,p){let v="black";if(Ct(p)&&(p=p[0]),ht(p))switch(p.type){case"solid":v=we.string(p.color);break;case"image":break;case"linear":case"radial":case"angular":let w=p.stops[0];v=we.string(gt(w)?w:w.color);break;default:J(p.r)||(v=we.string(p))}else v=p;g.color=v}(i,s),i.fontStyle=t.italic?"italic":"normal",i.fontWeight=t.fontWeight,ht(u)?(f=u.type,u.color&&(i.textDecorationColor=we.string(u.color))):f=u,i.textDecoration=OM[f],i.textTransform=BM[t.textCase],i.textAlign=t.textAlign==="both"?"justify":t.textAlign,i.display="flex",i.flexDirection="column",i.justifyContent=RM[t.verticalAlign],i.lineHeight=(t.__.__lineHeight||0)*n+"px",i.letterSpacing=(t.__.__letterSpacing||0)*n+"px",i.whiteSpace=h==="none"||t.__.__autoWidth?"nowrap":"normal",i.wordBreak=h==="break"?"break-all":"normal",i.textIndent=(t.paraIndent||0)*n+"px",i.padding=Ct(a)?a.map(g=>g*n+"px").join(" "):(a||0)*n+"px",i.textOverflow=l==="show"?"":l==="hide"?"clip":l}var q1=class extends Oa{constructor(){super(...arguments),this.config={selectAll:!0},this.eventIds=[]}get tag(){return"TextEditor"}onLoad(){let{editor:e}=this,{config:t}=e.app,n=this.editTarget;n.textEditing=!0,this.isHTMLText=!(n instanceof st),this._keyEvent=t.keyEvent,t.keyEvent=!1;let i=this.editDom=document.createElement("div");i.classList.add("leafer-text-editor");let{style:s}=i;i.contentEditable="true",s.position="fixed",s.transformOrigin="left top",s.boxSizing="border-box",this.isHTMLText?i.innerHTML=String(n.text):i.innerText=String(n.text);let{view:a}=e.app;(this.inBody=a instanceof HTMLCanvasElement)?document.body.appendChild(i):a.appendChild(i),this.eventIds=[e.app.on_(G.DOWN,u=>{let f,{target:g}=u.origin;for(;g;)g===i&&(f=!0),g=g.parentElement;f||e.closeInnerEditor()})],this.onFocus=this.onFocus.bind(this),this.onInput=this.onInput.bind(this),this.onPaste=this.onPaste.bind(this),this.onUpdate=this.onUpdate.bind(this),this.onKeydown=this.onKeydown.bind(this),i.addEventListener("focus",this.onFocus),i.addEventListener("input",this.onInput),i.addEventListener("paste",this.onPaste),window.addEventListener("keydown",this.onKeydown),window.addEventListener("scroll",this.onUpdate);let h=window.getSelection(),l=document.createRange();if(this.config.selectAll)l.selectNodeContents(i);else{let u=i.childNodes[0];u&&(l.setStartAfter(u),l.setEndAfter(u)),l.collapse(!0)}h.removeAllRanges(),h.addRange(l)}onInput(){let{editDom:e}=this;this.editTarget.text=this.isHTMLText?e.innerHTML:e.innerText}onFocus(){this.editDom.style.outline="none"}onKeydown(e){if(e.code==="Escape"&&this.editor.closeInnerEditor(),e.key==="Enter"){e.preventDefault();let t=document.createElement("br"),n=document.createTextNode("\u200B"),i=window.getSelection().getRangeAt(0);i.deleteContents(),i.insertNode(n),i.insertNode(t),i.setStartAfter(t),i.setEndAfter(t),this.onInput()}}onPaste(e){if(this.isHTMLText)return;e.preventDefault();let t=e.clipboardData;if(!t)return;let n=t.getData("text/plain").replace(/\r\n?/g,`
`),i=window.getSelection();if(!i||!i.rangeCount)return;let s=i.getRangeAt(0);s.deleteContents();let a=n.split(`
`),h=document.createDocumentFragment();a.forEach((l,u)=>{u>0&&h.appendChild(document.createElement("br")),h.appendChild(document.createTextNode(l))}),s.insertNode(h),s.collapse(!1),i.removeAllRanges(),i.addRange(s),this.onInput()}onUpdate(){let{editTarget:e}=this,t=1;if(!this.isHTMLText){let{scaleX:S,scaleY:R}=e.worldTransform;t=Math.max(Math.abs(S),Math.abs(R)),e.fontSize*t<12&&(t*=12/e.fontSize)}this.textScale=t;let{width:n,height:i}=e,s=0,a=0;n*=t,i*=t;let h=e.__;if(h.__autoWidth)switch(n+=20,h.textAlign){case"center":s=h.autoSizeAlign?-n/2:-10;break;case"right":s=h.autoSizeAlign?-n:-20}if(h.__autoHeight)switch(i+=20,h.verticalAlign){case"middle":a=h.autoSizeAlign?-i/2:-10;break;case"bottom":a=h.autoSizeAlign?-i:-20}let{x:l,y:u}=this.inBody?e.app.clientBounds:e.app.tree.clientBounds,{a:f,b:g,c:p,d:v,e:w,f:E}=new ye(e.worldTransform).scale(1/t).translateInner(s,a),{style:P}=this.editDom;P.transform=`matrix(${f},${g},${p},${v},${w},${E})`,P.left=l+"px",P.top=u+"px",P.width=n+"px",P.height=i+"px",this.isHTMLText||AM(this.editDom,e,t)}onUnload(){let{editTarget:e,editor:t,editDom:n}=this;e&&(this.onInput(),e.text===`
`&&(e.text=""),e.textEditing=void 0,t.app&&(t.app.config.keyEvent=this._keyEvent),t.off_(this.eventIds),n.removeEventListener("focus",this.onFocus),n.removeEventListener("input",this.onInput),n.removeEventListener("paste",this.onPaste),window.removeEventListener("keydown",this.onKeydown),window.removeEventListener("scroll",this.onUpdate),n.remove(),this.editDom=this.eventIds=void 0)}};q1=function(e,t,n,i){var s,a=arguments.length,h=a<3?t:i===null?i=Object.getOwnPropertyDescriptor(t,n):i;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")h=Reflect.decorate(e,t,n,i);else for(var l=e.length-1;l>=0;l--)(s=e[l])&&(h=(a<3?s(h):a>3?s(t,n,h):s(t,n))||h);return a>3&&h&&Object.defineProperty(t,n,h),h}([C1()],q1),Zt.add("text-editor","editor");var $1=["*"],MM=["collapseHeader"];function DM(e,t){if(e&1&&(Fh(0),Ne(1,"span",7),Nh()),e&2){let n=t.$implicit,i=xs(2);Fe(),Bi("nzType",n||"right")("nzRotate",i.nzActive?90:0)}}function IM(e,t){if(e&1&&(re(0,"div"),$i(1,DM,2,2,"ng-container",3),jt()),e&2){let n=xs();Fe(),Bi("nzStringTemplateOutlet",n.nzExpandedIcon)}}function zM(e,t){if(e&1&&(Fh(0),Pe(1),Nh()),e&2){let n=xs();Fe(),$u(n.nzHeader)}}function WM(e,t){if(e&1&&(Fh(0),Pe(1),Nh()),e&2){let n=xs(2);Fe(),$u(n.nzExtra)}}function FM(e,t){if(e&1&&(re(0,"div",4),$i(1,WM,2,1,"ng-container",3),jt()),e&2){let n=xs();Fe(),Bi("nzStringTemplateOutlet",n.nzExtra)}}var j1="collapse",Mp=(()=>{class e{constructor(n,i,s,a){this.nzConfigService=n,this.cdr=i,this.directionality=s,this.destroy$=a,this._nzModuleName=j1,this.nzAccordion=!1,this.nzBordered=!0,this.nzGhost=!1,this.nzExpandIconPosition="start",this.dir="ltr",this.listOfNzCollapsePanelComponent=[],this.nzConfigService.getConfigChangeEventForComponent(j1).pipe(Oo(this.destroy$)).subscribe(()=>{this.cdr.markForCheck()})}ngOnInit(){this.directionality.change?.pipe(Oo(this.destroy$)).subscribe(n=>{this.dir=n,this.cdr.detectChanges()}),this.dir=this.directionality.value}addPanel(n){this.listOfNzCollapsePanelComponent.push(n)}removePanel(n){this.listOfNzCollapsePanelComponent.splice(this.listOfNzCollapsePanelComponent.indexOf(n),1)}click(n){this.nzAccordion&&!n.nzActive&&this.listOfNzCollapsePanelComponent.filter(i=>i!==n).forEach(i=>{i.nzActive&&(i.nzActive=!1,i.nzActiveChange.emit(i.nzActive),i.markForCheck())}),n.nzActive=!n.nzActive,n.nzActiveChange.emit(n.nzActive)}static{this.\u0275fac=function(i){return new(i||e)(qn(id),qn(nd),qn(j0),qn(bs))}}static{this.\u0275cmp=Ao({type:e,selectors:[["nz-collapse"]],hostAttrs:[1,"ant-collapse"],hostVars:10,hostBindings:function(i,s){i&2&&Wh("ant-collapse-icon-position-start",s.nzExpandIconPosition==="start")("ant-collapse-icon-position-end",s.nzExpandIconPosition==="end")("ant-collapse-ghost",s.nzGhost)("ant-collapse-borderless",!s.nzBordered)("ant-collapse-rtl",s.dir==="rtl")},inputs:{nzAccordion:[2,"nzAccordion","nzAccordion",Rr],nzBordered:[2,"nzBordered","nzBordered",Rr],nzGhost:[2,"nzGhost","nzGhost",Rr],nzExpandIconPosition:"nzExpandIconPosition"},exportAs:["nzCollapse"],standalone:!0,features:[ed([bs]),Ku,Mo],ngContentSelectors:$1,decls:1,vars:0,template:function(i,s){i&1&&(ju(),Zu(0))},encapsulation:2,changeDetection:0})}}return Ro([Do()],e.prototype,"nzAccordion",void 0),Ro([Do()],e.prototype,"nzBordered",void 0),Ro([Do()],e.prototype,"nzGhost",void 0),e})(),Z1="collapsePanel",J1=(()=>{class e{markForCheck(){this.cdr.markForCheck()}constructor(n,i,s,a){this.nzConfigService=n,this.ngZone=i,this.cdr=s,this.destroy$=a,this._nzModuleName=Z1,this.nzActive=!1,this.nzDisabled=!1,this.nzShowArrow=!0,this.nzActiveChange=new F0,this.nzCollapseComponent=Gu(Mp,{host:!0}),this.noAnimation=Gu(em,{optional:!0}),this.nzConfigService.getConfigChangeEventForComponent(Z1).pipe(Oo(this.destroy$)).subscribe(()=>{this.cdr.markForCheck()})}ngOnInit(){this.nzCollapseComponent.addPanel(this),this.ngZone.runOutsideAngular(()=>z0(this.collapseHeader.nativeElement,"click").pipe(W0(()=>!this.nzDisabled),Oo(this.destroy$)).subscribe(()=>{this.ngZone.run(()=>{this.nzCollapseComponent.click(this),this.cdr.markForCheck()})}))}ngOnDestroy(){this.nzCollapseComponent.removePanel(this)}static{this.\u0275fac=function(i){return new(i||e)(qn(id),qn(N0),qn(nd),qn(bs))}}static{this.\u0275cmp=Ao({type:e,selectors:[["nz-collapse-panel"]],viewQuery:function(i,s){if(i&1&&Hh(MM,7),i&2){let a;Uh(a=Yh())&&(s.collapseHeader=a.first)}},hostAttrs:[1,"ant-collapse-item"],hostVars:6,hostBindings:function(i,s){i&2&&Wh("ant-collapse-no-arrow",!s.nzShowArrow)("ant-collapse-item-active",s.nzActive)("ant-collapse-item-disabled",s.nzDisabled)},inputs:{nzActive:[2,"nzActive","nzActive",Rr],nzDisabled:[2,"nzDisabled","nzDisabled",Rr],nzShowArrow:[2,"nzShowArrow","nzShowArrow",Rr],nzExtra:"nzExtra",nzHeader:"nzHeader",nzExpandedIcon:"nzExpandedIcon"},outputs:{nzActiveChange:"nzActiveChange"},exportAs:["nzCollapsePanel"],standalone:!0,features:[ed([bs]),Ku,Mo],ngContentSelectors:$1,decls:9,vars:8,consts:[["collapseHeader",""],["role","button",1,"ant-collapse-header"],[1,"ant-collapse-header-text"],[4,"nzStringTemplateOutlet"],[1,"ant-collapse-extra"],[1,"ant-collapse-content"],[1,"ant-collapse-content-box"],["nz-icon","",1,"ant-collapse-arrow",3,"nzType","nzRotate"]],template:function(i,s){i&1&&(ju(),re(0,"div",1,0),$i(2,IM,2,1,"div"),re(3,"span",2),$i(4,zM,2,1,"ng-container",3),jt(),$i(5,FM,2,1,"div",4),jt(),re(6,"div",5)(7,"div",6),Zu(8),jt()()),i&2&&(U0("aria-expanded",s.nzActive),Fe(2),ko(s.nzShowArrow?2:-1),Fe(2),Bi("nzStringTemplateOutlet",s.nzHeader),Fe(),ko(s.nzExtra?5:-1),Fe(),Wh("ant-collapse-content-active",s.nzActive),Bi("@.disabled",!!(s.noAnimation!=null&&s.noAnimation.nzNoAnimation))("@collapseMotion",s.nzActive?"expanded":"hidden"))},dependencies:[tm,Q0,q0,Vh],encapsulation:2,data:{animation:[J0]},changeDetection:0})}}return Ro([Do()],e.prototype,"nzShowArrow",void 0),e})();var Qw=UP(Jw());var rg=class extends zt{constructor(t,n,i){super(),this.draggable=!1,this._data=t,this.bg=new Oe({fill:"#fff",x:1,y:1,width:n-2,height:i-2,interactive:!0}),this.label=new st({text:t.text||"",fontSize:14,x:4,y:4,editable:!0,fill:"#32cd79",placeholder:"\u8F93\u5165\u6587\u672C",dragBounds:"parent"}),this.add([this.bg,this.label]),this.on(G.MENU,this.onPointerDown.bind(this))}onPointerDown(t){t.buttons===2&&this.emit("cellRightClick",{cell:this,event:t})}setText(t){this.label.text=t}},Ec=class extends zt{constructor(t,n,i=100,s=40){super(),this.cells=[],this.mergeRegions=[],this.editable=!0,this.rows=t,this.cols=n,this.cellWidth=i,this.cellHeight=s,this.render()}render(){this.clear(),this.cells=[];let t=new zt;for(let s=0;s<=this.cols;s++){let a=s*this.cellWidth;t.add(new Oe({x:a,y:0,width:1,widthRange:{min:1,max:1},editable:!0,height:this.rows*this.cellHeight,fill:"#000"}))}for(let s=0;s<=this.rows;s++){let a=s*this.cellHeight;t.add(new Oe({x:0,y:a,editable:!0,width:this.cols*this.cellWidth,height:1,heightRange:{min:1,max:1},fill:"#000"}))}this.add(t);let n=(s,a)=>this.mergeRegions.find(h=>h.r1===s&&h.c1===a),i=(s,a)=>this.mergeRegions.some(h=>s>=h.r1&&s<=h.r2&&a>=h.c1&&a<=h.c2&&!(s===h.r1&&a===h.c1));for(let s=0;s<this.rows;s++){let a=[];for(let h=0;h<this.cols;h++){if(i(s,h)){a.push(null);continue}let l=n(s,h),u=l?(l.c2-l.c1+1)*this.cellWidth:this.cellWidth,f=l?(l.r2-l.r1+1)*this.cellHeight:this.cellHeight,g=new rg({row:s,col:h,text:""},u,f);g.x=h*this.cellWidth,g.y=s*this.cellHeight,g.on("cellRightClick",p=>this.onCellRightClick(p)),this.add(g),a.push(g)}this.cells.push(a)}}onCellRightClick(t){let{row:n,col:i}=t.cell._data;this.showContextMenu(n,i,t.event)}showContextMenu(t,n,i){switch(prompt(`
        \u8868\u683C\u64CD\u4F5C (\u884C:${t}, \u5217:${n})
        1: \u589E\u52A0\u884C
        2: \u589E\u52A0\u5217
        3: \u5408\u5E76\u53F3\u8FB9\u5355\u5143\u683C
        4: \u52A0\u7C97\u8FB9\u6846
      `)){case"1":this.addRow();break;case"2":this.addCol();break;case"3":this.mergeCells(t,n,t,n+1);break}}addRow(){this.rows++,this.render()}addCol(){this.cols++,this.render()}mergeCells(t,n,i,s){let a=Math.min(t,i),h=Math.min(n,s),l=Math.max(t,i),u=Math.max(n,s);if(!(l>=this.rows||u>=this.cols)){for(let f=a;f<=l;f++)for(let g=h;g<=u;g++)if(this.isCellInAnyMerge(f,g)){console.warn("\u5408\u5E76\u533A\u57DF\u91CD\u53E0\uFF0C\u53D6\u6D88\u64CD\u4F5C");return}this.mergeRegions.push({r1:a,c1:h,r2:l,c2:u}),this.render()}}isCellInAnyMerge(t,n){return this.mergeRegions.some(i=>t>=i.r1&&t<=i.r2&&n>=i.c1&&n<=i.c2)}unmergeCell(t,n){this.mergeRegions=this.mergeRegions.filter(i=>!(i.r1===t&&i.c1===n)),this.render()}},Sc=class extends Us{constructor(t){super({width:t.size||200,height:t.size||200,url:""}),this.editable=!0,this._data=t.content,this._size=t.size||200,this.generate()}generate(){return I0(this,null,function*(){try{let t=yield Qw.default.toDataURL(this._data,{width:this._size,margin:1,color:{dark:"#000",light:"#fff"}});this.url=t}catch(t){console.error("QR Code generation failed:",t)}})}setData(t){this._data=t,this.generate()}setSize(t){this._size=t,this.width=t,this.height=t,this.generate()}};var kD=["leafer"];function MD(e,t){e&1&&(re(0,"div",26)(1,"p"),Pe(2,"\u62D6\u62FD\u5143\u7D20\u5230\u6B64\u5904\u5F00\u59CB\u8BBE\u8BA1"),jt(),Ne(3,"span",36),jt())}var _5=(()=>{class e{constructor(n){this.myApi=n,this.dataSourceTree=[{title:"\u7528\u6237\u4FE1\u606F",key:"user",children:[{title:"\u59D3\u540D",key:"userName",isLeaf:!0},{title:"\u5E74\u9F84",key:"age",isLeaf:!0},{title:"\u90AE\u7BB1",key:"email",isLeaf:!0}]},{title:"\u8BA2\u5355\u4FE1\u606F",key:"order",children:[{title:"\u8BA2\u5355\u53F7",key:"orderId",isLeaf:!0},{title:"\u91D1\u989D",key:"amount",isLeaf:!0},{title:"\u65F6\u95F4",key:"createTime",isLeaf:!0}]}],this.selectItem={type:"window",x:0,y:0,width:0,height:0,color:""}}ngAfterViewInit(){this.app=new Ol({view:"leafer",fill:"#aaa",editor:{keyEvent:!0,multipleSelect:!0},tree:{type:"design"},wheel:{disabled:!0}});let n=new Ec(3,4);this.app.tree.add(n),this.app.editor.on(Xt.SELECT,h=>{this.app?.editor.leafList.list.length>0?(this.selectItem.type=this.app.editor.leafList.list[0].tag,this.selectItem.width=this.app.editor.leafList.list[0].width,this.selectItem.height=this.app.editor.leafList.list[0].height,this.selectItem.x=this.app.editor.leafList.list[0].x,this.selectItem.y=this.app.editor.leafList.list[0].y):(this.selectItem.type="window",this.selectItem.width=this.app?.width,this.selectItem.height=this.app?.height)}),this.selectItem.width=this.app?.width,this.selectItem.height=this.app?.height;let i=new Ql(this.app);new tc(this.app).enable(!0);let a=document.querySelectorAll(".tool-item");for(let h=0;h<a.length;h++)a[h].addEventListener("dragstart",l=>{l.dataTransfer.setData("type",a[h].getAttribute("name"))});this.leafer.nativeElement.addEventListener("dragover",function(h){h.preventDefault()}),this.leafer.nativeElement.addEventListener("drop",h=>{let l=h.dataTransfer.getData("type"),u=this.app.getPagePointByClient(h);if(l==="rect")this.app.tree.add(Oe.one({fill:"#32cd79",editable:!0},u.x,u.y));else if(l==="circle")this.app.tree.add(lr.one({fill:"#32cd79",editable:!0,event:{}},u.x,u.y));else if(l==="line"){let f=new Sc({content:"https://leaferjs.com",size:150,x:u.x,y:u.y});this.app.tree.add(f)}else l==="text"&&this.app.tree.add(st.one({editable:!0,fill:"#32cd79",placeholder:"\u8F93\u5165\u6587\u672C"},u.x,u.y))})}handleGlobalKeyDown(n){n.key==="Delete"&&this.app?.editor.leafList.list.length>0&&this.app?.editor.leafList.list[0].destroy(),n.ctrlKey&&n.key.toLowerCase()==="v"&&this.myApi.readClipboard().then(i=>{if(i){let s=JSON.parse(i);s.x+=10,s.y+=10,this.app.tree.add(s),this.myApi.copy(JSON.stringify(s))}}),n.ctrlKey&&n.key.toLowerCase()==="c"&&this.app?.editor.leafList.list.length>0&&this.myApi.copy(this.app.editor.leafList.list[0].toString())}get hasElements(){return this.app?.tree.children.length>0}fieldChange(n,i){this.app?.editor.leafList.list.length>0?this.app.editor.leafList.list[0][i]=n:this.app[i]=n}static{this.\u0275fac=function(i){return new(i||e)(qn(rm))}}static{this.\u0275cmp=Ao({type:e,selectors:[["app-print"]],viewQuery:function(i,s){if(i&1&&Hh(kD,5),i&2){let a;Uh(a=Yh())&&(s.leafer=a.first)}},hostBindings:function(i,s){i&1&&qu("keydown",function(h){return s.handleGlobalKeyDown(h)},!1,H0)},standalone:!0,features:[Mo],decls:60,vars:5,consts:[["leafer",""],[1,"print-container"],[1,"print-header"],["nz-button","","nzType","primary"],["nz-icon","","nzType","edit"],["nz-icon","","nzType","save"],["nz-button","","nzType","default"],["nz-icon","","nzType","export"],["nz-icon","","nzType","eye"],[1,"print-main"],[1,"print-main-left"],["nzHeader","\u57FA\u7840\u5143\u7D20","nzActive","true"],["name","circle","draggable","true",1,"tool-item"],["nz-icon","","nzType","borderless-table","nzTheme","outline"],["name","rect","draggable","true",1,"tool-item"],["nz-icon","","nzType","border-horizontal","nzTheme","outline"],["name","line","draggable","true",1,"tool-item"],["nz-icon","","nzType","minus","nzTheme","outline"],["name","text","draggable","true",1,"tool-item"],["nz-icon","","nzType","font-colors","nzTheme","outline"],["nzHeader","\u6570\u636E\u5143\u7D20","nzActive","true"],["name","field","draggable","true",1,"tool-item"],["nz-icon","","nzType","database","nzTheme","outline"],["name","table","draggable","true",1,"tool-item"],["nz-icon","","nzType","table","nzTheme","outline"],["id","leafer",1,"print-main-center"],[1,"canvas-placeholder"],[1,"print-main-right"],["nzTitle","\u5C5E\u6027"],[1,"property-panel"],["nz-input","","name","type",3,"ngModelChange","ngModel"],["name","width",3,"ngModelChange","nzBlur","ngModel"],["name","height",3,"ngModel"],["nzTitle","\u6570\u636E\u6E90"],[1,"data-source-panel"],["nzShowIcon","true",3,"nzData"],["nz-icon","","nzType","plus-circle","nzTheme","outline",2,"font-size","48px"]],template:function(i,s){if(i&1){let a=Y0();re(0,"div",1)(1,"div",2)(2,"nz-button-group")(3,"button",3),Ne(4,"span",4),Pe(5," \u7F16\u8F91 "),jt(),re(6,"button",3),Ne(7,"span",5),Pe(8," \u4FDD\u5B58 "),jt(),re(9,"button",6),Ne(10,"span",7),Pe(11," \u5BFC\u51FA "),jt(),re(12,"button",6),Ne(13,"span",8),Pe(14," \u9884\u89C8 "),jt()()(),re(15,"div",9)(16,"div",10)(17,"nz-collapse")(18,"nz-collapse-panel",11)(19,"div",12),Ne(20,"span",13),Pe(21," \u5706\u5F62 "),jt(),re(22,"div",14),Ne(23,"span",15),Pe(24," \u77E9\u5F62 "),jt(),re(25,"div",16),Ne(26,"span",17),Pe(27," \u76F4\u7EBF "),jt(),re(28,"div",18),Ne(29,"span",19),Pe(30," \u6587\u672C "),jt()(),re(31,"nz-collapse-panel",20)(32,"div",21),Ne(33,"span",22),Pe(34," \u6570\u636E\u5B57\u6BB5 "),jt(),re(35,"div",23),Ne(36,"span",24),Pe(37," \u8868\u683C "),jt()()()(),re(38,"div",25,0),$i(40,MD,4,0,"div",26),jt(),re(41,"div",27)(42,"nz-tabset")(43,"nz-tab",28)(44,"div",29)(45,"div")(46,"span"),Pe(47,"\u7C7B\u578B"),jt(),re(48,"input",30),td("ngModelChange",function(l){return Ih(a),Qu(s.selectItem.type,l)||(s.selectItem.type=l),zh(l)}),jt()(),re(49,"div")(50,"span"),Pe(51,"\u5BBD\u5EA6"),jt(),re(52,"nz-input-number",31),td("ngModelChange",function(l){return Ih(a),Qu(s.selectItem.width,l)||(s.selectItem.width=l),zh(l)}),qu("nzBlur",function(){return Ih(a),zh(s.fieldChange(s.selectItem.width,"width"))}),jt()(),re(53,"div")(54,"span"),Pe(55,"\u9AD8\u5EA6"),jt(),Ne(56,"nz-input-number",32),jt()()(),re(57,"nz-tab",33)(58,"div",34),Ne(59,"nz-tree",35),jt()()()()()()}i&2&&(Fe(40),ko(s.hasElements?-1:40),Fe(8),Ju("ngModel",s.selectItem.type),Fe(4),Ju("ngModel",s.selectItem.width),Fe(4),Bi("ngModel",s.selectItem.height),Fe(3),Bi("nzData",s.dataSourceTree))},dependencies:[Z0,Vh,$0,Mp,J1,am,om,hm,im,nm,K0,V0,X0,G0,sm],styles:[".print-container[_ngcontent-%COMP%]{height:100%;display:flex;flex-direction:column}.print-header[_ngcontent-%COMP%]{padding:12px;border-bottom:1px solid #e8e8e8;background:#fff}.print-main[_ngcontent-%COMP%]{flex:1;display:flex;overflow:hidden}.print-main-left[_ngcontent-%COMP%]{width:240px;border-right:1px solid #e8e8e8;background:#fafafa;padding:12px;overflow-y:auto}.print-main-left[_ngcontent-%COMP%]   .tool-item[_ngcontent-%COMP%]{padding:8px 12px;cursor:move;border-radius:4px;margin-bottom:8px;display:flex;align-items:center;gap:8px}.print-main-left[_ngcontent-%COMP%]   .tool-item[_ngcontent-%COMP%]:hover{background:#f0f0f0}.print-main-center[_ngcontent-%COMP%]{flex:1;position:relative;background:#f5f5f5;overflow:auto;min-height:400px}.print-main-center[_ngcontent-%COMP%]   .canvas-placeholder[_ngcontent-%COMP%]{position:absolute;top:50%;left:50%;transform:translate(-50%,-50%);text-align:center;color:#999}.print-main-right[_ngcontent-%COMP%]{width:300px;border-left:1px solid #e8e8e8;background:#fff;overflow-y:auto}.print-main-right[_ngcontent-%COMP%]   .property-panel[_ngcontent-%COMP%], .print-main-right[_ngcontent-%COMP%]   .data-source-panel[_ngcontent-%COMP%]{padding:16px}.print-main-right[_ngcontent-%COMP%]   .property-panel[_ngcontent-%COMP%] > div[_ngcontent-%COMP%]{margin-bottom:5px}.print-main-right[_ngcontent-%COMP%]   .property-panel[_ngcontent-%COMP%] > div[_ngcontent-%COMP%] > input[_ngcontent-%COMP%], .print-main-right[_ngcontent-%COMP%]   .property-panel[_ngcontent-%COMP%] > div[_ngcontent-%COMP%] > nz-input-number[_ngcontent-%COMP%]{width:120px;margin-left:10px}.print-main-right[_ngcontent-%COMP%]   .data-source-panel[_ngcontent-%COMP%]   nz-tree[_ngcontent-%COMP%]{overflow:auto}nz-collapse[_ngcontent-%COMP%]{background:transparent}nz-tabset[_ngcontent-%COMP%]{height:100%}  .ant-tabs-content{height:calc(100% - 40px)}"]})}}return e})();export{_5 as PrintComponent};
