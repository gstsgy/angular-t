import{b as $}from"./chunk-KSRDVEKR.js";import{a as Y,b as Z}from"./chunk-5CUVPQL2.js";import"./chunk-D5MXNW3W.js";import{b as B}from"./chunk-PE6PQG5P.js";import"./chunk-WU3VUF36.js";import{d as X}from"./chunk-G4MBMDPR.js";import{s as U}from"./chunk-C6KGLNM7.js";import"./chunk-RXULLGBC.js";import"./chunk-5MKA6IQ4.js";import{a as O,b as j,e as L,f as P,g as Q,h as G}from"./chunk-GXHJ6PF2.js";import"./chunk-OC5M4CSB.js";import{C as A,D as R,F as T,G as E,H as V,Hb as q,N as W,cc as H,fc as J,hc as K,o as k,ta as D,z as F}from"./chunk-TXLPFZIX.js";import{Cb as M,Dc as z,Fa as p,Ga as d,Gb as s,Ub as l,Vb as m,Wb as x,_b as _,bc as w,dc as a,ic as S,jc as I,kc as b,lb as o,lc as N,mb as g,mc as c,qc as u,rc as f,sc as h,ua as C,uc as v,xb as y}from"./chunk-7MXG77XU.js";var ne=["user"];function ie(r,ee){if(r&1){let e=_();l(0,"form",3)(1,"nz-form-item")(2,"nz-form-label",4),c(3,"id"),m(),l(4,"nz-form-control",4)(5,"input",5),h("ngModelChange",function(t){p(e);let i=a();return f(i.userItem.id,t)||(i.userItem.id=t),d(t)}),m()()(),l(6,"nz-form-item")(7,"nz-form-label",4),c(8,"\u540D\u79F0"),m(),l(9,"nz-form-control",4)(10,"input",6),h("ngModelChange",function(t){p(e);let i=a();return f(i.userItem.name,t)||(i.userItem.name=t),d(t)}),m()()(),l(11,"nz-form-item")(12,"nz-form-label",4),c(13,"\u63CF\u8FF0"),m(),l(14,"nz-form-control",4)(15,"input",7),h("ngModelChange",function(t){p(e);let i=a();return f(i.userItem.desc,t)||(i.userItem.desc=t),d(t)}),m()()(),l(16,"nz-form-item")(17,"nz-form-label",4),c(18,"\u8BBE\u7F6E\u7528\u6237"),m(),l(19,"button",8),w("click",function(){p(e);let t=a(),i=N(4);return d(t.editBtn(i))}),c(20,"\u70B9\u51FB"),m()()()}if(r&2){let e=a();o(2),s("nzSpan",5),o(2),s("nzSpan",12),o(),u("ngModel",e.userItem.id),o(2),s("nzSpan",5),o(2),s("nzSpan",12),o(),u("ngModel",e.userItem.name),o(2),s("nzSpan",5),o(2),s("nzSpan",12),o(),u("ngModel",e.userItem.desc),o(2),s("nzSpan",5)}}function oe(r,ee){if(r&1){let e=_();l(0,"nz-checkbox-group",9),h("ngModelChange",function(t){p(e);let i=a();return f(i.usersModel,t)||(i.usersModel=t),d(t)}),m()}if(r&2){let e=a();u("ngModel",e.usersModel)}}var xe=(()=>{class r extends Y{constructor(e,n,t){super(e,n),this.myApi=e,this.route=n,this.modal=t,this.userItem={id:null,name:"",desc:""},this.usersModel=[]}afterInitialization(){this.myApi.get("userrole/allusers").then(e=>{e.code===200&&(this.usersModel=e.data.map(n=>({label:n.nickName,value:n.id})))})}btnClick(e){if(e==="add"){this.add();return}else if(e==="delete"){this.delete();return}super.btnClick(e)}add(){this.userItem={id:null,name:"",desc:""},this.modal.create({nzWidth:"640px",nzTitle:"\u65B0\u589E\u89D2\u8272",nzContent:this.menuModel,nzClosable:!0,nzOnOk:()=>{this.myApi.post("role/role",this.userItem).then(e=>{e.code===200&&this.myApi.success("\u4FDD\u5B58\u6210\u529F")})},nzCancelText:null})}gotoSetForm(e){this.userItem=e.row,this.modal.create({nzWidth:"640px",nzTitle:"\u7F16\u8F91\u89D2\u8272",nzContent:this.menuModel,nzClosable:!0,nzOnOk:()=>{this.myApi.put("role/role",this.userItem).then(n=>{n.code===200&&this.myApi.success("\u4FDD\u5B58\u6210\u529F")})},nzCancelText:null})}delete(){if(this.selectData.length===0){this.myApi.warning("\u8BF7\u52FE\u9009\u6570\u636E");return}this.myApi.confirm("\u60A8\u662F\u5426\u786E\u8BA4\u5220\u9664\uFF1F",()=>{this.myApi.delete("role/role",this.selectData).then(e=>{e.code===200&&(this.myApi.success("\u5220\u9664\u6210\u529F"),this.refresh())})})}editBtn(e){if(!this.userItem.id){this.myApi.warning("\u8BF7\u5148\u4FDD\u5B58\u89D2\u8272");return}this.usersModel.forEach(n=>n.checked=!1),this.myApi.get(`userrole/users?roleId=${this.userItem.id}`).then(n=>{n.code===200&&n.data.forEach(t=>{let i=this.usersModel.find(te=>te.value===t.userId);i&&(i.checked=!0)})}),this.modal.create({nzWidth:"640px",nzTitle:"\u8BBE\u7F6E\u89D2\u8272",nzContent:e,nzClosable:!0,nzOnOk:()=>{let n=this.usersModel.filter(t=>t.checked).map(t=>({id:t.value}));this.myApi.post(`userrole/userrole?roleId=${this.userItem.id}`,n).then(t=>{t.code===200&&this.myApi.success("\u4FDD\u5B58\u6210\u529F")})},nzCancelText:null})}static{this.\u0275fac=function(n){return new(n||r)(g(K),g(k),g(H))}}static{this.\u0275cmp=C({type:r,selectors:[["app-user"]],viewQuery:function(n,t){if(n&1&&S(ne,5),n&2){let i;I(i=b())&&(t.menuModel=i.first)}},standalone:!0,features:[y,v],decls:5,vars:1,consts:[["user",""],["btns1",""],[2,"height","100%",3,"commonObjs"],["nz-form",""],[3,"nzSpan"],["nz-input","","name","id","disabled","",3,"ngModelChange","ngModel"],["nz-input","","name","code",3,"ngModelChange","ngModel"],["nz-input","","name","nickName",3,"ngModelChange","ngModel"],["nz-button","","nzType","link",3,"click"],[3,"ngModelChange","ngModel"]],template:function(n,t){n&1&&(x(0,"app-form-report",2),M(1,ie,21,10,"ng-template",null,0,z)(3,oe,1,1,"ng-template",null,1,z)),n&2&&s("commonObjs",t.commonObjs)},dependencies:[J,Z,W,V,F,A,R,E,T,j,Q,P,L,G,q,O,X,U,$,B,D]})}}return r})();export{xe as RoleComponent};
