import{b as te}from"./chunk-KSRDVEKR.js";import{a as $,b as ee}from"./chunk-5CUVPQL2.js";import"./chunk-D5MXNW3W.js";import{b as U}from"./chunk-PE6PQG5P.js";import"./chunk-WU3VUF36.js";import{d as Z}from"./chunk-G4MBMDPR.js";import{i as K,r as X,s as Y}from"./chunk-C6KGLNM7.js";import"./chunk-RXULLGBC.js";import"./chunk-5MKA6IQ4.js";import{a as P,b as O,e as L,f as j,g as G,h as R}from"./chunk-GXHJ6PF2.js";import"./chunk-OC5M4CSB.js";import{C as v,D as V,F as A,G as T,H as B,Hb as Q,N as F,cc as q,fc as H,hc as J,o as E,ta as D,z as k}from"./chunk-TXLPFZIX.js";import{Cb as M,Dc as z,Fa as d,Ga as p,Gb as o,Ub as a,Vb as m,Wb as x,_b as f,bc as w,dc as l,ic as S,jc as I,kc as b,lb as r,lc as N,mb as _,mc as u,qc as c,rc as g,sc as h,ua as y,uc as W,xb as C}from"./chunk-7MXG77XU.js";var re=["user"];function oe(s,ne){if(s&1){let t=f();a(0,"form",3)(1,"nz-form-item")(2,"nz-form-label",4),u(3,"\u7528\u6237Id"),m(),a(4,"nz-form-control",4)(5,"input",5),h("ngModelChange",function(e){d(t);let i=l();return g(i.userItem.id,e)||(i.userItem.id=e),p(e)}),m()()(),a(6,"nz-form-item")(7,"nz-form-label",4),u(8,"\u7528\u6237\u540D"),m(),a(9,"nz-form-control",4)(10,"input",6),h("ngModelChange",function(e){d(t);let i=l();return g(i.userItem.code,e)||(i.userItem.code=e),p(e)}),m()()(),a(11,"nz-form-item")(12,"nz-form-label",4),u(13,"\u6635\u79F0"),m(),a(14,"nz-form-control",4)(15,"input",7),h("ngModelChange",function(e){d(t);let i=l();return g(i.userItem.nickName,e)||(i.userItem.nickName=e),p(e)}),m()()(),a(16,"nz-form-item")(17,"nz-form-label",4),u(18,"\u90AE\u7BB1"),m(),a(19,"nz-form-control",4)(20,"input",8),h("ngModelChange",function(e){d(t);let i=l();return g(i.userItem.email,e)||(i.userItem.email=e),p(e)}),m()()(),a(21,"nz-form-item")(22,"nz-form-label",4),u(23,"\u6027\u522B"),m(),a(24,"nz-form-control",4)(25,"nz-select",9),h("ngModelChange",function(e){d(t);let i=l();return g(i.userItem.gender,e)||(i.userItem.gender=e),p(e)}),m()()(),a(26,"nz-form-item")(27,"nz-form-label",4),u(28,"\u751F\u65E5"),m(),a(29,"nz-form-control",4)(30,"nz-date-picker",10),h("ngModelChange",function(e){d(t);let i=l();return g(i.userItem.birthday,e)||(i.userItem.birthday=e),p(e)}),m()()(),a(31,"nz-form-item")(32,"nz-form-label",4),u(33,"\u804C\u4F4D"),m(),a(34,"nz-form-control",4)(35,"input",11),h("ngModelChange",function(e){d(t);let i=l();return g(i.userItem.position,e)||(i.userItem.position=e),p(e)}),m()()(),a(36,"nz-form-item")(37,"nz-form-label",4),u(38,"\u8BBE\u7F6E\u89D2\u8272"),m(),a(39,"button",12),w("click",function(){d(t);let e=l(),i=N(4);return p(e.editBtn(i))}),u(40,"\u70B9\u51FB"),m()()()}if(s&2){let t=l();r(2),o("nzSpan",5),r(2),o("nzSpan",12),r(),c("ngModel",t.userItem.id),r(2),o("nzSpan",5),r(2),o("nzSpan",12),r(),c("ngModel",t.userItem.code),r(2),o("nzSpan",5),r(2),o("nzSpan",12),r(),c("ngModel",t.userItem.nickName),r(2),o("nzSpan",5),r(2),o("nzSpan",12),r(),c("ngModel",t.userItem.email),r(2),o("nzSpan",5),r(2),o("nzSpan",12),r(),c("ngModel",t.userItem.gender),o("nzOptions",t.operatorGenders),r(2),o("nzSpan",5),r(2),o("nzSpan",12),r(),c("ngModel",t.userItem.birthday),r(2),o("nzSpan",5),r(2),o("nzSpan",12),r(),c("ngModel",t.userItem.position),r(2),o("nzSpan",5)}}function ae(s,ne){if(s&1){let t=f();a(0,"nz-checkbox-group",13),h("ngModelChange",function(e){d(t);let i=l();return g(i.rolesModel,e)||(i.rolesModel=e),p(e)}),m()}if(s&2){let t=l();c("ngModel",t.rolesModel)}}var be=(()=>{class s extends ${constructor(t,n,e){super(t,n),this.myApi=t,this.route=n,this.modal=e,this.userItem={id:null,code:"",nickName:"",email:"",position:"",gender:"",birthday:""},this.operatorGenders=[],this.rolesModel=[]}afterInitialization(){this.myApi.getDict("operatorGender").subscribe(t=>{this.operatorGenders=t}),this.myApi.get("userrole/allroles").then(t=>{t.code===200&&(this.rolesModel=t.data.map(n=>({label:n.name,value:n.id})))})}btnClick(t){if(t==="add"){this.add();return}else if(t==="delete"){this.delete();return}super.btnClick(t)}add(){this.userItem={id:null,code:"",nickName:"",email:"",position:"",gender:"",birthday:new Date},this.modal.create({nzWidth:"640px",nzTitle:"\u65B0\u589E\u7528\u6237",nzContent:this.menuModel,nzClosable:!0,nzOnOk:()=>{this.myApi.post("user/user",this.userItem).then(t=>{t.code===200&&this.myApi.success("\u4FDD\u5B58\u6210\u529F")})},nzCancelText:null})}gotoSetForm(t){this.userItem=t.row,this.userItem.birthday=this.myApi.dateParse(this.userItem.birthday),this.modal.create({nzWidth:"640px",nzTitle:"\u7F16\u8F91\u7528\u6237",nzContent:this.menuModel,nzClosable:!0,nzOnOk:()=>{this.userItem.birthday=this.myApi.dateFormat(this.userItem.birthday),this.myApi.put("user/user",this.userItem).then(n=>{n.code===200&&this.myApi.success("\u4FDD\u5B58\u6210\u529F")})},nzCancelText:null})}delete(){if(this.selectData.length===0){this.myApi.warning("\u8BF7\u52FE\u9009\u6570\u636E");return}this.myApi.confirm("\u60A8\u662F\u5426\u786E\u8BA4\u5220\u9664\uFF1F",()=>{this.myApi.delete("user/user",this.selectData).then(t=>{t.code===200&&(this.myApi.success("\u5220\u9664\u6210\u529F"),this.refresh())})})}editBtn(t){if(!this.userItem.id){this.myApi.warning("\u8BF7\u5148\u4FDD\u5B58\u7528\u6237");return}this.rolesModel.forEach(n=>n.checked=!1),this.myApi.get(`userrole/roles?userId=${this.userItem.id}`).then(n=>{n.code===200&&n.data.forEach(e=>{let i=this.rolesModel.find(ie=>ie.value===e.roleId);i&&(i.checked=!0)})}),this.modal.create({nzWidth:"640px",nzTitle:"\u8BBE\u7F6E\u89D2\u8272",nzContent:t,nzClosable:!0,nzOnOk:()=>{let n=this.rolesModel.filter(e=>e.checked).map(e=>({id:e.value}));this.myApi.post(`userrole/roleuser?userId=${this.userItem.id}`,n).then(e=>{e.code===200&&this.myApi.success("\u4FDD\u5B58\u6210\u529F")})},nzCancelText:null})}ngAfterViewInit(){}static{this.\u0275fac=function(n){return new(n||s)(_(J),_(E),_(q))}}static{this.\u0275cmp=y({type:s,selectors:[["app-user"]],viewQuery:function(n,e){if(n&1&&S(re,5),n&2){let i;I(i=b())&&(e.menuModel=i.first)}},standalone:!0,features:[C,W],decls:5,vars:1,consts:[["user",""],["btns1",""],[2,"height","100%",3,"commonObjs"],["nz-form",""],[3,"nzSpan"],["nz-input","","name","id","disabled","",3,"ngModelChange","ngModel"],["nz-input","","name","code",3,"ngModelChange","ngModel"],["nz-input","","name","nickName",3,"ngModelChange","ngModel"],["nz-input","","name","email",3,"ngModelChange","ngModel"],["name","gender","nzAllowClear","","nzShowSearch","","nzPlaceHolder","\u9009\u62E9\u6027\u522B",3,"ngModelChange","ngModel","nzOptions"],["nzFormat","yyyy-MM-dd","name","birthday",3,"ngModelChange","ngModel"],["nz-input","","name","position",3,"ngModelChange","ngModel"],["nz-button","","nzType","link",3,"click"],[3,"ngModelChange","ngModel"]],template:function(n,e){n&1&&(x(0,"app-form-report",2),M(1,oe,41,23,"ng-template",null,0,z)(3,ae,1,1,"ng-template",null,1,z)),n&2&&o("commonObjs",e.commonObjs)},dependencies:[H,ee,F,B,k,v,V,T,A,O,G,j,L,R,Q,P,K,Z,Y,X,te,U,D]})}}return s})();export{be as UserComponent};
