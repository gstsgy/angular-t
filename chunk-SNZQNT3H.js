import{b as ie}from"./chunk-KSRDVEKR.js";import{d as ne}from"./chunk-RXULLGBC.js";import{b as R,e as j,f as q,h as Q}from"./chunk-GXHJ6PF2.js";import{C as k,D as E,F as A,G as F,H as W,Hb as G,Ib as U,N as B,Nb as H,Pb as J,Ub as X,Vb as Y,Wb as Z,cc as $,fc as ee,hc as te,na as L,o as I,ta as K,z as N}from"./chunk-TXLPFZIX.js";import{Cb as x,Dc as P,Fa as a,Ga as d,Gb as s,Ub as o,Vb as r,Wb as h,_b as M,bc as g,dc as _,ic as S,jc as b,kc as v,lb as c,lc as V,mb as f,mc as m,pc as T,qc as C,rc as z,sc as y,ua as O,uc as D}from"./chunk-7MXG77XU.js";var oe=["dictForm"];function re(p,w){if(p&1){let t=M();o(0,"span",18),g("contextmenu",function(n){let i=a(t).$implicit,u=_(),l=V(13);return d(u.contextMenu(n,l,i))}),m(1),r()}if(p&2){let t=w.$implicit,e=w.origin;c(),T(" ",t.title,"-",e.value," ")}}function le(p,w){if(p&1){let t=M();o(0,"form",19)(1,"nz-form-item")(2,"nz-form-label",20),m(3,"model"),r(),o(4,"nz-form-control",20)(5,"input",21),y("ngModelChange",function(n){a(t);let i=_();return z(i.dictItem.modelCode,n)||(i.dictItem.modelCode=n),d(n)}),r()()(),o(6,"nz-form-item")(7,"nz-form-label",20),m(8,"\u952E"),r(),o(9,"nz-form-control",20)(10,"input",22),y("ngModelChange",function(n){a(t);let i=_();return z(i.dictItem.dictKey,n)||(i.dictItem.dictKey=n),d(n)}),r()()(),o(11,"nz-form-item")(12,"nz-form-label",20),m(13,"\u503C"),r(),o(14,"nz-form-control",20)(15,"input",23),y("ngModelChange",function(n){a(t);let i=_();return z(i.dictItem.dictValue,n)||(i.dictItem.dictValue=n),d(n)}),r()()()()}if(p&2){let t=_();c(2),s("nzSpan",5),c(2),s("nzSpan",12),c(),s("disabled",!0),C("ngModel",t.dictItem.modelCode),c(2),s("nzSpan",5),c(2),s("nzSpan",12),c(),C("ngModel",t.dictItem.dictKey),c(2),s("nzSpan",5),c(2),s("nzSpan",12),c(),C("ngModel",t.dictItem.dictValue)}}var Pe=(()=>{class p{constructor(t,e,n,i){this.myApi=t,this.route=e,this.modal=n,this.nzContextMenuService=i,this.searchValue="",this.loading=!1,this.nodes=[],this.showOperations=!0,this.currentNode=null,this.dictItem={id:null,parentId:null,modelCode:null,dictKey:null,dictValue:null,seq:0},this.modelOptions=[]}ngOnInit(){this.refresh()}convertToTreeNodes(t){return t.map(e=>({key:e.id,title:e.label,value:e.value,model:e.model,isLeaf:!e.children||e.children.length===0,children:e.children?this.convertToTreeNodes(e.children):[],icon:!e.children||e.children.length===0?"file":"folder",expanded:e.expanded||!1,disabled:e.disabled||!1,selected:e.selected||!1}))}refresh(){this.myApi.get("dictionary/tree").then(t=>{t.code===200&&(this.nodes=this.convertToTreeNodes(t.data),console.log(this.nodes))})}add(t=null){this.dictItem={id:null,parentId:t.key,modelCode:t.id===4?"9527":t.origin.value,dictKey:null,dictValue:null,seq:0},this.modal.create({nzWidth:"640px",nzTitle:"\u9009\u62E9\u6309\u94AE",nzContent:this.dictForm,nzClosable:!0,nzOnOk:()=>{this.myApi.post("dictionary/dict",this.dictItem).then(e=>{e.code===200&&(this.myApi.success("\u4FDD\u5B58\u6210\u529F"),this.myApi.resetDict(this.dictItem.modelCode??""),this.refresh())})},nzCancelText:null})}edit(t){this.dictItem={id:t.key,parentId:null,modelCode:t.origin.model,dictKey:t.origin.value,dictValue:t.origin.title,seq:0},this.modal.create({nzWidth:"640px",nzTitle:"\u9009\u62E9\u6309\u94AE",nzContent:this.dictForm,nzClosable:!0,nzOnOk:()=>{this.myApi.put("dictionary/dict",this.dictItem).then(e=>{e.code===200&&(this.myApi.success("\u4FDD\u5B58\u6210\u529F"),this.myApi.resetDict(this.dictItem.modelCode??""),this.refresh())})},nzCancelText:null})}delete(t){this.myApi.confirm("\u786E\u5B9A\u5220\u9664\u5417\uFF1F",()=>{this.myApi.delete("dictionary/dict?id="+t.key).then(e=>{e.code===200&&(this.myApi.success("\u5220\u9664\u6210\u529F"),this.refresh())})})}contextMenu(t,e,n){this.currentNode=n,this.nzContextMenuService.create(t,e)}copy(t){this.myApi.copy(t)}static{this.\u0275fac=function(e){return new(e||p)(f(te),f(I),f($),f(Z))}}static{this.\u0275cmp=O({type:p,selectors:[["app-dict"]],viewQuery:function(e,n){if(e&1&&S(oe,5),e&2){let i;b(i=v())&&(n.dictForm=i.first)}},standalone:!0,features:[D],decls:31,vars:6,consts:[["nzTreeTemplate",""],["dictForm",""],["menu","nzDropdownMenu"],[1,"dict-tree-container"],[1,"tree-toolbar"],[1,"search-box"],["nzPrefixIcon","search"],["nz-input","","placeholder","\u641C\u7D22\u8282\u70B9...",3,"ngModelChange","keyup.enter","ngModel"],["nz-button","","nzType","link",3,"click"],["nzBlockNode","",3,"nzData","nzShowLine","nzShowIcon","nzExpandAll","nzMultiple"],["nz-menu",""],["nz-menu-item","",3,"click"],["nz-button","","nzType","text","nzSize","small"],["nz-icon","","nzType","plus","nzTheme","outline"],["nz-icon","","nzType","edit","nzTheme","outline"],["nz-button","","nzType","text","nzSize","small","nzDanger",""],["nz-icon","","nzType","delete","nzTheme","outline"],["nz-icon","","nzType","copy","nzTheme","outline"],[1,"macos-tree-node",3,"contextmenu"],["nz-form",""],[3,"nzSpan"],["nz-input","","name","modelCode",3,"ngModelChange","disabled","ngModel"],["nz-input","","name","dictKey",3,"ngModelChange","ngModel"],["nz-input","","name","dictValue",3,"ngModelChange","ngModel"]],template:function(e,n){if(e&1){let i=M();o(0,"div",3)(1,"div",4)(2,"div",5)(3,"nz-input-group",6)(4,"input",7),y("ngModelChange",function(l){return a(i),z(n.searchValue,l)||(n.searchValue=l),d(l)}),g("keyup.enter",function(){return a(i),d(n.refresh())}),r(),o(5,"button",8),g("click",function(){return a(i),d(n.refresh())}),m(6,"\u641C\u7D22"),r()()()(),o(7,"nz-tree",9),x(8,re,2,2,"ng-template",null,0,P),r()(),x(10,le,16,10,"ng-template",null,1,P),o(12,"nz-dropdown-menu",null,2)(14,"ul",10)(15,"li",11),g("click",function(l){return a(i),n.add(n.currentNode),d(l.stopPropagation())}),o(16,"button",12),h(17,"span",13),r(),m(18," \u6DFB\u52A0\u4E00\u9879 "),r(),o(19,"li",11),g("click",function(l){return a(i),n.edit(n.currentNode),d(l.stopPropagation())}),o(20,"button",12),h(21,"span",14),r(),m(22,"\u7F16\u8F91\u8BE5\u9879 "),r(),o(23,"li",11),g("click",function(l){return a(i),n.delete(n.currentNode),d(l.stopPropagation())}),o(24,"button",15),h(25,"span",16),r(),m(26,"\u5220\u9664\u8BE5\u9879 "),r(),o(27,"li",11),g("click",function(l){return a(i),n.copy(n.currentNode.origin.value),d(l.stopPropagation())}),o(28,"button",12),h(29,"span",17),r(),m(30,"\u590D\u5236key "),r()()()}e&2&&(c(4),C("ngModel",n.searchValue),c(3),s("nzData",n.nodes)("nzShowLine",!0)("nzShowIcon",!1)("nzExpandAll",!1)("nzMultiple",!0))},dependencies:[ee,B,W,N,k,E,F,A,G,ie,U,ne,K,L,j,Q,R,q,X,J,H,Y],styles:['.dict-tree-container[_ngcontent-%COMP%]{height:100%;display:flex;flex-direction:column}.dict-tree-container[_ngcontent-%COMP%]   .tree-toolbar[_ngcontent-%COMP%]{padding:12px 16px;background:#fafafa;border-bottom:1px solid #f0f0f0;display:flex;gap:8px;align-items:center}.dict-tree-container[_ngcontent-%COMP%]   .tree-toolbar[_ngcontent-%COMP%]   .search-box[_ngcontent-%COMP%]{width:300px}.dict-tree-container[_ngcontent-%COMP%]   .tree-wrapper[_ngcontent-%COMP%]{flex:1;padding:16px;overflow:auto}.dict-tree-container[_ngcontent-%COMP%]   .tree-wrapper[_ngcontent-%COMP%]   .tree-node-content[_ngcontent-%COMP%]{display:flex;align-items:center;width:100%}.dict-tree-container[_ngcontent-%COMP%]   .tree-wrapper[_ngcontent-%COMP%]   .tree-node-content[_ngcontent-%COMP%]   .node-title[_ngcontent-%COMP%]{font-weight:500;color:#262626}.dict-tree-container[_ngcontent-%COMP%]   .tree-wrapper[_ngcontent-%COMP%]   .tree-node-content[_ngcontent-%COMP%]   .node-key[_ngcontent-%COMP%]{margin-left:8px;font-size:12px;color:#8c8c8c}.dict-tree-container[_ngcontent-%COMP%]   .tree-wrapper[_ngcontent-%COMP%]   .tree-node-content[_ngcontent-%COMP%]   .node-actions[_ngcontent-%COMP%]{margin-left:auto;opacity:0;transition:opacity .3s}.dict-tree-container[_ngcontent-%COMP%]   .tree-wrapper[_ngcontent-%COMP%]   .tree-node-content[_ngcontent-%COMP%]   .node-actions[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]{margin-left:4px}.dict-tree-container[_ngcontent-%COMP%]   .tree-wrapper[_ngcontent-%COMP%]   .tree-node-content[_ngcontent-%COMP%]:hover   .node-actions[_ngcontent-%COMP%]{opacity:1}  .ant-tree{margin-top:20px;margin-left:20px;width:480px;font-family:-apple-system,BlinkMacSystemFont,Segoe UI,Roboto,sans-serif;font-size:13px;color:#333;background:transparent}  .ant-tree-node-content-wrapper{height:36px;line-height:36px;padding:0 12px;border-radius:8px;margin:2px 0;transition:background .2s ease}  .ant-tree-node-content-wrapper:hover{background-color:#f5f5f7}  .ant-tree-node-selected>.ant-tree-node-content-wrapper{background-color:#e8f3ff!important;color:#007aff!important}.macos-tree-node[_ngcontent-%COMP%]   .folder-icon[_ngcontent-%COMP%]:before{content:"\\1f4c1";margin-right:8px;filter:grayscale(100%) brightness(1.2)}.macos-tree-node[_ngcontent-%COMP%]   .file-icon[_ngcontent-%COMP%]:before{content:"\\1f4c4";margin-right:8px;filter:grayscale(100%) brightness(1.2)}  .ant-tree-node-selected .folder-icon:before, [_ngcontent-%COMP%]::ng-de   deep[_ngcontent-%COMP%]   .ant-tree-node-selected[_ngcontent-%COMP%]   .file-icon[_ngcontent-%COMP%]:before{filter:none!important;color:#007aff}  .ant-tree-indent-unit{width:20px}']})}}return p})();export{Pe as DictComponent};
